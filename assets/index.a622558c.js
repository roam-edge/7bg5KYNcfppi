var na=Object.defineProperty,ia=Object.defineProperties;var aa=Object.getOwnPropertyDescriptors;var Mn=Object.getOwnPropertySymbols;var oa=Object.prototype.hasOwnProperty,sa=Object.prototype.propertyIsEnumerable;var Pn=(e,b,I)=>b in e?na(e,b,{enumerable:!0,configurable:!0,writable:!0,value:I}):e[b]=I,Xe=(e,b)=>{for(var I in b||(b={}))oa.call(b,I)&&Pn(e,I,b[I]);if(Mn)for(var I of Mn(b))sa.call(b,I)&&Pn(e,I,b[I]);return e},ht=(e,b)=>ia(e,aa(b));import{au as At,az as la,i as en,r as ua,g as ye,ac as Nt,x as q,y as se,V as De,aA as da,l as ni,ag as ca,j as ee,B as ce,aB as mt,aC as gr,p as ne,af as ii,f as qe,C as Pr,q as Me,D as pt,ae as Rt,o as tn,aD as fa,E as It,aE as lt,aF as ha,e as et,s as Et,h as Qe,u as Oe,aG as rn,ah as nr,_ as Re,O as xe,N as ve,ao as gt,ap as Vt,A as de,R as at,W as dr,aH as Fe,k as Ae,H as ut,aj as rr,L as Rn,G as pa,I as ot,t as Kt,F as va,av as Tr,z as Ie,T as nn,U as je,w as Wt,aI as ma,aJ as ga,ax as ya,aK as Ea,aL as ai,aM as oi,ar as Ar,aN as ba,aO as Ta,P as xr,Q as Je,aP as xa,m as Sa,aQ as In,aR as La,aS as wn,aq as Ut,aT as Aa,X as wt,aU as Rr,aV as $r,aW as Da,ay as Ge,aX as kn,n as yr,aY as si,v as ln,at as Lt,am as _n,aZ as vr,a_ as Vr,as as Ca,a$ as Oa,b0 as ir,b1 as vt,b2 as Ma,b3 as Pa,b4 as Ra,b5 as li,b6 as ui,b7 as di,b8 as ci,b9 as Ia,ba as fi,bb as Bn,bc as wa,bd as ka,be as _a,bf as Ba,bg as Fa}from"./index.7ca58859.js";import{t as $t,p as an,q as Ua,u as hi,T as Na,m as un,l as Ka,r as on,w as pi,x as Ft,y as Wa,C as vi,E as mi,v as Ha}from"./el-input.facd574b.js";const wr=function(e,b,...I){let M;b.includes("mouse")||b.includes("click")?M="MouseEvents":b.includes("key")?M="KeyboardEvent":M="HTMLEvents";const i=document.createEvent(M);return i.initEvent(b,...I),e.dispatchEvent(i),e},ja=(e,b,I,M=!1)=>{e&&b&&I&&(e==null||e.addEventListener(b,I,M))},Ga=(e,b,I,M=!1)=>{e&&b&&I&&(e==null||e.removeEventListener(b,I,M))},Mt=(e,b,{checkForDefaultPrevented:I=!0}={})=>i=>{const A=e==null?void 0:e(i);if(I===!1||!A)return b==null?void 0:b(i)},za=function(e){for(const b of e){const I=b.target.__resizeListeners__||[];I.length&&I.forEach(M=>{M()})}},dn=function(e,b){!At||!e||(e.__resizeListeners__||(e.__resizeListeners__=[],e.__ro__=new ResizeObserver(za),e.__ro__.observe(e)),e.__resizeListeners__.push(b))},cn=function(e,b){var I;!e||!e.__resizeListeners__||(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(b),1),e.__resizeListeners__.length||(I=e.__ro__)==null||I.disconnect())};var $a=/\s/;function Va(e){for(var b=e.length;b--&&$a.test(e.charAt(b)););return b}var Ya=/^\s+/;function Xa(e){return e&&e.slice(0,Va(e)+1).replace(Ya,"")}var Fn=0/0,Qa=/^[-+]0x[0-9a-f]+$/i,Ja=/^0b[01]+$/i,Za=/^0o[0-7]+$/i,qa=parseInt;function Un(e){if(typeof e=="number")return e;if(la(e))return Fn;if(en(e)){var b=typeof e.valueOf=="function"?e.valueOf():e;e=en(b)?b+"":b}if(typeof e!="string")return e===0?e:+e;e=Xa(e);var I=Ja.test(e);return I||Za.test(e)?qa(e.slice(2),I?2:8):Qa.test(e)?Fn:+e}var eo=function(){return ua.Date.now()},Yr=eo,to="Expected a function",ro=Math.max,no=Math.min;function Nn(e,b,I){var M,i,A,u,r,P,O=0,x=!1,m=!1,c=!0;if(typeof e!="function")throw new TypeError(to);b=Un(b)||0,en(I)&&(x=!!I.leading,m="maxWait"in I,A=m?ro(Un(I.maxWait)||0,b):A,c="trailing"in I?!!I.trailing:c);function v(d){var l=M,s=i;return M=i=void 0,O=d,u=e.apply(s,l),u}function h(d){return O=d,r=setTimeout(g,b),x?v(d):u}function T(d){var l=d-P,s=d-O,f=b-l;return m?no(f,A-s):f}function L(d){var l=d-P,s=d-O;return P===void 0||l>=b||l<0||m&&s>=A}function g(){var d=Yr();if(L(d))return o(d);r=setTimeout(g,T(d))}function o(d){return r=void 0,c&&M?v(d):(M=i=void 0,u)}function t(){r!==void 0&&clearTimeout(r),O=0,M=P=i=r=void 0}function a(){return r===void 0?u:o(Yr())}function n(){var d=Yr(),l=L(d);if(M=arguments,i=this,P=d,l){if(r===void 0)return h(P);if(m)return clearTimeout(r),r=setTimeout(g,b),v(P)}return r===void 0&&(r=setTimeout(g,b)),u}return n.cancel=t,n.flush=a,n}const io=(e="")=>e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d");function ao(e,b){if(!At)return;if(!b){e.scrollTop=0;return}const I=[];let M=b.offsetParent;for(;M!==null&&e!==M&&e.contains(M);)I.push(M),M=M.offsetParent;const i=b.offsetTop+I.reduce((P,O)=>P+O.offsetTop,0),A=i+b.offsetHeight,u=e.scrollTop,r=u+e.clientHeight;i<u?e.scrollTop=i:A>r&&(e.scrollTop=A-e.clientHeight)}const oo=ye({name:"ArrowDown"}),so={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},lo=De("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"},null,-1),uo=[lo];function co(e,b,I,M,i,A){return q(),se("svg",so,uo)}var fo=Nt(oo,[["render",co]]);const ho=ye({name:"ArrowLeft"}),po={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},vo=De("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"},null,-1),mo=[vo];function go(e,b,I,M,i,A){return q(),se("svg",po,mo)}var yo=Nt(ho,[["render",go]]);const Eo=ye({name:"ArrowRight"}),bo={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},To=De("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"},null,-1),xo=[To];function So(e,b,I,M,i,A){return q(),se("svg",bo,xo)}var gi=Nt(Eo,[["render",So]]);const Lo=ye({name:"ArrowUp"}),Ao={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},Do=De("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0z"},null,-1),Co=[Do];function Oo(e,b,I,M,i,A){return q(),se("svg",Ao,Co)}var Mo=Nt(Lo,[["render",Oo]]);const Po=ye({name:"DArrowLeft"}),Ro={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},Io=De("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"},null,-1),wo=[Io];function ko(e,b,I,M,i,A){return q(),se("svg",Ro,wo)}var _o=Nt(Po,[["render",ko]]);const Bo=ye({name:"DArrowRight"}),Fo={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},Uo=De("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688zm-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"},null,-1),No=[Uo];function Ko(e,b,I,M,i,A){return q(),se("svg",Fo,No)}var Wo=Nt(Bo,[["render",Ko]]);const Ho=ye({name:"MoreFilled"}),jo={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},Go=De("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224 112 112 0 0 1 0-224zm336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224zm336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224z"},null,-1),zo=[Go];function $o(e,b,I,M,i,A){return q(),se("svg",jo,zo)}var Vo=Nt(Ho,[["render",$o]]);const Yo=ye({name:"More"}),Xo={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},Qo=De("path",{fill:"currentColor",d:"M176 416a112 112 0 1 0 0 224 112 112 0 0 0 0-224m0 64a48 48 0 1 1 0 96 48 48 0 0 1 0-96zm336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224zm0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96zm336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224zm0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96z"},null,-1),Jo=[Qo];function Zo(e,b,I,M,i,A){return q(),se("svg",Xo,Jo)}var qo=Nt(Yo,[["render",Zo]]);const es=e=>da[e||"default"],ts=e=>["",...ni].includes(e),rs=()=>Math.floor(Math.random()*1e4),yi=Symbol("elPaginationKey"),Ei=Symbol("scrollbarContextKey"),fn=Symbol("popper"),bi=Symbol("popperContent"),ns=e=>({focus:()=>{var b,I;(I=(b=e.value)==null?void 0:b.focus)==null||I.call(b)}});var is={name:"en",el:{colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"}}};const as=e=>(b,I)=>os(b,I,ce(e)),os=(e,b,I)=>mt(I,e,e).replace(/\{(\w+)\}/g,(M,i)=>{var A;return`${(A=b==null?void 0:b[i])!=null?A:`{${i}}`}`}),ss=e=>{const b=ee(()=>ce(e).name),I=gr(e)?e:ne(e);return{lang:b,locale:I,t:as(e)}},Yt=()=>{const e=ca("locale");return ss(ee(()=>e.value||is))},ls=ii({type:qe(Boolean),default:null}),us=ii({type:qe(Function)}),ds=e=>{const b={[e]:ls,[`onUpdate:${e}`]:us},I=[`update:${e}`];return{useModelToggle:({indicator:i,shouldHideWhenRouteChanges:A,shouldProceed:u,onShow:r,onHide:P})=>{const O=Rt(),x=O.props,{emit:m}=O,c=`update:${e}`,v=ee(()=>Pr(x[`onUpdate:${e}`])),h=ee(()=>x[e]===null),T=()=>{i.value!==!0&&(i.value=!0,Pr(r)&&r())},L=()=>{i.value!==!1&&(i.value=!1,Pr(P)&&P())},g=()=>{if(x.disabled===!0||Pr(u)&&!u())return;const n=v.value&&At;n&&m(c,!0),(h.value||!n)&&T()},o=()=>{if(x.disabled===!0||!At)return;const n=v.value&&At;n&&m(c,!1),(h.value||!n)&&L()},t=n=>{!tn(n)||(x.disabled&&n?v.value&&m(c,!1):i.value!==n&&(n?T():L()))},a=()=>{i.value?o():g()};return Me(()=>x[e],t),A&&O.appContext.config.globalProperties.$route!==void 0&&Me(()=>Xe({},O.proxy.$route),()=>{A.value&&i.value&&o()}),pt(()=>{t(x[e])}),{hide:o,show:g,toggle:a}},useModelToggleProps:b,useModelToggleEmits:I}};function cs(){let e;const b=(M,i)=>{I(),e=window.setTimeout(M,i)},I=()=>window.clearTimeout(e);return fa(()=>I()),{registerTimeout:b,cancelTimeout:I}}const fs=e=>{const b=I=>{const M=I;M.key===lt.esc&&(e==null||e(M))};pt(()=>{ja(document,"keydown",b)}),It(()=>{Ga(document,"keydown",b)})};let Kn;const Ti=`el-popper-container-${rs()}`,xi=`#${Ti}`,hs=()=>{const e=document.createElement("div");return e.id=Ti,document.body.appendChild(e),e},ps=()=>{ha(()=>{!At||(!Kn||!document.body.querySelector(xi))&&(Kn=hs())})},vs=et({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200}}),ms=({showAfter:e,hideAfter:b,open:I,close:M})=>{const{registerTimeout:i}=cs();return{onOpen:()=>{i(()=>{I()},ce(e))},onClose:()=>{i(()=>{M()},ce(b))}}},Si=Symbol("elForwardRef"),gs=e=>{Et(Si,{setForwardRef:I=>{e.value=I}})},ys=e=>({mounted(b){e(b)},updated(b){e(b)},unmounted(){e(null)}}),Es={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},bs=({move:e,size:b,bar:I})=>({[I.size]:b,transform:`translate${I.axis}(${e}%)`}),Ts=et({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),Wn="Thumb",xs=ye({name:Wn,props:Ts,setup(e){const b=Qe(Ei),I=Oe("scrollbar");b||$t(Wn,"can not inject scrollbar context");const M=ne(),i=ne(),A=ne({}),u=ne(!1);let r=!1,P=!1,O=At?document.onselectstart:null;const x=ee(()=>Es[e.vertical?"vertical":"horizontal"]),m=ee(()=>bs({size:e.size,move:e.move,bar:x.value})),c=ee(()=>M.value[x.value.offset]**2/b.wrapElement[x.value.scrollSize]/e.ratio/i.value[x.value.offset]),v=n=>{var d;if(n.stopPropagation(),n.ctrlKey||[1,2].includes(n.button))return;(d=window.getSelection())==null||d.removeAllRanges(),T(n);const l=n.currentTarget;!l||(A.value[x.value.axis]=l[x.value.offset]-(n[x.value.client]-l.getBoundingClientRect()[x.value.direction]))},h=n=>{if(!i.value||!M.value||!b.wrapElement)return;const d=Math.abs(n.target.getBoundingClientRect()[x.value.direction]-n[x.value.client]),l=i.value[x.value.offset]/2,s=(d-l)*100*c.value/M.value[x.value.offset];b.wrapElement[x.value.scroll]=s*b.wrapElement[x.value.scrollSize]/100},T=n=>{n.stopImmediatePropagation(),r=!0,document.addEventListener("mousemove",L),document.addEventListener("mouseup",g),O=document.onselectstart,document.onselectstart=()=>!1},L=n=>{if(!M.value||!i.value||r===!1)return;const d=A.value[x.value.axis];if(!d)return;const l=(M.value.getBoundingClientRect()[x.value.direction]-n[x.value.client])*-1,s=i.value[x.value.offset]-d,f=(l-s)*100*c.value/M.value[x.value.offset];b.wrapElement[x.value.scroll]=f*b.wrapElement[x.value.scrollSize]/100},g=()=>{r=!1,A.value[x.value.axis]=0,document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",g),a(),P&&(u.value=!1)},o=()=>{P=!1,u.value=!!e.size},t=()=>{P=!0,u.value=r};It(()=>{a(),document.removeEventListener("mouseup",g)});const a=()=>{document.onselectstart!==O&&(document.onselectstart=O)};return rn(nr(b,"scrollbarElement"),"mousemove",o),rn(nr(b,"scrollbarElement"),"mouseleave",t),{ns:I,instance:M,thumb:i,bar:x,thumbStyle:m,visible:u,clickTrackHandler:h,clickThumbHandler:v}}});function Ss(e,b,I,M,i,A){return q(),xe(dr,{name:e.ns.b("fade")},{default:ve(()=>[gt(De("div",{ref:"instance",class:de([e.ns.e("bar"),e.ns.is(e.bar.key)]),onMousedown:b[1]||(b[1]=(...u)=>e.clickTrackHandler&&e.clickTrackHandler(...u))},[De("div",{ref:"thumb",class:de(e.ns.e("thumb")),style:at(e.thumbStyle),onMousedown:b[0]||(b[0]=(...u)=>e.clickThumbHandler&&e.clickThumbHandler(...u))},null,38)],34),[[Vt,e.always||e.visible]])]),_:1},8,["name"])}var Ls=Re(xs,[["render",Ss],["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/thumb.vue"]]);const As=et({always:{type:Boolean,default:!0},width:{type:String,default:""},height:{type:String,default:""},ratioX:{type:Number,default:1},ratioY:{type:Number,default:1}}),Ds=ye({components:{Thumb:Ls},props:As,setup(e){const b=ne(0),I=ne(0),M=4;return{handleScroll:A=>{if(A){const u=A.offsetHeight-M,r=A.offsetWidth-M;I.value=A.scrollTop*100/u*e.ratioY,b.value=A.scrollLeft*100/r*e.ratioX}},moveX:b,moveY:I}}});function Cs(e,b,I,M,i,A){const u=Fe("thumb");return q(),se(ut,null,[Ae(u,{move:e.moveX,ratio:e.ratioX,size:e.width,always:e.always},null,8,["move","ratio","size","always"]),Ae(u,{move:e.moveY,ratio:e.ratioY,size:e.height,vertical:"",always:e.always},null,8,["move","ratio","size","always"])],64)}var Os=Re(Ds,[["render",Cs],["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/bar.vue"]]);const Ms=et({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:qe([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:{type:Boolean,default:!1},minSize:{type:Number,default:20}}),Ps={scroll:({scrollTop:e,scrollLeft:b})=>rr(e)&&rr(b)},Rs=ye({name:"ElScrollbar",components:{Bar:Os},props:Ms,emits:Ps,setup(e,{emit:b}){const I=Oe("scrollbar");let M,i;const A=ne(),u=ne(),r=ne(),P=ne("0"),O=ne("0"),x=ne(),m=ne(0),c=ne(0),v=ne(1),h=ne(1),T=4,L=ee(()=>{const d={};return e.height&&(d.height=Rn(e.height)),e.maxHeight&&(d.maxHeight=Rn(e.maxHeight)),[e.wrapStyle,d]}),g=()=>{var d;u.value&&((d=x.value)==null||d.handleScroll(u.value),b("scroll",{scrollTop:u.value.scrollTop,scrollLeft:u.value.scrollLeft}))};function o(d,l){Tr(d)?u.value.scrollTo(d):rr(d)&&rr(l)&&u.value.scrollTo(d,l)}const t=d=>{!rr(d)||(u.value.scrollTop=d)},a=d=>{!rr(d)||(u.value.scrollLeft=d)},n=()=>{if(!u.value)return;const d=u.value.offsetHeight-T,l=u.value.offsetWidth-T,s=d**2/u.value.scrollHeight,f=l**2/u.value.scrollWidth,C=Math.max(s,e.minSize),D=Math.max(f,e.minSize);v.value=s/(d-s)/(C/(d-C)),h.value=f/(l-f)/(D/(l-D)),O.value=C+T<d?`${C}px`:"",P.value=D+T<l?`${D}px`:""};return Me(()=>e.noresize,d=>{d?(M==null||M(),i==null||i()):({stop:M}=pa(r,n),i=rn("resize",n))},{immediate:!0}),Me(()=>[e.maxHeight,e.height],()=>{e.native||ot(()=>{var d;n(),u.value&&((d=x.value)==null||d.handleScroll(u.value))})}),Et(Ei,Kt({scrollbarElement:A,wrapElement:u})),pt(()=>{e.native||ot(()=>n())}),va(()=>n()),{ns:I,scrollbar$:A,wrap$:u,resize$:r,barRef:x,moveX:m,moveY:c,ratioX:h,ratioY:v,sizeWidth:P,sizeHeight:O,style:L,update:n,handleScroll:g,scrollTo:o,setScrollTop:t,setScrollLeft:a}}});function Is(e,b,I,M,i,A){const u=Fe("bar");return q(),se("div",{ref:"scrollbar$",class:de(e.ns.b())},[De("div",{ref:"wrap$",class:de([e.wrapClass,e.ns.e("wrap"),{[e.ns.em("wrap","hidden-default")]:!e.native}]),style:at(e.style),onScroll:b[0]||(b[0]=(...r)=>e.handleScroll&&e.handleScroll(...r))},[(q(),xe(nn(e.tag),{ref:"resize$",class:de([e.ns.e("view"),e.viewClass]),style:at(e.viewStyle)},{default:ve(()=>[Ie(e.$slots,"default")]),_:3},8,["class","style"]))],38),e.native?je("v-if",!0):(q(),xe(u,{key:0,ref:"barRef",height:e.sizeHeight,width:e.sizeWidth,always:e.always,"ratio-x":e.ratioX,"ratio-y":e.ratioY},null,8,["height","width","always","ratio-x","ratio-y"]))],2)}var ws=Re(Rs,[["render",Is],["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/scrollbar.vue"]]);const Li=Wt(ws),ks={name:"ElPopperRoot",inheritAttrs:!1},_s=ye(ht(Xe({},ks),{setup(e,{expose:b}){const I=ne(),M=ne(),i=ne(),A=ne(),u={triggerRef:I,popperInstanceRef:M,contentRef:i,referenceRef:A};return b(u),Et(fn,u),(r,P)=>Ie(r.$slots,"default")}}));var Bs=Re(_s,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/popper.vue"]]);const Ai=et({arrowOffset:{type:Number,default:5}}),Fs={name:"ElPopperArrow",inheritAttrs:!1},Us=ye(ht(Xe({},Fs),{props:Ai,setup(e,{expose:b}){const I=e,M=Oe("popper"),{arrowOffset:i,arrowRef:A}=Qe(bi,void 0);return Me(()=>I.arrowOffset,u=>{i.value=u}),It(()=>{A.value=void 0}),b({arrowRef:A}),(u,r)=>(q(),se("span",{ref_key:"arrowRef",ref:A,class:de(ce(M).e("arrow")),"data-popper-arrow":""},null,2))}}));var Ns=Re(Us,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/arrow.vue"]]);const Ks="ElOnlyChild",Ws=ye({name:Ks,setup(e,{slots:b,attrs:I}){var M;const i=Qe(Si),A=ys((M=i==null?void 0:i.setForwardRef)!=null?M:ma);return()=>{var u;const r=(u=b.default)==null?void 0:u.call(b,I);if(!r||r.length>1)return null;const P=Di(r);return P?gt(ga(P,I),[[A]]):null}}});function Di(e){if(!e)return null;const b=e;for(const I of b){if(Tr(I))switch(I.type){case Ea:continue;case ya:return Xr(I);case"svg":return Xr(I);case ut:return Di(I.children);default:return I}return Xr(I)}return null}function Xr(e){return Ae("span",{class:"el-only-child__content"},[e])}const Ci=et({virtualRef:{type:qe(Object)},virtualTriggering:Boolean,onMouseenter:Function,onMouseleave:Function,onClick:Function,onKeydown:Function,onFocus:Function,onBlur:Function,onContextmenu:Function,id:String,open:Boolean}),Hs={name:"ElPopperTrigger",inheritAttrs:!1},js=ye(ht(Xe({},Hs),{props:Ci,setup(e,{expose:b}){const I=e,{triggerRef:M}=Qe(fn,void 0);return gs(M),pt(()=>{Me(()=>I.virtualRef,i=>{i&&(M.value=ai(i))},{immediate:!0}),Me(()=>M.value,(i,A)=>{oi(i)&&["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"].forEach(u=>{var r;const P=I[u];P&&(i.addEventListener(u.slice(2).toLowerCase(),P),(r=A==null?void 0:A.removeEventListener)==null||r.call(A,u.slice(2).toLowerCase(),P))})},{immediate:!0})}),b({triggerRef:M}),(i,A)=>i.virtualTriggering?je("v-if",!0):(q(),xe(ce(Ws),Ar({key:0},i.$attrs,{"aria-describedby":i.open?i.id:void 0}),{default:ve(()=>[Ie(i.$slots,"default")]),_:3},16,["aria-describedby"]))}}));var Gs=Re(js,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/trigger.vue"]]),dt="top",bt="bottom",Tt="right",ct="left",hn="auto",Dr=[dt,bt,Tt,ct],ar="start",Sr="end",zs="clippingParents",Oi="viewport",mr="popper",$s="reference",Hn=Dr.reduce(function(e,b){return e.concat([b+"-"+ar,b+"-"+Sr])},[]),pn=[].concat(Dr,[hn]).reduce(function(e,b){return e.concat([b,b+"-"+ar,b+"-"+Sr])},[]),Vs="beforeRead",Ys="read",Xs="afterRead",Qs="beforeMain",Js="main",Zs="afterMain",qs="beforeWrite",el="write",tl="afterWrite",rl=[Vs,Ys,Xs,Qs,Js,Zs,qs,el,tl];function Ct(e){return e?(e.nodeName||"").toLowerCase():null}function St(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var b=e.ownerDocument;return b&&b.defaultView||window}return e}function or(e){var b=St(e).Element;return e instanceof b||e instanceof Element}function yt(e){var b=St(e).HTMLElement;return e instanceof b||e instanceof HTMLElement}function vn(e){if(typeof ShadowRoot=="undefined")return!1;var b=St(e).ShadowRoot;return e instanceof b||e instanceof ShadowRoot}function nl(e){var b=e.state;Object.keys(b.elements).forEach(function(I){var M=b.styles[I]||{},i=b.attributes[I]||{},A=b.elements[I];!yt(A)||!Ct(A)||(Object.assign(A.style,M),Object.keys(i).forEach(function(u){var r=i[u];r===!1?A.removeAttribute(u):A.setAttribute(u,r===!0?"":r)}))})}function il(e){var b=e.state,I={popper:{position:b.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(b.elements.popper.style,I.popper),b.styles=I,b.elements.arrow&&Object.assign(b.elements.arrow.style,I.arrow),function(){Object.keys(b.elements).forEach(function(M){var i=b.elements[M],A=b.attributes[M]||{},u=Object.keys(b.styles.hasOwnProperty(M)?b.styles[M]:I[M]),r=u.reduce(function(P,O){return P[O]="",P},{});!yt(i)||!Ct(i)||(Object.assign(i.style,r),Object.keys(A).forEach(function(P){i.removeAttribute(P)}))})}}var Mi={name:"applyStyles",enabled:!0,phase:"write",fn:nl,effect:il,requires:["computeStyles"]};function Dt(e){return e.split("-")[0]}var zt=Math.max,Br=Math.min,sr=Math.round;function lr(e,b){b===void 0&&(b=!1);var I=e.getBoundingClientRect(),M=1,i=1;if(yt(e)&&b){var A=e.offsetHeight,u=e.offsetWidth;u>0&&(M=sr(I.width)/u||1),A>0&&(i=sr(I.height)/A||1)}return{width:I.width/M,height:I.height/i,top:I.top/i,right:I.right/M,bottom:I.bottom/i,left:I.left/M,x:I.left/M,y:I.top/i}}function mn(e){var b=lr(e),I=e.offsetWidth,M=e.offsetHeight;return Math.abs(b.width-I)<=1&&(I=b.width),Math.abs(b.height-M)<=1&&(M=b.height),{x:e.offsetLeft,y:e.offsetTop,width:I,height:M}}function Pi(e,b){var I=b.getRootNode&&b.getRootNode();if(e.contains(b))return!0;if(I&&vn(I)){var M=b;do{if(M&&e.isSameNode(M))return!0;M=M.parentNode||M.host}while(M)}return!1}function Pt(e){return St(e).getComputedStyle(e)}function al(e){return["table","td","th"].indexOf(Ct(e))>=0}function Ht(e){return((or(e)?e.ownerDocument:e.document)||window.document).documentElement}function Fr(e){return Ct(e)==="html"?e:e.assignedSlot||e.parentNode||(vn(e)?e.host:null)||Ht(e)}function jn(e){return!yt(e)||Pt(e).position==="fixed"?null:e.offsetParent}function ol(e){var b=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,I=navigator.userAgent.indexOf("Trident")!==-1;if(I&&yt(e)){var M=Pt(e);if(M.position==="fixed")return null}var i=Fr(e);for(vn(i)&&(i=i.host);yt(i)&&["html","body"].indexOf(Ct(i))<0;){var A=Pt(i);if(A.transform!=="none"||A.perspective!=="none"||A.contain==="paint"||["transform","perspective"].indexOf(A.willChange)!==-1||b&&A.willChange==="filter"||b&&A.filter&&A.filter!=="none")return i;i=i.parentNode}return null}function Cr(e){for(var b=St(e),I=jn(e);I&&al(I)&&Pt(I).position==="static";)I=jn(I);return I&&(Ct(I)==="html"||Ct(I)==="body"&&Pt(I).position==="static")?b:I||ol(e)||b}function gn(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Er(e,b,I){return zt(e,Br(b,I))}function sl(e,b,I){var M=Er(e,b,I);return M>I?I:M}function Ri(){return{top:0,right:0,bottom:0,left:0}}function Ii(e){return Object.assign({},Ri(),e)}function wi(e,b){return b.reduce(function(I,M){return I[M]=e,I},{})}var ll=function(e,b){return e=typeof e=="function"?e(Object.assign({},b.rects,{placement:b.placement})):e,Ii(typeof e!="number"?e:wi(e,Dr))};function ul(e){var b,I=e.state,M=e.name,i=e.options,A=I.elements.arrow,u=I.modifiersData.popperOffsets,r=Dt(I.placement),P=gn(r),O=[ct,Tt].indexOf(r)>=0,x=O?"height":"width";if(!(!A||!u)){var m=ll(i.padding,I),c=mn(A),v=P==="y"?dt:ct,h=P==="y"?bt:Tt,T=I.rects.reference[x]+I.rects.reference[P]-u[P]-I.rects.popper[x],L=u[P]-I.rects.reference[P],g=Cr(A),o=g?P==="y"?g.clientHeight||0:g.clientWidth||0:0,t=T/2-L/2,a=m[v],n=o-c[x]-m[h],d=o/2-c[x]/2+t,l=Er(a,d,n),s=P;I.modifiersData[M]=(b={},b[s]=l,b.centerOffset=l-d,b)}}function dl(e){var b=e.state,I=e.options,M=I.element,i=M===void 0?"[data-popper-arrow]":M;i!=null&&(typeof i=="string"&&(i=b.elements.popper.querySelector(i),!i)||!Pi(b.elements.popper,i)||(b.elements.arrow=i))}var cl={name:"arrow",enabled:!0,phase:"main",fn:ul,effect:dl,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ur(e){return e.split("-")[1]}var fl={top:"auto",right:"auto",bottom:"auto",left:"auto"};function hl(e){var b=e.x,I=e.y,M=window,i=M.devicePixelRatio||1;return{x:sr(b*i)/i||0,y:sr(I*i)/i||0}}function Gn(e){var b,I=e.popper,M=e.popperRect,i=e.placement,A=e.variation,u=e.offsets,r=e.position,P=e.gpuAcceleration,O=e.adaptive,x=e.roundOffsets,m=e.isFixed,c=u.x,v=c===void 0?0:c,h=u.y,T=h===void 0?0:h,L=typeof x=="function"?x({x:v,y:T}):{x:v,y:T};v=L.x,T=L.y;var g=u.hasOwnProperty("x"),o=u.hasOwnProperty("y"),t=ct,a=dt,n=window;if(O){var d=Cr(I),l="clientHeight",s="clientWidth";if(d===St(I)&&(d=Ht(I),Pt(d).position!=="static"&&r==="absolute"&&(l="scrollHeight",s="scrollWidth")),d=d,i===dt||(i===ct||i===Tt)&&A===Sr){a=bt;var f=m&&d===n&&n.visualViewport?n.visualViewport.height:d[l];T-=f-M.height,T*=P?1:-1}if(i===ct||(i===dt||i===bt)&&A===Sr){t=Tt;var C=m&&d===n&&n.visualViewport?n.visualViewport.width:d[s];v-=C-M.width,v*=P?1:-1}}var D=Object.assign({position:r},O&&fl),E=x===!0?hl({x:v,y:T}):{x:v,y:T};if(v=E.x,T=E.y,P){var p;return Object.assign({},D,(p={},p[a]=o?"0":"",p[t]=g?"0":"",p.transform=(n.devicePixelRatio||1)<=1?"translate("+v+"px, "+T+"px)":"translate3d("+v+"px, "+T+"px, 0)",p))}return Object.assign({},D,(b={},b[a]=o?T+"px":"",b[t]=g?v+"px":"",b.transform="",b))}function pl(e){var b=e.state,I=e.options,M=I.gpuAcceleration,i=M===void 0?!0:M,A=I.adaptive,u=A===void 0?!0:A,r=I.roundOffsets,P=r===void 0?!0:r,O={placement:Dt(b.placement),variation:ur(b.placement),popper:b.elements.popper,popperRect:b.rects.popper,gpuAcceleration:i,isFixed:b.options.strategy==="fixed"};b.modifiersData.popperOffsets!=null&&(b.styles.popper=Object.assign({},b.styles.popper,Gn(Object.assign({},O,{offsets:b.modifiersData.popperOffsets,position:b.options.strategy,adaptive:u,roundOffsets:P})))),b.modifiersData.arrow!=null&&(b.styles.arrow=Object.assign({},b.styles.arrow,Gn(Object.assign({},O,{offsets:b.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:P})))),b.attributes.popper=Object.assign({},b.attributes.popper,{"data-popper-placement":b.placement})}var ki={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:pl,data:{}},Ir={passive:!0};function vl(e){var b=e.state,I=e.instance,M=e.options,i=M.scroll,A=i===void 0?!0:i,u=M.resize,r=u===void 0?!0:u,P=St(b.elements.popper),O=[].concat(b.scrollParents.reference,b.scrollParents.popper);return A&&O.forEach(function(x){x.addEventListener("scroll",I.update,Ir)}),r&&P.addEventListener("resize",I.update,Ir),function(){A&&O.forEach(function(x){x.removeEventListener("scroll",I.update,Ir)}),r&&P.removeEventListener("resize",I.update,Ir)}}var _i={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:vl,data:{}},ml={left:"right",right:"left",bottom:"top",top:"bottom"};function kr(e){return e.replace(/left|right|bottom|top/g,function(b){return ml[b]})}var gl={start:"end",end:"start"};function zn(e){return e.replace(/start|end/g,function(b){return gl[b]})}function yn(e){var b=St(e),I=b.pageXOffset,M=b.pageYOffset;return{scrollLeft:I,scrollTop:M}}function En(e){return lr(Ht(e)).left+yn(e).scrollLeft}function yl(e){var b=St(e),I=Ht(e),M=b.visualViewport,i=I.clientWidth,A=I.clientHeight,u=0,r=0;return M&&(i=M.width,A=M.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(u=M.offsetLeft,r=M.offsetTop)),{width:i,height:A,x:u+En(e),y:r}}function El(e){var b,I=Ht(e),M=yn(e),i=(b=e.ownerDocument)==null?void 0:b.body,A=zt(I.scrollWidth,I.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),u=zt(I.scrollHeight,I.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),r=-M.scrollLeft+En(e),P=-M.scrollTop;return Pt(i||I).direction==="rtl"&&(r+=zt(I.clientWidth,i?i.clientWidth:0)-A),{width:A,height:u,x:r,y:P}}function bn(e){var b=Pt(e),I=b.overflow,M=b.overflowX,i=b.overflowY;return/auto|scroll|overlay|hidden/.test(I+i+M)}function Bi(e){return["html","body","#document"].indexOf(Ct(e))>=0?e.ownerDocument.body:yt(e)&&bn(e)?e:Bi(Fr(e))}function br(e,b){var I;b===void 0&&(b=[]);var M=Bi(e),i=M===((I=e.ownerDocument)==null?void 0:I.body),A=St(M),u=i?[A].concat(A.visualViewport||[],bn(M)?M:[]):M,r=b.concat(u);return i?r:r.concat(br(Fr(u)))}function sn(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function bl(e){var b=lr(e);return b.top=b.top+e.clientTop,b.left=b.left+e.clientLeft,b.bottom=b.top+e.clientHeight,b.right=b.left+e.clientWidth,b.width=e.clientWidth,b.height=e.clientHeight,b.x=b.left,b.y=b.top,b}function $n(e,b){return b===Oi?sn(yl(e)):or(b)?bl(b):sn(El(Ht(e)))}function Tl(e){var b=br(Fr(e)),I=["absolute","fixed"].indexOf(Pt(e).position)>=0,M=I&&yt(e)?Cr(e):e;return or(M)?b.filter(function(i){return or(i)&&Pi(i,M)&&Ct(i)!=="body"}):[]}function xl(e,b,I){var M=b==="clippingParents"?Tl(e):[].concat(b),i=[].concat(M,[I]),A=i[0],u=i.reduce(function(r,P){var O=$n(e,P);return r.top=zt(O.top,r.top),r.right=Br(O.right,r.right),r.bottom=Br(O.bottom,r.bottom),r.left=zt(O.left,r.left),r},$n(e,A));return u.width=u.right-u.left,u.height=u.bottom-u.top,u.x=u.left,u.y=u.top,u}function Fi(e){var b=e.reference,I=e.element,M=e.placement,i=M?Dt(M):null,A=M?ur(M):null,u=b.x+b.width/2-I.width/2,r=b.y+b.height/2-I.height/2,P;switch(i){case dt:P={x:u,y:b.y-I.height};break;case bt:P={x:u,y:b.y+b.height};break;case Tt:P={x:b.x+b.width,y:r};break;case ct:P={x:b.x-I.width,y:r};break;default:P={x:b.x,y:b.y}}var O=i?gn(i):null;if(O!=null){var x=O==="y"?"height":"width";switch(A){case ar:P[O]=P[O]-(b[x]/2-I[x]/2);break;case Sr:P[O]=P[O]+(b[x]/2-I[x]/2);break}}return P}function Lr(e,b){b===void 0&&(b={});var I=b,M=I.placement,i=M===void 0?e.placement:M,A=I.boundary,u=A===void 0?zs:A,r=I.rootBoundary,P=r===void 0?Oi:r,O=I.elementContext,x=O===void 0?mr:O,m=I.altBoundary,c=m===void 0?!1:m,v=I.padding,h=v===void 0?0:v,T=Ii(typeof h!="number"?h:wi(h,Dr)),L=x===mr?$s:mr,g=e.rects.popper,o=e.elements[c?L:x],t=xl(or(o)?o:o.contextElement||Ht(e.elements.popper),u,P),a=lr(e.elements.reference),n=Fi({reference:a,element:g,strategy:"absolute",placement:i}),d=sn(Object.assign({},g,n)),l=x===mr?d:a,s={top:t.top-l.top+T.top,bottom:l.bottom-t.bottom+T.bottom,left:t.left-l.left+T.left,right:l.right-t.right+T.right},f=e.modifiersData.offset;if(x===mr&&f){var C=f[i];Object.keys(s).forEach(function(D){var E=[Tt,bt].indexOf(D)>=0?1:-1,p=[dt,bt].indexOf(D)>=0?"y":"x";s[D]+=C[p]*E})}return s}function Sl(e,b){b===void 0&&(b={});var I=b,M=I.placement,i=I.boundary,A=I.rootBoundary,u=I.padding,r=I.flipVariations,P=I.allowedAutoPlacements,O=P===void 0?pn:P,x=ur(M),m=x?r?Hn:Hn.filter(function(h){return ur(h)===x}):Dr,c=m.filter(function(h){return O.indexOf(h)>=0});c.length===0&&(c=m);var v=c.reduce(function(h,T){return h[T]=Lr(e,{placement:T,boundary:i,rootBoundary:A,padding:u})[Dt(T)],h},{});return Object.keys(v).sort(function(h,T){return v[h]-v[T]})}function Ll(e){if(Dt(e)===hn)return[];var b=kr(e);return[zn(e),b,zn(b)]}function Al(e){var b=e.state,I=e.options,M=e.name;if(!b.modifiersData[M]._skip){for(var i=I.mainAxis,A=i===void 0?!0:i,u=I.altAxis,r=u===void 0?!0:u,P=I.fallbackPlacements,O=I.padding,x=I.boundary,m=I.rootBoundary,c=I.altBoundary,v=I.flipVariations,h=v===void 0?!0:v,T=I.allowedAutoPlacements,L=b.options.placement,g=Dt(L),o=g===L,t=P||(o||!h?[kr(L)]:Ll(L)),a=[L].concat(t).reduce(function(H,G){return H.concat(Dt(G)===hn?Sl(b,{placement:G,boundary:x,rootBoundary:m,padding:O,flipVariations:h,allowedAutoPlacements:T}):G)},[]),n=b.rects.reference,d=b.rects.popper,l=new Map,s=!0,f=a[0],C=0;C<a.length;C++){var D=a[C],E=Dt(D),p=ur(D)===ar,y=[dt,bt].indexOf(E)>=0,S=y?"width":"height",R=Lr(b,{placement:D,boundary:x,rootBoundary:m,altBoundary:c,padding:O}),w=y?p?Tt:ct:p?bt:dt;n[S]>d[S]&&(w=kr(w));var k=kr(w),_=[];if(A&&_.push(R[E]<=0),r&&_.push(R[w]<=0,R[k]<=0),_.every(function(H){return H})){f=D,s=!1;break}l.set(D,_)}if(s)for(var F=h?3:1,U=function(H){var G=a.find(function(J){var X=l.get(J);if(X)return X.slice(0,H).every(function(te){return te})});if(G)return f=G,"break"},N=F;N>0;N--){var W=U(N);if(W==="break")break}b.placement!==f&&(b.modifiersData[M]._skip=!0,b.placement=f,b.reset=!0)}}var Dl={name:"flip",enabled:!0,phase:"main",fn:Al,requiresIfExists:["offset"],data:{_skip:!1}};function Vn(e,b,I){return I===void 0&&(I={x:0,y:0}),{top:e.top-b.height-I.y,right:e.right-b.width+I.x,bottom:e.bottom-b.height+I.y,left:e.left-b.width-I.x}}function Yn(e){return[dt,Tt,bt,ct].some(function(b){return e[b]>=0})}function Cl(e){var b=e.state,I=e.name,M=b.rects.reference,i=b.rects.popper,A=b.modifiersData.preventOverflow,u=Lr(b,{elementContext:"reference"}),r=Lr(b,{altBoundary:!0}),P=Vn(u,M),O=Vn(r,i,A),x=Yn(P),m=Yn(O);b.modifiersData[I]={referenceClippingOffsets:P,popperEscapeOffsets:O,isReferenceHidden:x,hasPopperEscaped:m},b.attributes.popper=Object.assign({},b.attributes.popper,{"data-popper-reference-hidden":x,"data-popper-escaped":m})}var Ol={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Cl};function Ml(e,b,I){var M=Dt(e),i=[ct,dt].indexOf(M)>=0?-1:1,A=typeof I=="function"?I(Object.assign({},b,{placement:e})):I,u=A[0],r=A[1];return u=u||0,r=(r||0)*i,[ct,Tt].indexOf(M)>=0?{x:r,y:u}:{x:u,y:r}}function Pl(e){var b=e.state,I=e.options,M=e.name,i=I.offset,A=i===void 0?[0,0]:i,u=pn.reduce(function(x,m){return x[m]=Ml(m,b.rects,A),x},{}),r=u[b.placement],P=r.x,O=r.y;b.modifiersData.popperOffsets!=null&&(b.modifiersData.popperOffsets.x+=P,b.modifiersData.popperOffsets.y+=O),b.modifiersData[M]=u}var Rl={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Pl};function Il(e){var b=e.state,I=e.name;b.modifiersData[I]=Fi({reference:b.rects.reference,element:b.rects.popper,strategy:"absolute",placement:b.placement})}var Ui={name:"popperOffsets",enabled:!0,phase:"read",fn:Il,data:{}};function wl(e){return e==="x"?"y":"x"}function kl(e){var b=e.state,I=e.options,M=e.name,i=I.mainAxis,A=i===void 0?!0:i,u=I.altAxis,r=u===void 0?!1:u,P=I.boundary,O=I.rootBoundary,x=I.altBoundary,m=I.padding,c=I.tether,v=c===void 0?!0:c,h=I.tetherOffset,T=h===void 0?0:h,L=Lr(b,{boundary:P,rootBoundary:O,padding:m,altBoundary:x}),g=Dt(b.placement),o=ur(b.placement),t=!o,a=gn(g),n=wl(a),d=b.modifiersData.popperOffsets,l=b.rects.reference,s=b.rects.popper,f=typeof T=="function"?T(Object.assign({},b.rects,{placement:b.placement})):T,C=typeof f=="number"?{mainAxis:f,altAxis:f}:Object.assign({mainAxis:0,altAxis:0},f),D=b.modifiersData.offset?b.modifiersData.offset[b.placement]:null,E={x:0,y:0};if(d){if(A){var p,y=a==="y"?dt:ct,S=a==="y"?bt:Tt,R=a==="y"?"height":"width",w=d[a],k=w+L[y],_=w-L[S],F=v?-s[R]/2:0,U=o===ar?l[R]:s[R],N=o===ar?-s[R]:-l[R],W=b.elements.arrow,H=v&&W?mn(W):{width:0,height:0},G=b.modifiersData["arrow#persistent"]?b.modifiersData["arrow#persistent"].padding:Ri(),J=G[y],X=G[S],te=Er(0,l[R],H[R]),le=t?l[R]/2-F-te-J-C.mainAxis:U-te-J-C.mainAxis,re=t?-l[R]/2+F+te+X+C.mainAxis:N+te+X+C.mainAxis,fe=b.elements.arrow&&Cr(b.elements.arrow),ue=fe?a==="y"?fe.clientTop||0:fe.clientLeft||0:0,ae=(p=D==null?void 0:D[a])!=null?p:0,me=w+le-ae-ue,ge=w+re-ae,be=Er(v?Br(k,me):k,w,v?zt(_,ge):_);d[a]=be,E[a]=be-w}if(r){var Se,we=a==="x"?dt:ct,Ce=a==="x"?bt:Tt,Le=d[n],Ue=n==="y"?"height":"width",Ke=Le+L[we],We=Le-L[Ce],Be=[dt,ct].indexOf(g)!==-1,ze=(Se=D==null?void 0:D[n])!=null?Se:0,Te=Be?Ke:Le-l[Ue]-s[Ue]-ze+C.altAxis,tt=Be?Le+l[Ue]+s[Ue]-ze-C.altAxis:We,rt=v&&Be?sl(Te,Le,tt):Er(v?Te:Ke,Le,v?tt:We);d[n]=rt,E[n]=rt-Le}b.modifiersData[M]=E}}var _l={name:"preventOverflow",enabled:!0,phase:"main",fn:kl,requiresIfExists:["offset"]};function Bl(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Fl(e){return e===St(e)||!yt(e)?yn(e):Bl(e)}function Ul(e){var b=e.getBoundingClientRect(),I=sr(b.width)/e.offsetWidth||1,M=sr(b.height)/e.offsetHeight||1;return I!==1||M!==1}function Nl(e,b,I){I===void 0&&(I=!1);var M=yt(b),i=yt(b)&&Ul(b),A=Ht(b),u=lr(e,i),r={scrollLeft:0,scrollTop:0},P={x:0,y:0};return(M||!M&&!I)&&((Ct(b)!=="body"||bn(A))&&(r=Fl(b)),yt(b)?(P=lr(b,!0),P.x+=b.clientLeft,P.y+=b.clientTop):A&&(P.x=En(A))),{x:u.left+r.scrollLeft-P.x,y:u.top+r.scrollTop-P.y,width:u.width,height:u.height}}function Kl(e){var b=new Map,I=new Set,M=[];e.forEach(function(A){b.set(A.name,A)});function i(A){I.add(A.name);var u=[].concat(A.requires||[],A.requiresIfExists||[]);u.forEach(function(r){if(!I.has(r)){var P=b.get(r);P&&i(P)}}),M.push(A)}return e.forEach(function(A){I.has(A.name)||i(A)}),M}function Wl(e){var b=Kl(e);return rl.reduce(function(I,M){return I.concat(b.filter(function(i){return i.phase===M}))},[])}function Hl(e){var b;return function(){return b||(b=new Promise(function(I){Promise.resolve().then(function(){b=void 0,I(e())})})),b}}function jl(e){var b=e.reduce(function(I,M){var i=I[M.name];return I[M.name]=i?Object.assign({},i,M,{options:Object.assign({},i.options,M.options),data:Object.assign({},i.data,M.data)}):M,I},{});return Object.keys(b).map(function(I){return b[I]})}var Xn={placement:"bottom",modifiers:[],strategy:"absolute"};function Qn(){for(var e=arguments.length,b=new Array(e),I=0;I<e;I++)b[I]=arguments[I];return!b.some(function(M){return!(M&&typeof M.getBoundingClientRect=="function")})}function Tn(e){e===void 0&&(e={});var b=e,I=b.defaultModifiers,M=I===void 0?[]:I,i=b.defaultOptions,A=i===void 0?Xn:i;return function(u,r,P){P===void 0&&(P=A);var O={placement:"bottom",orderedModifiers:[],options:Object.assign({},Xn,A),modifiersData:{},elements:{reference:u,popper:r},attributes:{},styles:{}},x=[],m=!1,c={state:O,setOptions:function(T){var L=typeof T=="function"?T(O.options):T;h(),O.options=Object.assign({},A,O.options,L),O.scrollParents={reference:or(u)?br(u):u.contextElement?br(u.contextElement):[],popper:br(r)};var g=Wl(jl([].concat(M,O.options.modifiers)));return O.orderedModifiers=g.filter(function(o){return o.enabled}),v(),c.update()},forceUpdate:function(){if(!m){var T=O.elements,L=T.reference,g=T.popper;if(Qn(L,g)){O.rects={reference:Nl(L,Cr(g),O.options.strategy==="fixed"),popper:mn(g)},O.reset=!1,O.placement=O.options.placement,O.orderedModifiers.forEach(function(s){return O.modifiersData[s.name]=Object.assign({},s.data)});for(var o=0;o<O.orderedModifiers.length;o++){if(O.reset===!0){O.reset=!1,o=-1;continue}var t=O.orderedModifiers[o],a=t.fn,n=t.options,d=n===void 0?{}:n,l=t.name;typeof a=="function"&&(O=a({state:O,options:d,name:l,instance:c})||O)}}}},update:Hl(function(){return new Promise(function(T){c.forceUpdate(),T(O)})}),destroy:function(){h(),m=!0}};if(!Qn(u,r))return c;c.setOptions(P).then(function(T){!m&&P.onFirstUpdate&&P.onFirstUpdate(T)});function v(){O.orderedModifiers.forEach(function(T){var L=T.name,g=T.options,o=g===void 0?{}:g,t=T.effect;if(typeof t=="function"){var a=t({state:O,name:L,instance:c,options:o}),n=function(){};x.push(a||n)}})}function h(){x.forEach(function(T){return T()}),x=[]}return c}}Tn();var Gl=[_i,Ui,ki,Mi];Tn({defaultModifiers:Gl});var zl=[_i,Ui,ki,Mi,Rl,Dl,_l,cl,Ol],$l=Tn({defaultModifiers:zl});const Vl=["fixed","absolute"],Yl=et({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:qe(Array),default:()=>[]},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:pn,default:"bottom"},popperOptions:{type:qe(Object),default:()=>({})},strategy:{type:String,values:Vl,default:"absolute"}}),Ni=et(ht(Xe({},Yl),{style:{type:qe([String,Array,Object])},className:{type:qe([String,Array,Object])},effect:{type:String,default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,popperClass:{type:qe([String,Array,Object])},popperStyle:{type:qe([String,Array,Object])},referenceEl:{type:qe(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},zIndex:Number})),Jn=(e,b)=>{const{placement:I,strategy:M,popperOptions:i}=e,A=ht(Xe({placement:I,strategy:M},i),{modifiers:Ql(e)});return Jl(A,b),Zl(A,i==null?void 0:i.modifiers),A},Xl=e=>{if(!!At)return ai(e)};function Ql(e){const{offset:b,gpuAcceleration:I,fallbackPlacements:M}=e;return[{name:"offset",options:{offset:[0,b!=null?b:12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:M!=null?M:[]}},{name:"computeStyles",options:{gpuAcceleration:I,adaptive:I}}]}function Jl(e,{arrowEl:b,arrowOffset:I}){e.modifiers.push({name:"arrow",options:{element:b,padding:I!=null?I:5}})}function Zl(e,b){b&&(e.modifiers=[...e.modifiers,...b!=null?b:[]])}const ql={name:"ElPopperContent"},eu=ye(ht(Xe({},ql),{props:Ni,emits:["mouseenter","mouseleave"],setup(e,{expose:b}){const I=e,{popperInstanceRef:M,contentRef:i,triggerRef:A}=Qe(fn,void 0),u=Qe(an,void 0),{nextZIndex:r}=ba(),P=Oe("popper"),O=ne(),x=ne(),m=ne();Et(bi,{arrowRef:x,arrowOffset:m}),Et(an,ht(Xe({},u),{addInputId:()=>{},removeInputId:()=>{}}));const c=ne(I.zIndex||r()),v=ee(()=>Xl(I.referenceEl)||ce(A)),h=ee(()=>[{zIndex:ce(c)},I.popperStyle]),T=ee(()=>[P.b(),P.is("pure",I.pure),P.is(I.effect),I.popperClass]),L=({referenceEl:t,popperContentEl:a,arrowEl:n})=>{const d=Jn(I,{arrowEl:n,arrowOffset:ce(m)});return $l(t,a,d)},g=(t=!0)=>{var a;(a=ce(M))==null||a.update(),t&&(c.value=I.zIndex||r())},o=()=>{var t,a;const n={name:"eventListeners",enabled:I.visible};(a=(t=ce(M))==null?void 0:t.setOptions)==null||a.call(t,d=>ht(Xe({},d),{modifiers:[...d.modifiers||[],n]})),g(!1)};return pt(()=>{let t;Me(v,a=>{var n;t==null||t();const d=ce(M);if((n=d==null?void 0:d.destroy)==null||n.call(d),a){const l=ce(O);i.value=l,M.value=L({referenceEl:a,popperContentEl:l,arrowEl:ce(x)}),t=Me(()=>a.getBoundingClientRect(),()=>g(),{immediate:!0})}else M.value=void 0},{immediate:!0}),Me(()=>I.visible,o,{immediate:!0}),Me(()=>Jn(I,{arrowEl:ce(x),arrowOffset:ce(m)}),a=>{var n;return(n=M.value)==null?void 0:n.setOptions(a)})}),b({popperContentRef:O,popperInstanceRef:M,updatePopper:g,contentStyle:h}),(t,a)=>(q(),se("div",{ref_key:"popperContentRef",ref:O,style:at(ce(h)),class:de(ce(T)),role:"tooltip",onMouseenter:a[0]||(a[0]=n=>t.$emit("mouseenter",n)),onMouseleave:a[1]||(a[1]=n=>t.$emit("mouseleave",n))},[Ie(t.$slots,"default")],38))}}));var tu=Re(eu,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/content.vue"]]);const ru={LIGHT:"light",DARK:"dark"};et({autoClose:{type:Number,default:0},cutoff:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}});const nu=Wt(Bs),iu=ye({name:"ElVisuallyHidden",props:{style:{type:[String,Object,Array]}},setup(e){return{computedStyle:ee(()=>[e.style,{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}])}}});function au(e,b,I,M,i,A){return q(),se("span",Ar(e.$attrs,{style:e.computedStyle}),[Ie(e.$slots,"default")],16)}var ou=Re(iu,[["render",au],["__file","/home/runner/work/element-plus/element-plus/packages/components/visual-hidden/src/visual-hidden.vue"]]);const xn=et(ht(Xe(Xe({},vs),Ni),{appendTo:{type:qe([String,Object]),default:xi},content:{type:String,default:""},rawContent:{type:Boolean,default:!1},persistent:Boolean,ariaLabel:String,visible:{type:qe(Boolean),default:null},transition:{type:String,default:"el-fade-in-linear"},teleported:{type:Boolean,default:!0},disabled:{type:Boolean}})),Ki=et(ht(Xe({},Ci),{disabled:Boolean,trigger:{type:qe([String,Array]),default:"hover"}})),su=et({openDelay:{type:Number},visibleArrow:{type:Boolean,default:void 0},hideAfter:{type:Number,default:200},showArrow:{type:Boolean,default:!0}}),Sn=Symbol("elTooltip"),lu=ye({name:"ElTooltipContent",components:{ElPopperContent:tu,ElVisuallyHidden:ou},inheritAttrs:!1,props:xn,setup(e){const b=ne(null),I=ne(!1),M=ne(!1),i=ne(!1),A=ne(!1),{controlled:u,id:r,open:P,trigger:O,onClose:x,onOpen:m,onShow:c,onHide:v,onBeforeShow:h,onBeforeHide:T}=Qe(Sn,void 0),L=ee(()=>e.persistent);It(()=>{A.value=!0});const g=ee(()=>ce(L)?!0:ce(P)),o=ee(()=>e.disabled?!1:ce(P)),t=ee(()=>{var p;return(p=e.style)!=null?p:{}}),a=ee(()=>!ce(P));fs(x);const n=()=>{v()},d=()=>{if(ce(u))return!0},l=Mt(d,()=>{e.enterable&&ce(O)==="hover"&&m()}),s=Mt(d,()=>{ce(O)==="hover"&&x()}),f=()=>{var p,y;(y=(p=b.value)==null?void 0:p.updatePopper)==null||y.call(p),h==null||h()},C=()=>{T==null||T()},D=()=>{c()};let E;return Me(()=>ce(P),p=>{p?E=Ta(ee(()=>{var y;return(y=b.value)==null?void 0:y.popperContentRef}),()=>{if(ce(u))return;ce(O)!=="hover"&&x()}):E==null||E()},{flush:"post"}),{ariaHidden:a,entering:M,leaving:i,id:r,intermediateOpen:I,contentStyle:t,contentRef:b,destroyed:A,shouldRender:g,shouldShow:o,open:P,onAfterShow:D,onBeforeEnter:f,onBeforeLeave:C,onContentEnter:l,onContentLeave:s,onTransitionLeave:n}}});function uu(e,b,I,M,i,A){const u=Fe("el-visually-hidden"),r=Fe("el-popper-content");return q(),xe(xa,{disabled:!e.teleported,to:e.appendTo},[Ae(dr,{name:e.transition,onAfterLeave:e.onTransitionLeave,onBeforeEnter:e.onBeforeEnter,onAfterEnter:e.onAfterShow,onBeforeLeave:e.onBeforeLeave},{default:ve(()=>[e.shouldRender?gt((q(),xe(r,Ar({key:0,ref:"contentRef"},e.$attrs,{"aria-hidden":e.ariaHidden,"boundaries-padding":e.boundariesPadding,"fallback-placements":e.fallbackPlacements,"gpu-acceleration":e.gpuAcceleration,offset:e.offset,placement:e.placement,"popper-options":e.popperOptions,strategy:e.strategy,effect:e.effect,enterable:e.enterable,pure:e.pure,"popper-class":e.popperClass,"popper-style":[e.popperStyle,e.contentStyle],"reference-el":e.referenceEl,visible:e.shouldShow,"z-index":e.zIndex,onMouseenter:e.onContentEnter,onMouseleave:e.onContentLeave}),{default:ve(()=>[je(" Workaround bug #6378 "),e.destroyed?je("v-if",!0):(q(),se(ut,{key:0},[Ie(e.$slots,"default"),Ae(u,{id:e.id,role:"tooltip"},{default:ve(()=>[xr(Je(e.ariaLabel),1)]),_:1},8,["id"])],64))]),_:3},16,["aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","visible","z-index","onMouseenter","onMouseleave"])),[[Vt,e.shouldShow]]):je("v-if",!0)]),_:3},8,["name","onAfterLeave","onBeforeEnter","onAfterEnter","onBeforeLeave"])],8,["disabled","to"])}var du=Re(lu,[["render",uu],["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/content.vue"]]);const cu=(e,b)=>Sa(e)?e.includes(b):e===b,tr=(e,b,I)=>M=>{cu(ce(e),b)&&I(M)},fu=ye({name:"ElTooltipTrigger",components:{ElPopperTrigger:Gs},props:Ki,setup(e){const b=Oe("tooltip"),{controlled:I,id:M,open:i,onOpen:A,onClose:u,onToggle:r}=Qe(Sn,void 0),P=ne(null),O=()=>{if(ce(I)||e.disabled)return!0},x=nr(e,"trigger"),m=Mt(O,tr(x,"hover",A)),c=Mt(O,tr(x,"hover",u)),v=Mt(O,tr(x,"click",o=>{o.button===0&&r(o)})),h=Mt(O,tr(x,"focus",A)),T=Mt(O,tr(x,"focus",u)),L=Mt(O,tr(x,"contextmenu",o=>{o.preventDefault(),r(o)})),g=Mt(O,o=>{const{code:t}=o;(t===lt.enter||t===lt.space)&&r(o)});return{onBlur:T,onContextMenu:L,onFocus:h,onMouseenter:m,onMouseleave:c,onClick:v,onKeydown:g,open:i,id:M,triggerRef:P,ns:b}}});function hu(e,b,I,M,i,A){const u=Fe("el-popper-trigger");return q(),xe(u,{id:e.id,"virtual-ref":e.virtualRef,open:e.open,"virtual-triggering":e.virtualTriggering,class:de(e.ns.e("trigger")),onBlur:e.onBlur,onClick:e.onClick,onContextmenu:e.onContextMenu,onFocus:e.onFocus,onMouseenter:e.onMouseenter,onMouseleave:e.onMouseleave,onKeydown:e.onKeydown},{default:ve(()=>[Ie(e.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"])}var pu=Re(fu,[["render",hu],["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/trigger.vue"]]);const{useModelToggleProps:vu,useModelToggle:mu,useModelToggleEmits:gu}=ds("visible"),yu=ye({name:"ElTooltip",components:{ElPopper:nu,ElPopperArrow:Ns,ElTooltipContent:du,ElTooltipTrigger:pu},props:Xe(Xe(Xe(Xe(Xe({},vu),xn),Ki),Ai),su),emits:[...gu,"before-show","before-hide","show","hide"],setup(e,{emit:b}){ps();const I=ee(()=>(In(e.openDelay),e.openDelay||e.showAfter)),M=ee(()=>(In(e.visibleArrow),tn(e.visibleArrow)?e.visibleArrow:e.showArrow)),i=Ua(),A=ne(null),u=()=>{var v;const h=ce(A);h&&((v=h.popperInstanceRef)==null||v.update())},r=ne(!1),{show:P,hide:O}=mu({indicator:r}),{onOpen:x,onClose:m}=ms({showAfter:I,hideAfter:nr(e,"hideAfter"),open:P,close:O}),c=ee(()=>tn(e.visible));return Et(Sn,{controlled:c,id:i,open:La(r),trigger:nr(e,"trigger"),onOpen:x,onClose:m,onToggle:()=>{ce(r)?m():x()},onShow:()=>{b("show")},onHide:()=>{b("hide")},onBeforeShow:()=>{b("before-show")},onBeforeHide:()=>{b("before-hide")},updatePopper:u}),Me(()=>e.disabled,v=>{v&&r.value&&(r.value=!1)}),{compatShowAfter:I,compatShowArrow:M,popperRef:A,open:r,hide:O,updatePopper:u,onOpen:x,onClose:m}}}),Eu=["innerHTML"],bu={key:1};function Tu(e,b,I,M,i,A){const u=Fe("el-tooltip-trigger"),r=Fe("el-popper-arrow"),P=Fe("el-tooltip-content"),O=Fe("el-popper");return q(),xe(O,{ref:"popperRef"},{default:ve(()=>[Ae(u,{disabled:e.disabled,trigger:e.trigger,"virtual-ref":e.virtualRef,"virtual-triggering":e.virtualTriggering},{default:ve(()=>[e.$slots.default?Ie(e.$slots,"default",{key:0}):je("v-if",!0)]),_:3},8,["disabled","trigger","virtual-ref","virtual-triggering"]),Ae(P,{"aria-label":e.ariaLabel,"boundaries-padding":e.boundariesPadding,content:e.content,disabled:e.disabled,effect:e.effect,enterable:e.enterable,"fallback-placements":e.fallbackPlacements,"hide-after":e.hideAfter,"gpu-acceleration":e.gpuAcceleration,offset:e.offset,persistent:e.persistent,"popper-class":e.popperClass,"popper-style":e.popperStyle,placement:e.placement,"popper-options":e.popperOptions,pure:e.pure,"raw-content":e.rawContent,"reference-el":e.referenceEl,"show-after":e.compatShowAfter,strategy:e.strategy,teleported:e.teleported,transition:e.transition,"z-index":e.zIndex,"append-to":e.appendTo},{default:ve(()=>[Ie(e.$slots,"content",{},()=>[e.rawContent?(q(),se("span",{key:0,innerHTML:e.content},null,8,Eu)):(q(),se("span",bu,Je(e.content),1))]),e.compatShowArrow?(q(),xe(r,{key:0,"arrow-offset":e.arrowOffset},null,8,["arrow-offset"])):je("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","show-after","strategy","teleported","transition","z-index","append-to"])]),_:3},512)}var xu=Re(yu,[["render",Tu],["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/tooltip.vue"]]);const Ln=Wt(xu),Bt=new Map;let Zn;At&&(document.addEventListener("mousedown",e=>Zn=e),document.addEventListener("mouseup",e=>{for(const b of Bt.values())for(const{documentHandler:I}of b)I(e,Zn)}));function qn(e,b){let I=[];return Array.isArray(b.arg)?I=b.arg:oi(b.arg)&&I.push(b.arg),function(M,i){const A=b.instance.popperRef,u=M.target,r=i==null?void 0:i.target,P=!b||!b.instance,O=!u||!r,x=e.contains(u)||e.contains(r),m=e===u,c=I.length&&I.some(h=>h==null?void 0:h.contains(u))||I.length&&I.includes(r),v=A&&(A.contains(u)||A.contains(r));P||O||x||m||c||v||b.value(M,i)}}const Su={beforeMount(e,b){Bt.has(e)||Bt.set(e,[]),Bt.get(e).push({documentHandler:qn(e,b),bindingFn:b.value})},updated(e,b){Bt.has(e)||Bt.set(e,[]);const I=Bt.get(e),M=I.findIndex(A=>A.bindingFn===b.oldValue),i={documentHandler:qn(e,b),bindingFn:b.value};M>=0?I.splice(M,1,i):I.push(i)},unmounted(e){Bt.delete(e)}},Lu={beforeMount(e,b){e._handleResize=()=>{var I;e&&((I=b.value)==null||I.call(b,e))},dn(e,e._handleResize)},beforeUnmount(e){cn(e,e._handleResize)}},Wi=et({closable:Boolean,type:{type:String,values:["success","info","warning","danger",""],default:""},hit:Boolean,disableTransitions:Boolean,color:{type:String,default:""},size:{type:String,values:ni,default:""},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),Au={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent},Du={name:"ElTag"},Cu=ye(ht(Xe({},Du),{props:Wi,emits:Au,setup(e,{emit:b}){const I=e,M=hi(),i=Oe("tag"),A=ee(()=>{const{type:P,hit:O,effect:x,closable:m,round:c}=I;return[i.b(),i.is("closable",m),i.m(P),i.m(M.value),i.m(x),i.is("hit",O),i.is("round",c)]}),u=P=>{P.stopPropagation(),b("close",P)},r=P=>{b("click",P)};return(P,O)=>P.disableTransitions?(q(),xe(dr,{key:1,name:`${ce(i).namespace.value}-zoom-in-center`},{default:ve(()=>[De("span",{class:de(ce(A)),style:at({backgroundColor:P.color}),onClick:r},[De("span",{class:de(ce(i).e("content"))},[Ie(P.$slots,"default")],2),P.closable?(q(),xe(ce(Ut),{key:0,class:de(ce(i).e("close")),onClick:u},{default:ve(()=>[Ae(ce(wn))]),_:1},8,["class"])):je("v-if",!0)],6)]),_:3},8,["name"])):(q(),se("span",{key:0,class:de(ce(A)),style:at({backgroundColor:P.color}),onClick:r},[De("span",{class:de(ce(i).e("content"))},[Ie(P.$slots,"default")],2),P.closable?(q(),xe(ce(Ut),{key:0,class:de(ce(i).e("close")),onClick:u},{default:ve(()=>[Ae(ce(wn))]),_:1},8,["class"])):je("v-if",!0)],6))}}));var Ou=Re(Cu,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tag/src/tag.vue"]]);const Mu=Wt(Ou),Pu=ye({name:"ElCollapseTransition",setup(){return{ns:Oe("collapse-transition"),on:{beforeEnter(b){b.dataset||(b.dataset={}),b.dataset.oldPaddingTop=b.style.paddingTop,b.dataset.oldPaddingBottom=b.style.paddingBottom,b.style.maxHeight=0,b.style.paddingTop=0,b.style.paddingBottom=0},enter(b){b.dataset.oldOverflow=b.style.overflow,b.scrollHeight!==0?(b.style.maxHeight=`${b.scrollHeight}px`,b.style.paddingTop=b.dataset.oldPaddingTop,b.style.paddingBottom=b.dataset.oldPaddingBottom):(b.style.maxHeight=0,b.style.paddingTop=b.dataset.oldPaddingTop,b.style.paddingBottom=b.dataset.oldPaddingBottom),b.style.overflow="hidden"},afterEnter(b){b.style.maxHeight="",b.style.overflow=b.dataset.oldOverflow},beforeLeave(b){b.dataset||(b.dataset={}),b.dataset.oldPaddingTop=b.style.paddingTop,b.dataset.oldPaddingBottom=b.style.paddingBottom,b.dataset.oldOverflow=b.style.overflow,b.style.maxHeight=`${b.scrollHeight}px`,b.style.overflow="hidden"},leave(b){b.scrollHeight!==0&&(b.style.maxHeight=0,b.style.paddingTop=0,b.style.paddingBottom=0)},afterLeave(b){b.style.maxHeight="",b.style.overflow=b.dataset.oldOverflow,b.style.paddingTop=b.dataset.oldPaddingTop,b.style.paddingBottom=b.dataset.oldPaddingBottom}}}}});function Ru(e,b,I,M,i,A){return q(),xe(dr,Ar({name:e.ns.b()},Aa(e.on)),{default:ve(()=>[Ie(e.$slots,"default")]),_:3},16,["name"])}var _r=Re(Pu,[["render",Ru],["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse-transition/src/collapse-transition.vue"]]);_r.install=e=>{e.component(_r.name,_r)};const Iu=_r,wu=ye({name:"ElContainer",props:{direction:{type:String,default:""}},setup(e,{slots:b}){const I=Oe("container");return{isVertical:ee(()=>e.direction==="vertical"?!0:e.direction==="horizontal"?!1:b&&b.default?b.default().some(A=>{const u=A.type.name;return u==="ElHeader"||u==="ElFooter"}):!1),ns:I}}});function ku(e,b,I,M,i,A){return q(),se("section",{class:de([e.ns.b(),e.ns.is("vertical",e.isVertical)])},[Ie(e.$slots,"default")],2)}var _u=Re(wu,[["render",ku],["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/container.vue"]]);const Bu=ye({name:"ElAside",props:{width:{type:String,default:null}},setup(e){const b=Oe("aside");return{style:ee(()=>e.width?b.cssVarBlock({width:e.width}):{}),ns:b}}});function Fu(e,b,I,M,i,A){return q(),se("aside",{class:de(e.ns.b()),style:at(e.style)},[Ie(e.$slots,"default")],6)}var Hi=Re(Bu,[["render",Fu],["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/aside.vue"]]);const Uu=ye({name:"ElFooter",props:{height:{type:String,default:null}},setup(e){const b=Oe("footer");return{style:ee(()=>e.height?b.cssVarBlock({height:e.height}):{}),ns:b}}});function Nu(e,b,I,M,i,A){return q(),se("footer",{class:de(e.ns.b()),style:at(e.style)},[Ie(e.$slots,"default")],6)}var ji=Re(Uu,[["render",Nu],["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/footer.vue"]]);const Ku=ye({name:"ElHeader",props:{height:{type:String,default:null}},setup(e){const b=Oe("header");return{style:ee(()=>e.height?b.cssVarBlock({height:e.height}):{}),ns:b}}});function Wu(e,b,I,M,i,A){return q(),se("header",{class:de(e.ns.b()),style:at(e.style)},[Ie(e.$slots,"default")],6)}var Gi=Re(Ku,[["render",Wu],["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/header.vue"]]);const Hu=ye({name:"ElMain",setup(){return{ns:Oe("main")}}});function ju(e,b,I,M,i,A){return q(),se("main",{class:de(e.ns.b())},[Ie(e.$slots,"default")],2)}var zi=Re(Hu,[["render",ju],["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/main.vue"]]);const Gu=Wt(_u,{Aside:Hi,Footer:ji,Header:Gi,Main:zi}),zu=wt(Hi),$u=wt(ji),Vu=wt(Gi),Yu=wt(zi);class Xu{constructor(b,I){this.parent=b,this.domNode=I,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()}gotoSubIndex(b){b===this.subMenuItems.length?b=0:b<0&&(b=this.subMenuItems.length-1),this.subMenuItems[b].focus(),this.subIndex=b}addListeners(){const b=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,I=>{I.addEventListener("keydown",M=>{let i=!1;switch(M.code){case lt.down:{this.gotoSubIndex(this.subIndex+1),i=!0;break}case lt.up:{this.gotoSubIndex(this.subIndex-1),i=!0;break}case lt.tab:{wr(b,"mouseleave");break}case lt.enter:case lt.space:{i=!0,M.currentTarget.click();break}}return i&&(M.preventDefault(),M.stopPropagation()),!1})})}}class Qu{constructor(b,I){this.domNode=b,this.submenu=null,this.submenu=null,this.init(I)}init(b){this.domNode.setAttribute("tabindex","0");const I=this.domNode.querySelector(`.${b}-menu`);I&&(this.submenu=new Xu(this,I)),this.addListeners()}addListeners(){this.domNode.addEventListener("keydown",b=>{let I=!1;switch(b.code){case lt.down:{wr(b.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(0),I=!0;break}case lt.up:{wr(b.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),I=!0;break}case lt.tab:{wr(b.currentTarget,"mouseleave");break}case lt.enter:case lt.space:{I=!0,b.currentTarget.click();break}}I&&b.preventDefault()})}}class Ju{constructor(b,I){this.domNode=b,this.init(I)}init(b){const I=this.domNode.childNodes;Array.from(I).forEach(M=>{M.nodeType===1&&new Qu(M,b)})}}const Zu=ye({name:"ElMenuCollapseTransition",setup(){const e=Oe("menu");return{listeners:{onBeforeEnter:I=>I.style.opacity="0.2",onEnter(I,M){Rr(I,`${e.namespace.value}-opacity-transition`),I.style.opacity="1",M()},onAfterEnter(I){$r(I,`${e.namespace.value}-opacity-transition`),I.style.opacity=""},onBeforeLeave(I){I.dataset||(I.dataset={}),Da(I,e.m("collapse"))?($r(I,e.m("collapse")),I.dataset.oldOverflow=I.style.overflow,I.dataset.scrollWidth=I.clientWidth.toString(),Rr(I,e.m("collapse"))):(Rr(I,e.m("collapse")),I.dataset.oldOverflow=I.style.overflow,I.dataset.scrollWidth=I.clientWidth.toString(),$r(I,e.m("collapse"))),I.style.width=`${I.scrollWidth}px`,I.style.overflow="hidden"},onLeave(I){Rr(I,"horizontal-collapse-transition"),I.style.width=`${I.dataset.scrollWidth}px`}}}}});function qu(e,b,I,M,i,A){return q(),xe(dr,Ar({mode:"out-in"},e.listeners),{default:ve(()=>[Ie(e.$slots,"default")]),_:3},16)}var ed=Re(Zu,[["render",qu],["__file","/home/runner/work/element-plus/element-plus/packages/components/menu/src/menu-collapse-transition.vue"]]);function $i(e,b){const I=Qe("rootMenu");I||$t("useMenu","can not inject root menu");const M=ee(()=>{let u=e.parent;const r=[b.value];for(;u.type.name!=="ElMenu";)u.props.index&&r.unshift(u.props.index),u=u.parent;return r}),i=ee(()=>{let u=e.parent;for(;u&&!["ElMenu","ElSubMenu"].includes(u.type.name);)u=u.parent;return u}),A=ee(()=>{let u=e.parent;if(I.props.mode!=="vertical")return{};let r=20;if(I.props.collapse)r=20;else for(;u&&u.type.name!=="ElMenu";)u.type.name==="ElSubMenu"&&(r+=20),u=u.parent;return{paddingLeft:`${r}px`}});return{parentMenu:i,paddingStyle:A,indexPath:M}}function td(e){return ee(()=>{const I=e.backgroundColor;return I?new Na(I).shade(20).toString():""})}const Vi=e=>{const b=Oe("menu");return ee(()=>b.cssVarBlock({"text-color":e.textColor||"","hover-text-color":e.textColor||"","bg-color":e.backgroundColor||"","hover-bg-color":td(e).value||"","active-color":e.activeTextColor||""}))},rd=et({index:{type:String,required:!0},showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300},popperClass:String,disabled:Boolean,popperAppendToBody:{type:Boolean,default:void 0},popperOffset:{type:Number,default:6}}),Qr="ElSubMenu";var An=ye({name:Qr,props:rd,setup(e,{slots:b,expose:I}){const M=Rt(),{paddingStyle:i,indexPath:A,parentMenu:u}=$i(M,ee(()=>e.index)),r=Oe("menu"),P=Oe("sub-menu"),O=Qe("rootMenu");O||$t(Qr,"can not inject root menu");const x=Qe(`subMenu:${u.value.uid}`);x||$t(Qr,"can not inject sub menu");const m=ne({}),c=ne({});let v;const h=ne(!1),T=ne(),L=ne(null),g=ee(()=>E.value==="horizontal"&&t.value?"bottom-start":"right-start"),o=ee(()=>E.value==="horizontal"&&t.value||E.value==="vertical"&&!O.props.collapse?fo:gi),t=ee(()=>{let F=!0,U=M.parent;for(;U&&U.type.name!=="ElMenu";)if(["ElSubMenu","ElMenuItemGroup"].includes(U.type.name)){F=!1;break}else U=U.parent;return F}),a=ee(()=>e.popperAppendToBody===void 0?t.value:Boolean(e.popperAppendToBody)),n=ee(()=>O.props.collapse?`${r.namespace.value}-zoom-in-left`:`${r.namespace.value}-zoom-in-top`),d=ee(()=>E.value==="horizontal"&&t.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","left-start","bottom-start","bottom-end","top-start","top-end"]),l=ee(()=>O.openedMenus.includes(e.index)),s=ee(()=>{let F=!1;return Object.values(m.value).forEach(U=>{U.active&&(F=!0)}),Object.values(c.value).forEach(U=>{U.active&&(F=!0)}),F}),f=ee(()=>O.props.backgroundColor||""),C=ee(()=>O.props.activeTextColor||""),D=ee(()=>O.props.textColor||""),E=ee(()=>O.props.mode),p=Kt({index:e.index,indexPath:A,active:s}),y=ee(()=>E.value!=="horizontal"?{color:D.value}:{borderBottomColor:s.value?O.props.activeTextColor?C.value:"":"transparent",color:s.value?C.value:D.value}),S=()=>{var F,U,N;return(N=(U=(F=L.value)==null?void 0:F.popperRef)==null?void 0:U.popperInstanceRef)==null?void 0:N.destroy()},R=F=>{F||S()},w=()=>{O.props.menuTrigger==="hover"&&O.props.mode==="horizontal"||O.props.collapse&&O.props.mode==="vertical"||e.disabled||O.handleSubMenuClick({index:e.index,indexPath:A.value,active:s.value})},k=(F,U=e.showTimeout)=>{var N;F.type==="focus"&&!F.relatedTarget||O.props.menuTrigger==="click"&&O.props.mode==="horizontal"||!O.props.collapse&&O.props.mode==="vertical"||e.disabled||(x.mouseInChild.value=!0,v==null||v(),{stop:v}=kn(()=>{O.openMenu(e.index,A.value)},U),a.value&&((N=u.value.vnode.el)==null||N.dispatchEvent(new MouseEvent("mouseenter"))))},_=(F=!1)=>{var U,N;O.props.menuTrigger==="click"&&O.props.mode==="horizontal"||!O.props.collapse&&O.props.mode==="vertical"||(v==null||v(),x.mouseInChild.value=!1,{stop:v}=kn(()=>!h.value&&O.closeMenu(e.index,A.value),e.hideTimeout),a.value&&F&&((U=M.parent)==null?void 0:U.type.name)==="ElSubMenu"&&((N=x.handleMouseleave)==null||N.call(x,!0)))};Me(()=>O.props.collapse,F=>R(Boolean(F)));{const F=N=>{c.value[N.index]=N},U=N=>{delete c.value[N.index]};Et(`subMenu:${M.uid}`,{addSubMenu:F,removeSubMenu:U,handleMouseleave:_,mouseInChild:h})}return I({opened:l}),pt(()=>{O.addSubMenu(p),x.addSubMenu(p)}),It(()=>{x.removeSubMenu(p),O.removeSubMenu(p)}),()=>{var F;const U=[(F=b.title)==null?void 0:F.call(b),Ge(Ut,{class:P.e("icon-arrow")},{default:()=>Ge(o.value)})],N=Vi(O.props),W=O.isMenuPopup?Ge(Ln,{ref:L,visible:l.value,effect:"light",pure:!0,offset:e.popperOffset,showArrow:!1,persistent:!0,popperClass:e.popperClass,placement:g.value,teleported:a.value,fallbackPlacements:d.value,transition:n.value,gpuAcceleration:!1},{content:()=>{var H;return Ge("div",{class:[r.m(E.value),e.popperClass],onMouseenter:G=>k(G,100),onMouseleave:()=>_(!0),onFocus:G=>k(G,100)},[Ge("ul",{class:[r.b(),r.m("popup"),r.m(`popup-${g.value}`)],style:N.value},[(H=b.default)==null?void 0:H.call(b)])])},default:()=>Ge("div",{class:P.e("title"),style:[i.value,y.value,{backgroundColor:f.value}],onClick:w},U)}):Ge(ut,{},[Ge("div",{class:P.e("title"),style:[i.value,y.value,{backgroundColor:f.value}],ref:T,onClick:w},U),Ge(Iu,{},{default:()=>{var H;return gt(Ge("ul",{role:"menu",class:[r.b(),r.m("inline")],style:N.value},[(H=b.default)==null?void 0:H.call(b)]),[[Vt,l.value]])}})]);return Ge("li",{class:[P.b(),P.is("active",s.value),P.is("opened",l.value),P.is("disabled",e.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:l.value,onMouseenter:k,onMouseleave:()=>_(!0),onFocus:k},[W])}}});const nd=et({mode:{type:String,values:["horizontal","vertical"],default:"vertical"},defaultActive:{type:String,default:""},defaultOpeneds:{type:qe(Array),default:()=>un([])},uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,values:["hover","click"],default:"hover"},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,collapseTransition:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0}}),Jr=e=>Array.isArray(e)&&e.every(b=>yr(b)),id={close:(e,b)=>yr(e)&&Jr(b),open:(e,b)=>yr(e)&&Jr(b),select:(e,b,I,M)=>yr(e)&&Jr(b)&&Tr(I)&&(M===void 0||M instanceof Promise)};var ad=ye({name:"ElMenu",props:nd,emits:id,setup(e,{emit:b,slots:I,expose:M}){const i=Rt(),A=i.appContext.config.globalProperties.$router,u=ne(),r=Oe("menu"),P=Oe("sub-menu"),O=ne(e.defaultOpeneds&&!e.collapse?e.defaultOpeneds.slice(0):[]),x=ne(e.defaultActive),m=ne({}),c=ne({}),v=ee(()=>e.mode==="horizontal"||e.mode==="vertical"&&e.collapse),h=()=>{const l=x.value&&m.value[x.value];if(!l||e.mode==="horizontal"||e.collapse)return;l.indexPath.forEach(f=>{const C=c.value[f];C&&T(f,C.indexPath)})},T=(l,s)=>{O.value.includes(l)||(e.uniqueOpened&&(O.value=O.value.filter(f=>s.includes(f))),O.value.push(l),b("open",l,s))},L=(l,s)=>{const f=O.value.indexOf(l);f!==-1&&O.value.splice(f,1),b("close",l,s)},g=({index:l,indexPath:s})=>{O.value.includes(l)?L(l,s):T(l,s)},o=l=>{(e.mode==="horizontal"||e.collapse)&&(O.value=[]);const{index:s,indexPath:f}=l;if(!(s===void 0||f===void 0))if(e.router&&A){const C=l.route||s,D=A.push(C).then(E=>(E||(x.value=s),E));b("select",s,f,{index:s,indexPath:f,route:C},D)}else x.value=s,b("select",s,f,{index:s,indexPath:f})},t=l=>{const s=m.value,f=s[l]||x.value&&s[x.value]||s[e.defaultActive];f?(x.value=f.index,h()):x.value=l},a=()=>{ot(()=>i.proxy.$forceUpdate())};Me(()=>e.defaultActive,l=>{m.value[l]||(x.value=""),t(l)}),Me(m.value,()=>h()),Me(()=>e.collapse,l=>{l&&(O.value=[])});{const l=D=>{c.value[D.index]=D},s=D=>{delete c.value[D.index]};Et("rootMenu",Kt({props:e,openedMenus:O,items:m,subMenus:c,activeIndex:x,isMenuPopup:v,addMenuItem:D=>{m.value[D.index]=D},removeMenuItem:D=>{delete m.value[D.index]},addSubMenu:l,removeSubMenu:s,openMenu:T,closeMenu:L,handleMenuItemClick:o,handleSubMenuClick:g})),Et(`subMenu:${i.uid}`,{addSubMenu:l,removeSubMenu:s,mouseInChild:ne(!1)})}pt(()=>{h(),e.mode==="horizontal"&&new Ju(i.vnode.el,r.namespace.value)}),M({open:s=>{const{indexPath:f}=c.value[s];f.forEach(C=>T(C,f))},close:L,handleResize:a});const n=l=>{const s=Array.isArray(l)?l:[l],f=[];return s.forEach(C=>{Array.isArray(C.children)?f.push(...n(C.children)):f.push(C)}),f},d=l=>e.mode==="horizontal"?gt(l,[[Lu,a]]):l;return()=>{var l,s,f,C;let D=(s=(l=I.default)==null?void 0:l.call(I))!=null?s:[];const E=[];if(e.mode==="horizontal"&&u.value){const R=Array.from((C=(f=u.value)==null?void 0:f.childNodes)!=null?C:[]).filter(J=>J.nodeName!=="#text"||J.nodeValue),w=n(D),k=64,_=Number.parseInt(getComputedStyle(u.value).paddingLeft,10),F=Number.parseInt(getComputedStyle(u.value).paddingRight,10),U=u.value.clientWidth-_-F;let N=0,W=0;R.forEach((J,X)=>{N+=J.offsetWidth||0,N<=U-k&&(W=X+1)});const H=w.slice(0,W),G=w.slice(W);(G==null?void 0:G.length)&&e.ellipsis&&(D=H,E.push(Ge(An,{index:"sub-menu-more",class:P.e("hide-arrow")},{title:()=>Ge(Ut,{class:P.e("icon-more")},{default:()=>Ge(qo)}),default:()=>G})))}const p=Vi(e),S=(R=>e.ellipsis?d(R):R)(Ge("ul",{key:String(e.collapse),role:"menubar",ref:u,style:p.value,class:{[r.b()]:!0,[r.m("horizontal")]:e.mode==="horizontal",[r.m("collapse")]:e.collapse}},[...D,...E]));return e.collapseTransition&&e.mode==="vertical"?Ge(ed,()=>S):S}}});const od=et({index:{type:qe([String,null]),default:null},route:{type:qe([String,Object])},disabled:Boolean}),sd={click:e=>yr(e.index)&&Array.isArray(e.indexPath)},Zr="ElMenuItem",ld=ye({name:Zr,components:{ElTooltip:Ln},props:od,emits:sd,setup(e,{emit:b}){const I=Rt(),M=Qe("rootMenu"),i=Oe("menu"),A=Oe("menu-item");M||$t(Zr,"can not inject root menu");const{parentMenu:u,paddingStyle:r,indexPath:P}=$i(I,nr(e,"index")),O=Qe(`subMenu:${u.value.uid}`);O||$t(Zr,"can not inject sub menu");const x=ee(()=>e.index===M.activeIndex),m=Kt({index:e.index,indexPath:P,active:x}),c=()=>{e.disabled||(M.handleMenuItemClick({index:e.index,indexPath:P.value,route:e.route}),b("click",m))};return pt(()=>{O.addSubMenu(m),M.addMenuItem(m)}),It(()=>{O.removeSubMenu(m),M.removeMenuItem(m)}),{Effect:ru,parentMenu:u,rootMenu:M,paddingStyle:r,active:x,nsMenu:i,nsMenuItem:A,handleClick:c}}});function ud(e,b,I,M,i,A){const u=Fe("el-tooltip");return q(),se("li",{class:de([e.nsMenuItem.b(),e.nsMenuItem.is("active",e.active),e.nsMenuItem.is("disabled",e.disabled)]),role:"menuitem",tabindex:"-1",style:at(e.paddingStyle),onClick:b[0]||(b[0]=(...r)=>e.handleClick&&e.handleClick(...r))},[e.parentMenu.type.name==="ElMenu"&&e.rootMenu.props.collapse&&e.$slots.title?(q(),xe(u,{key:0,effect:e.Effect.DARK,placement:"right","fallback-placements":["left"],persistent:""},{content:ve(()=>[Ie(e.$slots,"title")]),default:ve(()=>[De("div",{class:de(e.nsMenu.be("tooltip","trigger"))},[Ie(e.$slots,"default")],2)]),_:3},8,["effect"])):(q(),se(ut,{key:1},[Ie(e.$slots,"default"),Ie(e.$slots,"title")],64))],6)}var Yi=Re(ld,[["render",ud],["__file","/home/runner/work/element-plus/element-plus/packages/components/menu/src/menu-item.vue"]]);const dd={title:String},ei="ElMenuItemGroup",cd=ye({name:ei,props:dd,setup(){const e=Rt(),b=Qe("rootMenu");b||$t(ei,"can not inject root menu");const I=Oe("menu-item-group");return{levelPadding:ee(()=>{if(b.props.collapse)return 20;let i=20,A=e.parent;for(;A&&A.type.name!=="ElMenu";)A.type.name==="ElSubMenu"&&(i+=20),A=A.parent;return i}),ns:I}}});function fd(e,b,I,M,i,A){return q(),se("li",{class:de(e.ns.b())},[De("div",{class:de(e.ns.e("title")),style:at({paddingLeft:`${e.levelPadding}px`})},[e.$slots.title?Ie(e.$slots,"title",{key:1}):(q(),se(ut,{key:0},[xr(Je(e.title),1)],2112))],6),De("ul",null,[Ie(e.$slots,"default")])],2)}var Xi=Re(cd,[["render",fd],["__file","/home/runner/work/element-plus/element-plus/packages/components/menu/src/menu-item-group.vue"]]);const hd=Wt(ad,{MenuItem:Yi,MenuItemGroup:Xi,SubMenu:An}),pd=wt(Yi);wt(Xi);const vd=wt(An),md={disabled:Boolean,currentPage:{type:Number,default:1},prevText:{type:String,default:""}},gd=ye({name:"ElPaginationPrev",components:{ElIcon:Ut,ArrowLeft:yo},props:md,emits:["click"],setup(e){return{internalDisabled:ee(()=>e.disabled||e.currentPage<=1)}}}),yd=["disabled","aria-disabled"],Ed={key:0};function bd(e,b,I,M,i,A){const u=Fe("arrow-left"),r=Fe("el-icon");return q(),se("button",{type:"button",class:"btn-prev",disabled:e.internalDisabled,"aria-disabled":e.internalDisabled,onClick:b[0]||(b[0]=P=>e.$emit("click",P))},[e.prevText?(q(),se("span",Ed,Je(e.prevText),1)):(q(),xe(r,{key:1},{default:ve(()=>[Ae(u)]),_:1}))],8,yd)}var Td=Re(gd,[["render",bd],["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/prev.vue"]]);const xd={disabled:Boolean,currentPage:{type:Number,default:1},pageCount:{type:Number,default:50},nextText:{type:String,default:""}},Sd=ye({name:"ElPaginationNext",components:{ElIcon:Ut,ArrowRight:gi},props:xd,emits:["click"],setup(e){return{internalDisabled:ee(()=>e.disabled||e.currentPage===e.pageCount||e.pageCount===0)}}}),Ld=["disabled","aria-disabled"],Ad={key:0};function Dd(e,b,I,M,i,A){const u=Fe("arrow-right"),r=Fe("el-icon");return q(),se("button",{type:"button",class:"btn-next",disabled:e.internalDisabled,"aria-disabled":e.internalDisabled,onClick:b[0]||(b[0]=P=>e.$emit("click",P))},[e.nextText?(q(),se("span",Ad,Je(e.nextText),1)):(q(),xe(r,{key:1},{default:ve(()=>[Ae(u)]),_:1}))],8,Ld)}var Cd=Re(Sd,[["render",Dd],["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/next.vue"]]);const Qi="ElSelectGroup",Ur="ElSelect";function Od(e,b){const I=Qe(Ur),M=Qe(Qi,{disabled:!1}),i=ee(()=>Object.prototype.toString.call(e.value).toLowerCase()==="[object object]"),A=ee(()=>I.props.multiple?m(I.props.modelValue,e.value):c(e.value,I.props.modelValue)),u=ee(()=>{if(I.props.multiple){const T=I.props.modelValue||[];return!A.value&&T.length>=I.props.multipleLimit&&I.props.multipleLimit>0}else return!1}),r=ee(()=>e.label||(i.value?"":e.value)),P=ee(()=>e.value||e.label||""),O=ee(()=>e.disabled||b.groupDisabled||u.value),x=Rt(),m=(T=[],L)=>{if(i.value){const g=I.props.valueKey;return T&&T.some(o=>mt(o,g)===mt(L,g))}else return T&&T.includes(L)},c=(T,L)=>{if(i.value){const{valueKey:g}=I.props;return mt(T,g)===mt(L,g)}else return T===L},v=()=>{!e.disabled&&!M.disabled&&(I.hoverIndex=I.optionsArray.indexOf(x.proxy))};Me(()=>r.value,()=>{!e.created&&!I.props.remote&&I.setSelected()}),Me(()=>e.value,(T,L)=>{const{remote:g,valueKey:o}=I.props;if(!e.created&&!g){if(o&&typeof T=="object"&&typeof L=="object"&&T[o]===L[o])return;I.setSelected()}}),Me(()=>M.disabled,()=>{b.groupDisabled=M.disabled},{immediate:!0});const{queryChange:h}=si(I);return Me(h,T=>{const{query:L}=ce(T),g=new RegExp(io(L),"i");b.visible=g.test(r.value)||e.created,b.visible||I.filteredOptionsCount--}),{select:I,currentLabel:r,currentValue:P,itemSelected:A,isDisabled:O,hoverItem:v}}const Md=ye({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:{type:Boolean,default:!1}},setup(e){const b=Oe("select"),I=Kt({index:-1,groupDisabled:!1,visible:!0,hitState:!1,hover:!1}),{currentLabel:M,itemSelected:i,isDisabled:A,select:u,hoverItem:r}=Od(e,I),{visible:P,hover:O}=ln(I),x=Rt().proxy,m=x.value;u.onOptionCreate(x),It(()=>{const{selected:v}=u,T=(u.props.multiple?v:[v]).some(L=>L.value===x.value);u.cachedOptions.get(m)===x&&!T&&ot(()=>{u.cachedOptions.delete(m)}),u.onOptionDestroy(m,x)});function c(){e.disabled!==!0&&I.groupDisabled!==!0&&u.handleOptionSelect(x,!0)}return{ns:b,currentLabel:M,itemSelected:i,isDisabled:A,select:u,hoverItem:r,visible:P,hover:O,selectOptionClick:c,states:I}}});function Pd(e,b,I,M,i,A){return gt((q(),se("li",{class:de([e.ns.be("dropdown","item"),e.ns.is("disabled",e.isDisabled),{selected:e.itemSelected,hover:e.hover}]),onMouseenter:b[0]||(b[0]=(...u)=>e.hoverItem&&e.hoverItem(...u)),onClick:b[1]||(b[1]=Lt((...u)=>e.selectOptionClick&&e.selectOptionClick(...u),["stop"]))},[Ie(e.$slots,"default",{},()=>[De("span",null,Je(e.currentLabel),1)])],34)),[[Vt,e.visible]])}var Dn=Re(Md,[["render",Pd],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option.vue"]]);const Rd=ye({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const e=Qe(Ur),b=Oe("select"),I=ee(()=>e.props.popperClass),M=ee(()=>e.props.multiple),i=ee(()=>e.props.fitInputWidth),A=ne("");function u(){var r;A.value=`${(r=e.selectWrapper)==null?void 0:r.getBoundingClientRect().width}px`}return pt(()=>{u(),dn(e.selectWrapper,u)}),It(()=>{cn(e.selectWrapper,u)}),{ns:b,minWidth:A,popperClass:I,isMultiple:M,isFitInputWidth:i}}});function Id(e,b,I,M,i,A){return q(),se("div",{class:de([e.ns.b("dropdown"),e.ns.is("multiple",e.isMultiple),e.popperClass]),style:at({[e.isFitInputWidth?"width":"minWidth"]:e.minWidth})},[Ie(e.$slots,"default")],6)}var wd=Re(Rd,[["render",Id],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select-dropdown.vue"]]);function kd(e){const{t:b}=Yt();return Kt({options:new Map,cachedOptions:new Map,createdLabel:null,createdSelected:!1,selected:e.multiple?[]:{},inputLength:20,inputWidth:0,initialInputHeight:0,optionsCount:0,filteredOptionsCount:0,visible:!1,softFocus:!1,selectedLabel:"",hoverIndex:-1,query:"",previousQuery:null,inputHovering:!1,cachedPlaceHolder:"",currentPlaceholder:b("el.select.placeholder"),menuVisibleOnFocus:!1,isOnComposition:!1,isSilentBlur:!1,prefixWidth:11,tagInMultiLine:!1})}const _d=(e,b,I)=>{const{t:M}=Yt(),i=Oe("select"),A=ne(null),u=ne(null),r=ne(null),P=ne(null),O=ne(null),x=ne(null),m=ne(-1),c=_n({query:""}),v=_n(""),h=Qe(Ka,{}),T=Qe(an,{}),L=ee(()=>!e.filterable||e.multiple||!b.visible),g=ee(()=>e.disabled||h.disabled),o=ee(()=>{const Y=e.multiple?Array.isArray(e.modelValue)&&e.modelValue.length>0:e.modelValue!==void 0&&e.modelValue!==null&&e.modelValue!=="";return e.clearable&&!g.value&&b.inputHovering&&Y}),t=ee(()=>e.remote&&e.filterable?"":e.suffixIcon),a=ee(()=>i.is("reverse",t.value&&b.visible)),n=ee(()=>e.remote?300:0),d=ee(()=>e.loading?e.loadingText||M("el.select.loading"):e.remote&&b.query===""&&b.options.size===0?!1:e.filterable&&b.query&&b.options.size>0&&b.filteredOptionsCount===0?e.noMatchText||M("el.select.noMatch"):b.options.size===0?e.noDataText||M("el.select.noData"):null),l=ee(()=>Array.from(b.options.values())),s=ee(()=>Array.from(b.cachedOptions.values())),f=ee(()=>{const Y=l.value.filter(Z=>!Z.created).some(Z=>Z.currentLabel===b.query);return e.filterable&&e.allowCreate&&b.query!==""&&!Y}),C=hi(),D=ee(()=>["small"].includes(C.value)?"small":"default"),E=ee({get(){return b.visible&&d.value!==!1},set(Y){b.visible=Y}});Me([()=>g.value,()=>C.value,()=>h.size],()=>{ot(()=>{p()})}),Me(()=>e.placeholder,Y=>{b.cachedPlaceHolder=b.currentPlaceholder=Y}),Me(()=>e.modelValue,(Y,Z)=>{var oe;e.multiple&&(p(),Y&&Y.length>0||u.value&&b.query!==""?b.currentPlaceholder="":b.currentPlaceholder=b.cachedPlaceHolder,e.filterable&&!e.reserveKeyword&&(b.query="",y(b.query))),w(),e.filterable&&!e.multiple&&(b.inputLength=20),on(Y,Z)||(oe=T.validate)==null||oe.call(T,"change").catch(pe=>pi())},{flush:"post",deep:!0}),Me(()=>b.visible,Y=>{var Z,oe,pe;Y?((oe=(Z=r.value)==null?void 0:Z.updatePopper)==null||oe.call(Z),e.filterable&&(b.filteredOptionsCount=b.optionsCount,b.query=e.remote?"":b.selectedLabel,e.multiple?(pe=u.value)==null||pe.focus():b.selectedLabel&&(b.currentPlaceholder=`${b.selectedLabel}`,b.selectedLabel=""),y(b.query),!e.multiple&&!e.remote&&(c.value.query="",vr(c),vr(v)))):(u.value&&u.value.blur(),b.query="",b.previousQuery=null,b.selectedLabel="",b.inputLength=20,b.menuVisibleOnFocus=!1,_(),ot(()=>{u.value&&u.value.value===""&&b.selected.length===0&&(b.currentPlaceholder=b.cachedPlaceHolder)}),e.multiple||(b.selected&&(e.filterable&&e.allowCreate&&b.createdSelected&&b.createdLabel?b.selectedLabel=b.createdLabel:b.selectedLabel=b.selected.currentLabel,e.filterable&&(b.query=b.selectedLabel)),e.filterable&&(b.currentPlaceholder=b.cachedPlaceHolder))),I.emit("visible-change",Y)}),Me(()=>b.options.entries(),()=>{var Y,Z,oe;if(!At)return;(Z=(Y=r.value)==null?void 0:Y.updatePopper)==null||Z.call(Y),e.multiple&&p();const pe=((oe=O.value)==null?void 0:oe.querySelectorAll("input"))||[];Array.from(pe).includes(document.activeElement)||w(),e.defaultFirstOption&&(e.filterable||e.remote)&&b.filteredOptionsCount&&R()},{flush:"post"}),Me(()=>b.hoverIndex,Y=>{typeof Y=="number"&&Y>-1&&(m.value=l.value[Y]||{}),l.value.forEach(Z=>{Z.hover=m.value===Z})});const p=()=>{e.collapseTags&&!e.filterable||ot(()=>{var Y,Z;if(!A.value)return;const oe=A.value.$el.querySelector("input"),pe=P.value,Pe=b.initialInputHeight||es(C.value||h.size);oe.style.height=b.selected.length===0?`${Pe}px`:`${Math.max(pe?pe.clientHeight+(pe.clientHeight>Pe?6:0):0,Pe)}px`,b.tagInMultiLine=Number.parseFloat(oe.style.height)>=Pe,b.visible&&d.value!==!1&&((Z=(Y=r.value)==null?void 0:Y.updatePopper)==null||Z.call(Y))})},y=Y=>{if(!(b.previousQuery===Y||b.isOnComposition)){if(b.previousQuery===null&&(typeof e.filterMethod=="function"||typeof e.remoteMethod=="function")){b.previousQuery=Y;return}b.previousQuery=Y,ot(()=>{var Z,oe;b.visible&&((oe=(Z=r.value)==null?void 0:Z.updatePopper)==null||oe.call(Z))}),b.hoverIndex=-1,e.multiple&&e.filterable&&ot(()=>{const Z=u.value.value.length*15+20;b.inputLength=e.collapseTags?Math.min(50,Z):Z,S(),p()}),e.remote&&typeof e.remoteMethod=="function"?(b.hoverIndex=-1,e.remoteMethod(Y)):typeof e.filterMethod=="function"?(e.filterMethod(Y),vr(v)):(b.filteredOptionsCount=b.optionsCount,c.value.query=Y,vr(c),vr(v)),e.defaultFirstOption&&(e.filterable||e.remote)&&b.filteredOptionsCount&&R()}},S=()=>{b.currentPlaceholder!==""&&(b.currentPlaceholder=u.value.value?"":b.cachedPlaceHolder)},R=()=>{const Y=l.value.filter(pe=>pe.visible&&!pe.disabled&&!pe.states.groupDisabled),Z=Y.find(pe=>pe.created),oe=Y[0];b.hoverIndex=re(l.value,Z||oe)},w=()=>{var Y;if(e.multiple)b.selectedLabel="";else{const oe=k(e.modelValue);(Y=oe.props)!=null&&Y.created?(b.createdLabel=oe.props.value,b.createdSelected=!0):b.createdSelected=!1,b.selectedLabel=oe.currentLabel,b.selected=oe,e.filterable&&(b.query=b.selectedLabel);return}const Z=[];Array.isArray(e.modelValue)&&e.modelValue.forEach(oe=>{Z.push(k(oe))}),b.selected=Z,ot(()=>{p()})},k=Y=>{let Z;const oe=Vr(Y).toLowerCase()==="object",pe=Vr(Y).toLowerCase()==="null",Pe=Vr(Y).toLowerCase()==="undefined";for(let Ze=b.cachedOptions.size-1;Ze>=0;Ze--){const Ve=s.value[Ze];if(oe?mt(Ve.value,e.valueKey)===mt(Y,e.valueKey):Ve.value===Y){Z={value:Y,currentLabel:Ve.currentLabel,isDisabled:Ve.isDisabled};break}}if(Z)return Z;const He=oe?Y.label:!pe&&!Pe?Y:"",$e={value:Y,currentLabel:He};return e.multiple&&($e.hitState=!1),$e},_=()=>{setTimeout(()=>{const Y=e.valueKey;e.multiple?b.selected.length>0?b.hoverIndex=Math.min.apply(null,b.selected.map(Z=>l.value.findIndex(oe=>mt(oe,Y)===mt(Z,Y)))):b.hoverIndex=-1:b.hoverIndex=l.value.findIndex(Z=>Te(Z)===Te(b.selected))},300)},F=()=>{var Y,Z;U(),(Z=(Y=r.value)==null?void 0:Y.updatePopper)==null||Z.call(Y),e.multiple&&!e.filterable&&p()},U=()=>{var Y;b.inputWidth=(Y=A.value)==null?void 0:Y.$el.getBoundingClientRect().width},N=()=>{e.filterable&&b.query!==b.selectedLabel&&(b.query=b.selectedLabel,y(b.query))},W=Nn(()=>{N()},n.value),H=Nn(Y=>{y(Y.target.value)},n.value),G=Y=>{on(e.modelValue,Y)||I.emit(vi,Y)},J=Y=>{if(Y.target.value.length<=0&&!be()){const Z=e.modelValue.slice();Z.pop(),I.emit(Ft,Z),G(Z)}Y.target.value.length===1&&e.modelValue.length===0&&(b.currentPlaceholder=b.cachedPlaceHolder)},X=(Y,Z)=>{const oe=b.selected.indexOf(Z);if(oe>-1&&!g.value){const pe=e.modelValue.slice();pe.splice(oe,1),I.emit(Ft,pe),G(pe),I.emit("remove-tag",Z.value)}Y.stopPropagation()},te=Y=>{Y.stopPropagation();const Z=e.multiple?[]:"";if(typeof Z!="string")for(const oe of b.selected)oe.isDisabled&&Z.push(oe.value);I.emit(Ft,Z),G(Z),b.visible=!1,I.emit("clear")},le=(Y,Z)=>{var oe;if(e.multiple){const pe=(e.modelValue||[]).slice(),Pe=re(pe,Y.value);Pe>-1?pe.splice(Pe,1):(e.multipleLimit<=0||pe.length<e.multipleLimit)&&pe.push(Y.value),I.emit(Ft,pe),G(pe),Y.created&&(b.query="",y(""),b.inputLength=20),e.filterable&&((oe=u.value)==null||oe.focus())}else I.emit(Ft,Y.value),G(Y.value),b.visible=!1;b.isSilentBlur=Z,fe(),!b.visible&&ot(()=>{ue(Y)})},re=(Y=[],Z)=>{if(!Tr(Z))return Y.indexOf(Z);const oe=e.valueKey;let pe=-1;return Y.some((Pe,He)=>mt(Pe,oe)===mt(Z,oe)?(pe=He,!0):!1),pe},fe=()=>{b.softFocus=!0;const Y=u.value||A.value;Y&&(Y==null||Y.focus())},ue=Y=>{var Z,oe,pe,Pe,He;const $e=Array.isArray(Y)?Y[0]:Y;let Ze=null;if($e!=null&&$e.value){const Ve=l.value.filter(Ne=>Ne.value===$e.value);Ve.length>0&&(Ze=Ve[0].$el)}if(r.value&&Ze){const Ve=(Pe=(pe=(oe=(Z=r.value)==null?void 0:Z.popperRef)==null?void 0:oe.contentRef)==null?void 0:pe.querySelector)==null?void 0:Pe.call(pe,`.${i.be("dropdown","wrap")}`);Ve&&ao(Ve,Ze)}(He=x.value)==null||He.handleScroll()},ae=Y=>{b.optionsCount++,b.filteredOptionsCount++,b.options.set(Y.value,Y),b.cachedOptions.set(Y.value,Y)},me=(Y,Z)=>{b.options.get(Y)===Z&&(b.optionsCount--,b.filteredOptionsCount--,b.options.delete(Y))},ge=Y=>{Y.code!==lt.backspace&&be(!1),b.inputLength=u.value.value.length*15+20,p()},be=Y=>{if(!Array.isArray(b.selected))return;const Z=b.selected[b.selected.length-1];if(!!Z)return Y===!0||Y===!1?(Z.hitState=Y,Y):(Z.hitState=!Z.hitState,Z.hitState)},Se=Y=>{const Z=Y.target.value;if(Y.type==="compositionend")b.isOnComposition=!1,ot(()=>y(Z));else{const oe=Z[Z.length-1]||"";b.isOnComposition=!Wa(oe)}},we=()=>{ot(()=>ue(b.selected))},Ce=Y=>{b.softFocus?b.softFocus=!1:((e.automaticDropdown||e.filterable)&&(e.filterable&&!b.visible&&(b.menuVisibleOnFocus=!0),b.visible=!0),I.emit("focus",Y))},Le=()=>{var Y;b.visible=!1,(Y=A.value)==null||Y.blur()},Ue=Y=>{ot(()=>{b.isSilentBlur?b.isSilentBlur=!1:I.emit("blur",Y)}),b.softFocus=!1},Ke=Y=>{te(Y)},We=()=>{b.visible=!1},Be=()=>{var Y;e.automaticDropdown||g.value||(b.menuVisibleOnFocus?b.menuVisibleOnFocus=!1:b.visible=!b.visible,b.visible&&((Y=u.value||A.value)==null||Y.focus()))},ze=()=>{b.visible?l.value[b.hoverIndex]&&le(l.value[b.hoverIndex],void 0):Be()},Te=Y=>Tr(Y.value)?mt(Y.value,e.valueKey):Y.value,tt=ee(()=>l.value.filter(Y=>Y.visible).every(Y=>Y.disabled)),rt=Y=>{if(!b.visible){b.visible=!0;return}if(!(b.options.size===0||b.filteredOptionsCount===0)&&!b.isOnComposition&&!tt.value){Y==="next"?(b.hoverIndex++,b.hoverIndex===b.options.size&&(b.hoverIndex=0)):Y==="prev"&&(b.hoverIndex--,b.hoverIndex<0&&(b.hoverIndex=b.options.size-1));const Z=l.value[b.hoverIndex];(Z.disabled===!0||Z.states.groupDisabled===!0||!Z.visible)&&rt(Y),ot(()=>ue(m.value))}};return{optionsArray:l,selectSize:C,handleResize:F,debouncedOnInputChange:W,debouncedQueryChange:H,deletePrevTag:J,deleteTag:X,deleteSelected:te,handleOptionSelect:le,scrollToOption:ue,readonly:L,resetInputHeight:p,showClose:o,iconComponent:t,iconReverse:a,showNewOption:f,collapseTagSize:D,setSelected:w,managePlaceholder:S,selectDisabled:g,emptyText:d,toggleLastOptionHitState:be,resetInputState:ge,handleComposition:Se,onOptionCreate:ae,onOptionDestroy:me,handleMenuEnter:we,handleFocus:Ce,blur:Le,handleBlur:Ue,handleClearClick:Ke,handleClose:We,toggleMenu:Be,selectOption:ze,getValueKey:Te,navigateOptions:rt,dropMenuVisible:E,queryChange:c,groupQueryChange:v,reference:A,input:u,tooltipRef:r,tags:P,selectWrapper:O,scrollbar:x}},ti="ElSelect",Bd=ye({name:ti,componentName:ti,components:{ElInput:mi,ElSelectMenu:wd,ElOption:Dn,ElTag:Mu,ElScrollbar:Li,ElTooltip:Ln,ElIcon:Ut},directives:{ClickOutside:Su},props:{name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:{type:String,validator:ts},effect:{type:String,default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:{type:Boolean,default:!1},teleported:xn.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:[String,Object],default:Ca},fitInputWidth:{type:Boolean,default:!1},suffixIcon:{type:[String,Object],default:Mo},tagType:ht(Xe({},Wi.type),{default:"info"})},emits:[Ft,vi,"remove-tag","clear","visible-change","focus","blur"],setup(e,b){const I=Oe("select"),M=Oe("input"),{t:i}=Yt(),A=kd(e),{optionsArray:u,selectSize:r,readonly:P,handleResize:O,collapseTagSize:x,debouncedOnInputChange:m,debouncedQueryChange:c,deletePrevTag:v,deleteTag:h,deleteSelected:T,handleOptionSelect:L,scrollToOption:g,setSelected:o,resetInputHeight:t,managePlaceholder:a,showClose:n,selectDisabled:d,iconComponent:l,iconReverse:s,showNewOption:f,emptyText:C,toggleLastOptionHitState:D,resetInputState:E,handleComposition:p,onOptionCreate:y,onOptionDestroy:S,handleMenuEnter:R,handleFocus:w,blur:k,handleBlur:_,handleClearClick:F,handleClose:U,toggleMenu:N,selectOption:W,getValueKey:H,navigateOptions:G,dropMenuVisible:J,reference:X,input:te,tooltipRef:le,tags:re,selectWrapper:fe,scrollbar:ue,queryChange:ae,groupQueryChange:me}=_d(e,A,b),{focus:ge}=ns(X),{inputWidth:be,selected:Se,inputLength:we,filteredOptionsCount:Ce,visible:Le,softFocus:Ue,selectedLabel:Ke,hoverIndex:We,query:Be,inputHovering:ze,currentPlaceholder:Te,menuVisibleOnFocus:tt,isOnComposition:rt,isSilentBlur:Y,options:Z,cachedOptions:oe,optionsCount:pe,prefixWidth:Pe,tagInMultiLine:He}=ln(A),$e=ee(()=>{const Ne=[I.b()],nt=ce(r);return nt&&Ne.push(I.m(nt)),e.disabled&&Ne.push(I.m("disabled")),Ne}),Ze=ee(()=>({maxWidth:`${ce(be)-32}px`,width:"100%"}));Et(Ur,Kt({props:e,options:Z,optionsArray:u,cachedOptions:oe,optionsCount:pe,filteredOptionsCount:Ce,hoverIndex:We,handleOptionSelect:L,onOptionCreate:y,onOptionDestroy:S,selectWrapper:fe,selected:Se,setSelected:o,queryChange:ae,groupQueryChange:me})),pt(()=>{if(A.cachedPlaceHolder=Te.value=e.placeholder||i("el.select.placeholder"),e.multiple&&Array.isArray(e.modelValue)&&e.modelValue.length>0&&(Te.value=""),dn(fe.value,O),X.value&&X.value.$el){const Ne=X.value.input;A.initialInputHeight=Ne.getBoundingClientRect().height}e.remote&&e.multiple&&t(),ot(()=>{const Ne=X.value&&X.value.$el;if(!!Ne&&(be.value=Ne.getBoundingClientRect().width,b.slots.prefix)){const nt=Ne.querySelector(`.${M.e("prefix")}`);Pe.value=Math.max(nt.getBoundingClientRect().width+5,30)}}),o()}),It(()=>{cn(fe.value,O)}),e.multiple&&!Array.isArray(e.modelValue)&&b.emit(Ft,[]),!e.multiple&&Array.isArray(e.modelValue)&&b.emit(Ft,"");const Ve=ee(()=>{var Ne,nt;return(nt=(Ne=le.value)==null?void 0:Ne.popperRef)==null?void 0:nt.contentRef});return{tagInMultiLine:He,prefixWidth:Pe,selectSize:r,readonly:P,handleResize:O,collapseTagSize:x,debouncedOnInputChange:m,debouncedQueryChange:c,deletePrevTag:v,deleteTag:h,deleteSelected:T,handleOptionSelect:L,scrollToOption:g,inputWidth:be,selected:Se,inputLength:we,filteredOptionsCount:Ce,visible:Le,softFocus:Ue,selectedLabel:Ke,hoverIndex:We,query:Be,inputHovering:ze,currentPlaceholder:Te,menuVisibleOnFocus:tt,isOnComposition:rt,isSilentBlur:Y,options:Z,resetInputHeight:t,managePlaceholder:a,showClose:n,selectDisabled:d,iconComponent:l,iconReverse:s,showNewOption:f,emptyText:C,toggleLastOptionHitState:D,resetInputState:E,handleComposition:p,handleMenuEnter:R,handleFocus:w,blur:k,handleBlur:_,handleClearClick:F,handleClose:U,toggleMenu:N,selectOption:W,getValueKey:H,navigateOptions:G,dropMenuVisible:J,focus:ge,reference:X,input:te,tooltipRef:le,popperPaneRef:Ve,tags:re,selectWrapper:fe,scrollbar:ue,wrapperKls:$e,selectTagsStyle:Ze,nsSelect:I}}}),Fd={class:"select-trigger"},Ud=["disabled","autocomplete"],Nd={style:{height:"100%",display:"flex","justify-content":"center","align-items":"center"}};function Kd(e,b,I,M,i,A){const u=Fe("el-tag"),r=Fe("el-tooltip"),P=Fe("el-icon"),O=Fe("el-input"),x=Fe("el-option"),m=Fe("el-scrollbar"),c=Fe("el-select-menu"),v=Oa("click-outside");return gt((q(),se("div",{ref:"selectWrapper",class:de(e.wrapperKls),onClick:b[24]||(b[24]=Lt((...h)=>e.toggleMenu&&e.toggleMenu(...h),["stop"]))},[Ae(r,{ref:"tooltipRef",visible:e.dropMenuVisible,"onUpdate:visible":b[23]||(b[23]=h=>e.dropMenuVisible=h),placement:"bottom-start",teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"fallback-placements":["bottom-start","top-start","right","left"],effect:e.effect,pure:"",trigger:"click",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:e.persistent,onShow:e.handleMenuEnter},{default:ve(()=>[De("div",Fd,[e.multiple?(q(),se("div",{key:0,ref:"tags",class:de(e.nsSelect.e("tags")),style:at(e.selectTagsStyle)},[e.collapseTags&&e.selected.length?(q(),se("span",{key:0,class:de([e.nsSelect.b("tags-wrapper"),{"has-prefix":e.prefixWidth&&e.selected.length}])},[Ae(u,{closable:!e.selectDisabled&&!e.selected[0].isDisabled,size:e.collapseTagSize,hit:e.selected[0].hitState,type:e.tagType,"disable-transitions":"",onClose:b[0]||(b[0]=h=>e.deleteTag(h,e.selected[0]))},{default:ve(()=>[De("span",{class:de(e.nsSelect.e("tags-text")),style:at({maxWidth:e.inputWidth-123+"px"})},Je(e.selected[0].currentLabel),7)]),_:1},8,["closable","size","hit","type"]),e.selected.length>1?(q(),xe(u,{key:0,closable:!1,size:e.collapseTagSize,type:e.tagType,"disable-transitions":""},{default:ve(()=>[e.collapseTagsTooltip?(q(),xe(r,{key:0,disabled:e.dropMenuVisible,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:!1},{default:ve(()=>[De("span",{class:de(e.nsSelect.e("tags-text"))},"+ "+Je(e.selected.length-1),3)]),content:ve(()=>[De("div",{class:de(e.nsSelect.e("collapse-tags"))},[(q(!0),se(ut,null,ir(e.selected,(h,T)=>(q(),se("div",{key:T,class:de(e.nsSelect.e("collapse-tag"))},[(q(),xe(u,{key:e.getValueKey(h),class:"in-tooltip",closable:!e.selectDisabled&&!h.isDisabled,size:e.collapseTagSize,hit:h.hitState,type:e.tagType,"disable-transitions":"",style:{margin:"2px"},onClose:L=>e.deleteTag(L,h)},{default:ve(()=>[De("span",{class:de(e.nsSelect.e("tags-text")),style:at({maxWidth:e.inputWidth-75+"px"})},Je(h.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"]))],2))),128))],2)]),_:1},8,["disabled","effect"])):(q(),se("span",{key:1,class:de(e.nsSelect.e("tags-text"))},"+ "+Je(e.selected.length-1),3))]),_:1},8,["size","type"])):je("v-if",!0)],2)):je("v-if",!0),je(" <div> "),e.collapseTags?je("v-if",!0):(q(),xe(dr,{key:1,onAfterLeave:e.resetInputHeight},{default:ve(()=>[De("span",{class:de([e.nsSelect.b("tags-wrapper"),{"has-prefix":e.prefixWidth&&e.selected.length}])},[(q(!0),se(ut,null,ir(e.selected,h=>(q(),xe(u,{key:e.getValueKey(h),closable:!e.selectDisabled&&!h.isDisabled,size:e.collapseTagSize,hit:h.hitState,type:e.tagType,"disable-transitions":"",onClose:T=>e.deleteTag(T,h)},{default:ve(()=>[De("span",{class:de(e.nsSelect.e("tags-text")),style:at({maxWidth:e.inputWidth-75+"px"})},Je(h.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"]))),128))],2)]),_:1},8,["onAfterLeave"])),je(" </div> "),e.filterable?gt((q(),se("input",{key:2,ref:"input","onUpdate:modelValue":b[1]||(b[1]=h=>e.query=h),type:"text",class:de([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,autocomplete:e.autocomplete,style:at({marginLeft:e.prefixWidth&&!e.selected.length||e.tagInMultiLine?`${e.prefixWidth}px`:"",flexGrow:1,width:`${e.inputLength/(e.inputWidth-32)}%`,maxWidth:`${e.inputWidth-42}px`}),onFocus:b[2]||(b[2]=(...h)=>e.handleFocus&&e.handleFocus(...h)),onBlur:b[3]||(b[3]=(...h)=>e.handleBlur&&e.handleBlur(...h)),onKeyup:b[4]||(b[4]=(...h)=>e.managePlaceholder&&e.managePlaceholder(...h)),onKeydown:[b[5]||(b[5]=(...h)=>e.resetInputState&&e.resetInputState(...h)),b[6]||(b[6]=vt(Lt(h=>e.navigateOptions("next"),["prevent"]),["down"])),b[7]||(b[7]=vt(Lt(h=>e.navigateOptions("prev"),["prevent"]),["up"])),b[8]||(b[8]=vt(Lt(h=>e.visible=!1,["stop","prevent"]),["esc"])),b[9]||(b[9]=vt(Lt((...h)=>e.selectOption&&e.selectOption(...h),["stop","prevent"]),["enter"])),b[10]||(b[10]=vt((...h)=>e.deletePrevTag&&e.deletePrevTag(...h),["delete"])),b[11]||(b[11]=vt(h=>e.visible=!1,["tab"]))],onCompositionstart:b[12]||(b[12]=(...h)=>e.handleComposition&&e.handleComposition(...h)),onCompositionupdate:b[13]||(b[13]=(...h)=>e.handleComposition&&e.handleComposition(...h)),onCompositionend:b[14]||(b[14]=(...h)=>e.handleComposition&&e.handleComposition(...h)),onInput:b[15]||(b[15]=(...h)=>e.debouncedQueryChange&&e.debouncedQueryChange(...h))},null,46,Ud)),[[Ma,e.query]]):je("v-if",!0)],6)):je("v-if",!0),Ae(O,{id:e.id,ref:"reference",modelValue:e.selectedLabel,"onUpdate:modelValue":b[16]||(b[16]=h=>e.selectedLabel=h),type:"text",placeholder:e.currentPlaceholder,name:e.name,autocomplete:e.autocomplete,size:e.selectSize,disabled:e.selectDisabled,readonly:e.readonly,"validate-event":!1,class:de([e.nsSelect.is("focus",e.visible)]),tabindex:e.multiple&&e.filterable?-1:void 0,onFocus:e.handleFocus,onBlur:e.handleBlur,onInput:e.debouncedOnInputChange,onPaste:e.debouncedOnInputChange,onCompositionstart:e.handleComposition,onCompositionupdate:e.handleComposition,onCompositionend:e.handleComposition,onKeydown:[b[17]||(b[17]=vt(Lt(h=>e.navigateOptions("next"),["stop","prevent"]),["down"])),b[18]||(b[18]=vt(Lt(h=>e.navigateOptions("prev"),["stop","prevent"]),["up"])),vt(Lt(e.selectOption,["stop","prevent"]),["enter"]),b[19]||(b[19]=vt(Lt(h=>e.visible=!1,["stop","prevent"]),["esc"])),b[20]||(b[20]=vt(h=>e.visible=!1,["tab"]))],onMouseenter:b[21]||(b[21]=h=>e.inputHovering=!0),onMouseleave:b[22]||(b[22]=h=>e.inputHovering=!1)},Pa({suffix:ve(()=>[e.iconComponent&&!e.showClose?(q(),xe(P,{key:0,class:de([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.iconReverse])},{default:ve(()=>[(q(),xe(nn(e.iconComponent)))]),_:1},8,["class"])):je("v-if",!0),e.showClose&&e.clearIcon?(q(),xe(P,{key:1,class:de([e.nsSelect.e("caret"),e.nsSelect.e("icon")]),onClick:e.handleClearClick},{default:ve(()=>[(q(),xe(nn(e.clearIcon)))]),_:1},8,["class","onClick"])):je("v-if",!0)]),_:2},[e.$slots.prefix?{name:"prefix",fn:ve(()=>[De("div",Nd,[Ie(e.$slots,"prefix")])])}:void 0]),1032,["id","modelValue","placeholder","name","autocomplete","size","disabled","readonly","class","tabindex","onFocus","onBlur","onInput","onPaste","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown"])])]),content:ve(()=>[Ae(c,null,{default:ve(()=>[gt(Ae(m,{ref:"scrollbar",tag:"ul","wrap-class":e.nsSelect.be("dropdown","wrap"),"view-class":e.nsSelect.be("dropdown","list"),class:de([e.nsSelect.is("empty",!e.allowCreate&&Boolean(e.query)&&e.filteredOptionsCount===0)])},{default:ve(()=>[e.showNewOption?(q(),xe(x,{key:0,value:e.query,created:!0},null,8,["value"])):je("v-if",!0),Ie(e.$slots,"default")]),_:3},8,["wrap-class","view-class","class"]),[[Vt,e.options.size>0&&!e.loading]]),e.emptyText&&(!e.allowCreate||e.loading||e.allowCreate&&e.options.size===0)?(q(),se(ut,{key:0},[e.$slots.empty?Ie(e.$slots,"empty",{key:0}):(q(),se("p",{key:1,class:de(e.nsSelect.be("dropdown","empty"))},Je(e.emptyText),3))],2112)):je("v-if",!0)]),_:3})]),_:3},8,["visible","teleported","popper-class","effect","transition","persistent","onShow"])],2)),[[v,e.handleClose,e.popperPaneRef]])}var Wd=Re(Bd,[["render",Kd],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select.vue"]]);const Hd=ye({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:{type:Boolean,default:!1}},setup(e){const b=Oe("select"),I=ne(!0),M=Rt(),i=ne([]);Et(Qi,Kt(Xe({},ln(e))));const A=Qe(Ur);pt(()=>{i.value=u(M.subTree)});const u=P=>{const O=[];return Array.isArray(P.children)&&P.children.forEach(x=>{var m;x.type&&x.type.name==="ElOption"&&x.component&&x.component.proxy?O.push(x.component.proxy):(m=x.children)!=null&&m.length&&O.push(...u(x))}),O},{groupQueryChange:r}=si(A);return Me(r,()=>{I.value=i.value.some(P=>P.visible===!0)}),{visible:I,ns:b}}});function jd(e,b,I,M,i,A){return gt((q(),se("ul",{class:de(e.ns.be("group","wrap"))},[De("li",{class:de(e.ns.be("group","title"))},Je(e.label),3),De("li",null,[De("ul",{class:de(e.ns.b("group"))},[Ie(e.$slots,"default")],2)])],2)),[[Vt,e.visible]])}var Ji=Re(Hd,[["render",jd],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option-group.vue"]]);const Gd=Wt(Wd,{Option:Dn,OptionGroup:Ji}),zd=wt(Dn);wt(Ji);const Cn=()=>Qe(yi,{}),$d=et({pageSize:{type:Number,required:!0},pageSizes:{type:qe(Array),default:()=>un([10,20,30,40,50,100])},popperClass:{type:String,default:""},disabled:Boolean,size:{type:String,default:"default"}}),Vd=ye({name:"ElPaginationSizes",components:{ElSelect:Gd,ElOption:zd},props:$d,emits:["page-size-change"],setup(e,{emit:b}){const{t:I}=Yt(),M=Oe("pagination"),i=Cn(),A=ne(e.pageSize);Me(()=>e.pageSizes,(P,O)=>{if(!on(P,O)&&Array.isArray(P)){const x=P.includes(e.pageSize)?e.pageSize:e.pageSizes[0];b("page-size-change",x)}}),Me(()=>e.pageSize,P=>{A.value=P});const u=ee(()=>e.pageSizes);function r(P){var O;P!==A.value&&(A.value=P,(O=i.handleSizeChange)==null||O.call(i,Number(P)))}return{ns:M,innerPageSizes:u,innerPageSize:A,t:I,handleChange:r}}});function Yd(e,b,I,M,i,A){const u=Fe("el-option"),r=Fe("el-select");return q(),se("span",{class:de(e.ns.e("sizes"))},[Ae(r,{"model-value":e.innerPageSize,disabled:e.disabled,"popper-class":e.popperClass,size:e.size,onChange:e.handleChange},{default:ve(()=>[(q(!0),se(ut,null,ir(e.innerPageSizes,P=>(q(),xe(u,{key:P,value:P,label:P+e.t("el.pagination.pagesize")},null,8,["value","label"]))),128))]),_:1},8,["model-value","disabled","popper-class","size","onChange"])],2)}var Xd=Re(Vd,[["render",Yd],["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/sizes.vue"]]);const Qd=ye({name:"ElPaginationJumper",components:{ElInput:mi},setup(){const{t:e}=Yt(),b=Oe("pagination"),{pageCount:I,disabled:M,currentPage:i,changeEvent:A}=Cn(),u=ne(),r=ee(()=>{var x;return(x=u.value)!=null?x:i==null?void 0:i.value});function P(x){u.value=+x}function O(x){x=Math.trunc(+x),A==null||A(+x),u.value=void 0}return{ns:b,pageCount:I,disabled:M,innerValue:r,t:e,handleInput:P,handleChange:O}}}),Jd=["disabled"];function Zd(e,b,I,M,i,A){const u=Fe("el-input");return q(),se("span",{class:de(e.ns.e("jump")),disabled:e.disabled},[xr(Je(e.t("el.pagination.goto"))+" ",1),Ae(u,{size:"small",class:de([e.ns.e("editor"),e.ns.is("in-pagination")]),min:1,max:e.pageCount,disabled:e.disabled,"model-value":e.innerValue,type:"number","onUpdate:modelValue":e.handleInput,onChange:e.handleChange},null,8,["class","max","disabled","model-value","onUpdate:modelValue","onChange"]),xr(" "+Je(e.t("el.pagination.pageClassifier")),1)],10,Jd)}var qd=Re(Qd,[["render",Zd],["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/jumper.vue"]]);const ec={total:{type:Number,default:1e3}},tc=ye({name:"ElPaginationTotal",props:ec,setup(){const{t:e}=Yt(),b=Oe("pagination"),{disabled:I}=Cn();return{t:e,ns:b,disabled:I}}}),rc=["disabled"];function nc(e,b,I,M,i,A){return q(),se("span",{class:de(e.ns.e("total")),disabled:e.disabled},Je(e.t("el.pagination.total",{total:e.total})),11,rc)}var ic=Re(tc,[["render",nc],["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/total.vue"]]);const ac={currentPage:{type:Number,default:1},pageCount:{type:Number,required:!0},pagerCount:{type:Number,default:7},disabled:Boolean},oc=ye({name:"ElPaginationPager",components:{DArrowLeft:_o,DArrowRight:Wo,MoreFilled:Vo},props:ac,emits:["change"],setup(e,{emit:b}){const I=Oe("pager"),M=Oe("icon"),i=ne(!1),A=ne(!1),u=ne(!1),r=ne(!1),P=ee(()=>{const c=e.pagerCount,v=(c-1)/2,h=Number(e.currentPage),T=Number(e.pageCount);let L=!1,g=!1;T>c&&(h>c-v&&(L=!0),h<T-v&&(g=!0));const o=[];if(L&&!g){const t=T-(c-2);for(let a=t;a<T;a++)o.push(a)}else if(!L&&g)for(let t=2;t<c;t++)o.push(t);else if(L&&g){const t=Math.floor(c/2)-1;for(let a=h-t;a<=h+t;a++)o.push(a)}else for(let t=2;t<T;t++)o.push(t);return o});Ra(()=>{const c=(e.pagerCount-1)/2;i.value=!1,A.value=!1,e.pageCount>e.pagerCount&&(e.currentPage>e.pagerCount-c&&(i.value=!0),e.currentPage<e.pageCount-c&&(A.value=!0))});function O(c){e.disabled||(c==="left"?u.value=!0:r.value=!0)}function x(c){const v=c.target;if(v.tagName.toLowerCase()==="li"&&Array.from(v.classList).includes("number")){const h=Number(v.textContent);h!==e.currentPage&&b("change",h)}}function m(c){const v=c.target;if(v.tagName.toLowerCase()==="ul"||e.disabled)return;let h=Number(v.textContent);const T=e.pageCount,L=e.currentPage,g=e.pagerCount-2;v.className.includes("more")&&(v.className.includes("quickprev")?h=L-g:v.className.includes("quicknext")&&(h=L+g)),Number.isNaN(+h)||(h<1&&(h=1),h>T&&(h=T)),h!==L&&b("change",h)}return{showPrevMore:i,showNextMore:A,quickPrevHover:u,quickNextHover:r,pagers:P,nsPager:I,nsIcon:M,onMouseenter:O,onPagerClick:m,onEnter:x}}}),sc=["aria-current"],lc=["aria-current"],uc=["aria-current"];function dc(e,b,I,M,i,A){const u=Fe("d-arrow-left"),r=Fe("more-filled"),P=Fe("d-arrow-right");return q(),se("ul",{class:de(e.nsPager.b()),onClick:b[4]||(b[4]=(...O)=>e.onPagerClick&&e.onPagerClick(...O)),onKeyup:b[5]||(b[5]=vt((...O)=>e.onEnter&&e.onEnter(...O),["enter"]))},[e.pageCount>0?(q(),se("li",{key:0,class:de([[e.nsPager.is("active",e.currentPage===1),e.nsPager.is("disabled",e.disabled)],"number"]),"aria-current":e.currentPage===1,tabindex:"0"}," 1 ",10,sc)):je("v-if",!0),e.showPrevMore?(q(),se("li",{key:1,class:de(["more","btn-quickprev",e.nsIcon.b(),e.nsPager.is("disabled",e.disabled)]),onMouseenter:b[0]||(b[0]=O=>e.onMouseenter("left")),onMouseleave:b[1]||(b[1]=O=>e.quickPrevHover=!1)},[e.quickPrevHover?(q(),xe(u,{key:0})):(q(),xe(r,{key:1}))],34)):je("v-if",!0),(q(!0),se(ut,null,ir(e.pagers,O=>(q(),se("li",{key:O,class:de([[e.nsPager.is("active",e.currentPage===O),e.nsPager.is("disabled",e.disabled)],"number"]),"aria-current":e.currentPage===O,tabindex:"0"},Je(O),11,lc))),128)),e.showNextMore?(q(),se("li",{key:2,class:de(["more","btn-quicknext",e.nsIcon.b(),e.nsPager.is("disabled",e.disabled)]),onMouseenter:b[2]||(b[2]=O=>e.onMouseenter("right")),onMouseleave:b[3]||(b[3]=O=>e.quickNextHover=!1)},[e.quickNextHover?(q(),xe(P,{key:0})):(q(),xe(r,{key:1}))],34)):je("v-if",!0),e.pageCount>1?(q(),se("li",{key:3,class:de([[e.nsPager.is("active",e.currentPage===e.pageCount),e.nsPager.is("disabled",e.disabled)],"number"]),"aria-current":e.currentPage===e.pageCount,tabindex:"0"},Je(e.pageCount),11,uc)):je("v-if",!0)],34)}var cc=Re(oc,[["render",dc],["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/pager.vue"]]);const st=e=>typeof e!="number",fc=et({total:Number,pageSize:Number,defaultPageSize:Number,currentPage:Number,defaultCurrentPage:Number,pageCount:Number,pagerCount:{type:Number,validator:e=>typeof e=="number"&&Math.trunc(e)===e&&e>4&&e<22&&e%2===1,default:7},layout:{type:String,default:["prev","pager","next","jumper","->","total"].join(", ")},pageSizes:{type:qe(Array),default:()=>un([10,20,30,40,50,100])},popperClass:{type:String,default:""},prevText:{type:String,default:""},nextText:{type:String,default:""},small:Boolean,background:Boolean,disabled:Boolean,hideOnSinglePage:Boolean}),hc={"update:current-page":e=>typeof e=="number","update:page-size":e=>typeof e=="number","size-change":e=>typeof e=="number","current-change":e=>typeof e=="number","prev-click":e=>typeof e=="number","next-click":e=>typeof e=="number"},ri="ElPagination";var pc=ye({name:ri,props:fc,emits:hc,setup(e,{emit:b,slots:I}){const{t:M}=Yt(),i=Oe("pagination"),A=Rt().vnode.props||{},u="onUpdate:currentPage"in A||"onUpdate:current-page"in A||"onCurrentChange"in A,r="onUpdate:pageSize"in A||"onUpdate:page-size"in A||"onSizeChange"in A,P=ee(()=>{if(st(e.total)&&st(e.pageCount)||!st(e.currentPage)&&!u)return!1;if(e.layout.includes("sizes")){if(st(e.pageCount)){if(!st(e.total)&&!st(e.pageSize)&&!r)return!1}else if(!r)return!1}return!0}),O=ne(st(e.defaultPageSize)?10:e.defaultPageSize),x=ne(st(e.defaultCurrentPage)?1:e.defaultCurrentPage),m=ee({get(){return st(e.pageSize)?O.value:e.pageSize},set(t){st(e.pageSize)&&(O.value=t),r&&(b("update:page-size",t),b("size-change",t))}}),c=ee(()=>{let t=0;return st(e.pageCount)?st(e.total)||(t=Math.max(1,Math.ceil(e.total/m.value))):t=e.pageCount,t}),v=ee({get(){return st(e.currentPage)?x.value:e.currentPage},set(t){let a=t;t<1?a=1:t>c.value&&(a=c.value),st(e.currentPage)&&(x.value=a),u&&(b("update:current-page",a),b("current-change",a))}});Me(c,t=>{v.value>t&&(v.value=t)});function h(t){v.value=t}function T(t){m.value=t;const a=c.value;v.value>a&&(v.value=a)}function L(){e.disabled||(v.value-=1,b("prev-click",v.value))}function g(){e.disabled||(v.value+=1,b("next-click",v.value))}function o(t,a){t&&(t.props||(t.props={}),t.props.class=[t.props.class,a].join(" "))}return Et(yi,{pageCount:c,disabled:ee(()=>e.disabled),currentPage:v,changeEvent:h,handleSizeChange:T}),()=>{var t,a;if(!P.value)return pi(ri,M("el.pagination.deprecationWarning")),null;if(!e.layout||e.hideOnSinglePage&&c.value<=1)return null;const n=[],d=[],l=Ge("div",{class:i.e("rightwrapper")},d),s={prev:Ge(Td,{disabled:e.disabled,currentPage:v.value,prevText:e.prevText,onClick:L}),jumper:Ge(qd),pager:Ge(cc,{currentPage:v.value,pageCount:c.value,pagerCount:e.pagerCount,onChange:h,disabled:e.disabled}),next:Ge(Cd,{disabled:e.disabled,currentPage:v.value,pageCount:c.value,nextText:e.nextText,onClick:g}),sizes:Ge(Xd,{pageSize:m.value,pageSizes:e.pageSizes,popperClass:e.popperClass,disabled:e.disabled,size:e.small?"small":"default"}),slot:(a=(t=I==null?void 0:I.default)==null?void 0:t.call(I))!=null?a:null,total:Ge(ic,{total:st(e.total)?0:e.total})},f=e.layout.split(",").map(D=>D.trim());let C=!1;return f.forEach(D=>{if(D==="->"){C=!0;return}C?d.push(s[D]):n.push(s[D])}),o(n[0],i.is("first")),o(n[n.length-1],i.is("last")),C&&d.length>0&&(o(d[0],i.is("first")),o(d[d.length-1],i.is("last")),n.push(l)),Ge("div",{role:"pagination","aria-label":"pagination",class:[i.b(),i.is("background",e.background),{[i.m("small")]:e.small}]},n)}}});const vc=Wt(pc);const mc={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},gc=De("path",{fill:"currentColor",d:"M128 192h768v128H128V192zm0 256h512v128H128V448zm0 256h768v128H128V704zm576-352l192 160l-192 128V352z"},null,-1),yc=[gc];function Ec(e,b){return q(),se("svg",mc,yc)}var bc={name:"ep-expand",render:Ec};const Tc={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},xc=De("path",{fill:"currentColor",d:"M878.08 448H241.92l-96 384h636.16l96-384zM832 384v-64H485.76L357.504 192H128v448l57.92-231.744A32 32 0 0 1 216.96 384H832zm-24.96 512H96a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h287.872l128.384 128H864a32 32 0 0 1 32 32v96h23.04a32 32 0 0 1 31.04 39.744l-112 448A32 32 0 0 1 807.04 896z"},null,-1),Sc=[xc];function Lc(e,b){return q(),se("svg",Tc,Sc)}var Ac={name:"ep-folder-opened",render:Lc};const Dc={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Cc=De("path",{fill:"currentColor",d:"M832 384H192v448h640V384zM96 320h832V128H96v192zm800 64v480a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V384H64a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32h896a32 32 0 0 1 32 32v256a32 32 0 0 1-32 32h-64zM416 512h192a32 32 0 0 1 0 64H416a32 32 0 0 1 0-64z"},null,-1),Oc=[Cc];function Mc(e,b){return q(),se("svg",Dc,Oc)}var Pc={name:"ep-takeaway-box",render:Mc},Zi={exports:{}};(function(e,b){(function(I,M){e.exports=M()})(window,function(){return function(I){var M={};function i(A){if(M[A])return M[A].exports;var u=M[A]={i:A,l:!1,exports:{}};return I[A].call(u.exports,u,u.exports,i),u.l=!0,u.exports}return i.m=I,i.c=M,i.d=function(A,u,r){i.o(A,u)||Object.defineProperty(A,u,{enumerable:!0,get:r})},i.r=function(A){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(A,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(A,"__esModule",{value:!0})},i.t=function(A,u){if(1&u&&(A=i(A)),8&u||4&u&&typeof A=="object"&&A&&A.__esModule)return A;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:A}),2&u&&typeof A!="string")for(var P in A)i.d(r,P,function(O){return A[O]}.bind(null,P));return r},i.n=function(A){var u=A&&A.__esModule?function(){return A.default}:function(){return A};return i.d(u,"a",u),u},i.o=function(A,u){return Object.prototype.hasOwnProperty.call(A,u)},i.p="/",i(i.s=58)}([function(I,M,i){function A(v){return(A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(v)}var u=i(6),r=Object.prototype.toString;function P(v){return r.call(v)==="[object Array]"}function O(v){return v===void 0}function x(v){return v!==null&&A(v)==="object"}function m(v){return r.call(v)==="[object Function]"}function c(v,h){if(v!=null)if(A(v)!=="object"&&(v=[v]),P(v))for(var T=0,L=v.length;T<L;T++)h.call(null,v[T],T,v);else for(var g in v)Object.prototype.hasOwnProperty.call(v,g)&&h.call(null,v[g],g,v)}I.exports={isArray:P,isArrayBuffer:function(v){return r.call(v)==="[object ArrayBuffer]"},isBuffer:function(v){return v!==null&&!O(v)&&v.constructor!==null&&!O(v.constructor)&&typeof v.constructor.isBuffer=="function"&&v.constructor.isBuffer(v)},isFormData:function(v){return typeof FormData!="undefined"&&v instanceof FormData},isArrayBufferView:function(v){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?ArrayBuffer.isView(v):v&&v.buffer&&v.buffer instanceof ArrayBuffer},isString:function(v){return typeof v=="string"},isNumber:function(v){return typeof v=="number"},isObject:x,isUndefined:O,isDate:function(v){return r.call(v)==="[object Date]"},isFile:function(v){return r.call(v)==="[object File]"},isBlob:function(v){return r.call(v)==="[object Blob]"},isFunction:m,isStream:function(v){return x(v)&&m(v.pipe)},isURLSearchParams:function(v){return typeof URLSearchParams!="undefined"&&v instanceof URLSearchParams},isStandardBrowserEnv:function(){return(typeof navigator=="undefined"||navigator.product!=="ReactNative"&&navigator.product!=="NativeScript"&&navigator.product!=="NS")&&typeof window!="undefined"&&typeof document!="undefined"},forEach:c,merge:function v(){var h={};function T(o,t){A(h[t])==="object"&&A(o)==="object"?h[t]=v(h[t],o):h[t]=o}for(var L=0,g=arguments.length;L<g;L++)c(arguments[L],T);return h},deepMerge:function v(){var h={};function T(o,t){A(h[t])==="object"&&A(o)==="object"?h[t]=v(h[t],o):A(o)==="object"?h[t]=v({},o):h[t]=o}for(var L=0,g=arguments.length;L<g;L++)c(arguments[L],T);return h},extend:function(v,h,T){return c(h,function(L,g){v[g]=T&&typeof L=="function"?u(L,T):L}),v},trim:function(v){return v.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(I,M,i){var A=i(14);I.exports=function(u){var r="",P=(u=u||{}).enableSubtitle,O=u.subtitle,x=u.current,m=u.airplay,c=u.pic,v=A.$escape,h=u.screenshot,T=u.preload,L=u.url;return P=O&&O.type==="webvtt",r+=`
<video
    class="dplayer-video `,x&&(r+="dplayer-video-current"),r+=`"
    webkit-playsinline
    `,m&&(r+=' x-webkit-airplay="allow" '),r+=`
    playsinline
    `,c&&(r+='poster="',r+=v(c),r+='"'),r+=`
    `,(h||P)&&(r+='crossorigin="anonymous"'),r+=`
    `,T&&(r+='preload="',r+=v(T),r+='"'),r+=`
    `,L&&(r+='src="',r+=v(L),r+='"'),r+=`
    >
    `,P&&(r+=`
    <track kind="metadata" default src="`,r+=v(O.url),r+=`"></track>
    `),r+=`
</video>`}},function(I,M,i){I.exports=i(41)},function(I,M,i){I.exports=function(A){var u=[];return u.toString=function(){return this.map(function(r){var P=function(O,x){var m=O[1]||"",c=O[3];if(!c)return m;if(x&&typeof btoa=="function"){var v=(T=c,L=btoa(unescape(encodeURIComponent(JSON.stringify(T)))),g="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(L),"/*# ".concat(g," */")),h=c.sources.map(function(o){return"/*# sourceURL=".concat(c.sourceRoot||"").concat(o," */")});return[m].concat(h).concat([v]).join(`
`)}var T,L,g;return[m].join(`
`)}(r,A);return r[2]?"@media ".concat(r[2]," {").concat(P,"}"):P}).join("")},u.i=function(r,P,O){typeof r=="string"&&(r=[[null,r,""]]);var x={};if(O)for(var m=0;m<this.length;m++){var c=this[m][0];c!=null&&(x[c]=!0)}for(var v=0;v<r.length;v++){var h=[].concat(r[v]);O&&x[h[0]]||(P&&(h[2]?h[2]="".concat(P," and ").concat(h[2]):h[2]=P),u.push(h))}},u}},function(I,M){function i(u){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(u)}var A;A=function(){return this}();try{A=A||new Function("return this")()}catch{(typeof window=="undefined"?"undefined":i(window))==="object"&&(A=window)}I.exports=A},function(I,M){var i,A,u=I.exports={};function r(){throw new Error("setTimeout has not been defined")}function P(){throw new Error("clearTimeout has not been defined")}function O(o){if(i===setTimeout)return setTimeout(o,0);if((i===r||!i)&&setTimeout)return i=setTimeout,setTimeout(o,0);try{return i(o,0)}catch{try{return i.call(null,o,0)}catch{return i.call(this,o,0)}}}(function(){try{i=typeof setTimeout=="function"?setTimeout:r}catch{i=r}try{A=typeof clearTimeout=="function"?clearTimeout:P}catch{A=P}})();var x,m=[],c=!1,v=-1;function h(){c&&x&&(c=!1,x.length?m=x.concat(m):v=-1,m.length&&T())}function T(){if(!c){var o=O(h);c=!0;for(var t=m.length;t;){for(x=m,m=[];++v<t;)x&&x[v].run();v=-1,t=m.length}x=null,c=!1,function(a){if(A===clearTimeout)return clearTimeout(a);if((A===P||!A)&&clearTimeout)return A=clearTimeout,clearTimeout(a);try{A(a)}catch{try{return A.call(null,a)}catch{return A.call(this,a)}}}(o)}}function L(o,t){this.fun=o,this.array=t}function g(){}u.nextTick=function(o){var t=new Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];m.push(new L(o,t)),m.length!==1||c||O(T)},L.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=g,u.addListener=g,u.once=g,u.off=g,u.removeListener=g,u.removeAllListeners=g,u.emit=g,u.prependListener=g,u.prependOnceListener=g,u.listeners=function(o){return[]},u.binding=function(o){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(o){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(I,M,i){I.exports=function(A,u){return function(){for(var r=new Array(arguments.length),P=0;P<r.length;P++)r[P]=arguments[P];return A.apply(u,r)}}},function(I,M,i){var A=i(0);function u(r){return encodeURIComponent(r).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}I.exports=function(r,P,O){if(!P)return r;var x;if(O)x=O(P);else if(A.isURLSearchParams(P))x=P.toString();else{var m=[];A.forEach(P,function(v,h){v!=null&&(A.isArray(v)?h+="[]":v=[v],A.forEach(v,function(T){A.isDate(T)?T=T.toISOString():A.isObject(T)&&(T=JSON.stringify(T)),m.push(u(h)+"="+u(T))}))}),x=m.join("&")}if(x){var c=r.indexOf("#");c!==-1&&(r=r.slice(0,c)),r+=(r.indexOf("?")===-1?"?":"&")+x}return r}},function(I,M,i){I.exports=function(A){return!(!A||!A.__CANCEL__)}},function(I,M,i){(function(A){var u=i(0),r=i(46),P={"Content-Type":"application/x-www-form-urlencoded"};function O(c,v){!u.isUndefined(c)&&u.isUndefined(c["Content-Type"])&&(c["Content-Type"]=v)}var x,m={adapter:((typeof XMLHttpRequest!="undefined"||A!==void 0&&Object.prototype.toString.call(A)==="[object process]")&&(x=i(10)),x),transformRequest:[function(c,v){return r(v,"Accept"),r(v,"Content-Type"),u.isFormData(c)||u.isArrayBuffer(c)||u.isBuffer(c)||u.isStream(c)||u.isFile(c)||u.isBlob(c)?c:u.isArrayBufferView(c)?c.buffer:u.isURLSearchParams(c)?(O(v,"application/x-www-form-urlencoded;charset=utf-8"),c.toString()):u.isObject(c)?(O(v,"application/json;charset=utf-8"),JSON.stringify(c)):c}],transformResponse:[function(c){if(typeof c=="string")try{c=JSON.parse(c)}catch{}return c}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(c){return c>=200&&c<300}};m.headers={common:{Accept:"application/json, text/plain, */*"}},u.forEach(["delete","get","head"],function(c){m.headers[c]={}}),u.forEach(["post","put","patch"],function(c){m.headers[c]=u.merge(P)}),I.exports=m}).call(this,i(5))},function(I,M,i){var A=i(0),u=i(47),r=i(7),P=i(49),O=i(52),x=i(53),m=i(11);I.exports=function(c){return new Promise(function(v,h){var T=c.data,L=c.headers;A.isFormData(T)&&delete L["Content-Type"];var g=new XMLHttpRequest;if(c.auth){var o=c.auth.username||"",t=c.auth.password||"";L.Authorization="Basic "+btoa(o+":"+t)}var a=P(c.baseURL,c.url);if(g.open(c.method.toUpperCase(),r(a,c.params,c.paramsSerializer),!0),g.timeout=c.timeout,g.onreadystatechange=function(){if(g&&g.readyState===4&&(g.status!==0||g.responseURL&&g.responseURL.indexOf("file:")===0)){var l="getAllResponseHeaders"in g?O(g.getAllResponseHeaders()):null,s={data:c.responseType&&c.responseType!=="text"?g.response:g.responseText,status:g.status,statusText:g.statusText,headers:l,config:c,request:g};u(v,h,s),g=null}},g.onabort=function(){g&&(h(m("Request aborted",c,"ECONNABORTED",g)),g=null)},g.onerror=function(){h(m("Network Error",c,null,g)),g=null},g.ontimeout=function(){var l="timeout of "+c.timeout+"ms exceeded";c.timeoutErrorMessage&&(l=c.timeoutErrorMessage),h(m(l,c,"ECONNABORTED",g)),g=null},A.isStandardBrowserEnv()){var n=i(54),d=(c.withCredentials||x(a))&&c.xsrfCookieName?n.read(c.xsrfCookieName):void 0;d&&(L[c.xsrfHeaderName]=d)}if("setRequestHeader"in g&&A.forEach(L,function(l,s){T===void 0&&s.toLowerCase()==="content-type"?delete L[s]:g.setRequestHeader(s,l)}),A.isUndefined(c.withCredentials)||(g.withCredentials=!!c.withCredentials),c.responseType)try{g.responseType=c.responseType}catch(l){if(c.responseType!=="json")throw l}typeof c.onDownloadProgress=="function"&&g.addEventListener("progress",c.onDownloadProgress),typeof c.onUploadProgress=="function"&&g.upload&&g.upload.addEventListener("progress",c.onUploadProgress),c.cancelToken&&c.cancelToken.promise.then(function(l){g&&(g.abort(),h(l),g=null)}),T===void 0&&(T=null),g.send(T)})}},function(I,M,i){var A=i(48);I.exports=function(u,r,P,O,x){var m=new Error(u);return A(m,r,P,O,x)}},function(I,M,i){var A=i(0);I.exports=function(u,r){r=r||{};var P={},O=["url","method","params","data"],x=["headers","auth","proxy"],m=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];A.forEach(O,function(h){r[h]!==void 0&&(P[h]=r[h])}),A.forEach(x,function(h){A.isObject(r[h])?P[h]=A.deepMerge(u[h],r[h]):r[h]!==void 0?P[h]=r[h]:A.isObject(u[h])?P[h]=A.deepMerge(u[h]):u[h]!==void 0&&(P[h]=u[h])}),A.forEach(m,function(h){r[h]!==void 0?P[h]=r[h]:u[h]!==void 0&&(P[h]=u[h])});var c=O.concat(x).concat(m),v=Object.keys(r).filter(function(h){return c.indexOf(h)===-1});return A.forEach(v,function(h){r[h]!==void 0?P[h]=r[h]:u[h]!==void 0&&(P[h]=u[h])}),P}},function(I,M,i){function A(u){this.message=u}A.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},A.prototype.__CANCEL__=!0,I.exports=A},function(I,M,i){I.exports=i(57)},function(I,M,i){(function(A){var u=i(16);function r(o){return(r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(o)}var P=setTimeout;function O(o){return Boolean(o&&o.length!==void 0)}function x(){}function m(o){if(!(this instanceof m))throw new TypeError("Promises must be constructed via new");if(typeof o!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],g(o,this)}function c(o,t){for(;o._state===3;)o=o._value;o._state!==0?(o._handled=!0,m._immediateFn(function(){var a=o._state===1?t.onFulfilled:t.onRejected;if(a!==null){var n;try{n=a(o._value)}catch(d){return void h(t.promise,d)}v(t.promise,n)}else(o._state===1?v:h)(t.promise,o._value)})):o._deferreds.push(t)}function v(o,t){try{if(t===o)throw new TypeError("A promise cannot be resolved with itself.");if(t&&(r(t)==="object"||typeof t=="function")){var a=t.then;if(t instanceof m)return o._state=3,o._value=t,void T(o);if(typeof a=="function")return void g((n=a,d=t,function(){n.apply(d,arguments)}),o)}o._state=1,o._value=t,T(o)}catch(l){h(o,l)}var n,d}function h(o,t){o._state=2,o._value=t,T(o)}function T(o){o._state===2&&o._deferreds.length===0&&m._immediateFn(function(){o._handled||m._unhandledRejectionFn(o._value)});for(var t=0,a=o._deferreds.length;t<a;t++)c(o,o._deferreds[t]);o._deferreds=null}function L(o,t,a){this.onFulfilled=typeof o=="function"?o:null,this.onRejected=typeof t=="function"?t:null,this.promise=a}function g(o,t){var a=!1;try{o(function(n){a||(a=!0,v(t,n))},function(n){a||(a=!0,h(t,n))})}catch(n){if(a)return;a=!0,h(t,n)}}m.prototype.catch=function(o){return this.then(null,o)},m.prototype.then=function(o,t){var a=new this.constructor(x);return c(this,new L(o,t,a)),a},m.prototype.finally=u.a,m.all=function(o){return new m(function(t,a){if(!O(o))return a(new TypeError("Promise.all accepts an array"));var n=Array.prototype.slice.call(o);if(n.length===0)return t([]);var d=n.length;function l(f,C){try{if(C&&(r(C)==="object"||typeof C=="function")){var D=C.then;if(typeof D=="function")return void D.call(C,function(E){l(f,E)},a)}n[f]=C,--d==0&&t(n)}catch(E){a(E)}}for(var s=0;s<n.length;s++)l(s,n[s])})},m.resolve=function(o){return o&&r(o)==="object"&&o.constructor===m?o:new m(function(t){t(o)})},m.reject=function(o){return new m(function(t,a){a(o)})},m.race=function(o){return new m(function(t,a){if(!O(o))return a(new TypeError("Promise.race accepts an array"));for(var n=0,d=o.length;n<d;n++)m.resolve(o[n]).then(t,a)})},m._immediateFn=typeof A=="function"&&function(o){A(o)}||function(o){P(o,0)},m._unhandledRejectionFn=function(o){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",o)},M.a=m}).call(this,i(39).setImmediate)},function(I,M,i){M.a=function(A){var u=this.constructor;return this.then(function(r){return u.resolve(A()).then(function(){return r})},function(r){return u.resolve(A()).then(function(){return u.reject(r)})})}},function(I,M){I.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 16 32"><path d="M15.552 15.168q0.448 0.32 0.448 0.832 0 0.448-0.448 0.768l-13.696 8.512q-0.768 0.512-1.312 0.192t-0.544-1.28v-16.448q0-0.96 0.544-1.28t1.312 0.192z"></path></svg>'},function(I,M){I.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 17 32"><path d="M14.080 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048zM2.88 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048z"></path></svg>'},function(I,M){I.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528zM25.152 16q0 2.72-1.536 5.056t-4 3.36q-0.256 0.096-0.448 0.096-0.48 0-0.832-0.352t-0.32-0.8q0-0.704 0.672-1.056 1.024-0.512 1.376-0.8 1.312-0.96 2.048-2.4t0.736-3.104-0.736-3.104-2.048-2.4q-0.352-0.288-1.376-0.8-0.672-0.352-0.672-1.056 0-0.448 0.32-0.8t0.8-0.352q0.224 0 0.48 0.096 2.496 1.056 4 3.36t1.536 5.056z"></path></svg>'},function(I,M){I.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528z"></path></svg>'},function(I,M){I.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8z"></path></svg>'},function(I,M){I.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M6.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v4h4c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333zM30.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h4v-4c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM30.667 12c-0.8 0-1.333-0.533-1.333-1.333v-4h-4c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM1.333 12c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333h-4v4c0 0.8-0.533 1.333-1.333 1.333z"></path></svg>'},function(I,M){I.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M24.965 24.38h-18.132c-1.366 0-2.478-1.113-2.478-2.478v-11.806c0-1.364 1.111-2.478 2.478-2.478h18.132c1.366 0 2.478 1.113 2.478 2.478v11.806c0 1.364-1.11 2.478-2.478 2.478zM6.833 10.097v11.806h18.134l-0.002-11.806h-18.132zM2.478 28.928h5.952c0.684 0 1.238-0.554 1.238-1.239 0-0.684-0.554-1.238-1.238-1.238h-5.952v-5.802c0-0.684-0.554-1.239-1.238-1.239s-1.239 0.556-1.239 1.239v5.802c0 1.365 1.111 2.478 2.478 2.478zM30.761 19.412c-0.684 0-1.238 0.554-1.238 1.238v5.801h-5.951c-0.686 0-1.239 0.554-1.239 1.238 0 0.686 0.554 1.239 1.239 1.239h5.951c1.366 0 2.478-1.111 2.478-2.478v-5.801c0-0.683-0.554-1.238-1.239-1.238zM0 5.55v5.802c0 0.683 0.554 1.238 1.238 1.238s1.238-0.555 1.238-1.238v-5.802h5.952c0.684 0 1.238-0.554 1.238-1.238s-0.554-1.238-1.238-1.238h-5.951c-1.366-0.001-2.478 1.111-2.478 2.476zM32 11.35v-5.801c0-1.365-1.11-2.478-2.478-2.478h-5.951c-0.686 0-1.239 0.554-1.239 1.238s0.554 1.238 1.239 1.238h5.951v5.801c0 0.683 0.554 1.237 1.238 1.237 0.686 0.002 1.239-0.553 1.239-1.236z"></path></svg>'},function(I,M){I.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 28"><path d="M28.633 17.104c0.035 0.21 0.026 0.463-0.026 0.76s-0.14 0.598-0.262 0.904c-0.122 0.306-0.271 0.581-0.445 0.825s-0.367 0.419-0.576 0.524c-0.209 0.105-0.393 0.157-0.55 0.157s-0.332-0.035-0.524-0.105c-0.175-0.052-0.393-0.1-0.655-0.144s-0.528-0.052-0.799-0.026c-0.271 0.026-0.541 0.083-0.812 0.17s-0.502 0.236-0.694 0.445c-0.419 0.437-0.664 0.934-0.734 1.493s0.009 1.092 0.236 1.598c0.175 0.349 0.148 0.699-0.079 1.048-0.105 0.14-0.271 0.284-0.498 0.432s-0.476 0.284-0.747 0.406-0.555 0.218-0.851 0.288c-0.297 0.070-0.559 0.105-0.786 0.105-0.157 0-0.306-0.061-0.445-0.183s-0.236-0.253-0.288-0.393h-0.026c-0.192-0.541-0.52-1.009-0.982-1.402s-1-0.589-1.611-0.589c-0.594 0-1.131 0.197-1.611 0.589s-0.816 0.851-1.009 1.375c-0.087 0.21-0.218 0.362-0.393 0.458s-0.367 0.144-0.576 0.144c-0.244 0-0.52-0.044-0.825-0.131s-0.611-0.197-0.917-0.327c-0.306-0.131-0.581-0.284-0.825-0.458s-0.428-0.349-0.55-0.524c-0.087-0.122-0.135-0.266-0.144-0.432s0.057-0.397 0.197-0.694c0.192-0.402 0.266-0.86 0.223-1.375s-0.266-0.991-0.668-1.428c-0.244-0.262-0.541-0.432-0.891-0.511s-0.681-0.109-0.995-0.092c-0.367 0.017-0.742 0.087-1.127 0.21-0.244 0.070-0.489 0.052-0.734-0.052-0.192-0.070-0.371-0.231-0.537-0.485s-0.314-0.533-0.445-0.838c-0.131-0.306-0.231-0.62-0.301-0.943s-0.087-0.59-0.052-0.799c0.052-0.384 0.227-0.629 0.524-0.734 0.524-0.21 0.995-0.555 1.415-1.035s0.629-1.017 0.629-1.611c0-0.611-0.21-1.144-0.629-1.598s-0.891-0.786-1.415-0.996c-0.157-0.052-0.288-0.179-0.393-0.38s-0.157-0.406-0.157-0.616c0-0.227 0.035-0.48 0.105-0.76s0.162-0.55 0.275-0.812 0.244-0.502 0.393-0.72c0.148-0.218 0.31-0.38 0.485-0.485 0.14-0.087 0.275-0.122 0.406-0.105s0.275 0.052 0.432 0.105c0.524 0.21 1.070 0.275 1.637 0.197s1.070-0.327 1.506-0.747c0.21-0.209 0.362-0.467 0.458-0.773s0.157-0.607 0.183-0.904c0.026-0.297 0.026-0.568 0-0.812s-0.048-0.419-0.065-0.524c-0.035-0.105-0.066-0.227-0.092-0.367s-0.013-0.262 0.039-0.367c0.105-0.244 0.293-0.458 0.563-0.642s0.563-0.336 0.878-0.458c0.314-0.122 0.62-0.214 0.917-0.275s0.533-0.092 0.707-0.092c0.227 0 0.406 0.074 0.537 0.223s0.223 0.301 0.275 0.458c0.192 0.471 0.507 0.886 0.943 1.244s0.952 0.537 1.546 0.537c0.611 0 1.153-0.17 1.624-0.511s0.803-0.773 0.996-1.297c0.070-0.14 0.179-0.284 0.327-0.432s0.301-0.223 0.458-0.223c0.244 0 0.511 0.035 0.799 0.105s0.572 0.166 0.851 0.288c0.279 0.122 0.537 0.279 0.773 0.472s0.423 0.402 0.563 0.629c0.087 0.14 0.113 0.293 0.079 0.458s-0.070 0.284-0.105 0.354c-0.227 0.506-0.297 1.039-0.21 1.598s0.341 1.048 0.76 1.467c0.419 0.419 0.934 0.651 1.546 0.694s1.179-0.057 1.703-0.301c0.14-0.087 0.31-0.122 0.511-0.105s0.371 0.096 0.511 0.236c0.262 0.244 0.493 0.616 0.694 1.113s0.336 1 0.406 1.506c0.035 0.297-0.013 0.528-0.144 0.694s-0.266 0.275-0.406 0.327c-0.542 0.192-1.004 0.528-1.388 1.009s-0.576 1.026-0.576 1.637c0 0.594 0.162 1.113 0.485 1.559s0.747 0.764 1.27 0.956c0.122 0.070 0.227 0.14 0.314 0.21 0.192 0.157 0.323 0.358 0.393 0.602v0zM16.451 19.462c0.786 0 1.528-0.149 2.227-0.445s1.305-0.707 1.821-1.231c0.515-0.524 0.921-1.131 1.218-1.821s0.445-1.428 0.445-2.214c0-0.786-0.148-1.524-0.445-2.214s-0.703-1.292-1.218-1.808c-0.515-0.515-1.122-0.921-1.821-1.218s-1.441-0.445-2.227-0.445c-0.786 0-1.524 0.148-2.214 0.445s-1.292 0.703-1.808 1.218c-0.515 0.515-0.921 1.118-1.218 1.808s-0.445 1.428-0.445 2.214c0 0.786 0.149 1.524 0.445 2.214s0.703 1.297 1.218 1.821c0.515 0.524 1.118 0.934 1.808 1.231s1.428 0.445 2.214 0.445v0z"></path></svg>'},function(I,M){I.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M22 16l-10.105-10.6-1.895 1.987 8.211 8.613-8.211 8.612 1.895 1.988 8.211-8.613z"></path></svg>'},function(I,M){I.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.128 0.38h-22.553c-2.336 0-4.229 1.825-4.229 4.076v16.273c0 2.251 1.893 4.076 4.229 4.076h4.229v-2.685h8.403l-8.784 8.072 1.566 1.44 7.429-6.827h9.71c2.335 0 4.229-1.825 4.229-4.076v-16.273c0-2.252-1.894-4.076-4.229-4.076zM28.538 19.403c0 1.5-1.262 2.717-2.819 2.717h-8.36l-0.076-0.070-0.076 0.070h-11.223c-1.557 0-2.819-1.217-2.819-2.717v-13.589c0-1.501 1.262-2.718 2.819-2.718h19.734c1.557 0 2.819-0.141 2.819 1.359v14.947zM9.206 10.557c-1.222 0-2.215 0.911-2.215 2.036s0.992 2.035 2.215 2.035c1.224 0 2.216-0.911 2.216-2.035s-0.992-2.036-2.216-2.036zM22.496 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.224 0 2.215-0.911 2.215-2.035s-0.991-2.036-2.215-2.036zM15.852 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.222 0 2.215-0.911 2.215-2.035s-0.992-2.036-2.215-2.036z"></path></svg>'},function(I,M){I.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.090 0.131h-22.731c-2.354 0-4.262 1.839-4.262 4.109v16.401c0 2.269 1.908 4.109 4.262 4.109h4.262v-2.706h8.469l-8.853 8.135 1.579 1.451 7.487-6.88h9.787c2.353 0 4.262-1.84 4.262-4.109v-16.401c0-2.27-1.909-4.109-4.262-4.109v0zM28.511 19.304c0 1.512-1.272 2.738-2.841 2.738h-8.425l-0.076-0.070-0.076 0.070h-11.311c-1.569 0-2.841-1.226-2.841-2.738v-13.696c0-1.513 1.272-2.739 2.841-2.739h19.889c1.569 0 2.841-0.142 2.841 1.37v15.064z"></path></svg>'},function(I,M){I.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M13.725 30l3.9-5.325-3.9-1.125v6.45zM0 17.5l11.050 3.35 13.6-11.55-10.55 12.425 11.8 3.65 6.1-23.375-32 15.5z"></path></svg>'},function(I,M){I.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M19.357 2.88c1.749 0 3.366 0.316 4.851 0.946 1.485 0.632 2.768 1.474 3.845 2.533s1.922 2.279 2.532 3.661c0.611 1.383 0.915 2.829 0.915 4.334 0 1.425-0.304 2.847-0.915 4.271-0.611 1.425-1.587 2.767-2.928 4.028-0.855 0.813-1.811 1.607-2.869 2.38s-2.136 1.465-3.233 2.075c-1.099 0.61-2.198 1.098-3.296 1.465-1.098 0.366-2.115 0.549-3.051 0.549-1.343 0-2.441-0.438-3.296-1.311-0.854-0.876-1.281-2.41-1.281-4.608 0-0.366 0.020-0.773 0.060-1.221s0.062-0.895 0.062-1.343c0-0.773-0.183-1.353-0.55-1.738-0.366-0.387-0.793-0.58-1.281-0.58-0.652 0-1.21 0.295-1.678 0.886s-0.926 1.23-1.373 1.921c-0.447 0.693-0.905 1.334-1.372 1.923s-1.028 0.886-1.679 0.886c-0.529 0-1.048-0.427-1.556-1.282s-0.763-2.259-0.763-4.212c0-2.197 0.529-4.241 1.587-6.133s2.462-3.529 4.21-4.912c1.75-1.383 3.762-2.471 6.041-3.264 2.277-0.796 4.617-1.212 7.018-1.253zM7.334 15.817c0.569 0 1.047-0.204 1.434-0.611s0.579-0.875 0.579-1.404c0-0.569-0.193-1.047-0.579-1.434s-0.864-0.579-1.434-0.579c-0.529 0-0.987 0.193-1.373 0.579s-0.58 0.864-0.58 1.434c0 0.53 0.194 0.998 0.58 1.404 0.388 0.407 0.845 0.611 1.373 0.611zM12.216 11.79c0.691 0 1.292-0.254 1.8-0.763s0.762-1.107 0.762-1.8c0-0.732-0.255-1.343-0.762-1.831-0.509-0.489-1.109-0.732-1.8-0.732-0.732 0-1.342 0.244-1.831 0.732-0.488 0.488-0.732 1.098-0.732 1.831 0 0.693 0.244 1.292 0.732 1.8s1.099 0.763 1.831 0.763zM16.366 25.947c0.692 0 1.282-0.214 1.77-0.64s0.732-0.987 0.732-1.678-0.244-1.261-0.732-1.709c-0.489-0.448-1.078-0.671-1.77-0.671-0.65 0-1.21 0.223-1.678 0.671s-0.702 1.018-0.702 1.709c0 0.692 0.234 1.25 0.702 1.678s1.027 0.64 1.678 0.64zM19.113 9.592c0.651 0 1.129-0.203 1.433-0.611 0.305-0.406 0.459-0.874 0.459-1.404 0-0.488-0.154-0.947-0.459-1.373-0.304-0.427-0.782-0.641-1.433-0.641-0.529 0-1.008 0.193-1.434 0.58s-0.64 0.865-0.64 1.434c0 0.571 0.213 1.049 0.64 1.434 0.427 0.389 0.905 0.581 1.434 0.581zM24.848 12.826c0.57 0 1.067-0.213 1.495-0.64 0.427-0.427 0.64-0.947 0.64-1.556 0-0.57-0.214-1.068-0.64-1.495-0.428-0.427-0.927-0.64-1.495-0.64-0.611 0-1.129 0.213-1.555 0.64-0.428 0.427-0.642 0.926-0.642 1.495 0 0.611 0.213 1.129 0.642 1.556s0.947 0.64 1.555 0.64z"></path></svg>'},function(I,M){I.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M16 23c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6zM16 13c-2.206 0-4 1.794-4 4s1.794 4 4 4c2.206 0 4-1.794 4-4s-1.794-4-4-4zM27 28h-22c-1.654 0-3-1.346-3-3v-16c0-1.654 1.346-3 3-3h3c0.552 0 1 0.448 1 1s-0.448 1-1 1h-3c-0.551 0-1 0.449-1 1v16c0 0.552 0.449 1 1 1h22c0.552 0 1-0.448 1-1v-16c0-0.551-0.448-1-1-1h-11c-0.552 0-1-0.448-1-1s0.448-1 1-1h11c1.654 0 3 1.346 3 3v16c0 1.654-1.346 3-3 3zM24 10.5c0 0.828 0.672 1.5 1.5 1.5s1.5-0.672 1.5-1.5c0-0.828-0.672-1.5-1.5-1.5s-1.5 0.672-1.5 1.5zM15 4c0 0.552-0.448 1-1 1h-4c-0.552 0-1-0.448-1-1v0c0-0.552 0.448-1 1-1h4c0.552 0 1 0.448 1 1v0z"></path></svg>'},function(I,M){I.exports='<svg viewBox="0 0 288 288" xmlns="http://www.w3.org/2000/svg"><path d="M288 90v96c0 20-16 36-36 36h-10c-16 0-16-24 0-24h10c7 0 12-5 12-12V90c0-7-5-12-12-12H36c-7 0-12 5-12 12v96c0 7 5 12 12 12h10c16 0 16 24 0 24H36c-20 0-36-16-36-36V90c0-20 16-36 36-36h216c20 0 36 16 36 36zm-120 62l48 68c14 20 1 38-20 38H92c-21 0-34-18-20-38l48-68c13-18 35-18 48 0z"></path></svg>'},function(I,M){I.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M26.667 5.333h-21.333c-0 0-0.001 0-0.001 0-1.472 0-2.666 1.194-2.666 2.666 0 0 0 0.001 0 0.001v-0 16c0 0 0 0.001 0 0.001 0 1.472 1.194 2.666 2.666 2.666 0 0 0.001 0 0.001 0h21.333c0 0 0.001 0 0.001 0 1.472 0 2.666-1.194 2.666-2.666 0-0 0-0.001 0-0.001v0-16c0-0 0-0.001 0-0.001 0-1.472-1.194-2.666-2.666-2.666-0 0-0.001 0-0.001 0h0zM5.333 16h5.333v2.667h-5.333v-2.667zM18.667 24h-13.333v-2.667h13.333v2.667zM26.667 24h-5.333v-2.667h5.333v2.667zM26.667 18.667h-13.333v-2.667h13.333v2.667z"></path></svg>'},function(I,M){I.exports='<svg version="1.1" viewBox="0 0 22 22"><svg x="7" y="1"><circle class="diplayer-loading-dot diplayer-loading-dot-0" cx="4" cy="4" r="2"></circle></svg><svg x="11" y="3"><circle class="diplayer-loading-dot diplayer-loading-dot-1" cx="4" cy="4" r="2"></circle></svg><svg x="13" y="7"><circle class="diplayer-loading-dot diplayer-loading-dot-2" cx="4" cy="4" r="2"></circle></svg><svg x="11" y="11"><circle class="diplayer-loading-dot diplayer-loading-dot-3" cx="4" cy="4" r="2"></circle></svg><svg x="7" y="13"><circle class="diplayer-loading-dot diplayer-loading-dot-4" cx="4" cy="4" r="2"></circle></svg><svg x="3" y="11"><circle class="diplayer-loading-dot diplayer-loading-dot-5" cx="4" cy="4" r="2"></circle></svg><svg x="1" y="7"><circle class="diplayer-loading-dot diplayer-loading-dot-6" cx="4" cy="4" r="2"></circle></svg><svg x="3" y="3"><circle class="diplayer-loading-dot diplayer-loading-dot-7" cx="4" cy="4" r="2"></circle></svg></svg>'},function(I,M,i){var A=i(14);I.exports=function(u){u=u||{};var r="",P=function(L){return r+=L},O=u.video,x=u.options,m=A.$escape,c=u.tran,v=u.icons,h=u.index,T=A.$each;return u.$value,u.$index,r+=`<div class="dplayer-mask"></div>
<div class="dplayer-video-wrap">
    `,P(i(1)(O)),r+=`
    `,x.logo&&(r+=`
    <div class="dplayer-logo">
        <img src="`,r+=m(x.logo),r+=`">
    </div>
    `),r+=`
    <div class="dplayer-danmaku"`,x.danmaku&&x.danmaku.bottm&&(r+=' style="margin-bottom:',r+=m(x.danmaku.bottm),r+='"'),r+=`>
        <div class="dplayer-danmaku-item dplayer-danmaku-item--demo"></div>
    </div>
    <div class="dplayer-subtitle"></div>
    <div class="dplayer-bezel">
        <span class="dplayer-bezel-icon"></span>
        `,x.danmaku&&(r+=`
        <span class="dplayer-danloading">`,r+=m(c("Danmaku is loading")),r+=`</span>
        `),r+=`
        <span class="diplayer-loading-icon">`,r+=v.loading,r+=`</span>
    </div>
</div>
<div class="dplayer-controller-mask"></div>
<div class="dplayer-controller">
    <div class="dplayer-icons dplayer-comment-box">
        <button class="dplayer-icon dplayer-comment-setting-icon" data-balloon="`,r+=m(c("Setting")),r+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,r+=v.pallette,r+=`</span>
        </button>
        <div class="dplayer-comment-setting-box">
            <div class="dplayer-comment-setting-color">
                <div class="dplayer-comment-setting-title">`,r+=m(c("Set danmaku color")),r+=`</div>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,r+=m(h),r+=`" value="#fff" checked>
                    <span style="background: #fff;"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,r+=m(h),r+=`" value="#e54256">
                    <span style="background: #e54256"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,r+=m(h),r+=`" value="#ffe133">
                    <span style="background: #ffe133"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,r+=m(h),r+=`" value="#64DD17">
                    <span style="background: #64DD17"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,r+=m(h),r+=`" value="#39ccff">
                    <span style="background: #39ccff"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,r+=m(h),r+=`" value="#D500F9">
                    <span style="background: #D500F9"></span>
                </label>
            </div>
            <div class="dplayer-comment-setting-type">
                <div class="dplayer-comment-setting-title">`,r+=m(c("Set danmaku type")),r+=`</div>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,r+=m(h),r+=`" value="1">
                    <span>`,r+=m(c("Top")),r+=`</span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,r+=m(h),r+=`" value="0" checked>
                    <span>`,r+=m(c("Rolling")),r+=`</span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,r+=m(h),r+=`" value="2">
                    <span>`,r+=m(c("Bottom")),r+=`</span>
                </label>
            </div>
        </div>
        <input class="dplayer-comment-input" type="text" placeholder="`,r+=m(c("Input danmaku, hit Enter")),r+=`" maxlength="30">
        <button class="dplayer-icon dplayer-send-icon" data-balloon="`,r+=m(c("Send")),r+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,r+=v.send,r+=`</span>
        </button>
    </div>
    <div class="dplayer-icons dplayer-icons-left">
        <button class="dplayer-icon dplayer-play-icon">
            <span class="dplayer-icon-content">`,r+=v.play,r+=`</span>
        </button>
        <div class="dplayer-volume">
            <button class="dplayer-icon dplayer-volume-icon">
                <span class="dplayer-icon-content">`,r+=v.volumeDown,r+=`</span>
            </button>
            <div class="dplayer-volume-bar-wrap" data-balloon-pos="up">
                <div class="dplayer-volume-bar">
                    <div class="dplayer-volume-bar-inner" style="background: `,r+=m(x.theme),r+=`;">
                        <span class="dplayer-thumb" style="background: `,r+=m(x.theme),r+=`"></span>
                    </div>
                </div>
            </div>
        </div>
        <span class="dplayer-time">
            <span class="dplayer-ptime">0:00</span> /
            <span class="dplayer-dtime">0:00</span>
        </span>
        `,x.live&&(r+=`
        <span class="dplayer-live-badge"><span class="dplayer-live-dot" style="background: `,r+=m(x.theme),r+=';"></span>',r+=m(c("Live")),r+=`</span>
        `),r+=`
    </div>
    <div class="dplayer-icons dplayer-icons-right">
        `,x.video.quality&&(r+=`
        <div class="dplayer-quality">
            <button class="dplayer-icon dplayer-quality-icon">`,r+=m(x.video.quality[x.video.defaultQuality].name),r+=`</button>
            <div class="dplayer-quality-mask">
                <div class="dplayer-quality-list">
                `,T(x.video.quality,function(L,g){r+=`
                    <div class="dplayer-quality-item" data-index="`,r+=m(g),r+='">',r+=m(L.name),r+=`</div>
                `}),r+=`
                </div>
            </div>
        </div>
        `),r+=`
        `,x.screenshot&&(r+=`
        <div class="dplayer-icon dplayer-camera-icon" data-balloon="`,r+=m(c("Screenshot")),r+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,r+=v.camera,r+=`</span>
        </div>
        `),r+=`
        `,x.airplay&&(r+=`
        <div class="dplayer-icon dplayer-airplay-icon" data-balloon="`,r+=m(c("AirPlay")),r+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,r+=v.airplay,r+=`</span>
        </div>
        `),r+=`
        <div class="dplayer-comment">
            <button class="dplayer-icon dplayer-comment-icon" data-balloon="`,r+=m(c("Send danmaku")),r+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,r+=v.comment,r+=`</span>
            </button>
        </div>
        `,x.subtitle&&(r+=`
        <div class="dplayer-subtitle-btn">
            <button class="dplayer-icon dplayer-subtitle-icon" data-balloon="`,r+=m(c("Hide subtitle")),r+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,r+=v.subtitle,r+=`</span>
            </button>
        </div>
        `),r+=`
        <div class="dplayer-setting">
            <button class="dplayer-icon dplayer-setting-icon" data-balloon="`,r+=m(c("Setting")),r+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,r+=v.setting,r+=`</span>
            </button>
            <div class="dplayer-setting-box">
                <div class="dplayer-setting-origin-panel">
                    <div class="dplayer-setting-item dplayer-setting-speed">
                        <span class="dplayer-label">`,r+=m(c("Speed")),r+=`</span>
                        <div class="dplayer-toggle">`,r+=v.right,r+=`</div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-loop">
                        <span class="dplayer-label">`,r+=m(c("Loop")),r+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-toggle-setting-input" type="checkbox" name="dplayer-toggle">
                            <label for="dplayer-toggle"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-showdan">
                        <span class="dplayer-label">`,r+=m(c("Show danmaku")),r+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-showdan-setting-input" type="checkbox" name="dplayer-toggle-dan">
                            <label for="dplayer-toggle-dan"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-danunlimit">
                        <span class="dplayer-label">`,r+=m(c("Unlimited danmaku")),r+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-danunlimit-setting-input" type="checkbox" name="dplayer-toggle-danunlimit">
                            <label for="dplayer-toggle-danunlimit"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-danmaku">
                        <span class="dplayer-label">`,r+=m(c("Opacity for danmaku")),r+=`</span>
                        <div class="dplayer-danmaku-bar-wrap">
                            <div class="dplayer-danmaku-bar">
                                <div class="dplayer-danmaku-bar-inner">
                                    <span class="dplayer-thumb"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="dplayer-setting-speed-panel">
                    `,T(x.playbackSpeed,function(L,g){r+=`
                        <div class="dplayer-setting-speed-item" data-speed="`,r+=m(L),r+=`">
                            <span class="dplayer-label">`,r+=m(L===1?c("Normal"):L),r+=`</span>
                        </div>
                    `}),r+=`
                </div>
            </div>
        </div>
        <div class="dplayer-full">
            <button class="dplayer-icon dplayer-full-in-icon" data-balloon="`,r+=m(c("Web full screen")),r+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,r+=v.fullWeb,r+=`</span>
            </button>
            <button class="dplayer-icon dplayer-full-icon" data-balloon="`,r+=m(c("Full screen")),r+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,r+=v.full,r+=`</span>
            </button>
        </div>
    </div>
    <div class="dplayer-bar-wrap">
        <div class="dplayer-bar-time hidden">00:00</div>
        <div class="dplayer-bar-preview"></div>
        <div class="dplayer-bar">
            <div class="dplayer-loaded" style="width: 0;"></div>
            <div class="dplayer-played" style="width: 0; background: `,r+=m(x.theme),r+=`">
                <span class="dplayer-thumb" style="background: `,r+=m(x.theme),r+=`"></span>
            </div>
        </div>
    </div>
</div>
<div class="dplayer-info-panel dplayer-info-panel-hide">
    <div class="dplayer-info-panel-close">[x]</div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-version">
        <span class="dplayer-info-panel-item-title">Player version</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-fps">
        <span class="dplayer-info-panel-item-title">Player FPS</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-type">
        <span class="dplayer-info-panel-item-title">Video type</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-url">
        <span class="dplayer-info-panel-item-title">Video url</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-resolution">
        <span class="dplayer-info-panel-item-title">Video resolution</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-duration">
        <span class="dplayer-info-panel-item-title">Video duration</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    `,x.danmaku&&(r+=`
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-id">
        <span class="dplayer-info-panel-item-title">Danmaku id</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-api">
        <span class="dplayer-info-panel-item-title">Danmaku api</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-amount">
        <span class="dplayer-info-panel-item-title">Danmaku amount</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    `),r+=`
</div>
<div class="dplayer-menu">
    `,T(x.contextmenu,function(L,g){r+=`
        <div class="dplayer-menu-item">
            <a`,L.link&&(r+=' target="_blank"'),r+=' href="',r+=m(L.link||"javascript:void(0);"),r+='">',r+=m(c(L.text)),r+=`</a>
        </div>
    `}),r+=`
</div>
<div class="dplayer-notice"></div>
<button class="dplayer-mobile-play">
    `,r+=v.play,r+=`
</button>`}},function(I,M,i){var A=i(36),u=i(37);typeof(u=u.__esModule?u.default:u)=="string"&&(u=[[I.i,u,""]]);var r={insert:"head",singleton:!1};A(u,r),I.exports=u.locals||{}},function(I,M,i){var A,u=function(){return A===void 0&&(A=Boolean(window&&document&&document.all&&!window.atob)),A},r=function(){var t={};return function(a){if(t[a]===void 0){var n=document.querySelector(a);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch{n=null}t[a]=n}return t[a]}}(),P=[];function O(t){for(var a=-1,n=0;n<P.length;n++)if(P[n].identifier===t){a=n;break}return a}function x(t,a){for(var n={},d=[],l=0;l<t.length;l++){var s=t[l],f=a.base?s[0]+a.base:s[0],C=n[f]||0,D="".concat(f," ").concat(C);n[f]=C+1;var E=O(D),p={css:s[1],media:s[2],sourceMap:s[3]};E!==-1?(P[E].references++,P[E].updater(p)):P.push({identifier:D,updater:o(p,a),references:1}),d.push(D)}return d}function m(t){var a=document.createElement("style"),n=t.attributes||{};if(n.nonce===void 0){var d=i.nc;d&&(n.nonce=d)}if(Object.keys(n).forEach(function(s){a.setAttribute(s,n[s])}),typeof t.insert=="function")t.insert(a);else{var l=r(t.insert||"head");if(!l)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");l.appendChild(a)}return a}var c,v=(c=[],function(t,a){return c[t]=a,c.filter(Boolean).join(`
`)});function h(t,a,n,d){var l=n?"":d.media?"@media ".concat(d.media," {").concat(d.css,"}"):d.css;if(t.styleSheet)t.styleSheet.cssText=v(a,l);else{var s=document.createTextNode(l),f=t.childNodes;f[a]&&t.removeChild(f[a]),f.length?t.insertBefore(s,f[a]):t.appendChild(s)}}function T(t,a,n){var d=n.css,l=n.media,s=n.sourceMap;if(l?t.setAttribute("media",l):t.removeAttribute("media"),s&&btoa&&(d+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleSheet)t.styleSheet.cssText=d;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(d))}}var L=null,g=0;function o(t,a){var n,d,l;if(a.singleton){var s=g++;n=L||(L=m(a)),d=h.bind(null,n,s,!1),l=h.bind(null,n,s,!0)}else n=m(a),d=T.bind(null,n,a),l=function(){(function(f){if(f.parentNode===null)return!1;f.parentNode.removeChild(f)})(n)};return d(t),function(f){if(f){if(f.css===t.css&&f.media===t.media&&f.sourceMap===t.sourceMap)return;d(t=f)}else l()}}I.exports=function(t,a){(a=a||{}).singleton||typeof a.singleton=="boolean"||(a.singleton=u());var n=x(t=t||[],a);return function(d){if(d=d||[],Object.prototype.toString.call(d)==="[object Array]"){for(var l=0;l<n.length;l++){var s=O(n[l]);P[s].references--}for(var f=x(d,a),C=0;C<n.length;C++){var D=O(n[C]);P[D].references===0&&(P[D].updater(),P.splice(D,1))}n=f}}}},function(I,M,i){var A=i(3),u=i(38);(M=A(!1)).i(u),M.push([I.i,'@-webkit-keyframes my-face{2%{transform:translateY(1.5px) rotate(1.5deg)}4%{transform:translateY(-1.5px) rotate(-.5deg)}6%{transform:translateY(1.5px) rotate(-1.5deg)}8%{transform:translateY(-1.5px) rotate(-1.5deg)}10%{transform:translateY(2.5px) rotate(1.5deg)}12%{transform:translateY(-.5px) rotate(1.5deg)}14%{transform:translateY(-1.5px) rotate(1.5deg)}16%{transform:translateY(-.5px) rotate(-1.5deg)}18%{transform:translateY(.5px) rotate(-1.5deg)}20%{transform:translateY(-1.5px) rotate(2.5deg)}22%{transform:translateY(.5px) rotate(-1.5deg)}24%{transform:translateY(1.5px) rotate(1.5deg)}26%{transform:translateY(.5px) rotate(.5deg)}28%{transform:translateY(.5px) rotate(1.5deg)}30%{transform:translateY(-.5px) rotate(2.5deg)}32%{transform:translateY(1.5px) rotate(-.5deg)}34%{transform:translateY(1.5px) rotate(-.5deg)}36%{transform:translateY(-1.5px) rotate(2.5deg)}38%{transform:translateY(1.5px) rotate(-1.5deg)}40%{transform:translateY(-.5px) rotate(2.5deg)}42%{transform:translateY(2.5px) rotate(-1.5deg)}44%{transform:translateY(1.5px) rotate(.5deg)}46%{transform:translateY(-1.5px) rotate(2.5deg)}48%{transform:translateY(-.5px) rotate(.5deg)}50%{transform:translateY(.5px) rotate(.5deg)}52%{transform:translateY(2.5px) rotate(2.5deg)}54%{transform:translateY(-1.5px) rotate(1.5deg)}56%{transform:translateY(2.5px) rotate(2.5deg)}58%{transform:translateY(.5px) rotate(2.5deg)}60%{transform:translateY(2.5px) rotate(2.5deg)}62%{transform:translateY(-.5px) rotate(2.5deg)}64%{transform:translateY(-.5px) rotate(1.5deg)}66%{transform:translateY(1.5px) rotate(-.5deg)}68%{transform:translateY(-1.5px) rotate(-.5deg)}70%{transform:translateY(1.5px) rotate(.5deg)}72%{transform:translateY(2.5px) rotate(1.5deg)}74%{transform:translateY(-.5px) rotate(.5deg)}76%{transform:translateY(-.5px) rotate(2.5deg)}78%{transform:translateY(-.5px) rotate(1.5deg)}80%{transform:translateY(1.5px) rotate(1.5deg)}82%{transform:translateY(-.5px) rotate(.5deg)}84%{transform:translateY(1.5px) rotate(2.5deg)}86%{transform:translateY(-1.5px) rotate(-1.5deg)}88%{transform:translateY(-.5px) rotate(2.5deg)}90%{transform:translateY(2.5px) rotate(-.5deg)}92%{transform:translateY(.5px) rotate(-.5deg)}94%{transform:translateY(2.5px) rotate(.5deg)}96%{transform:translateY(-.5px) rotate(1.5deg)}98%{transform:translateY(-1.5px) rotate(-.5deg)}0%,to{transform:translate(0) rotate(0deg)}}@keyframes my-face{2%{transform:translateY(1.5px) rotate(1.5deg)}4%{transform:translateY(-1.5px) rotate(-.5deg)}6%{transform:translateY(1.5px) rotate(-1.5deg)}8%{transform:translateY(-1.5px) rotate(-1.5deg)}10%{transform:translateY(2.5px) rotate(1.5deg)}12%{transform:translateY(-.5px) rotate(1.5deg)}14%{transform:translateY(-1.5px) rotate(1.5deg)}16%{transform:translateY(-.5px) rotate(-1.5deg)}18%{transform:translateY(.5px) rotate(-1.5deg)}20%{transform:translateY(-1.5px) rotate(2.5deg)}22%{transform:translateY(.5px) rotate(-1.5deg)}24%{transform:translateY(1.5px) rotate(1.5deg)}26%{transform:translateY(.5px) rotate(.5deg)}28%{transform:translateY(.5px) rotate(1.5deg)}30%{transform:translateY(-.5px) rotate(2.5deg)}32%{transform:translateY(1.5px) rotate(-.5deg)}34%{transform:translateY(1.5px) rotate(-.5deg)}36%{transform:translateY(-1.5px) rotate(2.5deg)}38%{transform:translateY(1.5px) rotate(-1.5deg)}40%{transform:translateY(-.5px) rotate(2.5deg)}42%{transform:translateY(2.5px) rotate(-1.5deg)}44%{transform:translateY(1.5px) rotate(.5deg)}46%{transform:translateY(-1.5px) rotate(2.5deg)}48%{transform:translateY(-.5px) rotate(.5deg)}50%{transform:translateY(.5px) rotate(.5deg)}52%{transform:translateY(2.5px) rotate(2.5deg)}54%{transform:translateY(-1.5px) rotate(1.5deg)}56%{transform:translateY(2.5px) rotate(2.5deg)}58%{transform:translateY(.5px) rotate(2.5deg)}60%{transform:translateY(2.5px) rotate(2.5deg)}62%{transform:translateY(-.5px) rotate(2.5deg)}64%{transform:translateY(-.5px) rotate(1.5deg)}66%{transform:translateY(1.5px) rotate(-.5deg)}68%{transform:translateY(-1.5px) rotate(-.5deg)}70%{transform:translateY(1.5px) rotate(.5deg)}72%{transform:translateY(2.5px) rotate(1.5deg)}74%{transform:translateY(-.5px) rotate(.5deg)}76%{transform:translateY(-.5px) rotate(2.5deg)}78%{transform:translateY(-.5px) rotate(1.5deg)}80%{transform:translateY(1.5px) rotate(1.5deg)}82%{transform:translateY(-.5px) rotate(.5deg)}84%{transform:translateY(1.5px) rotate(2.5deg)}86%{transform:translateY(-1.5px) rotate(-1.5deg)}88%{transform:translateY(-.5px) rotate(2.5deg)}90%{transform:translateY(2.5px) rotate(-.5deg)}92%{transform:translateY(.5px) rotate(-.5deg)}94%{transform:translateY(2.5px) rotate(.5deg)}96%{transform:translateY(-.5px) rotate(1.5deg)}98%{transform:translateY(-1.5px) rotate(-.5deg)}0%,to{transform:translate(0) rotate(0deg)}}.dplayer{position:relative;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;line-height:1}.dplayer *{box-sizing:content-box}.dplayer svg{width:100%;height:100%}.dplayer svg circle,.dplayer svg path{fill:#fff}.dplayer:-webkit-full-screen{width:100%;height:100%;background:#000;position:fixed;z-index:100000;left:0;top:0;margin:0;padding:0;transform:translate(0)}.dplayer:-webkit-full-screen .dplayer-danmaku .dplayer-danmaku-bottom.dplayer-danmaku-move,.dplayer:-webkit-full-screen .dplayer-danmaku .dplayer-danmaku-top.dplayer-danmaku-move{-webkit-animation:danmaku-center 6s linear;animation:danmaku-center 6s linear;-webkit-animation-play-state:inherit;animation-play-state:inherit}.dplayer:-webkit-full-screen .dplayer-danmaku .dplayer-danmaku-right.dplayer-danmaku-move{-webkit-animation:danmaku 8s linear;animation:danmaku 8s linear;-webkit-animation-play-state:inherit;animation-play-state:inherit}.dplayer.dplayer-live .dplayer-bar-wrap,.dplayer.dplayer-live.dplayer-no-danmaku .dplayer-setting,.dplayer.dplayer-live .dplayer-setting-loop,.dplayer.dplayer-live .dplayer-setting-speed,.dplayer.dplayer-live .dplayer-time,.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-comment,.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danmaku,.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danunlimit,.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-showdan,.dplayer.dplayer-no-danmaku .dplayer-danmaku{display:none}.dplayer.dplayer-arrow .dplayer-danmaku{font-size:18px}.dplayer.dplayer-arrow .dplayer-icon{margin:0 -3px}.dplayer.dplayer-playing .dplayer-danmaku .dplayer-danmaku-move{-webkit-animation-play-state:running;animation-play-state:running}@media (min-width:900px){.dplayer.dplayer-playing .dplayer-controller,.dplayer.dplayer-playing .dplayer-controller-mask{opacity:0}.dplayer.dplayer-playing:hover .dplayer-controller,.dplayer.dplayer-playing:hover .dplayer-controller-mask{opacity:1}}.dplayer.dplayer-loading .dplayer-bezel .diplayer-loading-icon{display:block}.dplayer.dplayer-loading .dplayer-danmaku,.dplayer.dplayer-loading .dplayer-danmaku-move,.dplayer.dplayer-paused .dplayer-danmaku,.dplayer.dplayer-paused .dplayer-danmaku-move{-webkit-animation-play-state:paused;animation-play-state:paused}.dplayer.dplayer-hide-controller{cursor:none}.dplayer.dplayer-hide-controller .dplayer-controller,.dplayer.dplayer-hide-controller .dplayer-controller-mask{opacity:0;transform:translateY(100%)}.dplayer.dplayer-show-controller .dplayer-controller,.dplayer.dplayer-show-controller .dplayer-controller-mask{opacity:1}.dplayer.dplayer-fulled{position:fixed;z-index:100000;left:0;top:0;width:100%!important;height:100%!important}.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-airplay-icon,.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-camera-icon,.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-play-icon,.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-volume{display:none}.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon{position:static;display:inline-block}.dplayer.dplayer-mobile .dplayer-bar-time,.dplayer.dplayer-mobile.dplayer-hide-controller .dplayer-mobile-play{display:none}.dplayer.dplayer-mobile .dplayer-mobile-play{display:block}.dplayer-web-fullscreen-fix{position:fixed;top:0;left:0;margin:0;padding:0}[data-balloon]:before{display:none}[data-balloon]:after{padding:.3em .7em;background:rgba(17,17,17,.7)}[data-balloon][data-balloon-pos=up]:after{margin-bottom:0}.dplayer-bezel{position:absolute;left:0;right:0;top:0;bottom:0;font-size:22px;color:#fff;pointer-events:none}.dplayer-bezel .dplayer-bezel-icon{position:absolute;top:50%;left:50%;margin:-26px 0 0 -26px;height:52px;width:52px;padding:12px;box-sizing:border-box;background:rgba(0,0,0,.5);border-radius:50%;opacity:0;pointer-events:none}.dplayer-bezel .dplayer-bezel-icon.dplayer-bezel-transition{-webkit-animation:bezel-hide .5s linear;animation:bezel-hide .5s linear}@-webkit-keyframes bezel-hide{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(2)}}@keyframes bezel-hide{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(2)}}.dplayer-bezel .dplayer-danloading{position:absolute;top:50%;margin-top:-7px;width:100%;text-align:center;font-size:14px;line-height:14px;-webkit-animation:my-face 5s ease-in-out infinite;animation:my-face 5s ease-in-out infinite}.dplayer-bezel .diplayer-loading-icon{display:none;position:absolute;top:50%;left:50%;margin:-18px 0 0 -18px;height:36px;width:36px;pointer-events:none}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-hide{display:none}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot{-webkit-animation:diplayer-loading-dot-fade .8s ease infinite;animation:diplayer-loading-dot-fade .8s ease infinite;opacity:0;transform-origin:4px 4px}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-7{-webkit-animation-delay:.7s;animation-delay:.7s}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-6{-webkit-animation-delay:.6s;animation-delay:.6s}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-5{-webkit-animation-delay:.5s;animation-delay:.5s}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-4{-webkit-animation-delay:.4s;animation-delay:.4s}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-3{-webkit-animation-delay:.3s;animation-delay:.3s}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-2{-webkit-animation-delay:.2s;animation-delay:.2s}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-1{-webkit-animation-delay:.1s;animation-delay:.1s}@-webkit-keyframes diplayer-loading-dot-fade{0%{opacity:.7;transform:scale(1.2)}50%{opacity:.25;transform:scale(.9)}to{opacity:.25;transform:scale(.85)}}@keyframes diplayer-loading-dot-fade{0%{opacity:.7;transform:scale(1.2)}50%{opacity:.25;transform:scale(.9)}to{opacity:.25;transform:scale(.85)}}.dplayer-controller-mask{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg==) repeat-x bottom;height:98px;width:100%}.dplayer-controller,.dplayer-controller-mask{position:absolute;bottom:0;transition:all .3s ease}.dplayer-controller{left:0;right:0;height:41px;padding:0 20px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.dplayer-controller.dplayer-controller-comment .dplayer-icons{display:none}.dplayer-controller.dplayer-controller-comment .dplayer-icons.dplayer-comment-box{display:block}.dplayer-controller .dplayer-bar-wrap{padding:5px 0;cursor:pointer;position:absolute;bottom:33px;width:calc(100% - 40px);height:3px}.dplayer-controller .dplayer-bar-wrap:hover .dplayer-bar .dplayer-played .dplayer-thumb{transform:scale(1)}.dplayer-controller .dplayer-bar-wrap:hover .dplayer-highlight{display:block;width:8px;transform:translateX(-4px);top:4px;height:40%}.dplayer-controller .dplayer-bar-wrap .dplayer-highlight{z-index:12;position:absolute;top:5px;width:6px;height:20%;border-radius:6px;background-color:#fff;text-align:center;transform:translateX(-3px);transition:all .2s ease-in-out}.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover .dplayer-highlight-text{display:block}.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover~.dplayer-bar-preview,.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover~.dplayer-bar-time{opacity:0}.dplayer-controller .dplayer-bar-wrap .dplayer-highlight .dplayer-highlight-text{display:none;position:absolute;left:50%;top:-24px;padding:5px 8px;background-color:rgba(0,0,0,.62);color:#fff;border-radius:4px;font-size:12px;white-space:nowrap;transform:translateX(-50%)}.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview{position:absolute;background:#fff;pointer-events:none;display:none;background-size:16000px 100%}.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview-canvas{position:absolute;width:100%;height:100%;z-index:1;pointer-events:none}.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time{position:absolute;left:0;top:-20px;border-radius:4px;padding:5px 7px;background-color:rgba(0,0,0,.62);color:#fff;font-size:12px;text-align:center;opacity:1;transition:opacity .1s ease-in-out;word-wrap:normal;word-break:normal;z-index:2;pointer-events:none}.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time.hidden{opacity:0}.dplayer-controller .dplayer-bar-wrap .dplayer-bar{position:relative;height:3px;width:100%;background:hsla(0,0%,100%,.2);cursor:pointer}.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-loaded{background:hsla(0,0%,100%,.4);transition:all .5s ease}.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-loaded,.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played{position:absolute;left:0;top:0;bottom:0;height:3px;will-change:width}.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played .dplayer-thumb{position:absolute;top:0;right:5px;margin-top:-4px;margin-right:-10px;height:11px;width:11px;border-radius:50%;cursor:pointer;transition:all .3s ease-in-out;transform:scale(0)}.dplayer-controller .dplayer-icons{height:38px;position:absolute;bottom:0}.dplayer-controller .dplayer-icons.dplayer-comment-box{display:none;position:absolute;transition:all .3s ease-in-out;z-index:2;height:38px;bottom:0;left:20px;right:20px;color:#fff}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-icon{padding:7px}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-icon{position:absolute;left:0;top:0}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-send-icon{position:absolute;right:0;top:0}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box{position:absolute;background:rgba(28,28,28,.9);bottom:41px;left:0;box-shadow:0 0 25px rgba(0,0,0,.3);border-radius:4px;padding:10px 10px 16px;font-size:14px;width:204px;transition:all .3s ease-in-out;transform:scale(0)}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box.dplayer-comment-setting-open{transform:scale(1)}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box input[type=radio]{display:none}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box label{cursor:pointer}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-title{font-size:13px;color:#fff;line-height:30px}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type{font-size:0}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type .dplayer-comment-setting-title{margin-bottom:6px}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(2) span{border-radius:4px 0 0 4px}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(4) span{border-radius:0 4px 4px 0}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type span{width:33%;padding:4px 6px;line-height:16px;display:inline-block;font-size:12px;color:#fff;border:1px solid #fff;margin-right:-1px;box-sizing:border-box;text-align:center;cursor:pointer}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type input:checked+span{background:#e4e4e6;color:#1c1c1c}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color{font-size:0}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color label{font-size:0;padding:6px;display:inline-block}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span{width:22px;height:22px;display:inline-block;border-radius:50%;box-sizing:border-box;cursor:pointer}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span:hover{-webkit-animation:my-face 5s ease-in-out infinite;animation:my-face 5s ease-in-out infinite}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input{outline:none;border:none;padding:8px 31px;font-size:14px;line-height:18px;text-align:center;border-radius:4px;background:none;margin:0;height:100%;box-sizing:border-box;width:100%;color:#fff}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-webkit-input-placeholder{color:#fff;opacity:.8}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-moz-placeholder{color:#fff;opacity:.8}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input:-ms-input-placeholder{color:#fff;opacity:.8}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-ms-input-placeholder{color:#fff;opacity:.8}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::placeholder{color:#fff;opacity:.8}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-ms-clear{display:none}.dplayer-controller .dplayer-icons.dplayer-icons-left .dplayer-icon{padding:7px}.dplayer-controller .dplayer-icons.dplayer-icons-right{right:20px}.dplayer-controller .dplayer-icons.dplayer-icons-right .dplayer-icon{padding:8px}.dplayer-controller .dplayer-icons .dplayer-live-badge,.dplayer-controller .dplayer-icons .dplayer-time{line-height:38px;color:#eee;text-shadow:0 0 2px rgba(0,0,0,.5);vertical-align:middle;font-size:13px;cursor:default}.dplayer-controller .dplayer-icons .dplayer-live-dot{display:inline-block;width:6px;height:6px;vertical-align:4%;margin-right:5px;content:"";border-radius:6px}.dplayer-controller .dplayer-icons .dplayer-icon{width:40px;height:100%;border:none;background-color:transparent;outline:none;cursor:pointer;vertical-align:middle;box-sizing:border-box;display:inline-block}.dplayer-controller .dplayer-icons .dplayer-icon .dplayer-icon-content{transition:all .2s ease-in-out;opacity:.8}.dplayer-controller .dplayer-icons .dplayer-icon:hover .dplayer-icon-content{opacity:1}.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-quality-icon{color:#fff;width:auto;line-height:22px;font-size:14px}.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-comment-icon{padding:10px 9px 9px}.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-setting-icon{padding-top:8.5px}.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-volume-icon{width:43px}.dplayer-controller .dplayer-icons .dplayer-volume{position:relative;display:inline-block;cursor:pointer;height:100%}.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar{width:45px}.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb{transform:scale(1)}.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar{width:45px}.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb{transform:scale(1)}.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap{display:inline-block;margin:0 10px 0 -5px;vertical-align:middle;height:100%}.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar{position:relative;top:17px;width:0;height:3px;background:#aaa;transition:all .3s ease-in-out}.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner{position:absolute;bottom:0;left:0;height:100%;transition:all .1s ease;will-change:width}.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb{position:absolute;top:0;right:5px;margin-top:-4px;margin-right:-10px;height:11px;width:11px;border-radius:50%;cursor:pointer;transition:all .3s ease-in-out;transform:scale(0)}.dplayer-controller .dplayer-icons .dplayer-setting,.dplayer-controller .dplayer-icons .dplayer-subtitle-btn{display:inline-block;height:100%}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box{position:absolute;right:0;bottom:50px;transform:scale(0);width:150px;border-radius:2px;background:rgba(28,28,28,.9);padding:7px 0;transition:all .3s ease-in-out;overflow:hidden;z-index:2}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box>div{display:none}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box>div.dplayer-setting-origin-panel{display:block}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-open{transform:scale(1)}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-narrow{width:70px;text-align:center}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-origin-panel{display:none}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-speed-panel{display:block}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item,.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item{height:30px;padding:5px 10px;box-sizing:border-box;cursor:pointer;position:relative}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item:hover,.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item:hover{background-color:hsla(0,0%,100%,.1)}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku{padding:5px 0}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-label{padding:0 10px;display:inline}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-label{display:none}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-danmaku-bar-wrap{display:inline-block}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-label{display:none}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-danmaku-bar-wrap{display:inline-block}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap{padding:0 10px;box-sizing:border-box;display:none;vertical-align:middle;height:100%;width:100%}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar{position:relative;top:8.5px;width:100%;height:3px;background:#fff;transition:all .3s ease-in-out}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner{position:absolute;bottom:0;left:0;height:100%;transition:all .1s ease;background:#aaa;will-change:width}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner .dplayer-thumb{position:absolute;top:0;right:5px;margin-top:-4px;margin-right:-10px;height:11px;width:11px;border-radius:50%;cursor:pointer;transition:all .3s ease-in-out;background:#aaa}.dplayer-controller .dplayer-icons .dplayer-full{display:inline-block;height:100%;position:relative}.dplayer-controller .dplayer-icons .dplayer-full:hover .dplayer-full-in-icon{display:block}.dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon{position:absolute;top:-30px;z-index:1;display:none}.dplayer-controller .dplayer-icons .dplayer-quality{position:relative;display:inline-block;height:100%;z-index:2}.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-list,.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-mask{display:block}.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-mask{display:none;position:absolute;bottom:38px;left:-18px;width:80px;padding-bottom:12px}.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-list{display:none;font-size:12px;width:80px;border-radius:2px;background:rgba(28,28,28,.9);padding:5px 0;transition:all .3s ease-in-out;overflow:hidden;color:#fff;text-align:center}.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item{height:25px;box-sizing:border-box;cursor:pointer;line-height:25px}.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item:hover{background-color:hsla(0,0%,100%,.1)}.dplayer-controller .dplayer-icons .dplayer-comment{display:inline-block;height:100%}.dplayer-controller .dplayer-icons .dplayer-label{color:#eee;font-size:13px;display:inline-block;vertical-align:middle;white-space:nowrap}.dplayer-controller .dplayer-icons .dplayer-toggle{width:32px;height:20px;text-align:center;font-size:0;vertical-align:middle;position:absolute;top:5px;right:10px}.dplayer-controller .dplayer-icons .dplayer-toggle input{max-height:0;max-width:0;display:none}.dplayer-controller .dplayer-icons .dplayer-toggle input+label{display:inline-block;position:relative;box-shadow:inset 0 0 0 0 #dfdfdf;border:1px solid #dfdfdf;height:20px;width:32px;border-radius:10px;box-sizing:border-box;cursor:pointer;transition:.2s ease-in-out}.dplayer-controller .dplayer-icons .dplayer-toggle input+label:after,.dplayer-controller .dplayer-icons .dplayer-toggle input+label:before{content:"";position:absolute;display:block;height:18px;width:18px;top:0;left:0;border-radius:15px;transition:.2s ease-in-out}.dplayer-controller .dplayer-icons .dplayer-toggle input+label:after{background:#fff;box-shadow:0 1px 3px rgba(0,0,0,.4)}.dplayer-controller .dplayer-icons .dplayer-toggle input:checked+label{border-color:hsla(0,0%,100%,.5)}.dplayer-controller .dplayer-icons .dplayer-toggle input:checked+label:before{width:30px;background:hsla(0,0%,100%,.5)}.dplayer-controller .dplayer-icons .dplayer-toggle input:checked+label:after{left:12px}.dplayer-mobile-play{display:none;width:50px;height:50px;border:none;background-color:transparent;outline:none;cursor:pointer;box-sizing:border-box;bottom:0;opacity:.8;position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}.dplayer-danmaku{position:absolute;left:0;right:0;top:0;bottom:0;font-size:22px;color:#fff}.dplayer-danmaku .dplayer-danmaku-item{display:inline-block;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default;white-space:nowrap;text-shadow:.5px .5px .5px rgba(0,0,0,.5)}.dplayer-danmaku .dplayer-danmaku-item--demo{position:absolute;visibility:hidden}.dplayer-danmaku .dplayer-danmaku-right{position:absolute;right:0;transform:translateX(100%)}.dplayer-danmaku .dplayer-danmaku-right.dplayer-danmaku-move{will-change:transform;-webkit-animation:danmaku 5s linear;animation:danmaku 5s linear;-webkit-animation-play-state:paused;animation-play-state:paused}@-webkit-keyframes danmaku{0%{transform:translateX(100%)}}@keyframes danmaku{0%{transform:translateX(100%)}}.dplayer-danmaku .dplayer-danmaku-bottom,.dplayer-danmaku .dplayer-danmaku-top{position:absolute;width:100%;text-align:center;visibility:hidden}.dplayer-danmaku .dplayer-danmaku-bottom.dplayer-danmaku-move,.dplayer-danmaku .dplayer-danmaku-top.dplayer-danmaku-move{will-change:visibility;-webkit-animation:danmaku-center 4s linear;animation:danmaku-center 4s linear;-webkit-animation-play-state:paused;animation-play-state:paused}@-webkit-keyframes danmaku-center{0%{visibility:visible}to{visibility:visible}}@keyframes danmaku-center{0%{visibility:visible}to{visibility:visible}}.dplayer-logo{pointer-events:none;position:absolute;left:20px;top:20px;max-width:50px;max-height:50px}.dplayer-logo img{max-width:100%;max-height:100%;background:none}.dplayer-menu{position:absolute;width:170px;border-radius:2px;background:rgba(28,28,28,.85);padding:5px 0;overflow:hidden;z-index:3;display:none}.dplayer-menu.dplayer-menu-show{display:block}.dplayer-menu .dplayer-menu-item{height:30px;box-sizing:border-box;cursor:pointer}.dplayer-menu .dplayer-menu-item:hover{background-color:hsla(0,0%,100%,.1)}.dplayer-menu .dplayer-menu-item a{padding:0 10px;line-height:30px;color:#eee;font-size:13px;display:inline-block;vertical-align:middle;width:100%;box-sizing:border-box;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.dplayer-menu .dplayer-menu-item a:hover{text-decoration:none}.dplayer-notice{opacity:0;position:absolute;bottom:60px;left:20px;font-size:14px;border-radius:2px;background:rgba(28,28,28,.9);padding:7px 20px;transition:all .3s ease-in-out;overflow:hidden;color:#fff;pointer-events:none}.dplayer-subtitle{position:absolute;bottom:40px;width:90%;left:5%;text-align:center;color:#fff;text-shadow:.5px .5px .5px rgba(0,0,0,.5);font-size:20px}.dplayer-subtitle.dplayer-subtitle-hide{display:none}.dplayer-mask{position:absolute;top:0;bottom:0;left:0;right:0;z-index:1;display:none}.dplayer-mask.dplayer-mask-show{display:block}.dplayer-video-wrap{position:relative;background:#000;font-size:0;width:100%;height:100%}.dplayer-video-wrap .dplayer-video{width:100%;height:100%;display:none}.dplayer-video-wrap .dplayer-video-current{display:block}.dplayer-video-wrap .dplayer-video-prepare{display:none}.dplayer-info-panel{position:absolute;top:10px;left:10px;width:400px;background:rgba(28,28,28,.8);padding:10px;color:#fff;font-size:12px;border-radius:2px}.dplayer-info-panel-hide{display:none}.dplayer-info-panel .dplayer-info-panel-close{cursor:pointer;position:absolute;right:10px;top:10px}.dplayer-info-panel .dplayer-info-panel-item>span{display:inline-block;vertical-align:middle;line-height:15px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.dplayer-info-panel .dplayer-info-panel-item-title{width:100px;text-align:right;margin-right:10px}.dplayer-info-panel .dplayer-info-panel-item-data{width:260px}',""]),I.exports=M},function(I,M,i){(M=i(3)(!1)).push([I.i,':root{--balloon-border-radius:2px;--balloon-color:rgba(16,16,16,0.95);--balloon-text-color:#fff;--balloon-font-size:12px;--balloon-move:4px}button[aria-label][data-balloon-pos]{overflow:visible}[aria-label][data-balloon-pos]{position:relative;cursor:pointer}[aria-label][data-balloon-pos]:after{text-indent:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;font-weight:400;font-style:normal;text-shadow:none;font-size:var(--balloon-font-size);background:var(--balloon-color);border-radius:2px;color:var(--balloon-text-color);border-radius:var(--balloon-border-radius);content:attr(aria-label);padding:.5em 1em;white-space:nowrap}[aria-label][data-balloon-pos]:after,[aria-label][data-balloon-pos]:before{opacity:0;pointer-events:none;transition:all .18s ease-out .18s;position:absolute;z-index:10}[aria-label][data-balloon-pos]:before{width:0;height:0;border:5px solid transparent;border-top:5px solid var(--balloon-color);content:""}[aria-label][data-balloon-pos]:hover:after,[aria-label][data-balloon-pos]:hover:before,[aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:after,[aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:before,[aria-label][data-balloon-pos][data-balloon-visible]:after,[aria-label][data-balloon-pos][data-balloon-visible]:before{opacity:1;pointer-events:none}[aria-label][data-balloon-pos].font-awesome:after{font-family:FontAwesome,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif}[aria-label][data-balloon-pos][data-balloon-break]:after{white-space:pre}[aria-label][data-balloon-pos][data-balloon-break][data-balloon-length]:after{white-space:pre-line;word-break:break-word}[aria-label][data-balloon-pos][data-balloon-blunt]:after,[aria-label][data-balloon-pos][data-balloon-blunt]:before{transition:none}[aria-label][data-balloon-pos][data-balloon-pos=up]:after{margin-bottom:10px}[aria-label][data-balloon-pos][data-balloon-pos=up]:after,[aria-label][data-balloon-pos][data-balloon-pos=up]:before{bottom:100%;left:50%;transform:translate(-50%,var(--balloon-move));transform-origin:top}[aria-label][data-balloon-pos][data-balloon-pos=up]:hover:after,[aria-label][data-balloon-pos][data-balloon-pos=up]:hover:before,[aria-label][data-balloon-pos][data-balloon-pos=up][data-balloon-visible]:after,[aria-label][data-balloon-pos][data-balloon-pos=up][data-balloon-visible]:before{transform:translate(-50%)}[aria-label][data-balloon-pos][data-balloon-pos=up-left]:after{bottom:100%;left:0;margin-bottom:10px;transform:translateY(var(--balloon-move));transform-origin:top}[aria-label][data-balloon-pos][data-balloon-pos=up-left]:before{bottom:100%;left:5px;transform:translateY(var(--balloon-move));transform-origin:top}[aria-label][data-balloon-pos][data-balloon-pos=up-left]:hover:after,[aria-label][data-balloon-pos][data-balloon-pos=up-left]:hover:before,[aria-label][data-balloon-pos][data-balloon-pos=up-left][data-balloon-visible]:after,[aria-label][data-balloon-pos][data-balloon-pos=up-left][data-balloon-visible]:before{transform:translate(0)}[aria-label][data-balloon-pos][data-balloon-pos=up-right]:after{bottom:100%;right:0;margin-bottom:10px;transform:translateY(var(--balloon-move));transform-origin:top}[aria-label][data-balloon-pos][data-balloon-pos=up-right]:before{bottom:100%;right:5px;transform:translateY(var(--balloon-move));transform-origin:top}[aria-label][data-balloon-pos][data-balloon-pos=up-right]:hover:after,[aria-label][data-balloon-pos][data-balloon-pos=up-right]:hover:before,[aria-label][data-balloon-pos][data-balloon-pos=up-right][data-balloon-visible]:after,[aria-label][data-balloon-pos][data-balloon-pos=up-right][data-balloon-visible]:before{transform:translate(0)}[aria-label][data-balloon-pos][data-balloon-pos=down]:after{left:50%;margin-top:10px;top:100%;transform:translate(-50%,calc(var(--balloon-move)*-1))}[aria-label][data-balloon-pos][data-balloon-pos=down]:before{width:0;height:0;border:5px solid transparent;border-bottom:5px solid var(--balloon-color);left:50%;top:100%;transform:translate(-50%,calc(var(--balloon-move)*-1))}[aria-label][data-balloon-pos][data-balloon-pos=down]:hover:after,[aria-label][data-balloon-pos][data-balloon-pos=down]:hover:before,[aria-label][data-balloon-pos][data-balloon-pos=down][data-balloon-visible]:after,[aria-label][data-balloon-pos][data-balloon-pos=down][data-balloon-visible]:before{transform:translate(-50%)}[aria-label][data-balloon-pos][data-balloon-pos=down-left]:after{left:0;margin-top:10px;top:100%;transform:translateY(calc(var(--balloon-move)*-1))}[aria-label][data-balloon-pos][data-balloon-pos=down-left]:before{width:0;height:0;border:5px solid transparent;border-bottom:5px solid var(--balloon-color);left:5px;top:100%;transform:translateY(calc(var(--balloon-move)*-1))}[aria-label][data-balloon-pos][data-balloon-pos=down-left]:hover:after,[aria-label][data-balloon-pos][data-balloon-pos=down-left]:hover:before,[aria-label][data-balloon-pos][data-balloon-pos=down-left][data-balloon-visible]:after,[aria-label][data-balloon-pos][data-balloon-pos=down-left][data-balloon-visible]:before{transform:translate(0)}[aria-label][data-balloon-pos][data-balloon-pos=down-right]:after{right:0;margin-top:10px;top:100%;transform:translateY(calc(var(--balloon-move)*-1))}[aria-label][data-balloon-pos][data-balloon-pos=down-right]:before{width:0;height:0;border:5px solid transparent;border-bottom:5px solid var(--balloon-color);right:5px;top:100%;transform:translateY(calc(var(--balloon-move)*-1))}[aria-label][data-balloon-pos][data-balloon-pos=down-right]:hover:after,[aria-label][data-balloon-pos][data-balloon-pos=down-right]:hover:before,[aria-label][data-balloon-pos][data-balloon-pos=down-right][data-balloon-visible]:after,[aria-label][data-balloon-pos][data-balloon-pos=down-right][data-balloon-visible]:before{transform:translate(0)}[aria-label][data-balloon-pos][data-balloon-pos=left]:after{margin-right:10px;right:100%;top:50%;transform:translate(var(--balloon-move),-50%)}[aria-label][data-balloon-pos][data-balloon-pos=left]:before{width:0;height:0;border:5px solid transparent;border-left:5px solid var(--balloon-color);right:100%;top:50%;transform:translate(var(--balloon-move),-50%)}[aria-label][data-balloon-pos][data-balloon-pos=left]:hover:after,[aria-label][data-balloon-pos][data-balloon-pos=left]:hover:before,[aria-label][data-balloon-pos][data-balloon-pos=left][data-balloon-visible]:after,[aria-label][data-balloon-pos][data-balloon-pos=left][data-balloon-visible]:before{transform:translateY(-50%)}[aria-label][data-balloon-pos][data-balloon-pos=right]:after{left:100%;margin-left:10px;top:50%;transform:translate(calc(var(--balloon-move)*-1),-50%)}[aria-label][data-balloon-pos][data-balloon-pos=right]:before{width:0;height:0;border:5px solid transparent;border-right:5px solid var(--balloon-color);left:100%;top:50%;transform:translate(calc(var(--balloon-move)*-1),-50%)}[aria-label][data-balloon-pos][data-balloon-pos=right]:hover:after,[aria-label][data-balloon-pos][data-balloon-pos=right]:hover:before,[aria-label][data-balloon-pos][data-balloon-pos=right][data-balloon-visible]:after,[aria-label][data-balloon-pos][data-balloon-pos=right][data-balloon-visible]:before{transform:translateY(-50%)}[aria-label][data-balloon-pos][data-balloon-length=small]:after{white-space:normal;width:80px}[aria-label][data-balloon-pos][data-balloon-length=medium]:after{white-space:normal;width:150px}[aria-label][data-balloon-pos][data-balloon-length=large]:after{white-space:normal;width:260px}[aria-label][data-balloon-pos][data-balloon-length=xlarge]:after{white-space:normal;width:380px}@media screen and (max-width:768px){[aria-label][data-balloon-pos][data-balloon-length=xlarge]:after{white-space:normal;width:90vw}}[aria-label][data-balloon-pos][data-balloon-length=fit]:after{white-space:normal;width:100%}',""]),I.exports=M},function(I,M,i){var A=Function.prototype.apply;function u(r,P){this._id=r,this._clearFn=P}M.setTimeout=function(){return new u(A.call(setTimeout,window,arguments),clearTimeout)},M.setInterval=function(){return new u(A.call(setInterval,window,arguments),clearInterval)},M.clearTimeout=M.clearInterval=function(r){r&&r.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(window,this._id)},M.enroll=function(r,P){clearTimeout(r._idleTimeoutId),r._idleTimeout=P},M.unenroll=function(r){clearTimeout(r._idleTimeoutId),r._idleTimeout=-1},M._unrefActive=M.active=function(r){clearTimeout(r._idleTimeoutId);var P=r._idleTimeout;P>=0&&(r._idleTimeoutId=setTimeout(function(){r._onTimeout&&r._onTimeout()},P))},i(40),M.setImmediate=setImmediate,M.clearImmediate=clearImmediate},function(I,M,i){(function(A,u){(function(r,P){if(!r.setImmediate){var O,x,m,c,v,h=1,T={},L=!1,g=r.document,o=Object.getPrototypeOf&&Object.getPrototypeOf(r);o=o&&o.setTimeout?o:r,{}.toString.call(r.process)==="[object process]"?O=function(n){u.nextTick(function(){a(n)})}:function(){if(r.postMessage&&!r.importScripts){var n=!0,d=r.onmessage;return r.onmessage=function(){n=!1},r.postMessage("","*"),r.onmessage=d,n}}()?(c="setImmediate$"+Math.random()+"$",v=function(n){n.source===r&&typeof n.data=="string"&&n.data.indexOf(c)===0&&a(+n.data.slice(c.length))},r.addEventListener?r.addEventListener("message",v,!1):r.attachEvent("onmessage",v),O=function(n){r.postMessage(c+n,"*")}):r.MessageChannel?((m=new MessageChannel).port1.onmessage=function(n){a(n.data)},O=function(n){m.port2.postMessage(n)}):g&&"onreadystatechange"in g.createElement("script")?(x=g.documentElement,O=function(n){var d=g.createElement("script");d.onreadystatechange=function(){a(n),d.onreadystatechange=null,x.removeChild(d),d=null},x.appendChild(d)}):O=function(n){setTimeout(a,0,n)},o.setImmediate=function(n){typeof n!="function"&&(n=new Function(""+n));for(var d=new Array(arguments.length-1),l=0;l<d.length;l++)d[l]=arguments[l+1];var s={callback:n,args:d};return T[h]=s,O(h),h++},o.clearImmediate=t}function t(n){delete T[n]}function a(n){if(L)setTimeout(a,0,n);else{var d=T[n];if(d){L=!0;try{(function(l){var s=l.callback,f=l.args;switch(f.length){case 0:s();break;case 1:s(f[0]);break;case 2:s(f[0],f[1]);break;case 3:s(f[0],f[1],f[2]);break;default:s.apply(P,f)}})(d)}finally{t(n),L=!1}}}}})(typeof self=="undefined"?A===void 0?this:A:self)}).call(this,i(4),i(5))},function(I,M,i){var A=i(0),u=i(6),r=i(42),P=i(12);function O(m){var c=new r(m),v=u(r.prototype.request,c);return A.extend(v,r.prototype,c),A.extend(v,c),v}var x=O(i(9));x.Axios=r,x.create=function(m){return O(P(x.defaults,m))},x.Cancel=i(13),x.CancelToken=i(55),x.isCancel=i(8),x.all=function(m){return Promise.all(m)},x.spread=i(56),I.exports=x,I.exports.default=x},function(I,M,i){var A=i(0),u=i(7),r=i(43),P=i(44),O=i(12);function x(m){this.defaults=m,this.interceptors={request:new r,response:new r}}x.prototype.request=function(m){typeof m=="string"?(m=arguments[1]||{}).url=arguments[0]:m=m||{},(m=O(this.defaults,m)).method?m.method=m.method.toLowerCase():this.defaults.method?m.method=this.defaults.method.toLowerCase():m.method="get";var c=[P,void 0],v=Promise.resolve(m);for(this.interceptors.request.forEach(function(h){c.unshift(h.fulfilled,h.rejected)}),this.interceptors.response.forEach(function(h){c.push(h.fulfilled,h.rejected)});c.length;)v=v.then(c.shift(),c.shift());return v},x.prototype.getUri=function(m){return m=O(this.defaults,m),u(m.url,m.params,m.paramsSerializer).replace(/^\?/,"")},A.forEach(["delete","get","head","options"],function(m){x.prototype[m]=function(c,v){return this.request(A.merge(v||{},{method:m,url:c}))}}),A.forEach(["post","put","patch"],function(m){x.prototype[m]=function(c,v,h){return this.request(A.merge(h||{},{method:m,url:c,data:v}))}}),I.exports=x},function(I,M,i){var A=i(0);function u(){this.handlers=[]}u.prototype.use=function(r,P){return this.handlers.push({fulfilled:r,rejected:P}),this.handlers.length-1},u.prototype.eject=function(r){this.handlers[r]&&(this.handlers[r]=null)},u.prototype.forEach=function(r){A.forEach(this.handlers,function(P){P!==null&&r(P)})},I.exports=u},function(I,M,i){var A=i(0),u=i(45),r=i(8),P=i(9);function O(x){x.cancelToken&&x.cancelToken.throwIfRequested()}I.exports=function(x){return O(x),x.headers=x.headers||{},x.data=u(x.data,x.headers,x.transformRequest),x.headers=A.merge(x.headers.common||{},x.headers[x.method]||{},x.headers),A.forEach(["delete","get","head","post","put","patch","common"],function(m){delete x.headers[m]}),(x.adapter||P.adapter)(x).then(function(m){return O(x),m.data=u(m.data,m.headers,x.transformResponse),m},function(m){return r(m)||(O(x),m&&m.response&&(m.response.data=u(m.response.data,m.response.headers,x.transformResponse))),Promise.reject(m)})}},function(I,M,i){var A=i(0);I.exports=function(u,r,P){return A.forEach(P,function(O){u=O(u,r)}),u}},function(I,M,i){var A=i(0);I.exports=function(u,r){A.forEach(u,function(P,O){O!==r&&O.toUpperCase()===r.toUpperCase()&&(u[r]=P,delete u[O])})}},function(I,M,i){var A=i(11);I.exports=function(u,r,P){var O=P.config.validateStatus;!O||O(P.status)?u(P):r(A("Request failed with status code "+P.status,P.config,null,P.request,P))}},function(I,M,i){I.exports=function(A,u,r,P,O){return A.config=u,r&&(A.code=r),A.request=P,A.response=O,A.isAxiosError=!0,A.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},A}},function(I,M,i){var A=i(50),u=i(51);I.exports=function(r,P){return r&&!A(P)?u(r,P):P}},function(I,M,i){I.exports=function(A){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(A)}},function(I,M,i){I.exports=function(A,u){return u?A.replace(/\/+$/,"")+"/"+u.replace(/^\/+/,""):A}},function(I,M,i){var A=i(0),u=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];I.exports=function(r){var P,O,x,m={};return r&&A.forEach(r.split(`
`),function(c){if(x=c.indexOf(":"),P=A.trim(c.substr(0,x)).toLowerCase(),O=A.trim(c.substr(x+1)),P){if(m[P]&&u.indexOf(P)>=0)return;m[P]=P==="set-cookie"?(m[P]?m[P]:[]).concat([O]):m[P]?m[P]+", "+O:O}}),m}},function(I,M,i){var A=i(0);I.exports=A.isStandardBrowserEnv()?function(){var u,r=/(msie|trident)/i.test(navigator.userAgent),P=document.createElement("a");function O(x){var m=x;return r&&(P.setAttribute("href",m),m=P.href),P.setAttribute("href",m),{href:P.href,protocol:P.protocol?P.protocol.replace(/:$/,""):"",host:P.host,search:P.search?P.search.replace(/^\?/,""):"",hash:P.hash?P.hash.replace(/^#/,""):"",hostname:P.hostname,port:P.port,pathname:P.pathname.charAt(0)==="/"?P.pathname:"/"+P.pathname}}return u=O(window.location.href),function(x){var m=A.isString(x)?O(x):x;return m.protocol===u.protocol&&m.host===u.host}}():function(){return!0}},function(I,M,i){var A=i(0);I.exports=A.isStandardBrowserEnv()?{write:function(u,r,P,O,x,m){var c=[];c.push(u+"="+encodeURIComponent(r)),A.isNumber(P)&&c.push("expires="+new Date(P).toGMTString()),A.isString(O)&&c.push("path="+O),A.isString(x)&&c.push("domain="+x),m===!0&&c.push("secure"),document.cookie=c.join("; ")},read:function(u){var r=document.cookie.match(new RegExp("(^|;\\s*)("+u+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(u){this.write(u,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(I,M,i){var A=i(13);function u(r){if(typeof r!="function")throw new TypeError("executor must be a function.");var P;this.promise=new Promise(function(x){P=x});var O=this;r(function(x){O.reason||(O.reason=new A(x),P(O.reason))})}u.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},u.source=function(){var r;return{token:new u(function(P){r=P}),cancel:r}},I.exports=u},function(I,M,i){I.exports=function(A){return function(u){return A.apply(null,u)}}},function(I,M,i){(function(A){var u=typeof self!="undefined"?self:typeof window!="undefined"?window:A!==void 0?A:{},r=Object.create(u),P=/["&'<>]/;r.$escape=function(O){return function(x){var m=""+x,c=P.exec(m);if(!c)return x;var v="",h=void 0,T=void 0,L=void 0;for(h=c.index,T=0;h<m.length;h++){switch(m.charCodeAt(h)){case 34:L="&#34;";break;case 38:L="&#38;";break;case 39:L="&#39;";break;case 60:L="&#60;";break;case 62:L="&#62;";break;default:continue}T!==h&&(v+=m.substring(T,h)),T=h+1,v+=L}return T!==h?v+m.substring(T,h):v}(function x(m){return typeof m!="string"&&(m=m==null?"":typeof m=="function"?x(m.call(m)):JSON.stringify(m)),m}(O))},r.$each=function(O,x){if(Array.isArray(O))for(var m=0,c=O.length;m<c;m++)x(O[m],m);else for(var v in O)x(O[v],v)},I.exports=r}).call(this,i(4))},function(I,M,i){i.r(M),i(35);var A=i(15),u=/mobile/i.test(window.navigator.userAgent),r={secondToTime:function(j){if((j=j||0)===0||j===1/0||j.toString()==="NaN")return"00:00";var $=Math.floor(j/3600),z=Math.floor((j-3600*$)/60),B=Math.floor(j-3600*$-60*z);return($>0?[$,z,B]:[z,B]).map(function(K){return K<10?"0"+K:""+K}).join(":")},getElementViewLeft:function(j){var $=j.offsetLeft,z=j.offsetParent,B=document.body.scrollLeft+document.documentElement.scrollLeft;if(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)for(;z!==null&&z!==j;)$+=z.offsetLeft,z=z.offsetParent;else for(;z!==null;)$+=z.offsetLeft,z=z.offsetParent;return $-B},getBoundingClientRectViewLeft:function(j){var $=window.scrollY||window.pageYOffset||document.body.scrollTop+(document.documentElement&&document.documentElement.scrollTop||0);if(j.getBoundingClientRect){if(typeof this.getBoundingClientRectViewLeft.offset!="number"){var z=document.createElement("div");z.style.cssText="position:absolute;top:0;left:0;",document.body.appendChild(z),this.getBoundingClientRectViewLeft.offset=-z.getBoundingClientRect().top-$,document.body.removeChild(z),z=null}var B=j.getBoundingClientRect(),K=this.getBoundingClientRectViewLeft.offset;return B.left+K}return this.getElementViewLeft(j)},getScrollPosition:function(){return{left:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}},setScrollPosition:function(j){var $=j.left,z=$===void 0?0:$,B=j.top,K=B===void 0?0:B;this.isFirefox?(document.documentElement.scrollLeft=z,document.documentElement.scrollTop=K):window.scrollTo(z,K)},isMobile:u,isSafari:/Safari/i.test(window.navigator.userAgent),isFirefox:/firefox/i.test(window.navigator.userAgent),isChrome:/chrome/i.test(window.navigator.userAgent),storage:{set:function(j,$){localStorage.setItem(j,$)},get:function(j){return localStorage.getItem(j)}},nameMap:{dragStart:u?"touchstart":"mousedown",dragMove:u?"touchmove":"mousemove",dragEnd:u?"touchend":"mouseup"},color2Number:function(j){return j[0]==="#"&&(j=j.substr(1)),j.length===3&&(j="".concat(j[0]).concat(j[0]).concat(j[1]).concat(j[1]).concat(j[2]).concat(j[2])),parseInt(j,16)+0&16777215},number2Color:function(j){return"#"+("00000"+j.toString(16)).slice(-6)},number2Type:function(j){switch(j){case 0:return"right";case 1:return"top";case 2:return"bottom";default:return"right"}}},P=i(2),O=i.n(P),x={send:function(j){O.a.post(j.url,j.data).then(function($){var z=$.data;z&&z.code===0?j.success&&j.success(z):j.error&&j.error(z&&z.msg)}).catch(function($){console.error($),j.error&&j.error()})},read:function(j){O.a.get(j.url).then(function($){var z=$.data;z&&z.code===0?j.success&&j.success(z.data.map(function(B){return{time:B[0],type:B[1],color:B[2],author:B[3],text:B[4]}})):j.error&&j.error(z&&z.msg)}).catch(function($){console.error($),j.error&&j.error()})}};function m(j){return(m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $})(j)}var c=function(j){var $={container:j.element||document.getElementsByClassName("dplayer")[0],live:!1,autoplay:!1,theme:"#b7daff",loop:!1,lang:(navigator.language||navigator.browserLanguage).toLowerCase(),screenshot:!1,airplay:!0,hotkey:!0,preload:"metadata",volume:.7,playbackSpeed:[.5,.75,1,1.25,1.5,2],apiBackend:x,video:{},contextmenu:[],mutex:!0,pluginOptions:{hls:{},flv:{},dash:{},webtorrent:{}}};for(var z in $)$.hasOwnProperty(z)&&!j.hasOwnProperty(z)&&(j[z]=$[z]);return j.video&&!j.video.type&&(j.video.type="auto"),m(j.danmaku)==="object"&&j.danmaku&&!j.danmaku.user&&(j.danmaku.user="DIYgod"),j.subtitle&&(!j.subtitle.type&&(j.subtitle.type="webvtt"),!j.subtitle.fontSize&&(j.subtitle.fontSize="20px"),!j.subtitle.bottom&&(j.subtitle.bottom="40px"),!j.subtitle.color&&(j.subtitle.color="#fff")),j.video.quality&&(j.video.url=j.video.quality[j.video.defaultQuality].url),j.lang&&(j.lang=j.lang.toLowerCase()),j.contextmenu=j.contextmenu.concat([{text:"Video info",click:function(B){B.infoPanel.triggle()}},{text:"About author",link:"https://diygod.me"},{text:"DPlayer v".concat("1.26.0"),link:"https://github.com/MoePlayer/DPlayer"}]),j},v={"zh-cn":{"Danmaku is loading":"\u5F39\u5E55\u52A0\u8F7D\u4E2D",Top:"\u9876\u90E8",Bottom:"\u5E95\u90E8",Rolling:"\u6EDA\u52A8","Input danmaku, hit Enter":"\u8F93\u5165\u5F39\u5E55\uFF0C\u56DE\u8F66\u53D1\u9001","About author":"\u5173\u4E8E\u4F5C\u8005","DPlayer feedback":"\u64AD\u653E\u5668\u610F\u89C1\u53CD\u9988","About DPlayer":"\u5173\u4E8E DPlayer \u64AD\u653E\u5668",Loop:"\u6D17\u8111\u5FAA\u73AF",Speed:"\u901F\u5EA6","Opacity for danmaku":"\u5F39\u5E55\u900F\u660E\u5EA6",Normal:"\u6B63\u5E38","Please input danmaku content!":"\u8981\u8F93\u5165\u5F39\u5E55\u5185\u5BB9\u554A\u5582\uFF01","Set danmaku color":"\u8BBE\u7F6E\u5F39\u5E55\u989C\u8272","Set danmaku type":"\u8BBE\u7F6E\u5F39\u5E55\u7C7B\u578B","Show danmaku":"\u663E\u793A\u5F39\u5E55","Video load failed":"\u89C6\u9891\u52A0\u8F7D\u5931\u8D25","Danmaku load failed":"\u5F39\u5E55\u52A0\u8F7D\u5931\u8D25","Danmaku send failed":"\u5F39\u5E55\u53D1\u9001\u5931\u8D25","Switching to":"\u6B63\u5728\u5207\u6362\u81F3","Switched to":"\u5DF2\u7ECF\u5207\u6362\u81F3",quality:"\u753B\u8D28",FF:"\u5FEB\u8FDB",REW:"\u5FEB\u9000","Unlimited danmaku":"\u6D77\u91CF\u5F39\u5E55","Send danmaku":"\u53D1\u9001\u5F39\u5E55",Setting:"\u8BBE\u7F6E","Full screen":"\u5168\u5C4F","Web full screen":"\u9875\u9762\u5168\u5C4F",Send:"\u53D1\u9001",Screenshot:"\u622A\u56FE",AirPlay:"\u65E0\u7EBF\u6295\u5C4F",s:"\u79D2","Show subtitle":"\u663E\u793A\u5B57\u5E55","Hide subtitle":"\u9690\u85CF\u5B57\u5E55",Volume:"\u97F3\u91CF",Live:"\u76F4\u64AD","Video info":"\u89C6\u9891\u7EDF\u8BA1\u4FE1\u606F"},"zh-tw":{"Danmaku is loading":"\u5F48\u5E55\u8F09\u5165\u4E2D",Top:"\u9802\u90E8",Bottom:"\u5E95\u90E8",Rolling:"\u6EFE\u52D5","Input danmaku, hit Enter":"\u8F38\u5165\u5F48\u5E55\uFF0CEnter \u767C\u9001","About author":"\u95DC\u65BC\u4F5C\u8005","DPlayer feedback":"\u64AD\u653E\u5668\u610F\u898B\u56DE\u994B","About DPlayer":"\u95DC\u65BC DPlayer \u64AD\u653E\u5668",Loop:"\u5FAA\u74B0\u64AD\u653E",Speed:"\u901F\u5EA6","Opacity for danmaku":"\u5F48\u5E55\u900F\u660E\u5EA6",Normal:"\u6B63\u5E38","Please input danmaku content!":"\u8ACB\u8F38\u5165\u5F48\u5E55\u5167\u5BB9\u554A\uFF01","Set danmaku color":"\u8A2D\u5B9A\u5F48\u5E55\u984F\u8272","Set danmaku type":"\u8A2D\u5B9A\u5F48\u5E55\u985E\u578B","Show danmaku":"\u986F\u793A\u5F48\u5E55","Video load failed":"\u5F71\u7247\u8F09\u5165\u5931\u6557","Danmaku load failed":"\u5F48\u5E55\u8F09\u5165\u5931\u6557","Danmaku send failed":"\u5F48\u5E55\u767C\u9001\u5931\u6557","Switching to":"\u6B63\u5728\u5207\u63DB\u81F3","Switched to":"\u5DF2\u7D93\u5207\u63DB\u81F3",quality:"\u756B\u8CEA",FF:"\u5FEB\u9032",REW:"\u5FEB\u9000","Unlimited danmaku":"\u5DE8\u91CF\u5F48\u5E55","Send danmaku":"\u767C\u9001\u5F48\u5E55",Setting:"\u8A2D\u5B9A","Full screen":"\u5168\u87A2\u5E55","Web full screen":"\u9801\u9762\u5168\u87A2\u5E55",Send:"\u767C\u9001",Screenshot:"\u622A\u5716",AirPlay:"\u7121\u7DDA\u6295\u5C4F",s:"\u79D2","Show subtitle":"\u986F\u793A\u5B57\u5E55","Hide subtitle":"\u96B1\u85CF\u5B57\u5E55",Volume:"\u97F3\u91CF",Live:"\u76F4\u64AD","Video info":"\u5F71\u7247\u7D71\u8A08\u8A0A\u606F"}},h=function(j){var $=this;this.lang=j,this.tran=function(z){return v[$.lang]&&v[$.lang][z]?v[$.lang][z]:z}},T=i(17),L=i.n(T),g=i(18),o=i.n(g),t=i(19),a=i.n(t),n=i(20),d=i.n(n),l=i(21),s=i.n(l),f=i(22),C=i.n(f),D=i(23),E=i.n(D),p=i(24),y=i.n(p),S=i(25),R=i.n(S),w=i(26),k=i.n(w),_=i(27),F=i.n(_),U=i(28),N=i.n(U),W=i(29),H=i.n(W),G=i(30),J=i.n(G),X=i(31),te=i.n(X),le=i(32),re=i.n(le),fe=i(33),ue=i.n(fe),ae={play:L.a,pause:o.a,volumeUp:a.a,volumeDown:d.a,volumeOff:s.a,full:C.a,fullWeb:E.a,setting:y.a,right:R.a,comment:k.a,commentOff:F.a,send:N.a,pallette:H.a,camera:J.a,subtitle:re.a,loading:ue.a,airplay:te.a},me=i(34),ge=i.n(me);function be(j,$){for(var z=0;z<$.length;z++){var B=$[z];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}var Se=function(){function j(B){(function(K,V){if(!(K instanceof V))throw new TypeError("Cannot call a class as a function")})(this,j),this.container=B.container,this.options=B.options,this.index=B.index,this.tran=B.tran,this.init()}var $,z;return $=j,(z=[{key:"init",value:function(){this.container.innerHTML=ge()({options:this.options,index:this.index,tran:this.tran,icons:ae,mobile:r.isMobile,video:{current:!0,pic:this.options.video.pic,screenshot:this.options.screenshot,airplay:this.options.airplay,preload:this.options.preload,url:this.options.video.url,subtitle:this.options.subtitle}}),this.volumeBar=this.container.querySelector(".dplayer-volume-bar-inner"),this.volumeBarWrap=this.container.querySelector(".dplayer-volume-bar"),this.volumeBarWrapWrap=this.container.querySelector(".dplayer-volume-bar-wrap"),this.volumeButton=this.container.querySelector(".dplayer-volume"),this.volumeButtonIcon=this.container.querySelector(".dplayer-volume-icon"),this.volumeIcon=this.container.querySelector(".dplayer-volume-icon .dplayer-icon-content"),this.playedBar=this.container.querySelector(".dplayer-played"),this.loadedBar=this.container.querySelector(".dplayer-loaded"),this.playedBarWrap=this.container.querySelector(".dplayer-bar-wrap"),this.playedBarTime=this.container.querySelector(".dplayer-bar-time"),this.danmaku=this.container.querySelector(".dplayer-danmaku"),this.danmakuLoading=this.container.querySelector(".dplayer-danloading"),this.video=this.container.querySelector(".dplayer-video-current"),this.bezel=this.container.querySelector(".dplayer-bezel-icon"),this.playButton=this.container.querySelector(".dplayer-play-icon"),this.mobilePlayButton=this.container.querySelector(".dplayer-mobile-play"),this.videoWrap=this.container.querySelector(".dplayer-video-wrap"),this.controllerMask=this.container.querySelector(".dplayer-controller-mask"),this.ptime=this.container.querySelector(".dplayer-ptime"),this.settingButton=this.container.querySelector(".dplayer-setting-icon"),this.settingBox=this.container.querySelector(".dplayer-setting-box"),this.mask=this.container.querySelector(".dplayer-mask"),this.loop=this.container.querySelector(".dplayer-setting-loop"),this.loopToggle=this.container.querySelector(".dplayer-setting-loop .dplayer-toggle-setting-input"),this.showDanmaku=this.container.querySelector(".dplayer-setting-showdan"),this.showDanmakuToggle=this.container.querySelector(".dplayer-showdan-setting-input"),this.unlimitDanmaku=this.container.querySelector(".dplayer-setting-danunlimit"),this.unlimitDanmakuToggle=this.container.querySelector(".dplayer-danunlimit-setting-input"),this.speed=this.container.querySelector(".dplayer-setting-speed"),this.speedItem=this.container.querySelectorAll(".dplayer-setting-speed-item"),this.danmakuOpacityBar=this.container.querySelector(".dplayer-danmaku-bar-inner"),this.danmakuOpacityBarWrap=this.container.querySelector(".dplayer-danmaku-bar"),this.danmakuOpacityBarWrapWrap=this.container.querySelector(".dplayer-danmaku-bar-wrap"),this.danmakuOpacityBox=this.container.querySelector(".dplayer-setting-danmaku"),this.dtime=this.container.querySelector(".dplayer-dtime"),this.controller=this.container.querySelector(".dplayer-controller"),this.commentInput=this.container.querySelector(".dplayer-comment-input"),this.commentButton=this.container.querySelector(".dplayer-comment-icon"),this.commentSettingBox=this.container.querySelector(".dplayer-comment-setting-box"),this.commentSettingButton=this.container.querySelector(".dplayer-comment-setting-icon"),this.commentSettingFill=this.container.querySelector(".dplayer-comment-setting-icon path"),this.commentSendButton=this.container.querySelector(".dplayer-send-icon"),this.commentSendFill=this.container.querySelector(".dplayer-send-icon path"),this.commentColorSettingBox=this.container.querySelector(".dplayer-comment-setting-color"),this.browserFullButton=this.container.querySelector(".dplayer-full-icon"),this.webFullButton=this.container.querySelector(".dplayer-full-in-icon"),this.menu=this.container.querySelector(".dplayer-menu"),this.menuItem=this.container.querySelectorAll(".dplayer-menu-item"),this.qualityList=this.container.querySelector(".dplayer-quality-list"),this.camareButton=this.container.querySelector(".dplayer-camera-icon"),this.airplayButton=this.container.querySelector(".dplayer-airplay-icon"),this.subtitleButton=this.container.querySelector(".dplayer-subtitle-icon"),this.subtitleButtonInner=this.container.querySelector(".dplayer-subtitle-icon .dplayer-icon-content"),this.subtitle=this.container.querySelector(".dplayer-subtitle"),this.qualityButton=this.container.querySelector(".dplayer-quality-icon"),this.barPreview=this.container.querySelector(".dplayer-bar-preview"),this.barWrap=this.container.querySelector(".dplayer-bar-wrap"),this.notice=this.container.querySelector(".dplayer-notice"),this.infoPanel=this.container.querySelector(".dplayer-info-panel"),this.infoPanelClose=this.container.querySelector(".dplayer-info-panel-close"),this.infoVersion=this.container.querySelector(".dplayer-info-panel-item-version .dplayer-info-panel-item-data"),this.infoFPS=this.container.querySelector(".dplayer-info-panel-item-fps .dplayer-info-panel-item-data"),this.infoType=this.container.querySelector(".dplayer-info-panel-item-type .dplayer-info-panel-item-data"),this.infoUrl=this.container.querySelector(".dplayer-info-panel-item-url .dplayer-info-panel-item-data"),this.infoResolution=this.container.querySelector(".dplayer-info-panel-item-resolution .dplayer-info-panel-item-data"),this.infoDuration=this.container.querySelector(".dplayer-info-panel-item-duration .dplayer-info-panel-item-data"),this.infoDanmakuId=this.container.querySelector(".dplayer-info-panel-item-danmaku-id .dplayer-info-panel-item-data"),this.infoDanmakuApi=this.container.querySelector(".dplayer-info-panel-item-danmaku-api .dplayer-info-panel-item-data"),this.infoDanmakuAmount=this.container.querySelector(".dplayer-info-panel-item-danmaku-amount .dplayer-info-panel-item-data")}}])&&be($.prototype,z),j}();function we(j){return(we=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $})(j)}function Ce(j,$){for(var z=0;z<$.length;z++){var B=$[z];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}var Le=function(){function j(B){(function(K,V){if(!(K instanceof V))throw new TypeError("Cannot call a class as a function")})(this,j),this.options=B,this.container=this.options.container,this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.dan=[],this.showing=!0,this._opacity=this.options.opacity,this.events=this.options.events,this.unlimited=this.options.unlimited,this._measure(""),this.load()}var $,z;return $=j,(z=[{key:"load",value:function(){var B,K=this;B=this.options.api.maximum?"".concat(this.options.api.address,"v3/?id=").concat(this.options.api.id,"&max=").concat(this.options.api.maximum):"".concat(this.options.api.address,"v3/?id=").concat(this.options.api.id);var V=(this.options.api.addition||[]).slice(0);V.push(B),this.events&&this.events.trigger("danmaku_load_start",V),this._readAllEndpoints(V,function(Q){K.dan=[].concat.apply([],Q).sort(function(ie,he){return ie.time-he.time}),window.requestAnimationFrame(function(){K.frame()}),K.options.callback(),K.events&&K.events.trigger("danmaku_load_end")})}},{key:"reload",value:function(B){this.options.api=B,this.dan=[],this.clear(),this.load()}},{key:"_readAllEndpoints",value:function(B,K){for(var V=this,Q=[],ie=0,he=function(it){V.options.apiBackend.read({url:B[it],success:function(Ye){Q[it]=Ye,++ie===B.length&&K(Q)},error:function(Ye){V.options.error(Ye||V.options.tran("Danmaku load failed")),Q[it]=[],++ie===B.length&&K(Q)}})},Ee=0;Ee<B.length;++Ee)he(Ee)}},{key:"send",value:function(B,K){var V=this,Q={token:this.options.api.token,id:this.options.api.id,author:this.options.api.user,time:this.options.time(),text:B.text,color:B.color,type:B.type};this.options.apiBackend.send({url:this.options.api.address+"v3/",data:Q,success:K,error:function(he){V.options.error(he||V.options.tran("Danmaku send failed"))}}),this.dan.splice(this.danIndex,0,Q),this.danIndex++;var ie={text:this.htmlEncode(Q.text),color:Q.color,type:Q.type,border:"2px solid ".concat(this.options.borderColor)};this.draw(ie),this.events&&this.events.trigger("danmaku_send",Q)}},{key:"frame",value:function(){var B=this;if(this.dan.length&&!this.paused&&this.showing){for(var K=this.dan[this.danIndex],V=[];K&&this.options.time()>parseFloat(K.time);)V.push(K),K=this.dan[++this.danIndex];this.draw(V)}window.requestAnimationFrame(function(){B.frame()})}},{key:"opacity",value:function(B){if(B!==void 0){for(var K=this.container.getElementsByClassName("dplayer-danmaku-item"),V=0;V<K.length;V++)K[V].style.opacity=B;this._opacity=B,this.events&&this.events.trigger("danmaku_opacity",this._opacity)}return this._opacity}},{key:"draw",value:function(B){var K=this;if(this.showing){var V=this.options.height,Q=this.container.offsetWidth,ie=this.container.offsetHeight,he=parseInt(ie/V),Ee=function(ke){var _e=ke.offsetWidth||parseInt(ke.style.width),qt=ke.getBoundingClientRect().right||K.container.getBoundingClientRect().right+_e;return K.container.getBoundingClientRect().right-qt},it=function(ke){return(Q+ke)/5},Ye=function(ke,_e,qt){for(var Ot=Q/it(qt),ra=function(Gt){var er=K.danTunnel[_e][Gt+""];if(!er||!er.length)return K.danTunnel[_e][Gt+""]=[ke],ke.addEventListener("animationend",function(){K.danTunnel[_e][Gt+""].splice(0,1)}),{v:Gt%he};if(_e!=="right")return"continue";for(var pr=0;pr<er.length;pr++){var On=Ee(er[pr])-10;if(On<=Q-Ot*it(parseInt(er[pr].style.width))||On<=0)break;if(pr===er.length-1)return K.danTunnel[_e][Gt+""].push(ke),ke.addEventListener("animationend",function(){K.danTunnel[_e][Gt+""].splice(0,1)}),{v:Gt%he}}},Gr=0;K.unlimited||Gr<he;Gr++){var zr=ra(Gr);switch(zr){case"continue":continue;default:if(we(zr)==="object")return zr.v}}return-1};Object.prototype.toString.call(B)!=="[object Array]"&&(B=[B]);for(var hr=document.createDocumentFragment(),Jt=function(ke){B[ke].type=r.number2Type(B[ke].type),B[ke].color||(B[ke].color=16777215);var _e=document.createElement("div");_e.classList.add("dplayer-danmaku-item"),_e.classList.add("dplayer-danmaku-".concat(B[ke].type)),B[ke].border?_e.innerHTML='<span style="border:'.concat(B[ke].border,'">').concat(B[ke].text,"</span>"):_e.innerHTML=B[ke].text,_e.style.opacity=K._opacity,_e.style.color=r.number2Color(B[ke].color),_e.addEventListener("animationend",function(){K.container.removeChild(_e)});var qt=K._measure(B[ke].text),Ot=void 0;switch(B[ke].type){case"right":(Ot=Ye(_e,B[ke].type,qt))>=0&&(_e.style.width=qt+1+"px",_e.style.top=V*Ot+"px",_e.style.transform="translateX(-".concat(Q,"px)"));break;case"top":(Ot=Ye(_e,B[ke].type))>=0&&(_e.style.top=V*Ot+"px");break;case"bottom":(Ot=Ye(_e,B[ke].type))>=0&&(_e.style.bottom=V*Ot+"px");break;default:console.error("Can't handled danmaku type: ".concat(B[ke].type))}Ot>=0&&(_e.classList.add("dplayer-danmaku-move"),hr.appendChild(_e))},Zt=0;Zt<B.length;Zt++)Jt(Zt);return this.container.appendChild(hr),hr}}},{key:"play",value:function(){this.paused=!1}},{key:"pause",value:function(){this.paused=!0}},{key:"_measure",value:function(B){if(!this.context){var K=getComputedStyle(this.container.getElementsByClassName("dplayer-danmaku-item")[0],null);this.context=document.createElement("canvas").getContext("2d"),this.context.font=K.getPropertyValue("font")}return this.context.measureText(B).width}},{key:"seek",value:function(){this.clear();for(var B=0;B<this.dan.length;B++){if(this.dan[B].time>=this.options.time()){this.danIndex=B;break}this.danIndex=this.dan.length}}},{key:"clear",value:function(){this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.options.container.innerHTML="",this.events&&this.events.trigger("danmaku_clear")}},{key:"htmlEncode",value:function(B){return B.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2f;")}},{key:"resize",value:function(){for(var B=this.container.offsetWidth,K=this.container.getElementsByClassName("dplayer-danmaku-item"),V=0;V<K.length;V++)K[V].style.transform="translateX(-".concat(B,"px)")}},{key:"hide",value:function(){this.showing=!1,this.pause(),this.clear(),this.events&&this.events.trigger("danmaku_hide")}},{key:"show",value:function(){this.seek(),this.showing=!0,this.play(),this.events&&this.events.trigger("danmaku_show")}},{key:"unlimit",value:function(B){this.unlimited=B}}])&&Ce($.prototype,z),j}();function Ue(j,$){for(var z=0;z<$.length;z++){var B=$[z];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}var Ke=function(){function j(){(function(B,K){if(!(B instanceof K))throw new TypeError("Cannot call a class as a function")})(this,j),this.events={},this.videoEvents=["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","mozaudioavailable","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],this.playerEvents=["screenshot","thumbnails_show","thumbnails_hide","danmaku_show","danmaku_hide","danmaku_clear","danmaku_loaded","danmaku_send","danmaku_opacity","contextmenu_show","contextmenu_hide","notice_show","notice_hide","quality_start","quality_end","destroy","resize","fullscreen","fullscreen_cancel","webfullscreen","webfullscreen_cancel","subtitle_show","subtitle_hide","subtitle_change"]}var $,z;return $=j,(z=[{key:"on",value:function(B,K){this.type(B)&&typeof K=="function"&&(this.events[B]||(this.events[B]=[]),this.events[B].push(K))}},{key:"trigger",value:function(B,K){if(this.events[B]&&this.events[B].length)for(var V=0;V<this.events[B].length;V++)this.events[B][V](K)}},{key:"type",value:function(B){return this.playerEvents.indexOf(B)!==-1?"player":this.videoEvents.indexOf(B)!==-1?"video":(console.error("Unknown event name: ".concat(B)),null)}}])&&Ue($.prototype,z),j}();function We(j,$){for(var z=0;z<$.length;z++){var B=$[z];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}var Be=function(){function j(B){var K=this;(function(ie,he){if(!(ie instanceof he))throw new TypeError("Cannot call a class as a function")})(this,j),this.player=B,this.lastScrollPosition={left:0,top:0},this.player.events.on("webfullscreen",function(){K.player.resize()}),this.player.events.on("webfullscreen_cancel",function(){K.player.resize(),r.setScrollPosition(K.lastScrollPosition)});var V=function(){K.player.resize(),K.isFullScreen("browser")?K.player.events.trigger("fullscreen"):(r.setScrollPosition(K.lastScrollPosition),K.player.events.trigger("fullscreen_cancel"))},Q=function(){var ie=document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;ie&&ie!==K.player.container||(K.player.resize(),ie?K.player.events.trigger("fullscreen"):(r.setScrollPosition(K.lastScrollPosition),K.player.events.trigger("fullscreen_cancel")))};/Firefox/.test(navigator.userAgent)?(document.addEventListener("mozfullscreenchange",Q),document.addEventListener("fullscreenchange",Q)):(this.player.container.addEventListener("fullscreenchange",V),this.player.container.addEventListener("webkitfullscreenchange",V),document.addEventListener("msfullscreenchange",Q),document.addEventListener("MSFullscreenChange",Q))}var $,z;return $=j,(z=[{key:"isFullScreen",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";switch(B){case"browser":return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;case"web":return this.player.container.classList.contains("dplayer-fulled")}}},{key:"request",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser",K=B==="browser"?"web":"browser",V=this.isFullScreen(K);switch(V||(this.lastScrollPosition=r.getScrollPosition()),B){case"browser":this.player.container.requestFullscreen?this.player.container.requestFullscreen():this.player.container.mozRequestFullScreen?this.player.container.mozRequestFullScreen():this.player.container.webkitRequestFullscreen?this.player.container.webkitRequestFullscreen():this.player.video.webkitEnterFullscreen?this.player.video.webkitEnterFullscreen():this.player.video.webkitEnterFullScreen?this.player.video.webkitEnterFullScreen():this.player.container.msRequestFullscreen&&this.player.container.msRequestFullscreen();break;case"web":this.player.container.classList.add("dplayer-fulled"),document.body.classList.add("dplayer-web-fullscreen-fix"),this.player.events.trigger("webfullscreen")}V&&this.cancel(K)}},{key:"cancel",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";switch(B){case"browser":document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.webkitCancelFullscreen?document.webkitCancelFullscreen():document.msCancelFullScreen?document.msCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen();break;case"web":this.player.container.classList.remove("dplayer-fulled"),document.body.classList.remove("dplayer-web-fullscreen-fix"),this.player.events.trigger("webfullscreen_cancel")}}},{key:"toggle",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";this.isFullScreen(B)?this.cancel(B):this.request(B)}}])&&We($.prototype,z),j}();function ze(j,$){for(var z=0;z<$.length;z++){var B=$[z];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}var Te=function(){function j(B){(function(K,V){if(!(K instanceof V))throw new TypeError("Cannot call a class as a function")})(this,j),this.storageName={opacity:"dplayer-danmaku-opacity",volume:"dplayer-volume",unlimited:"dplayer-danmaku-unlimited",danmaku:"dplayer-danmaku-show",subtitle:"dplayer-subtitle-show"},this.default={opacity:.7,volume:B.options.hasOwnProperty("volume")?B.options.volume:.7,unlimited:(B.options.danmaku&&B.options.danmaku.unlimited?1:0)||0,danmaku:1,subtitle:1},this.data={},this.init()}var $,z;return $=j,(z=[{key:"init",value:function(){for(var B in this.storageName){var K=this.storageName[B];this.data[B]=parseFloat(r.storage.get(K)||this.default[B])}}},{key:"get",value:function(B){return this.data[B]}},{key:"set",value:function(B,K){this.data[B]=K,r.storage.set(this.storageName[B],K)}}])&&ze($.prototype,z),j}();function tt(j,$){for(var z=0;z<$.length;z++){var B=$[z];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}var rt=function(){function j(B,K,V,Q){(function(ie,he){if(!(ie instanceof he))throw new TypeError("Cannot call a class as a function")})(this,j),this.container=B,this.video=K,this.options=V,this.events=Q,this.init()}var $,z;return $=j,(z=[{key:"init",value:function(){var B=this;if(this.container.style.fontSize=this.options.fontSize,this.container.style.bottom=this.options.bottom,this.container.style.color=this.options.color,this.video.textTracks&&this.video.textTracks[0]){var K=this.video.textTracks[0];K.oncuechange=function(){var V=K.activeCues[0];if(B.container.innerHTML="",V){var Q=document.createElement("div");Q.appendChild(V.getCueAsHTML());var ie=Q.innerHTML.split(/\r?\n/).map(function(he){return"<p>".concat(he,"</p>")}).join("");B.container.innerHTML=ie}B.events.trigger("subtitle_change")}}}},{key:"show",value:function(){this.container.classList.remove("dplayer-subtitle-hide"),this.events.trigger("subtitle_show")}},{key:"hide",value:function(){this.container.classList.add("dplayer-subtitle-hide"),this.events.trigger("subtitle_hide")}},{key:"toggle",value:function(){this.container.classList.contains("dplayer-subtitle-hide")?this.show():this.hide()}}])&&tt($.prototype,z),j}();function Y(j,$){for(var z=0;z<$.length;z++){var B=$[z];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}var Z=function(){function j(B){(function(K,V){if(!(K instanceof V))throw new TypeError("Cannot call a class as a function")})(this,j),this.elements={},this.elements.volume=B.volumeBar,this.elements.played=B.playedBar,this.elements.loaded=B.loadedBar,this.elements.danmaku=B.danmakuOpacityBar}var $,z;return $=j,(z=[{key:"set",value:function(B,K,V){K=Math.max(K,0),K=Math.min(K,1),this.elements[B].style[V]=100*K+"%"}},{key:"get",value:function(B){return parseFloat(this.elements[B].style.width)/100}}])&&Y($.prototype,z),j}();function oe(j,$){for(var z=0;z<$.length;z++){var B=$[z];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}var pe=function(){function j(B){(function(K,V){if(!(K instanceof V))throw new TypeError("Cannot call a class as a function")})(this,j),this.player=B,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(K){window.setTimeout(K,1e3/60)},this.types=["loading","info","fps"],this.init()}var $,z;return $=j,(z=[{key:"init",value:function(){var B=this;this.types.map(function(K){return K!=="fps"&&B["init".concat(K,"Checker")](),K})}},{key:"initloadingChecker",value:function(){var B=this,K=0,V=0,Q=!1;this.loadingChecker=setInterval(function(){B.enableloadingChecker&&(V=B.player.video.currentTime,Q||V!==K||B.player.video.paused||(B.player.container.classList.add("dplayer-loading"),Q=!0),Q&&V>K&&!B.player.video.paused&&(B.player.container.classList.remove("dplayer-loading"),Q=!1),K=V)},100)}},{key:"initfpsChecker",value:function(){var B=this;window.requestAnimationFrame(function(){if(B.enablefpsChecker)if(B.initfpsChecker(),B.fpsStart){B.fpsIndex++;var K=new Date;K-B.fpsStart>1e3&&(B.player.infoPanel.fps(B.fpsIndex/(K-B.fpsStart)*1e3),B.fpsStart=new Date,B.fpsIndex=0)}else B.fpsStart=new Date,B.fpsIndex=0;else B.fpsStart=0,B.fpsIndex=0})}},{key:"initinfoChecker",value:function(){var B=this;this.infoChecker=setInterval(function(){B.enableinfoChecker&&B.player.infoPanel.update()},1e3)}},{key:"enable",value:function(B){this["enable".concat(B,"Checker")]=!0,B==="fps"&&this.initfpsChecker()}},{key:"disable",value:function(B){this["enable".concat(B,"Checker")]=!1}},{key:"destroy",value:function(){var B=this;this.types.map(function(K){return B["enable".concat(K,"Checker")]=!1,B["".concat(K,"Checker")]&&clearInterval(B["".concat(K,"Checker")]),K})}}])&&oe($.prototype,z),j}();function Pe(j,$){for(var z=0;z<$.length;z++){var B=$[z];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}var He=function(){function j(B){var K=this;(function(V,Q){if(!(V instanceof Q))throw new TypeError("Cannot call a class as a function")})(this,j),this.container=B,this.container.addEventListener("animationend",function(){K.container.classList.remove("dplayer-bezel-transition")})}var $,z;return $=j,(z=[{key:"switch",value:function(B){this.container.innerHTML=B,this.container.classList.add("dplayer-bezel-transition")}}])&&Pe($.prototype,z),j}();function $e(j,$){for(var z=0;z<$.length;z++){var B=$[z];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}var Ze=function(){function j(B){(function(K,V){if(!(K instanceof V))throw new TypeError("Cannot call a class as a function")})(this,j),this.container=B.container,this.barWidth=B.barWidth,this.container.style.backgroundImage="url('".concat(B.url,"')"),this.events=B.events}var $,z;return $=j,(z=[{key:"resize",value:function(B,K,V){this.container.style.width="".concat(B,"px"),this.container.style.height="".concat(K,"px"),this.container.style.top="".concat(2-K,"px"),this.barWidth=V}},{key:"show",value:function(){this.container.style.display="block",this.events&&this.events.trigger("thumbnails_show")}},{key:"move",value:function(B){this.container.style.backgroundPosition="-".concat(160*(Math.ceil(B/this.barWidth*100)-1),"px 0"),this.container.style.left="".concat(Math.min(Math.max(B-this.container.offsetWidth/2,-10),this.barWidth-150),"px")}},{key:"hide",value:function(){this.container.style.display="none",this.events&&this.events.trigger("thumbnails_hide")}}])&&$e($.prototype,z),j}();function Ve(j,$){for(var z=0;z<$.length;z++){var B=$[z];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}var Ne=function(){function j(B){var K=this;(function(V,Q){if(!(V instanceof Q))throw new TypeError("Cannot call a class as a function")})(this,j),this.player=B,this.autoHideTimer=0,r.isMobile||(this.player.container.addEventListener("mousemove",function(){K.setAutoHide()}),this.player.container.addEventListener("click",function(){K.setAutoHide()}),this.player.on("play",function(){K.setAutoHide()}),this.player.on("pause",function(){K.setAutoHide()})),this.initPlayButton(),this.initThumbnails(),this.initPlayedBar(),this.initFullButton(),this.initQualityButton(),this.initScreenshotButton(),this.initSubtitleButton(),this.initHighlights(),r.isSafari&&this.initAirplayButton(),r.isMobile||this.initVolumeButton()}var $,z;return $=j,(z=[{key:"initPlayButton",value:function(){var B=this;this.player.template.playButton.addEventListener("click",function(){B.player.toggle()}),this.player.template.mobilePlayButton.addEventListener("click",function(){B.player.toggle()}),r.isMobile?(this.player.template.videoWrap.addEventListener("click",function(){B.toggle()}),this.player.template.controllerMask.addEventListener("click",function(){B.toggle()})):(this.player.template.videoWrap.addEventListener("click",function(){B.player.toggle()}),this.player.template.controllerMask.addEventListener("click",function(){B.player.toggle()}))}},{key:"initHighlights",value:function(){var B=this;this.player.on("durationchange",function(){if(B.player.video.duration!==1&&B.player.video.duration!==1/0&&B.player.options.highlight){var K=document.querySelectorAll(".dplayer-highlight");[].slice.call(K,0).forEach(function(ie){B.player.template.playedBarWrap.removeChild(ie)});for(var V=0;V<B.player.options.highlight.length;V++)if(B.player.options.highlight[V].text&&B.player.options.highlight[V].time){var Q=document.createElement("div");Q.classList.add("dplayer-highlight"),Q.style.left=B.player.options.highlight[V].time/B.player.video.duration*100+"%",Q.innerHTML='<span class="dplayer-highlight-text">'+B.player.options.highlight[V].text+"</span>",B.player.template.playedBarWrap.insertBefore(Q,B.player.template.playedBarTime)}}})}},{key:"initThumbnails",value:function(){var B=this;this.player.options.video.thumbnails&&(this.thumbnails=new Ze({container:this.player.template.barPreview,barWidth:this.player.template.barWrap.offsetWidth,url:this.player.options.video.thumbnails,events:this.player.events}),this.player.on("loadedmetadata",function(){B.thumbnails.resize(160,B.player.video.videoHeight/B.player.video.videoWidth*160,B.player.template.barWrap.offsetWidth)}))}},{key:"initPlayedBar",value:function(){var B=this,K=function(Q){var ie=((Q.clientX||Q.changedTouches[0].clientX)-r.getBoundingClientRectViewLeft(B.player.template.playedBarWrap))/B.player.template.playedBarWrap.clientWidth;ie=Math.max(ie,0),ie=Math.min(ie,1),B.player.bar.set("played",ie,"width"),B.player.template.ptime.innerHTML=r.secondToTime(ie*B.player.video.duration)},V=function Q(ie){document.removeEventListener(r.nameMap.dragEnd,Q),document.removeEventListener(r.nameMap.dragMove,K);var he=((ie.clientX||ie.changedTouches[0].clientX)-r.getBoundingClientRectViewLeft(B.player.template.playedBarWrap))/B.player.template.playedBarWrap.clientWidth;he=Math.max(he,0),he=Math.min(he,1),B.player.bar.set("played",he,"width"),B.player.seek(B.player.bar.get("played")*B.player.video.duration),B.player.timer.enable("progress")};this.player.template.playedBarWrap.addEventListener(r.nameMap.dragStart,function(){B.player.timer.disable("progress"),document.addEventListener(r.nameMap.dragMove,K),document.addEventListener(r.nameMap.dragEnd,V)}),this.player.template.playedBarWrap.addEventListener(r.nameMap.dragMove,function(Q){if(B.player.video.duration){var ie=B.player.template.playedBarWrap.getBoundingClientRect().left,he=(Q.clientX||Q.changedTouches[0].clientX)-ie;if(he<0||he>B.player.template.playedBarWrap.offsetWidth)return;var Ee=B.player.video.duration*(he/B.player.template.playedBarWrap.offsetWidth);r.isMobile&&B.thumbnails&&B.thumbnails.show(),B.thumbnails&&B.thumbnails.move(he),B.player.template.playedBarTime.style.left="".concat(he-(Ee>=3600?25:20),"px"),B.player.template.playedBarTime.innerText=r.secondToTime(Ee),B.player.template.playedBarTime.classList.remove("hidden")}}),this.player.template.playedBarWrap.addEventListener(r.nameMap.dragEnd,function(){r.isMobile&&B.thumbnails&&B.thumbnails.hide()}),r.isMobile||(this.player.template.playedBarWrap.addEventListener("mouseenter",function(){B.player.video.duration&&(B.thumbnails&&B.thumbnails.show(),B.player.template.playedBarTime.classList.remove("hidden"))}),this.player.template.playedBarWrap.addEventListener("mouseleave",function(){B.player.video.duration&&(B.thumbnails&&B.thumbnails.hide(),B.player.template.playedBarTime.classList.add("hidden"))}))}},{key:"initFullButton",value:function(){var B=this;this.player.template.browserFullButton.addEventListener("click",function(){B.player.fullScreen.toggle("browser")}),this.player.template.webFullButton.addEventListener("click",function(){B.player.fullScreen.toggle("web")})}},{key:"initVolumeButton",value:function(){var B=this,K=function(Q){var ie=Q||window.event,he=((ie.clientX||ie.changedTouches[0].clientX)-r.getBoundingClientRectViewLeft(B.player.template.volumeBarWrap)-5.5)/35;B.player.volume(he)},V=function Q(){document.removeEventListener(r.nameMap.dragEnd,Q),document.removeEventListener(r.nameMap.dragMove,K),B.player.template.volumeButton.classList.remove("dplayer-volume-active")};this.player.template.volumeBarWrapWrap.addEventListener("click",function(Q){var ie=Q||window.event,he=((ie.clientX||ie.changedTouches[0].clientX)-r.getBoundingClientRectViewLeft(B.player.template.volumeBarWrap)-5.5)/35;B.player.volume(he)}),this.player.template.volumeBarWrapWrap.addEventListener(r.nameMap.dragStart,function(){document.addEventListener(r.nameMap.dragMove,K),document.addEventListener(r.nameMap.dragEnd,V),B.player.template.volumeButton.classList.add("dplayer-volume-active")}),this.player.template.volumeButtonIcon.addEventListener("click",function(){B.player.video.muted?(B.player.video.muted=!1,B.player.switchVolumeIcon(),B.player.bar.set("volume",B.player.volume(),"width")):(B.player.video.muted=!0,B.player.template.volumeIcon.innerHTML=ae.volumeOff,B.player.bar.set("volume",0,"width"))})}},{key:"initQualityButton",value:function(){var B=this;this.player.options.video.quality&&this.player.template.qualityList.addEventListener("click",function(K){K.target.classList.contains("dplayer-quality-item")&&B.player.switchQuality(K.target.dataset.index)})}},{key:"initScreenshotButton",value:function(){var B=this;this.player.options.screenshot&&this.player.template.camareButton.addEventListener("click",function(){var K,V=document.createElement("canvas");V.width=B.player.video.videoWidth,V.height=B.player.video.videoHeight,V.getContext("2d").drawImage(B.player.video,0,0,V.width,V.height),V.toBlob(function(Q){K=URL.createObjectURL(Q);var ie=document.createElement("a");ie.href=K,ie.download="DPlayer.png",ie.style.display="none",document.body.appendChild(ie),ie.click(),document.body.removeChild(ie),URL.revokeObjectURL(K)}),B.player.events.trigger("screenshot",K)})}},{key:"initAirplayButton",value:function(){this.player.options.airplay&&(window.WebKitPlaybackTargetAvailabilityEvent?this.player.video.addEventListener("webkitplaybacktargetavailabilitychanged",function(B){switch(B.availability){case"available":this.template.airplayButton.disable=!1;break;default:this.template.airplayButton.disable=!0}this.template.airplayButton.addEventListener("click",function(){this.video.webkitShowPlaybackTargetPicker()}.bind(this))}.bind(this.player)):this.player.template.airplayButton.style.display="none")}},{key:"initSubtitleButton",value:function(){var B=this;this.player.options.subtitle&&(this.player.events.on("subtitle_show",function(){B.player.template.subtitleButton.dataset.balloon=B.player.tran("Hide subtitle"),B.player.template.subtitleButtonInner.style.opacity="",B.player.user.set("subtitle",1)}),this.player.events.on("subtitle_hide",function(){B.player.template.subtitleButton.dataset.balloon=B.player.tran("Show subtitle"),B.player.template.subtitleButtonInner.style.opacity="0.4",B.player.user.set("subtitle",0)}),this.player.template.subtitleButton.addEventListener("click",function(){B.player.subtitle.toggle()}))}},{key:"setAutoHide",value:function(){var B=this;this.show(),clearTimeout(this.autoHideTimer),this.autoHideTimer=setTimeout(function(){!B.player.video.played.length||B.player.paused||B.disableAutoHide||B.hide()},3e3)}},{key:"show",value:function(){this.player.container.classList.remove("dplayer-hide-controller")}},{key:"hide",value:function(){this.player.container.classList.add("dplayer-hide-controller"),this.player.setting.hide(),this.player.comment&&this.player.comment.hide()}},{key:"isShow",value:function(){return!this.player.container.classList.contains("dplayer-hide-controller")}},{key:"toggle",value:function(){this.isShow()?this.hide():this.show()}},{key:"destroy",value:function(){clearTimeout(this.autoHideTimer)}}])&&Ve($.prototype,z),j}();function nt(j,$){for(var z=0;z<$.length;z++){var B=$[z];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}var xt=function(){function j(B){var K=this;(function(Ee,it){if(!(Ee instanceof it))throw new TypeError("Cannot call a class as a function")})(this,j),this.player=B,this.player.template.mask.addEventListener("click",function(){K.hide()}),this.player.template.settingButton.addEventListener("click",function(){K.show()}),this.loop=this.player.options.loop,this.player.template.loopToggle.checked=this.loop,this.player.template.loop.addEventListener("click",function(){K.player.template.loopToggle.checked=!K.player.template.loopToggle.checked,K.player.template.loopToggle.checked?K.loop=!0:K.loop=!1,K.hide()}),this.showDanmaku=this.player.user.get("danmaku"),this.showDanmaku||this.player.danmaku&&this.player.danmaku.hide(),this.player.template.showDanmakuToggle.checked=this.showDanmaku,this.player.template.showDanmaku.addEventListener("click",function(){K.player.template.showDanmakuToggle.checked=!K.player.template.showDanmakuToggle.checked,K.player.template.showDanmakuToggle.checked?(K.showDanmaku=!0,K.player.danmaku.show()):(K.showDanmaku=!1,K.player.danmaku.hide()),K.player.user.set("danmaku",K.showDanmaku?1:0),K.hide()}),this.unlimitDanmaku=this.player.user.get("unlimited"),this.player.template.unlimitDanmakuToggle.checked=this.unlimitDanmaku,this.player.template.unlimitDanmaku.addEventListener("click",function(){K.player.template.unlimitDanmakuToggle.checked=!K.player.template.unlimitDanmakuToggle.checked,K.player.template.unlimitDanmakuToggle.checked?(K.unlimitDanmaku=!0,K.player.danmaku.unlimit(!0)):(K.unlimitDanmaku=!1,K.player.danmaku.unlimit(!1)),K.player.user.set("unlimited",K.unlimitDanmaku?1:0),K.hide()}),this.player.template.speed.addEventListener("click",function(){K.player.template.settingBox.classList.add("dplayer-setting-box-narrow"),K.player.template.settingBox.classList.add("dplayer-setting-box-speed")});for(var V=function(Ee){K.player.template.speedItem[Ee].addEventListener("click",function(){K.player.speed(K.player.template.speedItem[Ee].dataset.speed),K.hide()})},Q=0;Q<this.player.template.speedItem.length;Q++)V(Q);if(this.player.danmaku){this.player.on("danmaku_opacity",function(Ee){K.player.bar.set("danmaku",Ee,"width"),K.player.user.set("opacity",Ee)}),this.player.danmaku.opacity(this.player.user.get("opacity"));var ie=function(Ee){var it=Ee||window.event,Ye=((it.clientX||it.changedTouches[0].clientX)-r.getBoundingClientRectViewLeft(K.player.template.danmakuOpacityBarWrap))/130;Ye=Math.max(Ye,0),Ye=Math.min(Ye,1),K.player.danmaku.opacity(Ye)},he=function Ee(){document.removeEventListener(r.nameMap.dragEnd,Ee),document.removeEventListener(r.nameMap.dragMove,ie),K.player.template.danmakuOpacityBox.classList.remove("dplayer-setting-danmaku-active")};this.player.template.danmakuOpacityBarWrapWrap.addEventListener("click",function(Ee){var it=Ee||window.event,Ye=((it.clientX||it.changedTouches[0].clientX)-r.getBoundingClientRectViewLeft(K.player.template.danmakuOpacityBarWrap))/130;Ye=Math.max(Ye,0),Ye=Math.min(Ye,1),K.player.danmaku.opacity(Ye)}),this.player.template.danmakuOpacityBarWrapWrap.addEventListener(r.nameMap.dragStart,function(){document.addEventListener(r.nameMap.dragMove,ie),document.addEventListener(r.nameMap.dragEnd,he),K.player.template.danmakuOpacityBox.classList.add("dplayer-setting-danmaku-active")})}}var $,z;return $=j,(z=[{key:"hide",value:function(){var B=this;this.player.template.settingBox.classList.remove("dplayer-setting-box-open"),this.player.template.mask.classList.remove("dplayer-mask-show"),setTimeout(function(){B.player.template.settingBox.classList.remove("dplayer-setting-box-narrow"),B.player.template.settingBox.classList.remove("dplayer-setting-box-speed")},300),this.player.controller.disableAutoHide=!1}},{key:"show",value:function(){this.player.template.settingBox.classList.add("dplayer-setting-box-open"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.controller.disableAutoHide=!0}}])&&nt($.prototype,z),j}();function ft(j,$){for(var z=0;z<$.length;z++){var B=$[z];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}var kt=function(){function j(B){var K=this;(function(V,Q){if(!(V instanceof Q))throw new TypeError("Cannot call a class as a function")})(this,j),this.player=B,this.player.template.mask.addEventListener("click",function(){K.hide()}),this.player.template.commentButton.addEventListener("click",function(){K.show()}),this.player.template.commentSettingButton.addEventListener("click",function(){K.toggleSetting()}),this.player.template.commentColorSettingBox.addEventListener("click",function(){if(K.player.template.commentColorSettingBox.querySelector("input:checked+span")){var V=K.player.template.commentColorSettingBox.querySelector("input:checked").value;K.player.template.commentSettingFill.style.fill=V,K.player.template.commentInput.style.color=V,K.player.template.commentSendFill.style.fill=V}}),this.player.template.commentInput.addEventListener("click",function(){K.hideSetting()}),this.player.template.commentInput.addEventListener("keydown",function(V){(V||window.event).keyCode===13&&K.send()}),this.player.template.commentSendButton.addEventListener("click",function(){K.send()})}var $,z;return $=j,(z=[{key:"show",value:function(){this.player.controller.disableAutoHide=!0,this.player.template.controller.classList.add("dplayer-controller-comment"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.container.classList.add("dplayer-show-controller"),this.player.template.commentInput.focus()}},{key:"hide",value:function(){this.player.template.controller.classList.remove("dplayer-controller-comment"),this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.container.classList.remove("dplayer-show-controller"),this.player.controller.disableAutoHide=!1,this.hideSetting()}},{key:"showSetting",value:function(){this.player.template.commentSettingBox.classList.add("dplayer-comment-setting-open")}},{key:"hideSetting",value:function(){this.player.template.commentSettingBox.classList.remove("dplayer-comment-setting-open")}},{key:"toggleSetting",value:function(){this.player.template.commentSettingBox.classList.contains("dplayer-comment-setting-open")?this.hideSetting():this.showSetting()}},{key:"send",value:function(){var B=this;this.player.template.commentInput.blur(),this.player.template.commentInput.value.replace(/^\s+|\s+$/g,"")?this.player.danmaku.send({text:this.player.template.commentInput.value,color:r.color2Number(this.player.container.querySelector(".dplayer-comment-setting-color input:checked").value),type:parseInt(this.player.container.querySelector(".dplayer-comment-setting-type input:checked").value)},function(){B.player.template.commentInput.value="",B.hide()}):this.player.notice(this.player.tran("Please input danmaku content!"))}}])&&ft($.prototype,z),j}(),jt=function j($){(function(z,B){if(!(z instanceof B))throw new TypeError("Cannot call a class as a function")})(this,j),$.options.hotkey&&document.addEventListener("keydown",function(z){if($.focus){var B=document.activeElement.tagName.toUpperCase(),K=document.activeElement.getAttribute("contenteditable");if(B!=="INPUT"&&B!=="TEXTAREA"&&K!==""&&K!=="true"){var V,Q=z||window.event;switch(Q.keyCode){case 32:Q.preventDefault(),$.toggle();break;case 37:if(Q.preventDefault(),$.options.live)break;$.seek($.video.currentTime-5),$.controller.setAutoHide();break;case 39:if(Q.preventDefault(),$.options.live)break;$.seek($.video.currentTime+5),$.controller.setAutoHide();break;case 38:Q.preventDefault(),V=$.volume()+.1,$.volume(V);break;case 40:Q.preventDefault(),V=$.volume()-.1,$.volume(V)}}}}),document.addEventListener("keydown",function(z){switch((z||window.event).keyCode){case 27:$.fullScreen.isFullScreen("web")&&$.fullScreen.cancel("web")}})};function Xt(j,$){for(var z=0;z<$.length;z++){var B=$[z];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}var Nr=function(){function j(B){var K=this;(function(V,Q){if(!(V instanceof Q))throw new TypeError("Cannot call a class as a function")})(this,j),this.player=B,this.shown=!1,Array.prototype.slice.call(this.player.template.menuItem).forEach(function(V,Q){K.player.options.contextmenu[Q].click&&V.addEventListener("click",function(){K.player.options.contextmenu[Q].click(K.player),K.hide()})}),this.player.container.addEventListener("contextmenu",function(V){if(K.shown)K.hide();else{var Q=V||window.event;Q.preventDefault();var ie=K.player.container.getBoundingClientRect();K.show(Q.clientX-ie.left,Q.clientY-ie.top),K.player.template.mask.addEventListener("click",function(){K.hide()})}})}var $,z;return $=j,(z=[{key:"show",value:function(B,K){this.player.template.menu.classList.add("dplayer-menu-show");var V=this.player.container.getBoundingClientRect();B+this.player.template.menu.offsetWidth>=V.width?(this.player.template.menu.style.right=V.width-B+"px",this.player.template.menu.style.left="initial"):(this.player.template.menu.style.left=B+"px",this.player.template.menu.style.right="initial"),K+this.player.template.menu.offsetHeight>=V.height?(this.player.template.menu.style.bottom=V.height-K+"px",this.player.template.menu.style.top="initial"):(this.player.template.menu.style.top=K+"px",this.player.template.menu.style.bottom="initial"),this.player.template.mask.classList.add("dplayer-mask-show"),this.shown=!0,this.player.events.trigger("contextmenu_show")}},{key:"hide",value:function(){this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.template.menu.classList.remove("dplayer-menu-show"),this.shown=!1,this.player.events.trigger("contextmenu_hide")}}])&&Xt($.prototype,z),j}();function cr(j,$){for(var z=0;z<$.length;z++){var B=$[z];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}var Kr=function(){function j(B){var K=this;(function(V,Q){if(!(V instanceof Q))throw new TypeError("Cannot call a class as a function")})(this,j),this.container=B.template.infoPanel,this.template=B.template,this.video=B.video,this.player=B,this.template.infoPanelClose.addEventListener("click",function(){K.hide()})}var $,z;return $=j,(z=[{key:"show",value:function(){this.beginTime=Date.now(),this.update(),this.player.timer.enable("info"),this.player.timer.enable("fps"),this.container.classList.remove("dplayer-info-panel-hide")}},{key:"hide",value:function(){this.player.timer.disable("info"),this.player.timer.disable("fps"),this.container.classList.add("dplayer-info-panel-hide")}},{key:"triggle",value:function(){this.container.classList.contains("dplayer-info-panel-hide")?this.show():this.hide()}},{key:"update",value:function(){this.template.infoVersion.innerHTML="v".concat("1.26.0"," ").concat("63275c8"),this.template.infoType.innerHTML=this.player.type,this.template.infoUrl.innerHTML=this.player.options.video.url,this.template.infoResolution.innerHTML="".concat(this.player.video.videoWidth," x ").concat(this.player.video.videoHeight),this.template.infoDuration.innerHTML=this.player.video.duration,this.player.options.danmaku&&(this.template.infoDanmakuId.innerHTML=this.player.options.danmaku.id,this.template.infoDanmakuApi.innerHTML=this.player.options.danmaku.api,this.template.infoDanmakuAmount.innerHTML=this.player.danmaku.dan.length)}},{key:"fps",value:function(B){this.template.infoFPS.innerHTML="".concat(B.toFixed(1))}}])&&cr($.prototype,z),j}(),Or=i(1),Wr=i.n(Or);function Mr(j,$){var z=Object.keys(j);if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(j);$&&(B=B.filter(function(K){return Object.getOwnPropertyDescriptor(j,K).enumerable})),z.push.apply(z,B)}return z}function Hr(j,$,z){return $ in j?Object.defineProperty(j,$,{value:z,enumerable:!0,configurable:!0,writable:!0}):j[$]=z,j}function Qt(j,$){for(var z=0;z<$.length;z++){var B=$[z];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}var fr=0,_t=[],jr=function(){function j(K){var V=this;(function(Q,ie){if(!(Q instanceof ie))throw new TypeError("Cannot call a class as a function")})(this,j),this.options=c(function(Q){for(var ie=1;ie<arguments.length;ie++){var he=arguments[ie]!=null?arguments[ie]:{};ie%2?Mr(Object(he),!0).forEach(function(Ee){Hr(Q,Ee,he[Ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Q,Object.getOwnPropertyDescriptors(he)):Mr(Object(he)).forEach(function(Ee){Object.defineProperty(Q,Ee,Object.getOwnPropertyDescriptor(he,Ee))})}return Q}({preload:K.video.type==="webtorrent"?"none":"metadata"},K)),this.options.video.quality&&(this.qualityIndex=this.options.video.defaultQuality,this.quality=this.options.video.quality[this.options.video.defaultQuality]),this.tran=new h(this.options.lang).tran,this.events=new Ke,this.user=new Te(this),this.container=this.options.container,this.container.classList.add("dplayer"),this.options.danmaku||this.container.classList.add("dplayer-no-danmaku"),this.options.live&&this.container.classList.add("dplayer-live"),r.isMobile&&this.container.classList.add("dplayer-mobile"),this.arrow=this.container.offsetWidth<=500,this.arrow&&this.container.classList.add("dplayer-arrow"),this.template=new Se({container:this.container,options:this.options,index:fr,tran:this.tran}),this.video=this.template.video,this.bar=new Z(this.template),this.bezel=new He(this.template.bezel),this.fullScreen=new Be(this),this.controller=new Ne(this),this.options.danmaku&&(this.danmaku=new Le({container:this.template.danmaku,opacity:this.user.get("opacity"),callback:function(){setTimeout(function(){V.template.danmakuLoading.style.display="none",V.options.autoplay&&V.play()},0)},error:function(Q){V.notice(Q)},apiBackend:this.options.apiBackend,borderColor:this.options.theme,height:this.arrow?24:30,time:function(){return V.video.currentTime},unlimited:this.user.get("unlimited"),api:{id:this.options.danmaku.id,address:this.options.danmaku.api,token:this.options.danmaku.token,maximum:this.options.danmaku.maximum,addition:this.options.danmaku.addition,user:this.options.danmaku.user},events:this.events,tran:function(Q){return V.tran(Q)}}),this.comment=new kt(this)),this.setting=new xt(this),this.plugins={},document.addEventListener("click",function(){V.focus=!1},!0),this.container.addEventListener("click",function(){V.focus=!0},!0),this.paused=!0,this.timer=new pe(this),this.hotkey=new jt(this),this.contextmenu=new Nr(this),this.initVideo(this.video,this.quality&&this.quality.type||this.options.video.type),this.infoPanel=new Kr(this),!this.danmaku&&this.options.autoplay&&this.play(),fr++,_t.push(this)}var $,z,B;return $=j,B=[{key:"version",get:function(){return"1.26.0"}}],(z=[{key:"seek",value:function(K){K=Math.max(K,0),this.video.duration&&(K=Math.min(K,this.video.duration)),this.video.currentTime<K?this.notice("".concat(this.tran("FF")," ").concat((K-this.video.currentTime).toFixed(0)," ").concat(this.tran("s"))):this.video.currentTime>K&&this.notice("".concat(this.tran("REW")," ").concat((this.video.currentTime-K).toFixed(0)," ").concat(this.tran("s"))),this.video.currentTime=K,this.danmaku&&this.danmaku.seek(),this.bar.set("played",K/this.video.duration,"width"),this.template.ptime.innerHTML=r.secondToTime(K)}},{key:"play",value:function(K){var V=this;if(this.paused=!1,this.video.paused&&!r.isMobile&&this.bezel.switch(ae.play),this.template.playButton.innerHTML=ae.pause,this.template.mobilePlayButton.innerHTML=ae.pause,K||A.a.resolve(this.video.play()).catch(function(){V.pause()}).then(function(){}),this.timer.enable("loading"),this.container.classList.remove("dplayer-paused"),this.container.classList.add("dplayer-playing"),this.danmaku&&this.danmaku.play(),this.options.mutex)for(var Q=0;Q<_t.length;Q++)this!==_t[Q]&&_t[Q].pause()}},{key:"pause",value:function(K){this.paused=!0,this.container.classList.remove("dplayer-loading"),this.video.paused||r.isMobile||this.bezel.switch(ae.pause),this.template.playButton.innerHTML=ae.play,this.template.mobilePlayButton.innerHTML=ae.play,K||this.video.pause(),this.timer.disable("loading"),this.container.classList.remove("dplayer-playing"),this.container.classList.add("dplayer-paused"),this.danmaku&&this.danmaku.pause()}},{key:"switchVolumeIcon",value:function(){this.volume()>=.95?this.template.volumeIcon.innerHTML=ae.volumeUp:this.volume()>0?this.template.volumeIcon.innerHTML=ae.volumeDown:this.template.volumeIcon.innerHTML=ae.volumeOff}},{key:"volume",value:function(K,V,Q){if(K=parseFloat(K),!isNaN(K)){K=Math.max(K,0),K=Math.min(K,1),this.bar.set("volume",K,"width");var ie="".concat((100*K).toFixed(0),"%");this.template.volumeBarWrapWrap.dataset.balloon=ie,V||this.user.set("volume",K),Q||this.notice("".concat(this.tran("Volume")," ").concat((100*K).toFixed(0),"%")),this.video.volume=K,this.video.muted&&(this.video.muted=!1),this.switchVolumeIcon()}return this.video.volume}},{key:"toggle",value:function(){this.video.paused?this.play():this.pause()}},{key:"on",value:function(K,V){this.events.on(K,V)}},{key:"switchVideo",value:function(K,V){this.pause(),this.video.poster=K.pic?K.pic:"",this.video.src=K.url,this.initMSE(this.video,K.type||"auto"),V&&(this.template.danmakuLoading.style.display="block",this.bar.set("played",0,"width"),this.bar.set("loaded",0,"width"),this.template.ptime.innerHTML="00:00",this.template.danmaku.innerHTML="",this.danmaku&&this.danmaku.reload({id:V.id,address:V.api,token:V.token,maximum:V.maximum,addition:V.addition,user:V.user}))}},{key:"initMSE",value:function(K,V){var Q=this;if(this.type=V,this.options.video.customType&&this.options.video.customType[V])Object.prototype.toString.call(this.options.video.customType[V])==="[object Function]"?this.options.video.customType[V](this.video,this):console.error("Illegal customType: ".concat(V));else switch(this.type==="auto"&&(/m3u8(#|\?|$)/i.exec(K.src)?this.type="hls":/.flv(#|\?|$)/i.exec(K.src)?this.type="flv":/.mpd(#|\?|$)/i.exec(K.src)?this.type="dash":this.type="normal"),this.type==="hls"&&(K.canPlayType("application/x-mpegURL")||K.canPlayType("application/vnd.apple.mpegURL"))&&(this.type="normal"),this.type){case"hls":if(window.Hls)if(window.Hls.isSupported()){var ie=this.options.pluginOptions.hls,he=new window.Hls(ie);this.plugins.hls=he,he.loadSource(K.src),he.attachMedia(K),this.events.on("destroy",function(){he.destroy(),delete Q.plugins.hls})}else this.notice("Error: Hls is not supported.");else this.notice("Error: Can't find Hls.");break;case"flv":if(window.flvjs)if(window.flvjs.isSupported()){var Ee=window.flvjs.createPlayer(Object.assign(this.options.pluginOptions.flv.mediaDataSource||{},{type:"flv",url:K.src}),this.options.pluginOptions.flv.config);this.plugins.flvjs=Ee,Ee.attachMediaElement(K),Ee.load(),this.events.on("destroy",function(){Ee.unload(),Ee.detachMediaElement(),Ee.destroy(),delete Q.plugins.flvjs})}else this.notice("Error: flvjs is not supported.");else this.notice("Error: Can't find flvjs.");break;case"dash":if(window.dashjs){var it=window.dashjs.MediaPlayer().create().initialize(K,K.src,!1),Ye=this.options.pluginOptions.dash;it.updateSettings(Ye),this.plugins.dash=it,this.events.on("destroy",function(){window.dashjs.MediaPlayer().reset(),delete Q.plugins.dash})}else this.notice("Error: Can't find dashjs.");break;case"webtorrent":if(window.WebTorrent)if(window.WebTorrent.WEBRTC_SUPPORT){this.container.classList.add("dplayer-loading");var hr=this.options.pluginOptions.webtorrent,Jt=new window.WebTorrent(hr);this.plugins.webtorrent=Jt;var Zt=K.src;K.src="",K.preload="metadata",K.addEventListener("durationchange",function(){return Q.container.classList.remove("dplayer-loading")},{once:!0}),Jt.add(Zt,function(ke){ke.files.find(function(_e){return _e.name.endsWith(".mp4")}).renderTo(Q.video,{autoplay:Q.options.autoplay,controls:!1})}),this.events.on("destroy",function(){Jt.remove(Zt),Jt.destroy(),delete Q.plugins.webtorrent})}else this.notice("Error: Webtorrent is not supported.");else this.notice("Error: Can't find Webtorrent.")}}},{key:"initVideo",value:function(K,V){var Q=this;this.initMSE(K,V),this.on("durationchange",function(){K.duration!==1&&K.duration!==1/0&&(Q.template.dtime.innerHTML=r.secondToTime(K.duration))}),this.on("progress",function(){var Ee=K.buffered.length?K.buffered.end(K.buffered.length-1)/K.duration:0;Q.bar.set("loaded",Ee,"width")}),this.on("error",function(){Q.video.error&&Q.tran&&Q.notice&&Q.type!=="webtorrent"&&Q.notice(Q.tran("Video load failed"),-1)}),this.on("ended",function(){Q.bar.set("played",1,"width"),Q.setting.loop?(Q.seek(0),Q.play()):Q.pause(),Q.danmaku&&(Q.danmaku.danIndex=0)}),this.on("play",function(){Q.paused&&Q.play(!0)}),this.on("pause",function(){Q.paused||Q.pause(!0)}),this.on("timeupdate",function(){Q.bar.set("played",Q.video.currentTime/Q.video.duration,"width");var Ee=r.secondToTime(Q.video.currentTime);Q.template.ptime.innerHTML!==Ee&&(Q.template.ptime.innerHTML=Ee)});for(var ie=function(Ee){K.addEventListener(Q.events.videoEvents[Ee],function(){Q.events.trigger(Q.events.videoEvents[Ee])})},he=0;he<this.events.videoEvents.length;he++)ie(he);this.volume(this.user.get("volume"),!0,!0),this.options.subtitle&&(this.subtitle=new rt(this.template.subtitle,this.video,this.options.subtitle,this.events),this.user.get("subtitle")||this.subtitle.hide())}},{key:"switchQuality",value:function(K){var V=this;if(K=typeof K=="string"?parseInt(K):K,this.qualityIndex!==K&&!this.switchingQuality){this.qualityIndex=K,this.switchingQuality=!0,this.quality=this.options.video.quality[K],this.template.qualityButton.innerHTML=this.quality.name;var Q=this.video.paused;this.video.pause();var ie=Wr()({current:!1,pic:null,screenshot:this.options.screenshot,preload:"auto",url:this.quality.url,subtitle:this.options.subtitle}),he=new DOMParser().parseFromString(ie,"text/html").body.firstChild;this.template.videoWrap.insertBefore(he,this.template.videoWrap.getElementsByTagName("div")[0]),this.prevVideo=this.video,this.video=he,this.initVideo(this.video,this.quality.type||this.options.video.type),this.seek(this.prevVideo.currentTime),this.notice("".concat(this.tran("Switching to")," ").concat(this.quality.name," ").concat(this.tran("quality")),-1),this.events.trigger("quality_start",this.quality),this.on("canplay",function(){if(V.prevVideo){if(V.video.currentTime!==V.prevVideo.currentTime)return void V.seek(V.prevVideo.currentTime);V.template.videoWrap.removeChild(V.prevVideo),V.video.classList.add("dplayer-video-current"),Q||V.video.play(),V.prevVideo=null,V.notice("".concat(V.tran("Switched to")," ").concat(V.quality.name," ").concat(V.tran("quality"))),V.switchingQuality=!1,V.events.trigger("quality_end")}})}}},{key:"notice",value:function(K){var V=this,Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2e3,ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:.8;this.template.notice.innerHTML=K,this.template.notice.style.opacity=ie,this.noticeTime&&clearTimeout(this.noticeTime),this.events.trigger("notice_show",K),Q>0&&(this.noticeTime=setTimeout(function(){V.template.notice.style.opacity=0,V.events.trigger("notice_hide")},Q))}},{key:"resize",value:function(){this.danmaku&&this.danmaku.resize(),this.controller.thumbnails&&this.controller.thumbnails.resize(160,this.video.videoHeight/this.video.videoWidth*160,this.template.barWrap.offsetWidth),this.events.trigger("resize")}},{key:"speed",value:function(K){this.video.playbackRate=K}},{key:"destroy",value:function(){_t.splice(_t.indexOf(this),1),this.pause(),this.controller.destroy(),this.timer.destroy(),this.video.src="",this.container.innerHTML="",this.events.trigger("destroy")}}])&&Qt($.prototype,z),B&&Qt($,B),j}();console.log(`
`.concat(" %c DPlayer v","1.26.0"," ").concat("63275c8"," %c http://dplayer.js.org ",`
`,`
`),"color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;"),M.default=jr}]).default})})(Zi);var Rc=li(Zi.exports),qi={exports:{}};(function(e,b){typeof window!="undefined"&&function(M,i){e.exports=i()}(ui,function(){return function(I){var M={};function i(A){if(M[A])return M[A].exports;var u=M[A]={i:A,l:!1,exports:{}};return I[A].call(u.exports,u,u.exports,i),u.l=!0,u.exports}return i.m=I,i.c=M,i.d=function(A,u,r){i.o(A,u)||Object.defineProperty(A,u,{enumerable:!0,get:r})},i.r=function(A){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(A,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(A,"__esModule",{value:!0})},i.t=function(A,u){if(u&1&&(A=i(A)),u&8||u&4&&typeof A=="object"&&A&&A.__esModule)return A;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:A}),u&2&&typeof A!="string")for(var P in A)i.d(r,P,function(O){return A[O]}.bind(null,P));return r},i.n=function(A){var u=A&&A.__esModule?function(){return A.default}:function(){return A};return i.d(u,"a",u),u},i.o=function(A,u){return Object.prototype.hasOwnProperty.call(A,u)},i.p="/dist/",i(i.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(I,M,i){var A=Object.prototype.hasOwnProperty,u="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(u=!1));function P(c,v,h){this.fn=c,this.context=v,this.once=h||!1}function O(c,v,h,T,L){if(typeof h!="function")throw new TypeError("The listener must be a function");var g=new P(h,T||c,L),o=u?u+v:v;return c._events[o]?c._events[o].fn?c._events[o]=[c._events[o],g]:c._events[o].push(g):(c._events[o]=g,c._eventsCount++),c}function x(c,v){--c._eventsCount===0?c._events=new r:delete c._events[v]}function m(){this._events=new r,this._eventsCount=0}m.prototype.eventNames=function(){var v=[],h,T;if(this._eventsCount===0)return v;for(T in h=this._events)A.call(h,T)&&v.push(u?T.slice(1):T);return Object.getOwnPropertySymbols?v.concat(Object.getOwnPropertySymbols(h)):v},m.prototype.listeners=function(v){var h=u?u+v:v,T=this._events[h];if(!T)return[];if(T.fn)return[T.fn];for(var L=0,g=T.length,o=new Array(g);L<g;L++)o[L]=T[L].fn;return o},m.prototype.listenerCount=function(v){var h=u?u+v:v,T=this._events[h];return T?T.fn?1:T.length:0},m.prototype.emit=function(v,h,T,L,g,o){var t=u?u+v:v;if(!this._events[t])return!1;var a=this._events[t],n=arguments.length,d,l;if(a.fn){switch(a.once&&this.removeListener(v,a.fn,void 0,!0),n){case 1:return a.fn.call(a.context),!0;case 2:return a.fn.call(a.context,h),!0;case 3:return a.fn.call(a.context,h,T),!0;case 4:return a.fn.call(a.context,h,T,L),!0;case 5:return a.fn.call(a.context,h,T,L,g),!0;case 6:return a.fn.call(a.context,h,T,L,g,o),!0}for(l=1,d=new Array(n-1);l<n;l++)d[l-1]=arguments[l];a.fn.apply(a.context,d)}else{var s=a.length,f;for(l=0;l<s;l++)switch(a[l].once&&this.removeListener(v,a[l].fn,void 0,!0),n){case 1:a[l].fn.call(a[l].context);break;case 2:a[l].fn.call(a[l].context,h);break;case 3:a[l].fn.call(a[l].context,h,T);break;case 4:a[l].fn.call(a[l].context,h,T,L);break;default:if(!d)for(f=1,d=new Array(n-1);f<n;f++)d[f-1]=arguments[f];a[l].fn.apply(a[l].context,d)}}return!0},m.prototype.on=function(v,h,T){return O(this,v,h,T,!1)},m.prototype.once=function(v,h,T){return O(this,v,h,T,!0)},m.prototype.removeListener=function(v,h,T,L){var g=u?u+v:v;if(!this._events[g])return this;if(!h)return x(this,g),this;var o=this._events[g];if(o.fn)o.fn===h&&(!L||o.once)&&(!T||o.context===T)&&x(this,g);else{for(var t=0,a=[],n=o.length;t<n;t++)(o[t].fn!==h||L&&!o[t].once||T&&o[t].context!==T)&&a.push(o[t]);a.length?this._events[g]=a.length===1?a[0]:a:x(this,g)}return this},m.prototype.removeAllListeners=function(v){var h;return v?(h=u?u+v:v,this._events[h]&&x(this,h)):(this._events=new r,this._eventsCount=0),this},m.prototype.off=m.prototype.removeListener,m.prototype.addListener=m.prototype.on,m.prefixed=u,m.EventEmitter=m,I.exports=m},"./node_modules/url-toolkit/src/url-toolkit.js":function(I,M,i){(function(A){var u=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,r=/^([^\/?#]*)([^]*)$/,P=/(?:\/|^)\.(?=\/)/g,O=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,x={buildAbsoluteURL:function(m,c,v){if(v=v||{},m=m.trim(),c=c.trim(),!c){if(!v.alwaysNormalize)return m;var h=x.parseURL(m);if(!h)throw new Error("Error trying to parse base URL.");return h.path=x.normalizePath(h.path),x.buildURLFromParts(h)}var T=x.parseURL(c);if(!T)throw new Error("Error trying to parse relative URL.");if(T.scheme)return v.alwaysNormalize?(T.path=x.normalizePath(T.path),x.buildURLFromParts(T)):c;var L=x.parseURL(m);if(!L)throw new Error("Error trying to parse base URL.");if(!L.netLoc&&L.path&&L.path[0]!=="/"){var g=r.exec(L.path);L.netLoc=g[1],L.path=g[2]}L.netLoc&&!L.path&&(L.path="/");var o={scheme:L.scheme,netLoc:T.netLoc,path:null,params:T.params,query:T.query,fragment:T.fragment};if(!T.netLoc&&(o.netLoc=L.netLoc,T.path[0]!=="/"))if(!T.path)o.path=L.path,T.params||(o.params=L.params,T.query||(o.query=L.query));else{var t=L.path,a=t.substring(0,t.lastIndexOf("/")+1)+T.path;o.path=x.normalizePath(a)}return o.path===null&&(o.path=v.alwaysNormalize?x.normalizePath(T.path):T.path),x.buildURLFromParts(o)},parseURL:function(m){var c=u.exec(m);return c?{scheme:c[1]||"",netLoc:c[2]||"",path:c[3]||"",params:c[4]||"",query:c[5]||"",fragment:c[6]||""}:null},normalizePath:function(m){for(m=m.split("").reverse().join("").replace(P,"");m.length!==(m=m.replace(O,"")).length;);return m.split("").reverse().join("")},buildURLFromParts:function(m){return m.scheme+m.netLoc+m.path+m.params+m.query+m.fragment}};I.exports=x})()},"./node_modules/webworkify-webpack/index.js":function(I,M,i){function A(v){var h={};function T(g){if(h[g])return h[g].exports;var o=h[g]={i:g,l:!1,exports:{}};return v[g].call(o.exports,o,o.exports,T),o.l=!0,o.exports}T.m=v,T.c=h,T.i=function(g){return g},T.d=function(g,o,t){T.o(g,o)||Object.defineProperty(g,o,{configurable:!1,enumerable:!0,get:t})},T.r=function(g){Object.defineProperty(g,"__esModule",{value:!0})},T.n=function(g){var o=g&&g.__esModule?function(){return g.default}:function(){return g};return T.d(o,"a",o),o},T.o=function(g,o){return Object.prototype.hasOwnProperty.call(g,o)},T.p="/",T.oe=function(g){throw console.error(g),g};var L=T(T.s=ENTRY_MODULE);return L.default||L}var u="[\\.|\\-|\\+|\\w|/|@]+",r="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+u+").*?\\)";function P(v){return(v+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function O(v){return!isNaN(1*v)}function x(v,h,T){var L={};L[T]=[];var g=h.toString(),o=g.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!o)return L;for(var t=o[1],a=new RegExp("(\\\\n|\\W)"+P(t)+r,"g"),n;n=a.exec(g);)n[3]!=="dll-reference"&&L[T].push(n[3]);for(a=new RegExp("\\("+P(t)+'\\("(dll-reference\\s('+u+'))"\\)\\)'+r,"g");n=a.exec(g);)v[n[2]]||(L[T].push(n[1]),v[n[2]]=i(n[1]).m),L[n[2]]=L[n[2]]||[],L[n[2]].push(n[4]);for(var d=Object.keys(L),l=0;l<d.length;l++)for(var s=0;s<L[d[l]].length;s++)O(L[d[l]][s])&&(L[d[l]][s]=1*L[d[l]][s]);return L}function m(v){var h=Object.keys(v);return h.reduce(function(T,L){return T||v[L].length>0},!1)}function c(v,h){for(var T={main:[h]},L={main:[]},g={main:{}};m(T);)for(var o=Object.keys(T),t=0;t<o.length;t++){var a=o[t],n=T[a],d=n.pop();if(g[a]=g[a]||{},!(g[a][d]||!v[a][d])){g[a][d]=!0,L[a]=L[a]||[],L[a].push(d);for(var l=x(v,v[a][d],a),s=Object.keys(l),f=0;f<s.length;f++)T[s[f]]=T[s[f]]||[],T[s[f]]=T[s[f]].concat(l[s[f]])}}return L}I.exports=function(v,h){h=h||{};var T={main:i.m},L=h.all?{main:Object.keys(T.main)}:c(T,v),g="";Object.keys(L).filter(function(d){return d!=="main"}).forEach(function(d){for(var l=0;L[d][l];)l++;L[d].push(l),T[d][l]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",g=g+"var "+d+" = ("+A.toString().replace("ENTRY_MODULE",JSON.stringify(l))+")({"+L[d].map(function(s){return""+JSON.stringify(s)+": "+T[d][s].toString()}).join(",")+`});
`}),g=g+"new (("+A.toString().replace("ENTRY_MODULE",JSON.stringify(v))+")({"+L.main.map(function(d){return""+JSON.stringify(d)+": "+T.main[d].toString()}).join(",")+"}))(self);";var o=new window.Blob([g],{type:"text/javascript"});if(h.bare)return o;var t=window.URL||window.webkitURL||window.mozURL||window.msURL,a=t.createObjectURL(o),n=new window.Worker(a);return n.objectURL=a,n}},"./src/config.ts":function(I,M,i){i.r(M),i.d(M,"hlsDefaultConfig",function(){return f}),i.d(M,"mergeConfig",function(){return D}),i.d(M,"enableStreamingMode",function(){return E});var A=i("./src/controller/abr-controller.ts"),u=i("./src/controller/audio-stream-controller.ts"),r=i("./src/controller/audio-track-controller.ts"),P=i("./src/controller/subtitle-stream-controller.ts"),O=i("./src/controller/subtitle-track-controller.ts"),x=i("./src/controller/buffer-controller.ts"),m=i("./src/controller/timeline-controller.ts"),c=i("./src/controller/cap-level-controller.ts"),v=i("./src/controller/fps-controller.ts"),h=i("./src/controller/eme-controller.ts"),T=i("./src/controller/cmcd-controller.ts"),L=i("./src/utils/xhr-loader.ts"),g=i("./src/utils/fetch-loader.ts"),o=i("./src/utils/cues.ts"),t=i("./src/utils/mediakeys-helper.ts"),a=i("./src/utils/logger.ts");function n(){return n=Object.assign||function(p){for(var y=1;y<arguments.length;y++){var S=arguments[y];for(var R in S)Object.prototype.hasOwnProperty.call(S,R)&&(p[R]=S[R])}return p},n.apply(this,arguments)}function d(p,y){var S=Object.keys(p);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(p);y&&(R=R.filter(function(w){return Object.getOwnPropertyDescriptor(p,w).enumerable})),S.push.apply(S,R)}return S}function l(p){for(var y=1;y<arguments.length;y++){var S=arguments[y]!=null?arguments[y]:{};y%2?d(Object(S),!0).forEach(function(R){s(p,R,S[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(S)):d(Object(S)).forEach(function(R){Object.defineProperty(p,R,Object.getOwnPropertyDescriptor(S,R))})}return p}function s(p,y,S){return y in p?Object.defineProperty(p,y,{value:S,enumerable:!0,configurable:!0,writable:!0}):p[y]=S,p}var f=l(l({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:L.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:A.default,bufferController:x.default,capLevelController:c.default,fpsController:v.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:t.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0},C()),{},{subtitleStreamController:P.SubtitleStreamController,subtitleTrackController:O.default,timelineController:m.TimelineController,audioStreamController:u.default,audioTrackController:r.default,emeController:h.default,cmcdController:T.default});function C(){return{cueHandler:o.default,enableCEA708Captions:!0,enableWebVTT:!0,enableIMSC1:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function D(p,y){if((y.liveSyncDurationCount||y.liveMaxLatencyDurationCount)&&(y.liveSyncDuration||y.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(y.liveMaxLatencyDurationCount!==void 0&&(y.liveSyncDurationCount===void 0||y.liveMaxLatencyDurationCount<=y.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(y.liveMaxLatencyDuration!==void 0&&(y.liveSyncDuration===void 0||y.liveMaxLatencyDuration<=y.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return n({},p,y)}function E(p){var y=p.loader;if(y!==g.default&&y!==L.default)a.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),p.progressive=!1;else{var S=Object(g.fetchSupported)();S&&(p.loader=g.default,p.progressive=!0,p.enableSoftwareAES=!0,a.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}},"./src/controller/abr-controller.ts":function(I,M,i){i.r(M);var A=i("./src/polyfills/number.ts"),u=i("./src/utils/ewma-bandwidth-estimator.ts"),r=i("./src/events.ts"),P=i("./src/utils/buffer-helper.ts"),O=i("./src/errors.ts"),x=i("./src/types/loader.ts"),m=i("./src/utils/logger.ts");function c(T,L){for(var g=0;g<L.length;g++){var o=L[g];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(T,o.key,o)}}function v(T,L,g){return L&&c(T.prototype,L),g&&c(T,g),T}var h=function(){function T(g){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=g;var o=g.config;this.bwEstimator=new u.default(o.abrEwmaSlowVoD,o.abrEwmaFastVoD,o.abrEwmaDefaultEstimate),this.registerListeners()}var L=T.prototype;return L.registerListeners=function(){var o=this.hls;o.on(r.Events.FRAG_LOADING,this.onFragLoading,this),o.on(r.Events.FRAG_LOADED,this.onFragLoaded,this),o.on(r.Events.FRAG_BUFFERED,this.onFragBuffered,this),o.on(r.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(r.Events.ERROR,this.onError,this)},L.unregisterListeners=function(){var o=this.hls;o.off(r.Events.FRAG_LOADING,this.onFragLoading,this),o.off(r.Events.FRAG_LOADED,this.onFragLoaded,this),o.off(r.Events.FRAG_BUFFERED,this.onFragBuffered,this),o.off(r.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(r.Events.ERROR,this.onError,this)},L.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},L.onFragLoading=function(o,t){var a=t.frag;if(a.type===x.PlaylistLevelType.MAIN&&!this.timer){var n;this.fragCurrent=a,this.partCurrent=(n=t.part)!=null?n:null,this.timer=self.setInterval(this.onCheck,100)}},L.onLevelLoaded=function(o,t){var a=this.hls.config;t.details.live?this.bwEstimator.update(a.abrEwmaSlowLive,a.abrEwmaFastLive):this.bwEstimator.update(a.abrEwmaSlowVoD,a.abrEwmaFastVoD)},L._abandonRulesCheck=function(){var o=this.fragCurrent,t=this.partCurrent,a=this.hls,n=a.autoLevelEnabled,d=a.config,l=a.media;if(!(!o||!l)){var s=t?t.stats:o.stats,f=t?t.duration:o.duration;if(s.aborted){m.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!n||l.paused||!l.playbackRate||!l.readyState)){var C=performance.now()-s.loading.start,D=Math.abs(l.playbackRate);if(!(C<=500*f/D)){var E=a.levels,p=a.minAutoLevel,y=E[o.level],S=s.total||Math.max(s.loaded,Math.round(f*y.maxBitrate/8)),R=Math.max(1,s.bwEstimate?s.bwEstimate/8:s.loaded*1e3/C),w=(S-s.loaded)/R,k=l.currentTime,_=(P.BufferHelper.bufferInfo(l,k,d.maxBufferHole).end-k)/D;if(!(_>=2*f/D||w<=_)){var F=Number.POSITIVE_INFINITY,U;for(U=o.level-1;U>p;U--){var N=E[U].maxBitrate;if(F=f*N/(8*.8*R),F<_)break}if(!(F>=w)){var W=this.bwEstimator.getEstimate();m.logger.warn("Fragment "+o.sn+(t?" part "+t.index:"")+" of level "+o.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+U+`
      Current BW estimate: `+(Object(A.isFiniteNumber)(W)?(W/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+w.toFixed(3)+` s
      Estimated load time for the next fragment: `+F.toFixed(3)+` s
      Time to underbuffer: `+_.toFixed(3)+" s"),a.nextLoadLevel=U,this.bwEstimator.sample(C,s.loaded),this.clearTimer(),o.loader&&(this.fragCurrent=this.partCurrent=null,o.loader.abort()),a.trigger(r.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:o,part:t,stats:s})}}}}}},L.onFragLoaded=function(o,t){var a=t.frag,n=t.part;if(a.type===x.PlaylistLevelType.MAIN&&Object(A.isFiniteNumber)(a.sn)){var d=n?n.stats:a.stats,l=n?n.duration:a.duration;if(this.clearTimer(),this.lastLoadedFragLevel=a.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var s=this.hls.levels[a.level],f=(s.loaded?s.loaded.bytes:0)+d.loaded,C=(s.loaded?s.loaded.duration:0)+l;s.loaded={bytes:f,duration:C},s.realBitrate=Math.round(8*f/C)}if(a.bitrateTest){var D={stats:d,frag:a,part:n,id:a.type};this.onFragBuffered(r.Events.FRAG_BUFFERED,D),a.bitrateTest=!1}}},L.onFragBuffered=function(o,t){var a=t.frag,n=t.part,d=n?n.stats:a.stats;if(!d.aborted&&!(a.type!==x.PlaylistLevelType.MAIN||a.sn==="initSegment")){var l=d.parsing.end-d.loading.start;this.bwEstimator.sample(l,d.loaded),d.bwEstimate=this.bwEstimator.getEstimate(),a.bitrateTest?this.bitrateTestDelay=l/1e3:this.bitrateTestDelay=0}},L.onError=function(o,t){switch(t.details){case O.ErrorDetails.FRAG_LOAD_ERROR:case O.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},L.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},L.getNextABRAutoLevel=function(){var o=this.fragCurrent,t=this.partCurrent,a=this.hls,n=a.maxAutoLevel,d=a.config,l=a.minAutoLevel,s=a.media,f=t?t.duration:o?o.duration:0,C=s?s.currentTime:0,D=s&&s.playbackRate!==0?Math.abs(s.playbackRate):1,E=this.bwEstimator?this.bwEstimator.getEstimate():d.abrEwmaDefaultEstimate,p=(P.BufferHelper.bufferInfo(s,C,d.maxBufferHole).end-C)/D,y=this.findBestLevel(E,l,n,p,d.abrBandWidthFactor,d.abrBandWidthUpFactor);if(y>=0)return y;m.logger.trace((p?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var S=f?Math.min(f,d.maxStarvationDelay):d.maxStarvationDelay,R=d.abrBandWidthFactor,w=d.abrBandWidthUpFactor;if(!p){var k=this.bitrateTestDelay;if(k){var _=f?Math.min(f,d.maxLoadingDelay):d.maxLoadingDelay;S=_-k,m.logger.trace("bitrate test took "+Math.round(1e3*k)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*S)+" ms"),R=w=1}}return y=this.findBestLevel(E,l,n,p+S,R,w),Math.max(y,0)},L.findBestLevel=function(o,t,a,n,d,l){for(var s,f=this.fragCurrent,C=this.partCurrent,D=this.lastLoadedFragLevel,E=this.hls.levels,p=E[D],y=!!(p!=null&&(s=p.details)!==null&&s!==void 0&&s.live),S=p==null?void 0:p.codecSet,R=C?C.duration:f?f.duration:0,w=a;w>=t;w--){var k=E[w];if(!(!k||S&&k.codecSet!==S)){var _=k.details,F=(C?_==null?void 0:_.partTarget:_==null?void 0:_.averagetargetduration)||R,U=void 0;w<=D?U=d*o:U=l*o;var N=E[w].maxBitrate,W=N*F/U;if(m.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+w+"/"+Math.round(U)+"/"+N+"/"+F+"/"+n+"/"+W),U>N&&(!W||y&&!this.bitrateTestDelay||W<n))return w}}return-1},v(T,[{key:"nextAutoLevel",get:function(){var o=this._nextAutoLevel,t=this.bwEstimator;if(o!==-1&&(!t||!t.canEstimate()))return o;var a=this.getNextABRAutoLevel();return o!==-1&&(a=Math.min(o,a)),a},set:function(o){this._nextAutoLevel=o}}]),T}();M.default=h},"./src/controller/audio-stream-controller.ts":function(I,M,i){i.r(M);var A=i("./src/polyfills/number.ts"),u=i("./src/controller/base-stream-controller.ts"),r=i("./src/events.ts"),P=i("./src/utils/buffer-helper.ts"),O=i("./src/controller/fragment-tracker.ts"),x=i("./src/types/level.ts"),m=i("./src/types/loader.ts"),c=i("./src/loader/fragment.ts"),v=i("./src/demux/chunk-cache.ts"),h=i("./src/demux/transmuxer-interface.ts"),T=i("./src/types/transmuxer.ts"),L=i("./src/controller/fragment-finders.ts"),g=i("./src/utils/discontinuities.ts"),o=i("./src/errors.ts"),t=i("./src/utils/logger.ts");function a(){return a=Object.assign||function(f){for(var C=1;C<arguments.length;C++){var D=arguments[C];for(var E in D)Object.prototype.hasOwnProperty.call(D,E)&&(f[E]=D[E])}return f},a.apply(this,arguments)}function n(f,C){f.prototype=Object.create(C.prototype),f.prototype.constructor=f,d(f,C)}function d(f,C){return d=Object.setPrototypeOf||function(E,p){return E.__proto__=p,E},d(f,C)}var l=100,s=function(f){n(C,f);function C(E,p){var y;return y=f.call(this,E,p,"[audio-stream-controller]")||this,y.videoBuffer=null,y.videoTrackCC=-1,y.waitingVideoCC=-1,y.audioSwitch=!1,y.trackId=-1,y.waitingData=null,y.mainDetails=null,y.bufferFlushed=!1,y._registerListeners(),y}var D=C.prototype;return D.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},D._registerListeners=function(){var p=this.hls;p.on(r.Events.MEDIA_ATTACHED,this.onMediaAttached,this),p.on(r.Events.MEDIA_DETACHING,this.onMediaDetaching,this),p.on(r.Events.MANIFEST_LOADING,this.onManifestLoading,this),p.on(r.Events.LEVEL_LOADED,this.onLevelLoaded,this),p.on(r.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),p.on(r.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),p.on(r.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),p.on(r.Events.ERROR,this.onError,this),p.on(r.Events.BUFFER_RESET,this.onBufferReset,this),p.on(r.Events.BUFFER_CREATED,this.onBufferCreated,this),p.on(r.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),p.on(r.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),p.on(r.Events.FRAG_BUFFERED,this.onFragBuffered,this)},D._unregisterListeners=function(){var p=this.hls;p.off(r.Events.MEDIA_ATTACHED,this.onMediaAttached,this),p.off(r.Events.MEDIA_DETACHING,this.onMediaDetaching,this),p.off(r.Events.MANIFEST_LOADING,this.onManifestLoading,this),p.off(r.Events.LEVEL_LOADED,this.onLevelLoaded,this),p.off(r.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),p.off(r.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),p.off(r.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),p.off(r.Events.ERROR,this.onError,this),p.off(r.Events.BUFFER_RESET,this.onBufferReset,this),p.off(r.Events.BUFFER_CREATED,this.onBufferCreated,this),p.off(r.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),p.off(r.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),p.off(r.Events.FRAG_BUFFERED,this.onFragBuffered,this)},D.onInitPtsFound=function(p,y){var S=y.frag,R=y.id,w=y.initPTS;if(R==="main"){var k=S.cc;this.initPTS[S.cc]=w,this.log("InitPTS for cc: "+k+" found from main: "+w),this.videoTrackCC=k,this.state===u.State.WAITING_INIT_PTS&&this.tick()}},D.startLoad=function(p){if(!this.levels){this.startPosition=p,this.state=u.State.STOPPED;return}var y=this.lastCurrentTime;this.stopLoad(),this.setInterval(l),this.fragLoadError=0,y>0&&p===-1?(this.log("Override startPosition with lastCurrentTime @"+y.toFixed(3)),this.state=u.State.IDLE):(this.loadedmetadata=!1,this.state=u.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=p,this.tick()},D.doTick=function(){switch(this.state){case u.State.IDLE:this.doTickIdle();break;case u.State.WAITING_TRACK:{var p,y=this.levels,S=this.trackId,R=y==null||(p=y[S])===null||p===void 0?void 0:p.details;if(R){if(this.waitForCdnTuneIn(R))break;this.state=u.State.WAITING_INIT_PTS}break}case u.State.FRAG_LOADING_WAITING_RETRY:{var w,k=performance.now(),_=this.retryDate;(!_||k>=_||(w=this.media)!==null&&w!==void 0&&w.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=u.State.IDLE);break}case u.State.WAITING_INIT_PTS:{var F=this.waitingData;if(F){var U=F.frag,N=F.part,W=F.cache,H=F.complete;if(this.initPTS[U.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=u.State.FRAG_LOADING;var G=W.flush(),J={frag:U,part:N,payload:G,networkDetails:null};this._handleFragmentLoadProgress(J),H&&f.prototype._handleFragmentLoadComplete.call(this,J)}else if(this.videoTrackCC!==this.waitingVideoCC)t.logger.log("Waiting fragment cc ("+U.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var X=this.getLoadPosition(),te=P.BufferHelper.bufferInfo(this.mediaBuffer,X,this.config.maxBufferHole),le=Object(L.fragmentWithinToleranceTest)(te.end,this.config.maxFragLookUpTolerance,U);le<0&&(t.logger.log("Waiting fragment cc ("+U.cc+") @ "+U.start+" cancelled because another fragment at "+te.end+" is needed"),this.clearWaitingFragment())}}else this.state=u.State.IDLE}}this.onTickEnd()},D.clearWaitingFragment=function(){var p=this.waitingData;p&&(this.fragmentTracker.removeFragment(p.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=u.State.IDLE)},D.onTickEnd=function(){var p=this.media;if(!(!p||!p.readyState)){var y=this.mediaBuffer?this.mediaBuffer:p,S=y.buffered;!this.loadedmetadata&&S.length&&(this.loadedmetadata=!0),this.lastCurrentTime=p.currentTime}},D.doTickIdle=function(){var p,y,S=this.hls,R=this.levels,w=this.media,k=this.trackId,_=S.config;if(!(!R||!R[k])&&!(!w&&(this.startFragRequested||!_.startFragPrefetch))){var F=R[k],U=F.details;if(!U||U.live&&this.levelLastLoaded!==k||this.waitForCdnTuneIn(U)){this.state=u.State.WAITING_TRACK;return}this.bufferFlushed&&(this.bufferFlushed=!1,this.afterBufferFlushed(this.mediaBuffer?this.mediaBuffer:this.media,c.ElementaryStreamTypes.AUDIO,m.PlaylistLevelType.AUDIO));var N=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,m.PlaylistLevelType.AUDIO);if(N!==null){var W=N.len,H=this.getMaxBufferLength(),G=this.audioSwitch;if(!(W>=H&&!G)){if(!G&&this._streamEnded(N,U)){S.trigger(r.Events.BUFFER_EOS,{type:"audio"}),this.state=u.State.ENDED;return}var J=U.fragments,X=J[0].start,te=N.end;if(G){var le=this.getLoadPosition();te=le,U.PTSKnown&&le<X&&(N.end>X||N.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),w.currentTime=X+.05)}var re=this.getNextFragment(te,U);if(!re){this.bufferFlushed=!0;return}((p=re.decryptdata)===null||p===void 0?void 0:p.keyFormat)==="identity"&&!((y=re.decryptdata)!==null&&y!==void 0&&y.key)?this.loadKey(re,U):this.loadFragment(re,U,te)}}}},D.getMaxBufferLength=function(){var p=f.prototype.getMaxBufferLength.call(this),y=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,m.PlaylistLevelType.MAIN);return y===null?p:Math.max(p,y.len)},D.onMediaDetaching=function(){this.videoBuffer=null,f.prototype.onMediaDetaching.call(this)},D.onAudioTracksUpdated=function(p,y){var S=y.audioTracks;this.resetTransmuxer(),this.levels=S.map(function(R){return new x.Level(R)})},D.onAudioTrackSwitching=function(p,y){var S=!!y.url;this.trackId=y.id;var R=this.fragCurrent;R!=null&&R.loader&&R.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),S?this.setInterval(l):this.resetTransmuxer(),S?(this.audioSwitch=!0,this.state=u.State.IDLE):this.state=u.State.STOPPED,this.tick()},D.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},D.onLevelLoaded=function(p,y){this.mainDetails=y.details},D.onAudioTrackLoaded=function(p,y){var S,R=this.levels,w=y.details,k=y.id;if(!R){this.warn("Audio tracks were reset while loading level "+k);return}this.log("Track "+k+" loaded ["+w.startSN+","+w.endSN+"],duration:"+w.totalduration);var _=R[k],F=0;if(w.live||(S=_.details)!==null&&S!==void 0&&S.live){var U=this.mainDetails;if(w.fragments[0]||(w.deltaUpdateFailed=!0),w.deltaUpdateFailed||!U)return;!_.details&&w.hasProgramDateTime&&U.hasProgramDateTime?(Object(g.alignMediaPlaylistByPDT)(w,U),F=w.fragments[0].start):F=this.alignPlaylists(w,_.details)}_.details=w,this.levelLastLoaded=k,!this.startFragRequested&&(this.mainDetails||!w.live)&&this.setStartPosition(_.details,F),this.state===u.State.WAITING_TRACK&&!this.waitForCdnTuneIn(w)&&(this.state=u.State.IDLE),this.tick()},D._handleFragmentLoadProgress=function(p){var y,S=p.frag,R=p.part,w=p.payload,k=this.config,_=this.trackId,F=this.levels;if(!F){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+S.sn+" of level "+S.level+" will not be buffered");return}var U=F[_];console.assert(U,"Audio track is defined on fragment load progress");var N=U.details;console.assert(N,"Audio track details are defined on fragment load progress");var W=k.defaultAudioCodec||U.audioCodec||"mp4a.40.2",H=this.transmuxer;H||(H=this.transmuxer=new h.default(this.hls,m.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var G=this.initPTS[S.cc],J=(y=S.initSegment)===null||y===void 0?void 0:y.data;if(G!==void 0){var X=!1,te=R?R.index:-1,le=te!==-1,re=new T.ChunkMetadata(S.level,S.sn,S.stats.chunkCount,w.byteLength,te,le);H.push(w,J,W,"",S,R,N.totalduration,X,re,G)}else{t.logger.log("Unknown video PTS for cc "+S.cc+", waiting for video PTS before demuxing audio frag "+S.sn+" of ["+N.startSN+" ,"+N.endSN+"],track "+_);var fe=this.waitingData=this.waitingData||{frag:S,part:R,cache:new v.default,complete:!1},ue=fe.cache;ue.push(new Uint8Array(w)),this.waitingVideoCC=this.videoTrackCC,this.state=u.State.WAITING_INIT_PTS}},D._handleFragmentLoadComplete=function(p){if(this.waitingData){this.waitingData.complete=!0;return}f.prototype._handleFragmentLoadComplete.call(this,p)},D.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},D.onBufferCreated=function(p,y){var S=y.tracks.audio;S&&(this.mediaBuffer=S.buffer),y.tracks.video&&(this.videoBuffer=y.tracks.video.buffer)},D.onFragBuffered=function(p,y){var S=y.frag,R=y.part;if(S.type===m.PlaylistLevelType.AUDIO){if(this.fragContextChanged(S)){this.warn("Fragment "+S.sn+(R?" p: "+R.index:"")+" of level "+S.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}S.sn!=="initSegment"&&(this.fragPrevious=S,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(r.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(S,R)}},D.onError=function(p,y){switch(y.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:case o.ErrorDetails.KEY_LOAD_ERROR:case o.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(m.PlaylistLevelType.AUDIO,y);break;case o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==u.State.ERROR&&this.state!==u.State.STOPPED&&(this.state=y.fatal?u.State.ERROR:u.State.IDLE,this.warn(y.details+" while loading frag, switching to "+this.state+" state"));break;case o.ErrorDetails.BUFFER_FULL_ERROR:if(y.parent==="audio"&&(this.state===u.State.PARSING||this.state===u.State.PARSED)){var S=!0,R=this.getFwdBufferInfo(this.mediaBuffer,m.PlaylistLevelType.AUDIO);R&&R.len>.5&&(S=!this.reduceMaxBufferLength(R.len)),S&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,f.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break}},D.onBufferFlushed=function(p,y){var S=y.type;S===c.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},D._handleTransmuxComplete=function(p){var y,S="audio",R=this.hls,w=p.remuxResult,k=p.chunkMeta,_=this.getCurrentContext(k);if(!_){this.warn("The loading context changed while buffering fragment "+k.sn+" of level "+k.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(k.level);return}var F=_.frag,U=_.part,N=w.audio,W=w.text,H=w.id3,G=w.initSegment;if(!this.fragContextChanged(F)){if(this.state=u.State.PARSING,this.audioSwitch&&N&&this.completeAudioSwitch(),G!=null&&G.tracks&&(this._bufferInitSegment(G.tracks,F,k),R.trigger(r.Events.FRAG_PARSING_INIT_SEGMENT,{frag:F,id:S,tracks:G.tracks})),N){var J=N.startPTS,X=N.endPTS,te=N.startDTS,le=N.endDTS;U&&(U.elementaryStreams[c.ElementaryStreamTypes.AUDIO]={startPTS:J,endPTS:X,startDTS:te,endDTS:le}),F.setElementaryStreamInfo(c.ElementaryStreamTypes.AUDIO,J,X,te,le),this.bufferFragmentData(N,F,U,k)}if(H!=null&&(y=H.samples)!==null&&y!==void 0&&y.length){var re=a({frag:F,id:S},H);R.trigger(r.Events.FRAG_PARSING_METADATA,re)}if(W){var fe=a({frag:F,id:S},W);R.trigger(r.Events.FRAG_PARSING_USERDATA,fe)}}},D._bufferInitSegment=function(p,y,S){if(this.state===u.State.PARSING){p.video&&delete p.video;var R=p.audio;if(!!R){R.levelCodec=R.codec,R.id="audio",this.log("Init audio buffer, container:"+R.container+", codecs[parsed]=["+R.codec+"]"),this.hls.trigger(r.Events.BUFFER_CODECS,p);var w=R.initSegment;if(w!=null&&w.byteLength){var k={type:"audio",frag:y,part:null,chunkMeta:S,parent:y.type,data:w};this.hls.trigger(r.Events.BUFFER_APPENDING,k)}this.tick()}}},D.loadFragment=function(p,y,S){var R=this.fragmentTracker.getState(p);this.fragCurrent=p,(this.audioSwitch||R===O.FragmentState.NOT_LOADED||R===O.FragmentState.PARTIAL)&&(p.sn==="initSegment"?this._loadInitSegment(p):y.live&&!Object(A.isFiniteNumber)(this.initPTS[p.cc])?(this.log("Waiting for video PTS in continuity counter "+p.cc+" of live stream before loading audio fragment "+p.sn+" of level "+this.trackId),this.state=u.State.WAITING_INIT_PTS):(this.startFragRequested=!0,f.prototype.loadFragment.call(this,p,y,S)))},D.completeAudioSwitch=function(){var p=this.hls,y=this.media,S=this.trackId;y&&(this.log("Switching audio track : flushing all audio"),f.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,p.trigger(r.Events.AUDIO_TRACK_SWITCHED,{id:S})},C}(u.default);M.default=s},"./src/controller/audio-track-controller.ts":function(I,M,i){i.r(M);var A=i("./src/events.ts"),u=i("./src/errors.ts"),r=i("./src/controller/base-playlist-controller.ts"),P=i("./src/types/loader.ts");function O(h,T){for(var L=0;L<T.length;L++){var g=T[L];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(h,g.key,g)}}function x(h,T,L){return T&&O(h.prototype,T),L&&O(h,L),h}function m(h,T){h.prototype=Object.create(T.prototype),h.prototype.constructor=h,c(h,T)}function c(h,T){return c=Object.setPrototypeOf||function(g,o){return g.__proto__=o,g},c(h,T)}var v=function(h){m(T,h);function T(g){var o;return o=h.call(this,g,"[audio-track-controller]")||this,o.tracks=[],o.groupId=null,o.tracksInGroup=[],o.trackId=-1,o.trackName="",o.selectDefaultTrack=!0,o.registerListeners(),o}var L=T.prototype;return L.registerListeners=function(){var o=this.hls;o.on(A.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(A.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.on(A.Events.LEVEL_LOADING,this.onLevelLoading,this),o.on(A.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),o.on(A.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),o.on(A.Events.ERROR,this.onError,this)},L.unregisterListeners=function(){var o=this.hls;o.off(A.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(A.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.off(A.Events.LEVEL_LOADING,this.onLevelLoading,this),o.off(A.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),o.off(A.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),o.off(A.Events.ERROR,this.onError,this)},L.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,h.prototype.destroy.call(this)},L.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},L.onManifestParsed=function(o,t){this.tracks=t.audioTracks||[]},L.onAudioTrackLoaded=function(o,t){var a=t.id,n=t.details,d=this.tracksInGroup[a];if(!d){this.warn("Invalid audio track id "+a);return}var l=d.details;d.details=t.details,this.log("audioTrack "+a+" loaded ["+n.startSN+"-"+n.endSN+"]"),a===this.trackId&&(this.retryCount=0,this.playlistLoaded(a,t,l))},L.onLevelLoading=function(o,t){this.switchLevel(t.level)},L.onLevelSwitching=function(o,t){this.switchLevel(t.level)},L.switchLevel=function(o){var t=this.hls.levels[o];if(!!(t!=null&&t.audioGroupIds)){var a=t.audioGroupIds[t.urlId];if(this.groupId!==a){this.groupId=a;var n=this.tracks.filter(function(l){return!a||l.groupId===a});this.selectDefaultTrack&&!n.some(function(l){return l.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=n;var d={audioTracks:n};this.log("Updating audio tracks, "+n.length+' track(s) found in "'+a+'" group-id'),this.hls.trigger(A.Events.AUDIO_TRACKS_UPDATED,d),this.selectInitialTrack()}}},L.onError=function(o,t){h.prototype.onError.call(this,o,t),!(t.fatal||!t.context)&&t.context.type===P.PlaylistContextType.AUDIO_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.retryLoadingOrFail(t)},L.setAudioTrack=function(o){var t=this.tracksInGroup;if(o<0||o>=t.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var a=t[this.trackId];this.log("Now switching to audio-track index "+o);var n=t[o],d=n.id,l=n.groupId,s=l===void 0?"":l,f=n.name,C=n.type,D=n.url;if(this.trackId=o,this.trackName=f,this.selectDefaultTrack=!1,this.hls.trigger(A.Events.AUDIO_TRACK_SWITCHING,{id:d,groupId:s,name:f,type:C,url:D}),!(n.details&&!n.details.live)){var E=this.switchParams(n.url,a==null?void 0:a.details);this.loadPlaylist(E)}},L.selectInitialTrack=function(){var o=this.tracksInGroup;console.assert(o.length,"Initial audio track should be selected when tracks are known");var t=this.trackName,a=this.findTrackId(t)||this.findTrackId();a!==-1?this.setAudioTrack(a):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(A.Events.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},L.findTrackId=function(o){for(var t=this.tracksInGroup,a=0;a<t.length;a++){var n=t[a];if((!this.selectDefaultTrack||n.default)&&(!o||o===n.name))return n.id}return-1},L.loadPlaylist=function(o){var t=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(t)){var a=t.id,n=t.groupId,d=t.url;if(o)try{d=o.addDirectives(d)}catch(l){this.warn("Could not construct new URL with HLS Delivery Directives: "+l)}this.log("loading audio-track playlist for id: "+a),this.clearTimer(),this.hls.trigger(A.Events.AUDIO_TRACK_LOADING,{url:d,id:a,groupId:n,deliveryDirectives:o||null})}},x(T,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(o){this.selectDefaultTrack=!1,this.setAudioTrack(o)}}]),T}(r.default);M.default=v},"./src/controller/base-playlist-controller.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return x});var A=i("./src/polyfills/number.ts"),u=i("./src/types/level.ts"),r=i("./src/controller/level-helper.ts"),P=i("./src/utils/logger.ts"),O=i("./src/errors.ts"),x=function(){function m(v,h){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=P.logger.log.bind(P.logger,h+":"),this.warn=P.logger.warn.bind(P.logger,h+":"),this.hls=v}var c=m.prototype;return c.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},c.onError=function(h,T){T.fatal&&T.type===O.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},c.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},c.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},c.stopLoad=function(){this.canLoad=!1,this.clearTimer()},c.switchParams=function(h,T){var L=T==null?void 0:T.renditionReports;if(L)for(var g=0;g<L.length;g++){var o=L[g],t=""+o.URI;if(t===h.substr(-t.length)){var a=parseInt(o["LAST-MSN"]),n=parseInt(o["LAST-PART"]);if(T&&this.hls.config.lowLatencyMode){var d=Math.min(T.age-T.partTarget,T.targetduration);n!==void 0&&d>T.partTarget&&(n+=1)}if(Object(A.isFiniteNumber)(a))return new u.HlsUrlParameters(a,Object(A.isFiniteNumber)(n)?n:void 0,u.HlsSkip.No)}}},c.loadPlaylist=function(h){},c.shouldLoadTrack=function(h){return this.canLoad&&h&&!!h.url&&(!h.details||h.details.live)},c.playlistLoaded=function(h,T,L){var g=this,o=T.details,t=T.stats,a=t.loading.end?Math.max(0,self.performance.now()-t.loading.end):0;if(o.advancedDateTime=Date.now()-a,o.live||L!=null&&L.live){if(o.reloaded(L),L&&this.log("live playlist "+h+" "+(o.advanced?"REFRESHED "+o.lastPartSn+"-"+o.lastPartIndex:"MISSED")),L&&o.fragments.length>0&&Object(r.mergeDetails)(L,o),!this.canLoad||!o.live)return;var n,d=void 0,l=void 0;if(o.canBlockReload&&o.endSN&&o.advanced){var s=this.hls.config.lowLatencyMode,f=o.lastPartSn,C=o.endSN,D=o.lastPartIndex,E=D!==-1,p=f===C,y=s?0:D;E?(d=p?C+1:f,l=p?y:D+1):d=C+1;var S=o.age,R=S+o.ageHeader,w=Math.min(R-o.partTarget,o.targetduration*1.5);if(w>0){if(L&&w>L.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+L.tuneInGoal+" to: "+w+" with playlist age: "+o.age),w=0;else{var k=Math.floor(w/o.targetduration);if(d+=k,l!==void 0){var _=Math.round(w%o.targetduration/o.partTarget);l+=_}this.log("CDN Tune-in age: "+o.ageHeader+"s last advanced "+S.toFixed(2)+"s goal: "+w+" skip sn "+k+" to part "+l)}o.tuneInGoal=w}if(n=this.getDeliveryDirectives(o,T.deliveryDirectives,d,l),s||!p){this.loadPlaylist(n);return}}else n=this.getDeliveryDirectives(o,T.deliveryDirectives,d,l);var F=Object(r.computeReloadInterval)(o,t);d!==void 0&&o.canBlockReload&&(F-=o.partTarget||1),this.log("reload live playlist "+h+" in "+Math.round(F)+" ms"),this.timer=self.setTimeout(function(){return g.loadPlaylist(n)},F)}else this.clearTimer()},c.getDeliveryDirectives=function(h,T,L,g){var o=Object(u.getSkipValue)(h,L);return T!=null&&T.skip&&h.deltaUpdateFailed&&(L=T.msn,g=T.part,o=u.HlsSkip.No),new u.HlsUrlParameters(L,g,o)},c.retryLoadingOrFail=function(h){var T=this,L=this.hls.config,g=this.retryCount<L.levelLoadingMaxRetry;if(g){var o;if(this.retryCount++,h.details.indexOf("LoadTimeOut")>-1&&(o=h.context)!==null&&o!==void 0&&o.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+h.details+'"'),this.loadPlaylist();else{var t=Math.min(Math.pow(2,this.retryCount)*L.levelLoadingRetryDelay,L.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return T.loadPlaylist()},t),this.warn("retry playlist loading #"+this.retryCount+" in "+t+' ms after "'+h.details+'"')}}else this.warn('cannot recover from error "'+h.details+'"'),this.clearTimer(),h.fatal=!0;return g},m}()},"./src/controller/base-stream-controller.ts":function(I,M,i){i.r(M),i.d(M,"State",function(){return C}),i.d(M,"default",function(){return D});var A=i("./src/polyfills/number.ts"),u=i("./src/task-loop.ts"),r=i("./src/controller/fragment-tracker.ts"),P=i("./src/utils/buffer-helper.ts"),O=i("./src/utils/logger.ts"),x=i("./src/events.ts"),m=i("./src/errors.ts"),c=i("./src/types/transmuxer.ts"),v=i("./src/utils/mp4-tools.ts"),h=i("./src/utils/discontinuities.ts"),T=i("./src/controller/fragment-finders.ts"),L=i("./src/controller/level-helper.ts"),g=i("./src/loader/fragment-loader.ts"),o=i("./src/crypt/decrypter.ts"),t=i("./src/utils/time-ranges.ts"),a=i("./src/types/loader.ts");function n(E,p){for(var y=0;y<p.length;y++){var S=p[y];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(E,S.key,S)}}function d(E,p,y){return p&&n(E.prototype,p),y&&n(E,y),E}function l(E){if(E===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E}function s(E,p){E.prototype=Object.create(p.prototype),E.prototype.constructor=E,f(E,p)}function f(E,p){return f=Object.setPrototypeOf||function(S,R){return S.__proto__=R,S},f(E,p)}var C={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BACKTRACKING:"BACKTRACKING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},D=function(E){s(p,E);function p(S,R,w){var k;return k=E.call(this)||this,k.hls=void 0,k.fragPrevious=null,k.fragCurrent=null,k.fragmentTracker=void 0,k.transmuxer=null,k._state=C.STOPPED,k.media=void 0,k.mediaBuffer=void 0,k.config=void 0,k.bitrateTest=!1,k.lastCurrentTime=0,k.nextLoadPosition=0,k.startPosition=0,k.loadedmetadata=!1,k.fragLoadError=0,k.retryDate=0,k.levels=null,k.fragmentLoader=void 0,k.levelLastLoaded=null,k.startFragRequested=!1,k.decrypter=void 0,k.initPTS=[],k.onvseeking=null,k.onvended=null,k.logPrefix="",k.log=void 0,k.warn=void 0,k.logPrefix=w,k.log=O.logger.log.bind(O.logger,w+":"),k.warn=O.logger.warn.bind(O.logger,w+":"),k.hls=S,k.fragmentLoader=new g.default(S.config),k.fragmentTracker=R,k.config=S.config,k.decrypter=new o.default(S,S.config),S.on(x.Events.KEY_LOADED,k.onKeyLoaded,l(k)),k}var y=p.prototype;return y.doTick=function(){this.onTickEnd()},y.onTickEnd=function(){},y.startLoad=function(R){},y.stopLoad=function(){this.fragmentLoader.abort();var R=this.fragCurrent;R&&this.fragmentTracker.removeFragment(R),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=C.STOPPED},y._streamEnded=function(R,w){var k=this.fragCurrent,_=this.fragmentTracker;if(!w.live&&k&&k.sn>=w.endSN&&!R.nextStart){var F=w.partList;if(F!=null&&F.length){var U=F[F.length-1],N=P.BufferHelper.isBuffered(this.media,U.start+U.duration/2);return N}var W=_.getState(k);return W===r.FragmentState.PARTIAL||W===r.FragmentState.OK}return!1},y.onMediaAttached=function(R,w){var k=this.media=this.mediaBuffer=w.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),k.addEventListener("seeking",this.onvseeking),k.addEventListener("ended",this.onvended);var _=this.config;this.levels&&_.autoStartLoad&&this.state===C.STOPPED&&this.startLoad(_.startPosition)},y.onMediaDetaching=function(){var R=this.media;R!=null&&R.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),R&&(R.removeEventListener("seeking",this.onvseeking),R.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},y.onMediaSeeking=function(){var R=this.config,w=this.fragCurrent,k=this.media,_=this.mediaBuffer,F=this.state,U=k?k.currentTime:0,N=P.BufferHelper.bufferInfo(_||k,U,R.maxBufferHole);if(this.log("media seeking to "+(Object(A.isFiniteNumber)(U)?U.toFixed(3):U)+", state: "+F),F===C.ENDED)this.resetLoadingState();else if(w&&!N.len){var W=R.maxFragLookUpTolerance,H=w.start-W,G=w.start+w.duration+W,J=U>G;(U<H||J)&&(J&&w.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),w.loader.abort()),this.resetLoadingState())}k&&(this.lastCurrentTime=U),!this.loadedmetadata&&!N.len&&(this.nextLoadPosition=this.startPosition=U),this.tickImmediate()},y.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},y.onKeyLoaded=function(R,w){if(!(this.state!==C.KEY_LOADING||w.frag!==this.fragCurrent||!this.levels)){this.state=C.IDLE;var k=this.levels[w.frag.level].details;k&&this.loadFragment(w.frag,k,w.frag.start)}},y.onHandlerDestroying=function(){this.stopLoad(),E.prototype.onHandlerDestroying.call(this)},y.onHandlerDestroyed=function(){this.state=C.STOPPED,this.hls.off(x.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,E.prototype.onHandlerDestroyed.call(this)},y.loadKey=function(R,w){this.log("Loading key for "+R.sn+" of ["+w.startSN+"-"+w.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+R.level),this.state=C.KEY_LOADING,this.fragCurrent=R,this.hls.trigger(x.Events.KEY_LOADING,{frag:R})},y.loadFragment=function(R,w,k){this._loadFragForPlayback(R,w,k)},y._loadFragForPlayback=function(R,w,k){var _=this,F=function(N){if(_.fragContextChanged(R)){_.warn("Fragment "+R.sn+(N.part?" p: "+N.part.index:"")+" of level "+R.level+" was dropped during download."),_.fragmentTracker.removeFragment(R);return}R.stats.chunkCount++,_._handleFragmentLoadProgress(N)};this._doFragLoad(R,w,k,F).then(function(U){if(!!U){_.fragLoadError=0;var N=_.state;if(_.fragContextChanged(R)){(N===C.FRAG_LOADING||N===C.BACKTRACKING||!_.fragCurrent&&N===C.PARSING)&&(_.fragmentTracker.removeFragment(R),_.state=C.IDLE);return}if("payload"in U&&(_.log("Loaded fragment "+R.sn+" of level "+R.level),_.hls.trigger(x.Events.FRAG_LOADED,U),_.state===C.BACKTRACKING)){_.fragmentTracker.backtrack(R,U),_.resetFragmentLoading(R);return}_._handleFragmentLoadComplete(U)}}).catch(function(U){_.warn(U),_.resetFragmentLoading(R)})},y.flushMainBuffer=function(R,w,k){if(k===void 0&&(k=null),!!(R-w)){var _={startOffset:R,endOffset:w,type:k};this.fragLoadError=0,this.hls.trigger(x.Events.BUFFER_FLUSHING,_)}},y._loadInitSegment=function(R){var w=this;this._doFragLoad(R).then(function(k){if(!k||w.fragContextChanged(R)||!w.levels)throw new Error("init load aborted");return k}).then(function(k){var _=w.hls,F=k.payload,U=R.decryptdata;if(F&&F.byteLength>0&&U&&U.key&&U.iv&&U.method==="AES-128"){var N=self.performance.now();return w.decrypter.webCryptoDecrypt(new Uint8Array(F),U.key.buffer,U.iv.buffer).then(function(W){var H=self.performance.now();return _.trigger(x.Events.FRAG_DECRYPTED,{frag:R,payload:W,stats:{tstart:N,tdecrypt:H}}),k.payload=W,k})}return k}).then(function(k){var _=w.fragCurrent,F=w.hls,U=w.levels;if(!U)throw new Error("init load aborted, missing levels");var N=U[R.level].details;console.assert(N,"Level details are defined when init segment is loaded");var W=R.stats;w.state=C.IDLE,w.fragLoadError=0,R.data=new Uint8Array(k.payload),W.parsing.start=W.buffering.start=self.performance.now(),W.parsing.end=W.buffering.end=self.performance.now(),k.frag===_&&F.trigger(x.Events.FRAG_BUFFERED,{stats:W,frag:_,part:null,id:R.type}),w.tick()}).catch(function(k){w.warn(k),w.resetFragmentLoading(R)})},y.fragContextChanged=function(R){var w=this.fragCurrent;return!R||!w||R.level!==w.level||R.sn!==w.sn||R.urlId!==w.urlId},y.fragBufferedComplete=function(R,w){var k=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+R.type+" sn: "+R.sn+(w?" part: "+w.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+R.level+" "+t.default.toString(P.BufferHelper.getBuffered(k))),this.state=C.IDLE,this.tick()},y._handleFragmentLoadComplete=function(R){var w=this.transmuxer;if(!!w){var k=R.frag,_=R.part,F=R.partsLoaded,U=!F||F.length===0||F.some(function(W){return!W}),N=new c.ChunkMetadata(k.level,k.sn,k.stats.chunkCount+1,0,_?_.index:-1,!U);w.flush(N)}},y._handleFragmentLoadProgress=function(R){},y._doFragLoad=function(R,w,k,_){var F=this;if(k===void 0&&(k=null),!this.levels)throw new Error("frag load aborted, missing levels");if(k=Math.max(R.start,k||0),this.config.lowLatencyMode&&w){var U=w.partList;if(U&&_){k>R.end&&w.fragmentHint&&(R=w.fragmentHint);var N=this.getNextPart(U,R,k);if(N>-1){var W=U[N];return this.log("Loading part sn: "+R.sn+" p: "+W.index+" cc: "+R.cc+" of playlist ["+w.startSN+"-"+w.endSN+"] parts [0-"+N+"-"+(U.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+R.level+", target: "+parseFloat(k.toFixed(3))),this.nextLoadPosition=W.start+W.duration,this.state=C.FRAG_LOADING,this.hls.trigger(x.Events.FRAG_LOADING,{frag:R,part:U[N],targetBufferTime:k}),this.doFragPartsLoad(R,U,N,_).catch(function(H){return F.handleFragLoadError(H)})}else if(!R.url||this.loadedEndOfParts(U,k))return Promise.resolve(null)}}return this.log("Loading fragment "+R.sn+" cc: "+R.cc+" "+(w?"of ["+w.startSN+"-"+w.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+R.level+", target: "+parseFloat(k.toFixed(3))),Object(A.isFiniteNumber)(R.sn)&&!this.bitrateTest&&(this.nextLoadPosition=R.start+R.duration),this.state=C.FRAG_LOADING,this.hls.trigger(x.Events.FRAG_LOADING,{frag:R,targetBufferTime:k}),this.fragmentLoader.load(R,_).catch(function(H){return F.handleFragLoadError(H)})},y.doFragPartsLoad=function(R,w,k,_){var F=this;return new Promise(function(U,N){var W=[],H=function G(J){var X=w[J];F.fragmentLoader.loadPart(R,X,_).then(function(te){W[X.index]=te;var le=te.part;F.hls.trigger(x.Events.FRAG_LOADED,te);var re=w[J+1];if(re&&re.fragment===R)G(J+1);else return U({frag:R,part:le,partsLoaded:W})}).catch(N)};H(k)})},y.handleFragLoadError=function(R){var w=R.data;return w&&w.details===m.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(w.frag,w.part):this.hls.trigger(x.Events.ERROR,w),null},y._handleTransmuxerFlush=function(R){var w=this.getCurrentContext(R);if(!w||this.state!==C.PARSING){this.fragCurrent||(this.state=C.IDLE);return}var k=w.frag,_=w.part,F=w.level,U=self.performance.now();k.stats.parsing.end=U,_&&(_.stats.parsing.end=U),this.updateLevelTiming(k,_,F,R.partial)},y.getCurrentContext=function(R){var w=this.levels,k=R.level,_=R.sn,F=R.part;if(!w||!w[k])return this.warn("Levels object was unset while buffering fragment "+_+" of level "+k+". The current chunk will not be buffered."),null;var U=w[k],N=F>-1?Object(L.getPartWith)(U,_,F):null,W=N?N.fragment:Object(L.getFragmentWithSN)(U,_,this.fragCurrent);return W?{frag:W,part:N,level:U}:null},y.bufferFragmentData=function(R,w,k,_){if(!(!R||this.state!==C.PARSING)){var F=R.data1,U=R.data2,N=F;if(F&&U&&(N=Object(v.appendUint8Array)(F,U)),!(!N||!N.length)){var W={type:R.type,frag:w,part:k,chunkMeta:_,parent:w.type,data:N};this.hls.trigger(x.Events.BUFFER_APPENDING,W),R.dropped&&R.independent&&!k&&this.flushBufferGap(w)}}},y.flushBufferGap=function(R){var w=this.media;if(!!w){if(!P.BufferHelper.isBuffered(w,w.currentTime)){this.flushMainBuffer(0,R.start);return}var k=w.currentTime,_=P.BufferHelper.bufferInfo(w,k,0),F=R.duration,U=Math.min(this.config.maxFragLookUpTolerance*2,F*.25),N=Math.max(Math.min(R.start-U,_.end-U),k+U);R.start-N>U&&this.flushMainBuffer(N,R.start)}},y.getFwdBufferInfo=function(R,w){var k=this.config,_=this.getLoadPosition();if(!Object(A.isFiniteNumber)(_))return null;var F=P.BufferHelper.bufferInfo(R,_,k.maxBufferHole);if(F.len===0&&F.nextStart!==void 0){var U=this.fragmentTracker.getBufferedFrag(_,w);if(U&&F.nextStart<U.end)return P.BufferHelper.bufferInfo(R,_,Math.max(F.nextStart,k.maxBufferHole))}return F},y.getMaxBufferLength=function(R){var w=this.config,k;return R?k=Math.max(8*w.maxBufferSize/R,w.maxBufferLength):k=w.maxBufferLength,Math.min(k,w.maxMaxBufferLength)},y.reduceMaxBufferLength=function(R){var w=this.config,k=R||w.maxBufferLength;return w.maxMaxBufferLength>=k?(w.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+w.maxMaxBufferLength+"s"),!0):!1},y.getNextFragment=function(R,w){var k,_,F=w.fragments,U=F.length;if(!U)return null;var N=this.config,W=F[0].start,H;if(w.live){var G=N.initialLiveManifestSize;if(U<G)return this.warn("Not enough fragments to start playback (have: "+U+", need: "+G+")"),null;!w.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(H=this.getInitialLiveFragment(w,F),this.startPosition=H?this.hls.liveSyncPosition||H.start:R)}else R<=W&&(H=F[0]);if(!H){var J=N.lowLatencyMode?w.partEnd:w.fragmentEnd;H=this.getFragmentAtPosition(R,J,w)}return(k=H)!==null&&k!==void 0&&k.initSegment&&!((_=H)!==null&&_!==void 0&&_.initSegment.data)&&!this.bitrateTest&&(H=H.initSegment),H},y.getNextPart=function(R,w,k){for(var _=-1,F=!1,U=!0,N=0,W=R.length;N<W;N++){var H=R[N];if(U=U&&!H.independent,_>-1&&k<H.start)break;var G=H.loaded;!G&&(F||H.independent||U)&&H.fragment===w&&(_=N),F=G}return _},y.loadedEndOfParts=function(R,w){var k=R[R.length-1];return k&&w>k.start&&k.loaded},y.getInitialLiveFragment=function(R,w){var k=this.fragPrevious,_=null;if(k){if(R.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+k.programDateTime),_=Object(T.findFragmentByPDT)(w,k.endProgramDateTime,this.config.maxFragLookUpTolerance)),!_){var F=k.sn+1;if(F>=R.startSN&&F<=R.endSN){var U=w[F-R.startSN];k.cc===U.cc&&(_=U,this.log("Live playlist, switching playlist, load frag with next SN: "+_.sn))}_||(_=Object(T.findFragWithCC)(w,k.cc),_&&this.log("Live playlist, switching playlist, load frag with same CC: "+_.sn))}}else{var N=this.hls.liveSyncPosition;N!==null&&(_=this.getFragmentAtPosition(N,this.bitrateTest?R.fragmentEnd:R.edge,R))}return _},y.getFragmentAtPosition=function(R,w,k){var _=this.config,F=this.fragPrevious,U=k.fragments,N=k.endSN,W=k.fragmentHint,H=_.maxFragLookUpTolerance,G=!!(_.lowLatencyMode&&k.partList&&W);G&&W&&!this.bitrateTest&&(U=U.concat(W),N=W.sn);var J;if(R<w){var X=R>w-H?0:H;J=Object(T.findFragmentByPTS)(F,U,R,X)}else J=U[U.length-1];if(J){var te=J.sn-k.startSN,le=F&&J.level===F.level,re=U[te+1],fe=this.fragmentTracker.getState(J);if(fe===r.FragmentState.BACKTRACKED){J=null;for(var ue=te;U[ue]&&this.fragmentTracker.getState(U[ue])===r.FragmentState.BACKTRACKED;)F?J=U[ue--]:J=U[--ue];J||(J=re)}else F&&J.sn===F.sn&&!G&&le&&(J.sn<N&&this.fragmentTracker.getState(re)!==r.FragmentState.OK?(this.log("SN "+J.sn+" just loaded, load next one: "+re.sn),J=re):J=null)}return J},y.synchronizeToLiveEdge=function(R){var w=this.config,k=this.media;if(!!k){var _=this.hls.liveSyncPosition,F=k.currentTime,U=R.fragments[0].start,N=R.edge,W=F>=U-w.maxFragLookUpTolerance&&F<=N;if(_!==null&&k.duration>_&&(F<_||!W)){var H=w.liveMaxLatencyDuration!==void 0?w.liveMaxLatencyDuration:w.liveMaxLatencyDurationCount*R.targetduration;(!W&&k.readyState<4||F<N-H)&&(this.loadedmetadata||(this.nextLoadPosition=_),k.readyState&&(this.warn("Playback: "+F.toFixed(3)+" is located too far from the end of live sliding playlist: "+N+", reset currentTime to : "+_.toFixed(3)),k.currentTime=_))}}},y.alignPlaylists=function(R,w){var k=this.levels,_=this.levelLastLoaded,F=this.fragPrevious,U=_!==null?k[_]:null,N=R.fragments.length;if(!N)return this.warn("No fragments in live playlist"),0;var W=R.fragments[0].start,H=!w,G=R.alignedSliding&&Object(A.isFiniteNumber)(W);if(H||!G&&!W){Object(h.alignStream)(F,U,R);var J=R.fragments[0].start;return this.log("Live playlist sliding: "+J.toFixed(2)+" start-sn: "+(w?w.startSN:"na")+"->"+R.startSN+" prev-sn: "+(F?F.sn:"na")+" fragments: "+N),J}return W},y.waitForCdnTuneIn=function(R){var w=3;return R.live&&R.canBlockReload&&R.tuneInGoal>Math.max(R.partHoldBack,R.partTarget*w)},y.setStartPosition=function(R,w){var k=this.startPosition;if(k<w&&(k=-1),k===-1||this.lastCurrentTime===-1){var _=R.startTimeOffset;Object(A.isFiniteNumber)(_)?(k=w+_,_<0&&(k+=R.totalduration),k=Math.min(Math.max(w,k),w+R.totalduration),this.log("Start time offset "+_+" found in playlist, adjust startPosition to "+k),this.startPosition=k):R.live?k=this.hls.liveSyncPosition||w:this.startPosition=k=0,this.lastCurrentTime=k}this.nextLoadPosition=k},y.getLoadPosition=function(){var R=this.media,w=0;return this.loadedmetadata&&R?w=R.currentTime:this.nextLoadPosition&&(w=this.nextLoadPosition),w},y.handleFragLoadAborted=function(R,w){this.transmuxer&&R.sn!=="initSegment"&&R.stats.aborted&&(this.warn("Fragment "+R.sn+(w?" part"+w.index:"")+" of level "+R.level+" was aborted"),this.resetFragmentLoading(R))},y.resetFragmentLoading=function(R){(!this.fragCurrent||!this.fragContextChanged(R))&&(this.state=C.IDLE)},y.onFragmentOrKeyLoadError=function(R,w){if(!w.fatal){var k=w.frag;if(!(!k||k.type!==R)){var _=this.fragCurrent;console.assert(_&&k.sn===_.sn&&k.level===_.level&&k.urlId===_.urlId,"Frag load error must match current frag to retry");var F=this.config;if(this.fragLoadError+1<=F.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(k.level))return;var U=Math.min(Math.pow(2,this.fragLoadError)*F.fragLoadingRetryDelay,F.fragLoadingMaxRetryTimeout);this.warn("Fragment "+k.sn+" of "+R+" "+k.level+" failed to load, retrying in "+U+"ms"),this.retryDate=self.performance.now()+U,this.fragLoadError++,this.state=C.FRAG_LOADING_WAITING_RETRY}else w.levelRetry?(R===a.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=C.IDLE):(O.logger.error(w.details+" reaches max retry, redispatch as fatal ..."),w.fatal=!0,this.hls.stopLoad(),this.state=C.ERROR)}}},y.afterBufferFlushed=function(R,w,k){if(!!R){var _=P.BufferHelper.getBuffered(R);this.fragmentTracker.detectEvictedFragments(w,_,k),this.state===C.ENDED&&this.resetLoadingState()}},y.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=C.IDLE},y.resetLiveStartWhenNotLoaded=function(R){if(!this.loadedmetadata){this.startFragRequested=!1;var w=this.levels?this.levels[R].details:null;if(w!=null&&w.live)return this.startPosition=-1,this.setStartPosition(w,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},y.updateLevelTiming=function(R,w,k,_){var F=this,U=k.details;console.assert(!!U,"level.details must be defined");var N=Object.keys(R.elementaryStreams).reduce(function(W,H){var G=R.elementaryStreams[H];if(G){var J=G.endPTS-G.startPTS;if(J<=0)return F.warn("Could not parse fragment "+R.sn+" "+H+" duration reliably ("+J+") resetting transmuxer to fallback to playlist timing"),F.resetTransmuxer(),W||!1;var X=_?0:Object(L.updateFragPTSDTS)(U,R,G.startPTS,G.endPTS,G.startDTS,G.endDTS);return F.hls.trigger(x.Events.LEVEL_PTS_UPDATED,{details:U,level:k,drift:X,type:H,frag:R,start:G.startPTS,end:G.endPTS}),!0}return W},!1);N?(this.state=C.PARSED,this.hls.trigger(x.Events.FRAG_PARSED,{frag:R,part:w})):this.resetLoadingState()},y.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},d(p,[{key:"state",get:function(){return this._state},set:function(R){var w=this._state;w!==R&&(this._state=R,this.log(w+"->"+R))}}]),p}(u.default)},"./src/controller/buffer-controller.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return T});var A=i("./src/polyfills/number.ts"),u=i("./src/events.ts"),r=i("./src/utils/logger.ts"),P=i("./src/errors.ts"),O=i("./src/utils/buffer-helper.ts"),x=i("./src/utils/mediasource-helper.ts"),m=i("./src/loader/fragment.ts"),c=i("./src/controller/buffer-operation-queue.ts"),v=Object(x.getMediaSource)(),h=/([ha]vc.)(?:\.[^.,]+)+/,T=function(){function L(o){var t=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var a=t.hls,n=t.media,d=t.mediaSource;r.logger.log("[buffer-controller]: Media source opened"),n&&(t.updateMediaElementDuration(),a.trigger(u.Events.MEDIA_ATTACHED,{media:n})),d&&d.removeEventListener("sourceopen",t._onMediaSourceOpen),t.checkPendingTracks()},this._onMediaSourceClose=function(){r.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){r.logger.log("[buffer-controller]: Media source ended")},this.hls=o,this._initSourceBuffer(),this.registerListeners()}var g=L.prototype;return g.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},g.destroy=function(){this.unregisterListeners(),this.details=null},g.registerListeners=function(){var t=this.hls;t.on(u.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(u.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(u.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(u.Events.BUFFER_RESET,this.onBufferReset,this),t.on(u.Events.BUFFER_APPENDING,this.onBufferAppending,this),t.on(u.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.on(u.Events.BUFFER_EOS,this.onBufferEos,this),t.on(u.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(u.Events.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(u.Events.FRAG_PARSED,this.onFragParsed,this),t.on(u.Events.FRAG_CHANGED,this.onFragChanged,this)},g.unregisterListeners=function(){var t=this.hls;t.off(u.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(u.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(u.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(u.Events.BUFFER_RESET,this.onBufferReset,this),t.off(u.Events.BUFFER_APPENDING,this.onBufferAppending,this),t.off(u.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.off(u.Events.BUFFER_EOS,this.onBufferEos,this),t.off(u.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(u.Events.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(u.Events.FRAG_PARSED,this.onFragParsed,this),t.off(u.Events.FRAG_CHANGED,this.onFragChanged,this)},g._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new c.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},g.onManifestParsed=function(t,a){var n=2;(a.audio&&!a.video||!a.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.details=null,r.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},g.onMediaAttaching=function(t,a){var n=this.media=a.media;if(n&&v){var d=this.mediaSource=new v;d.addEventListener("sourceopen",this._onMediaSourceOpen),d.addEventListener("sourceended",this._onMediaSourceEnded),d.addEventListener("sourceclose",this._onMediaSourceClose),n.src=self.URL.createObjectURL(d),this._objectUrl=n.src}},g.onMediaDetaching=function(){var t=this.media,a=this.mediaSource,n=this._objectUrl;if(a){if(r.logger.log("[buffer-controller]: media source detaching"),a.readyState==="open")try{a.endOfStream()}catch(d){r.logger.warn("[buffer-controller]: onMediaDetaching: "+d.message+" while calling endOfStream")}this.onBufferReset(),a.removeEventListener("sourceopen",this._onMediaSourceOpen),a.removeEventListener("sourceended",this._onMediaSourceEnded),a.removeEventListener("sourceclose",this._onMediaSourceClose),t&&(n&&self.URL.revokeObjectURL(n),t.src===n?(t.removeAttribute("src"),t.load()):r.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(u.Events.MEDIA_DETACHED,void 0)},g.onBufferReset=function(){var t=this;this.getSourceBufferTypes().forEach(function(a){var n=t.sourceBuffer[a];try{n&&(t.removeBufferListeners(a),t.mediaSource&&t.mediaSource.removeSourceBuffer(n),t.sourceBuffer[a]=void 0)}catch(d){r.logger.warn("[buffer-controller]: Failed to reset the "+a+" buffer",d)}}),this._initSourceBuffer()},g.onBufferCodecs=function(t,a){var n=this,d=this.getSourceBufferTypes().length;Object.keys(a).forEach(function(l){if(d){var s=n.tracks[l];if(s&&typeof s.buffer.changeType=="function"){var f=a[l],C=f.codec,D=f.levelCodec,E=f.container,p=(s.levelCodec||s.codec).replace(h,"$1"),y=(D||C).replace(h,"$1");if(p!==y){var S=E+";codecs="+(D||C);n.appendChangeType(l,S)}}}else n.pendingTracks[l]=a[l]}),!d&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},g.appendChangeType=function(t,a){var n=this,d=this.operationQueue,l={execute:function(){var f=n.sourceBuffer[t];f&&(r.logger.log("[buffer-controller]: changing "+t+" sourceBuffer type to "+a),f.changeType(a)),d.shiftAndExecuteNext(t)},onStart:function(){},onComplete:function(){},onError:function(f){r.logger.warn("[buffer-controller]: Failed to change "+t+" SourceBuffer type",f)}};d.append(l,t)},g.onBufferAppending=function(t,a){var n=this,d=this.hls,l=this.operationQueue,s=this.tracks,f=a.data,C=a.type,D=a.frag,E=a.part,p=a.chunkMeta,y=p.buffering[C],S=self.performance.now();y.start=S;var R=D.stats.buffering,w=E?E.stats.buffering:null;R.start===0&&(R.start=S),w&&w.start===0&&(w.start=S);var k=s.audio,_=C==="audio"&&p.id===1&&(k==null?void 0:k.container)==="audio/mpeg",F={execute:function(){if(y.executeStart=self.performance.now(),_){var N=n.sourceBuffer[C];if(N){var W=D.start-N.timestampOffset;Math.abs(W)>=.1&&(r.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+D.start+" (delta: "+W+") sn: "+D.sn+")"),N.timestampOffset=D.start)}}n.appendExecutor(f,C)},onStart:function(){},onComplete:function(){var N=self.performance.now();y.executeEnd=y.end=N,R.first===0&&(R.first=N),w&&w.first===0&&(w.first=N);var W=n.sourceBuffer,H={};for(var G in W)H[G]=O.BufferHelper.getBuffered(W[G]);n.appendError=0,n.hls.trigger(u.Events.BUFFER_APPENDED,{type:C,frag:D,part:E,chunkMeta:p,parent:D.type,timeRanges:H})},onError:function(N){r.logger.error("[buffer-controller]: Error encountered while trying to append to the "+C+" SourceBuffer",N);var W={type:P.ErrorTypes.MEDIA_ERROR,parent:D.type,details:P.ErrorDetails.BUFFER_APPEND_ERROR,err:N,fatal:!1};N.code===DOMException.QUOTA_EXCEEDED_ERR?W.details=P.ErrorDetails.BUFFER_FULL_ERROR:(n.appendError++,W.details=P.ErrorDetails.BUFFER_APPEND_ERROR,n.appendError>d.config.appendErrorMaxRetry&&(r.logger.error("[buffer-controller]: Failed "+d.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),W.fatal=!0)),d.trigger(u.Events.ERROR,W)}};l.append(F,C)},g.onBufferFlushing=function(t,a){var n=this,d=this.operationQueue,l=function(f){return{execute:n.removeExecutor.bind(n,f,a.startOffset,a.endOffset),onStart:function(){},onComplete:function(){n.hls.trigger(u.Events.BUFFER_FLUSHED,{type:f})},onError:function(D){r.logger.warn("[buffer-controller]: Failed to remove from "+f+" SourceBuffer",D)}}};a.type?d.append(l(a.type),a.type):this.getSourceBufferTypes().forEach(function(s){d.append(l(s),s)})},g.onFragParsed=function(t,a){var n=this,d=a.frag,l=a.part,s=[],f=l?l.elementaryStreams:d.elementaryStreams;f[m.ElementaryStreamTypes.AUDIOVIDEO]?s.push("audiovideo"):(f[m.ElementaryStreamTypes.AUDIO]&&s.push("audio"),f[m.ElementaryStreamTypes.VIDEO]&&s.push("video"));var C=function(){var E=self.performance.now();d.stats.buffering.end=E,l&&(l.stats.buffering.end=E);var p=l?l.stats:d.stats;n.hls.trigger(u.Events.FRAG_BUFFERED,{frag:d,part:l,stats:p,id:d.type})};s.length===0&&r.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+d.type+" level: "+d.level+" sn: "+d.sn),this.blockBuffers(C,s)},g.onFragChanged=function(t,a){this.flushBackBuffer()},g.onBufferEos=function(t,a){var n=this,d=this.getSourceBufferTypes().reduce(function(l,s){var f=n.sourceBuffer[s];return(!a.type||a.type===s)&&f&&!f.ended&&(f.ended=!0,r.logger.log("[buffer-controller]: "+s+" sourceBuffer now EOS")),l&&!!(!f||f.ended)},!0);d&&this.blockBuffers(function(){var l=n.mediaSource;!l||l.readyState!=="open"||l.endOfStream()})},g.onLevelUpdated=function(t,a){var n=a.details;!n.fragments.length||(this.details=n,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},g.flushBackBuffer=function(){var t=this.hls,a=this.details,n=this.media,d=this.sourceBuffer;if(!(!n||a===null)){var l=this.getSourceBufferTypes();if(!!l.length){var s=a.live&&t.config.liveBackBufferLength!==null?t.config.liveBackBufferLength:t.config.backBufferLength;if(!(!Object(A.isFiniteNumber)(s)||s<0)){var f=n.currentTime,C=a.levelTargetDuration,D=Math.max(s,C),E=Math.floor(f/C)*C-D;l.forEach(function(p){var y=d[p];if(y){var S=O.BufferHelper.getBuffered(y);S.length>0&&E>S.start(0)&&(t.trigger(u.Events.BACK_BUFFER_REACHED,{bufferEnd:E}),a.live&&t.trigger(u.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:E}),t.trigger(u.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:E,type:p}))}})}}}},g.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var t=this.details,a=this.hls,n=this.media,d=this.mediaSource,l=t.fragments[0].start+t.totalduration,s=n.duration,f=Object(A.isFiniteNumber)(d.duration)?d.duration:0;t.live&&a.config.liveDurationInfinity?(r.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),d.duration=1/0,this.updateSeekableRange(t)):(l>f&&l>s||!Object(A.isFiniteNumber)(s))&&(r.logger.log("[buffer-controller]: Updating Media Source duration to "+l.toFixed(3)),d.duration=l)}},g.updateSeekableRange=function(t){var a=this.mediaSource,n=t.fragments,d=n.length;if(d&&t.live&&a!==null&&a!==void 0&&a.setLiveSeekableRange){var l=Math.max(0,n[0].start),s=Math.max(l,l+t.totalduration);a.setLiveSeekableRange(l,s)}},g.checkPendingTracks=function(){var t=this.bufferCodecEventsExpected,a=this.operationQueue,n=this.pendingTracks,d=Object.keys(n).length;if(d&&!t||d===2){this.createSourceBuffers(n),this.pendingTracks={};var l=this.getSourceBufferTypes();if(l.length===0){this.hls.trigger(u.Events.ERROR,{type:P.ErrorTypes.MEDIA_ERROR,details:P.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}l.forEach(function(s){a.executeNext(s)})}},g.createSourceBuffers=function(t){var a=this.sourceBuffer,n=this.mediaSource;if(!n)throw Error("createSourceBuffers called when mediaSource was null");var d=0;for(var l in t)if(!a[l]){var s=t[l];if(!s)throw Error("source buffer exists for track "+l+", however track does not");var f=s.levelCodec||s.codec,C=s.container+";codecs="+f;r.logger.log("[buffer-controller]: creating sourceBuffer("+C+")");try{var D=a[l]=n.addSourceBuffer(C),E=l;this.addBufferListener(E,"updatestart",this._onSBUpdateStart),this.addBufferListener(E,"updateend",this._onSBUpdateEnd),this.addBufferListener(E,"error",this._onSBUpdateError),this.tracks[l]={buffer:D,codec:f,container:s.container,levelCodec:s.levelCodec,id:s.id},d++}catch(p){r.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+p.message),this.hls.trigger(u.Events.ERROR,{type:P.ErrorTypes.MEDIA_ERROR,details:P.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:p,mimeType:C})}}d&&this.hls.trigger(u.Events.BUFFER_CREATED,{tracks:this.tracks})},g._onSBUpdateStart=function(t){var a=this.operationQueue,n=a.current(t);n.onStart()},g._onSBUpdateEnd=function(t){var a=this.operationQueue,n=a.current(t);n.onComplete(),a.shiftAndExecuteNext(t)},g._onSBUpdateError=function(t,a){r.logger.error("[buffer-controller]: "+t+" SourceBuffer error",a),this.hls.trigger(u.Events.ERROR,{type:P.ErrorTypes.MEDIA_ERROR,details:P.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var n=this.operationQueue.current(t);n&&n.onError(a)},g.removeExecutor=function(t,a,n){var d=this.media,l=this.mediaSource,s=this.operationQueue,f=this.sourceBuffer,C=f[t];if(!d||!l||!C){r.logger.warn("[buffer-controller]: Attempting to remove from the "+t+" SourceBuffer, but it does not exist"),s.shiftAndExecuteNext(t);return}var D=Object(A.isFiniteNumber)(d.duration)?d.duration:1/0,E=Object(A.isFiniteNumber)(l.duration)?l.duration:1/0,p=Math.max(0,a),y=Math.min(n,D,E);y>p?(r.logger.log("[buffer-controller]: Removing ["+p+","+y+"] from the "+t+" SourceBuffer"),console.assert(!C.updating,t+" sourceBuffer must not be updating"),C.remove(p,y)):s.shiftAndExecuteNext(t)},g.appendExecutor=function(t,a){var n=this.operationQueue,d=this.sourceBuffer,l=d[a];if(!l){r.logger.warn("[buffer-controller]: Attempting to append to the "+a+" SourceBuffer, but it does not exist"),n.shiftAndExecuteNext(a);return}l.ended=!1,console.assert(!l.updating,a+" sourceBuffer must not be updating"),l.appendBuffer(t)},g.blockBuffers=function(t,a){var n=this;if(a===void 0&&(a=this.getSourceBufferTypes()),!a.length){r.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve(t);return}var d=this.operationQueue,l=a.map(function(s){return d.appendBlocker(s)});Promise.all(l).then(function(){t(),a.forEach(function(s){var f=n.sourceBuffer[s];(!f||!f.updating)&&d.shiftAndExecuteNext(s)})})},g.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},g.addBufferListener=function(t,a,n){var d=this.sourceBuffer[t];if(!!d){var l=n.bind(this,t);this.listeners[t].push({event:a,listener:l}),d.addEventListener(a,l)}},g.removeBufferListeners=function(t){var a=this.sourceBuffer[t];!a||this.listeners[t].forEach(function(n){a.removeEventListener(n.event,n.listener)})},L}()},"./src/controller/buffer-operation-queue.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return u});var A=i("./src/utils/logger.ts"),u=function(){function r(O){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=O}var P=r.prototype;return P.append=function(x,m){var c=this.queues[m];c.push(x),c.length===1&&this.buffers[m]&&this.executeNext(m)},P.insertAbort=function(x,m){var c=this.queues[m];c.unshift(x),this.executeNext(m)},P.appendBlocker=function(x){var m,c=new Promise(function(h){m=h}),v={execute:m,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(v,x),c},P.executeNext=function(x){var m=this.buffers,c=this.queues,v=m[x],h=c[x];if(h.length){var T=h[0];try{T.execute()}catch(L){A.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),T.onError(L),(!v||!v.updating)&&(h.shift(),this.executeNext(x))}}},P.shiftAndExecuteNext=function(x){this.queues[x].shift(),this.executeNext(x)},P.current=function(x){return this.queues[x][0]},r}()},"./src/controller/cap-level-controller.ts":function(I,M,i){i.r(M);var A=i("./src/events.ts");function u(O,x){for(var m=0;m<x.length;m++){var c=x[m];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(O,c.key,c)}}function r(O,x,m){return x&&u(O.prototype,x),m&&u(O,m),O}var P=function(){function O(m){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=m,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var x=O.prototype;return x.setStreamController=function(c){this.streamController=c},x.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},x.registerListeners=function(){var c=this.hls;c.on(A.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),c.on(A.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),c.on(A.Events.MANIFEST_PARSED,this.onManifestParsed,this),c.on(A.Events.BUFFER_CODECS,this.onBufferCodecs,this),c.on(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},x.unregisterListener=function(){var c=this.hls;c.off(A.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),c.off(A.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),c.off(A.Events.MANIFEST_PARSED,this.onManifestParsed,this),c.off(A.Events.BUFFER_CODECS,this.onBufferCodecs,this),c.off(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},x.onFpsDropLevelCapping=function(c,v){O.isLevelAllowed(v.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(v.droppedLevel)},x.onMediaAttaching=function(c,v){this.media=v.media instanceof HTMLVideoElement?v.media:null},x.onManifestParsed=function(c,v){var h=this.hls;this.restrictedLevels=[],this.firstLevel=v.firstLevel,h.config.capLevelToPlayerSize&&v.video&&this.startCapping()},x.onBufferCodecs=function(c,v){var h=this.hls;h.config.capLevelToPlayerSize&&v.video&&this.startCapping()},x.onMediaDetaching=function(){this.stopCapping()},x.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var c=this.hls.levels;if(c.length){var v=this.hls;v.autoLevelCapping=this.getMaxLevel(c.length-1),v.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=v.autoLevelCapping}}},x.getMaxLevel=function(c){var v=this,h=this.hls.levels;if(!h.length)return-1;var T=h.filter(function(L,g){return O.isLevelAllowed(g,v.restrictedLevels)&&g<=c});return this.clientRect=null,O.getMaxLevelByMediaSize(T,this.mediaWidth,this.mediaHeight)},x.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},x.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},x.getDimensions=function(){if(this.clientRect)return this.clientRect;var c=this.media,v={width:0,height:0};if(c){var h=c.getBoundingClientRect();v.width=h.width,v.height=h.height,!v.width&&!v.height&&(v.width=h.right-h.left||c.width||0,v.height=h.bottom-h.top||c.height||0)}return this.clientRect=v,v},O.isLevelAllowed=function(c,v){return v===void 0&&(v=[]),v.indexOf(c)===-1},O.getMaxLevelByMediaSize=function(c,v,h){if(!c||!c.length)return-1;for(var T=function(a,n){return n?a.width!==n.width||a.height!==n.height:!0},L=c.length-1,g=0;g<c.length;g+=1){var o=c[g];if((o.width>=v||o.height>=h)&&T(o,c[g+1])){L=g;break}}return L},r(O,[{key:"mediaWidth",get:function(){return this.getDimensions().width*O.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*O.contentScaleFactor}}],[{key:"contentScaleFactor",get:function(){var c=1;try{c=self.devicePixelRatio}catch{}return c}}]),O}();M.default=P},"./src/controller/cmcd-controller.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return T});var A=i("./src/events.ts"),u=i("./src/types/cmcd.ts"),r=i("./src/utils/buffer-helper.ts"),P=i("./src/utils/logger.ts");function O(L,g){for(var o=0;o<g.length;o++){var t=g[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(L,t.key,t)}}function x(L,g,o){return g&&O(L.prototype,g),o&&O(L,o),L}function m(L,g){var o=typeof Symbol!="undefined"&&L[Symbol.iterator]||L["@@iterator"];if(o)return(o=o.call(L)).next.bind(o);if(Array.isArray(L)||(o=c(L))||g&&L&&typeof L.length=="number"){o&&(L=o);var t=0;return function(){return t>=L.length?{done:!0}:{done:!1,value:L[t++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c(L,g){if(!!L){if(typeof L=="string")return v(L,g);var o=Object.prototype.toString.call(L).slice(8,-1);if(o==="Object"&&L.constructor&&(o=L.constructor.name),o==="Map"||o==="Set")return Array.from(L);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return v(L,g)}}function v(L,g){(g==null||g>L.length)&&(g=L.length);for(var o=0,t=new Array(g);o<g;o++)t[o]=L[o];return t}function h(){return h=Object.assign||function(L){for(var g=1;g<arguments.length;g++){var o=arguments[g];for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(L[t]=o[t])}return L},h.apply(this,arguments)}var T=function(){function L(o){var t=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){t.initialized&&(t.starved=!0),t.buffering=!0},this.onPlaying=function(){t.initialized||(t.initialized=!0),t.buffering=!1},this.applyPlaylistData=function(d){try{t.apply(d,{ot:u.CMCDObjectType.MANIFEST,su:!t.initialized})}catch(l){P.logger.warn("Could not generate manifest CMCD data.",l)}},this.applyFragmentData=function(d){try{var l=d.frag,s=t.hls.levels[l.level],f=t.getObjectType(l),C={d:l.duration*1e3,ot:f};(f===u.CMCDObjectType.VIDEO||f===u.CMCDObjectType.AUDIO||f==u.CMCDObjectType.MUXED)&&(C.br=s.bitrate/1e3,C.tb=t.getTopBandwidth(f)/1e3,C.bl=t.getBufferLength(f)),t.apply(d,C)}catch(D){P.logger.warn("Could not generate segment CMCD data.",D)}},this.hls=o;var a=this.config=o.config,n=a.cmcd;n!=null&&(a.pLoader=this.createPlaylistLoader(),a.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||L.uuid(),this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.registerListeners())}var g=L.prototype;return g.registerListeners=function(){var t=this.hls;t.on(A.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(A.Events.MEDIA_DETACHED,this.onMediaDetached,this),t.on(A.Events.BUFFER_CREATED,this.onBufferCreated,this)},g.unregisterListeners=function(){var t=this.hls;t.off(A.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(A.Events.MEDIA_DETACHED,this.onMediaDetached,this),t.off(A.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},g.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},g.onMediaAttached=function(t,a){this.media=a.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},g.onMediaDetached=function(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},g.onBufferCreated=function(t,a){var n,d;this.audioBuffer=(n=a.tracks.audio)===null||n===void 0?void 0:n.buffer,this.videoBuffer=(d=a.tracks.video)===null||d===void 0?void 0:d.buffer},g.createData=function(){var t;return{v:u.CMCDVersion,sf:u.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(t=this.media)===null||t===void 0?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},g.apply=function(t,a){a===void 0&&(a={}),h(a,this.createData());var n=a.ot===u.CMCDObjectType.INIT||a.ot===u.CMCDObjectType.VIDEO||a.ot===u.CMCDObjectType.MUXED;if(this.starved&&n&&(a.bs=!0,a.su=!0,this.starved=!1),a.su==null&&(a.su=this.buffering),this.useHeaders){var d=L.toHeaders(a);if(!Object.keys(d).length)return;t.headers||(t.headers={}),h(t.headers,d)}else{var l=L.toQuery(a);if(!l)return;t.url=L.appendQueryToUri(t.url,l)}},g.getObjectType=function(t){var a=t.type;if(a==="subtitle")return u.CMCDObjectType.TIMED_TEXT;if(t.sn==="initSegment")return u.CMCDObjectType.INIT;if(a==="audio")return u.CMCDObjectType.AUDIO;if(a==="main")return this.hls.audioTracks.length?u.CMCDObjectType.VIDEO:u.CMCDObjectType.MUXED},g.getTopBandwidth=function(t){var a=0,n,d=this.hls;if(t===u.CMCDObjectType.AUDIO)n=d.audioTracks;else{var l=d.maxAutoLevel,s=l>-1?l+1:d.levels.length;n=d.levels.slice(0,s)}for(var f=m(n),C;!(C=f()).done;){var D=C.value;D.bitrate>a&&(a=D.bitrate)}return a>0?a:NaN},g.getBufferLength=function(t){var a=this.hls.media,n=t===u.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!n||!a)return NaN;var d=r.BufferHelper.bufferInfo(n,a.currentTime,this.config.maxBufferHole);return d.len*1e3},g.createPlaylistLoader=function(){var t=this.config.pLoader,a=this.applyPlaylistData,n=t||this.config.loader;return function(){function d(s){this.loader=void 0,this.loader=new n(s)}var l=d.prototype;return l.destroy=function(){this.loader.destroy()},l.abort=function(){this.loader.abort()},l.load=function(f,C,D){a(f),this.loader.load(f,C,D)},x(d,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),d}()},g.createFragmentLoader=function(){var t=this.config.fLoader,a=this.applyFragmentData,n=t||this.config.loader;return function(){function d(s){this.loader=void 0,this.loader=new n(s)}var l=d.prototype;return l.destroy=function(){this.loader.destroy()},l.abort=function(){this.loader.abort()},l.load=function(f,C,D){a(f),this.loader.load(f,C,D)},x(d,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),d}()},L.uuid=function(){var t=URL.createObjectURL(new Blob),a=t.toString();return URL.revokeObjectURL(t),a.substr(a.lastIndexOf("/")+1)},L.serialize=function(t){for(var a=[],n=function(_){return!Number.isNaN(_)&&_!=null&&_!==""&&_!==!1},d=function(_){return Math.round(_)},l=function(_){return d(_/100)*100},s=function(_){return encodeURIComponent(_)},f={br:d,d,bl:l,dl:l,mtp:l,nor:s,rtp:l,tb:d},C=Object.keys(t||{}).sort(),D=m(C),E;!(E=D()).done;){var p=E.value,y=t[p];if(!!n(y)&&!(p==="v"&&y===1)&&!(p=="pr"&&y===1)){var S=f[p];S&&(y=S(y));var R=typeof y,w=void 0;p==="ot"||p==="sf"||p==="st"?w=p+"="+y:R==="boolean"?w=p:R==="number"?w=p+"="+y:w=p+"="+JSON.stringify(y),a.push(w)}}return a.join(",")},L.toHeaders=function(t){for(var a=Object.keys(t),n={},d=["Object","Request","Session","Status"],l=[{},{},{},{}],s={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},f=0,C=a;f<C.length;f++){var D=C[f],E=s[D]!=null?s[D]:1;l[E][D]=t[D]}for(var p=0;p<l.length;p++){var y=L.serialize(l[p]);y&&(n["CMCD-"+d[p]]=y)}return n},L.toQuery=function(t){return"CMCD="+encodeURIComponent(L.serialize(t))},L.appendQueryToUri=function(t,a){if(!a)return t;var n=t.includes("?")?"&":"?";return""+t+n+a},L}()},"./src/controller/eme-controller.ts":function(I,M,i){i.r(M);var A=i("./src/events.ts"),u=i("./src/errors.ts"),r=i("./src/utils/logger.ts"),P=i("./src/utils/mediakeys-helper.ts");function O(T,L){for(var g=0;g<L.length;g++){var o=L[g];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(T,o.key,o)}}function x(T,L,g){return L&&O(T.prototype,L),g&&O(T,g),T}var m=3,c=function(L,g,o){var t={audioCapabilities:[],videoCapabilities:[]};return L.forEach(function(a){t.audioCapabilities.push({contentType:'audio/mp4; codecs="'+a+'"',robustness:o.audioRobustness||""})}),g.forEach(function(a){t.videoCapabilities.push({contentType:'video/mp4; codecs="'+a+'"',robustness:o.videoRobustness||""})}),[t]},v=function(L,g,o,t){switch(L){case P.KeySystems.WIDEVINE:return c(g,o,t);default:throw new Error("Unknown key-system: "+L)}},h=function(){function T(g){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=g,this._config=g.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var L=T.prototype;return L.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},L._registerListeners=function(){this.hls.on(A.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(A.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(A.Events.MANIFEST_PARSED,this.onManifestParsed,this)},L._unregisterListeners=function(){this.hls.off(A.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(A.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(A.Events.MANIFEST_PARSED,this.onManifestParsed,this)},L.getLicenseServerUrl=function(o){switch(o){case P.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+o+'"')},L._attemptKeySystemAccess=function(o,t,a){var n=this,d=v(o,t,a,this._drmSystemOptions);r.logger.log("Requesting encrypted media key-system access");var l=this.requestMediaKeySystemAccess(o,d);this.mediaKeysPromise=l.then(function(s){return n._onMediaKeySystemAccessObtained(o,s)}),l.catch(function(s){r.logger.error('Failed to obtain key-system "'+o+'" access:',s)})},L._onMediaKeySystemAccessObtained=function(o,t){var a=this;r.logger.log('Access for key-system "'+o+'" obtained');var n={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:o};this._mediaKeysList.push(n);var d=Promise.resolve().then(function(){return t.createMediaKeys()}).then(function(l){return n.mediaKeys=l,r.logger.log('Media-keys created for key-system "'+o+'"'),a._onMediaKeysCreated(),l});return d.catch(function(l){r.logger.error("Failed to create media-keys:",l)}),d},L._onMediaKeysCreated=function(){var o=this;this._mediaKeysList.forEach(function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),o._onNewMediaKeySession(t.mediaKeysSession))})},L._onNewMediaKeySession=function(o){var t=this;r.logger.log("New key-system session "+o.sessionId),o.addEventListener("message",function(a){t._onKeySessionMessage(o,a.message)},!1)},L._onKeySessionMessage=function(o,t){r.logger.log("Got EME message event, creating license request"),this._requestLicense(t,function(a){r.logger.log("Received license data (length: "+(a&&a.byteLength)+"), updating key-session"),o.update(a)})},L.onMediaEncrypted=function(o){var t=this;if(r.logger.log('Media is encrypted using "'+o.initDataType+'" init data type'),!this.mediaKeysPromise){r.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),this.hls.trigger(A.Events.ERROR,{type:u.ErrorTypes.KEY_SYSTEM_ERROR,details:u.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var a=function(d){!t._media||(t._attemptSetMediaKeys(d),t._generateRequestWithPreferredKeySession(o.initDataType,o.initData))};this.mediaKeysPromise.then(a).catch(a)},L._attemptSetMediaKeys=function(o){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var t=this._mediaKeysList[0];if(!t||!t.mediaKeys){r.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(A.Events.ERROR,{type:u.ErrorTypes.KEY_SYSTEM_ERROR,details:u.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}r.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(t.mediaKeys),this._hasSetMediaKeys=!0}},L._generateRequestWithPreferredKeySession=function(o,t){var a=this,n=this._mediaKeysList[0];if(!n){r.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(A.Events.ERROR,{type:u.ErrorTypes.KEY_SYSTEM_ERROR,details:u.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(n.mediaKeysSessionInitialized){r.logger.warn("Key-Session already initialized but requested again");return}var d=n.mediaKeysSession;if(!d){r.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(A.Events.ERROR,{type:u.ErrorTypes.KEY_SYSTEM_ERROR,details:u.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!t){r.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(A.Events.ERROR,{type:u.ErrorTypes.KEY_SYSTEM_ERROR,details:u.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}r.logger.log('Generating key-session request for "'+o+'" init data type'),n.mediaKeysSessionInitialized=!0,d.generateRequest(o,t).then(function(){r.logger.debug("Key-session generation succeeded")}).catch(function(l){r.logger.error("Error generating key-session request:",l),a.hls.trigger(A.Events.ERROR,{type:u.ErrorTypes.KEY_SYSTEM_ERROR,details:u.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},L._createLicenseXhr=function(o,t,a){var n=new XMLHttpRequest;n.responseType="arraybuffer",n.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,n,o,t,a);var d=this._licenseXhrSetup;if(d)try{d.call(this.hls,n,o),d=void 0}catch(l){r.logger.error(l)}try{n.readyState||n.open("POST",o,!0),d&&d.call(this.hls,n,o)}catch(l){throw new Error("issue setting up KeySystem license XHR "+l)}return n},L._onLicenseRequestReadyStageChange=function(o,t,a,n){switch(o.readyState){case 4:if(o.status===200){this._requestLicenseFailureCount=0,r.logger.log("License request succeeded");var d=o.response,l=this._licenseResponseCallback;if(l)try{d=l.call(this.hls,o,t)}catch(f){r.logger.error(f)}n(d)}else{if(r.logger.error("License Request XHR failed ("+t+"). Status: "+o.status+" ("+o.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>m){this.hls.trigger(A.Events.ERROR,{type:u.ErrorTypes.KEY_SYSTEM_ERROR,details:u.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var s=m-this._requestLicenseFailureCount+1;r.logger.warn("Retrying license request, "+s+" attempts left"),this._requestLicense(a,n)}break}},L._generateLicenseRequestChallenge=function(o,t){switch(o.mediaKeySystemDomain){case P.KeySystems.WIDEVINE:return t}throw new Error("unsupported key-system: "+o.mediaKeySystemDomain)},L._requestLicense=function(o,t){r.logger.log("Requesting content license for key-system");var a=this._mediaKeysList[0];if(!a){r.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(A.Events.ERROR,{type:u.ErrorTypes.KEY_SYSTEM_ERROR,details:u.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var n=this.getLicenseServerUrl(a.mediaKeySystemDomain),d=this._createLicenseXhr(n,o,t);r.logger.log("Sending license request to URL: "+n);var l=this._generateLicenseRequestChallenge(a,o);d.send(l)}catch(s){r.logger.error("Failure requesting DRM license: "+s),this.hls.trigger(A.Events.ERROR,{type:u.ErrorTypes.KEY_SYSTEM_ERROR,details:u.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},L.onMediaAttached=function(o,t){if(!!this._emeEnabled){var a=t.media;this._media=a,a.addEventListener("encrypted",this._onMediaEncrypted)}},L.onMediaDetached=function(){var o=this._media,t=this._mediaKeysList;!o||(o.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(t.map(function(a){if(a.mediaKeysSession)return a.mediaKeysSession.close().catch(function(){})})).then(function(){return o.setMediaKeys(null)}).catch(function(){}))},L.onManifestParsed=function(o,t){if(!!this._emeEnabled){var a=t.levels.map(function(d){return d.audioCodec}).filter(function(d){return!!d}),n=t.levels.map(function(d){return d.videoCodec}).filter(function(d){return!!d});this._attemptKeySystemAccess(P.KeySystems.WIDEVINE,a,n)}},x(T,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),T}();M.default=h},"./src/controller/fps-controller.ts":function(I,M,i){i.r(M);var A=i("./src/events.ts"),u=i("./src/utils/logger.ts"),r=function(){function P(x){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=x,this.registerListeners()}var O=P.prototype;return O.setStreamController=function(m){this.streamController=m},O.registerListeners=function(){this.hls.on(A.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},O.unregisterListeners=function(){this.hls.off(A.Events.MEDIA_ATTACHING,this.onMediaAttaching)},O.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},O.onMediaAttaching=function(m,c){var v=this.hls.config;if(v.capLevelOnFPSDrop){var h=c.media instanceof self.HTMLVideoElement?c.media:null;this.media=h,h&&typeof h.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),v.fpsDroppedMonitoringPeriod)}},O.checkFPS=function(m,c,v){var h=performance.now();if(c){if(this.lastTime){var T=h-this.lastTime,L=v-this.lastDroppedFrames,g=c-this.lastDecodedFrames,o=1e3*L/T,t=this.hls;if(t.trigger(A.Events.FPS_DROP,{currentDropped:L,currentDecoded:g,totalDroppedFrames:v}),o>0&&L>t.config.fpsDroppedMonitoringThreshold*g){var a=t.currentLevel;u.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+a),a>0&&(t.autoLevelCapping===-1||t.autoLevelCapping>=a)&&(a=a-1,t.trigger(A.Events.FPS_DROP_LEVEL_CAPPING,{level:a,droppedLevel:t.currentLevel}),t.autoLevelCapping=a,this.streamController.nextLevelSwitch())}}this.lastTime=h,this.lastDroppedFrames=v,this.lastDecodedFrames=c}},O.checkFPSInterval=function(){var m=this.media;if(m)if(this.isVideoPlaybackQualityAvailable){var c=m.getVideoPlaybackQuality();this.checkFPS(m,c.totalVideoFrames,c.droppedVideoFrames)}else this.checkFPS(m,m.webkitDecodedFrameCount,m.webkitDroppedFrameCount)},P}();M.default=r},"./src/controller/fragment-finders.ts":function(I,M,i){i.r(M),i.d(M,"findFragmentByPDT",function(){return r}),i.d(M,"findFragmentByPTS",function(){return P}),i.d(M,"fragmentWithinToleranceTest",function(){return O}),i.d(M,"pdtWithinToleranceTest",function(){return x}),i.d(M,"findFragWithCC",function(){return m});var A=i("./src/polyfills/number.ts"),u=i("./src/utils/binary-search.ts");function r(c,v,h){if(v===null||!Array.isArray(c)||!c.length||!Object(A.isFiniteNumber)(v))return null;var T=c[0].programDateTime;if(v<(T||0))return null;var L=c[c.length-1].endProgramDateTime;if(v>=(L||0))return null;h=h||0;for(var g=0;g<c.length;++g){var o=c[g];if(x(v,h,o))return o}return null}function P(c,v,h,T){h===void 0&&(h=0),T===void 0&&(T=0);var L=null;if(c?L=v[c.sn-v[0].sn+1]||null:h===0&&v[0].start===0&&(L=v[0]),L&&O(h,T,L)===0)return L;var g=u.default.search(v,O.bind(null,h,T));return g||L}function O(c,v,h){c===void 0&&(c=0),v===void 0&&(v=0);var T=Math.min(v,h.duration+(h.deltaPTS?h.deltaPTS:0));return h.start+h.duration-T<=c?1:h.start-T>c&&h.start?-1:0}function x(c,v,h){var T=Math.min(v,h.duration+(h.deltaPTS?h.deltaPTS:0))*1e3,L=h.endProgramDateTime||0;return L-T>c}function m(c,v){return u.default.search(c,function(h){return h.cc<v?1:h.cc>v?-1:0})}},"./src/controller/fragment-tracker.ts":function(I,M,i){i.r(M),i.d(M,"FragmentState",function(){return r}),i.d(M,"FragmentTracker",function(){return P});var A=i("./src/events.ts"),u=i("./src/types/loader.ts"),r;(function(m){m.NOT_LOADED="NOT_LOADED",m.BACKTRACKED="BACKTRACKED",m.APPENDING="APPENDING",m.PARTIAL="PARTIAL",m.OK="OK"})(r||(r={}));var P=function(){function m(v){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=v,this._registerListeners()}var c=m.prototype;return c._registerListeners=function(){var h=this.hls;h.on(A.Events.BUFFER_APPENDED,this.onBufferAppended,this),h.on(A.Events.FRAG_BUFFERED,this.onFragBuffered,this),h.on(A.Events.FRAG_LOADED,this.onFragLoaded,this)},c._unregisterListeners=function(){var h=this.hls;h.off(A.Events.BUFFER_APPENDED,this.onBufferAppended,this),h.off(A.Events.FRAG_BUFFERED,this.onFragBuffered,this),h.off(A.Events.FRAG_LOADED,this.onFragLoaded,this)},c.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},c.getAppendedFrag=function(h,T){if(T===u.PlaylistLevelType.MAIN){var L=this.activeFragment,g=this.activeParts;if(!L)return null;if(g)for(var o=g.length;o--;){var t=g[o],a=t?t.end:L.appendedPTS;if(t.start<=h&&a!==void 0&&h<=a)return o>9&&(this.activeParts=g.slice(o-9)),t}else if(L.start<=h&&L.appendedPTS!==void 0&&h<=L.appendedPTS)return L}return this.getBufferedFrag(h,T)},c.getBufferedFrag=function(h,T){for(var L=this.fragments,g=Object.keys(L),o=g.length;o--;){var t=L[g[o]];if((t==null?void 0:t.body.type)===T&&t.buffered){var a=t.body;if(a.start<=h&&h<=a.end)return a}}return null},c.detectEvictedFragments=function(h,T,L){var g=this;Object.keys(this.fragments).forEach(function(o){var t=g.fragments[o];if(!!t){if(!t.buffered){t.body.type===L&&g.removeFragment(t.body);return}var a=t.range[h];!a||a.time.some(function(n){var d=!g.isTimeBuffered(n.startPTS,n.endPTS,T);return d&&g.removeFragment(t.body),d})}})},c.detectPartialFragments=function(h){var T=this,L=this.timeRanges,g=h.frag,o=h.part;if(!(!L||g.sn==="initSegment")){var t=x(g),a=this.fragments[t];!a||(Object.keys(L).forEach(function(n){var d=g.elementaryStreams[n];if(!!d){var l=L[n],s=o!==null||d.partial===!0;a.range[n]=T.getBufferedTimes(g,o,s,l)}}),a.backtrack=a.loaded=null,Object.keys(a.range).length?a.buffered=!0:this.removeFragment(a.body))}},c.fragBuffered=function(h){var T=x(h),L=this.fragments[T];L&&(L.backtrack=L.loaded=null,L.buffered=!0)},c.getBufferedTimes=function(h,T,L,g){for(var o={time:[],partial:L},t=T?T.start:h.start,a=T?T.end:h.end,n=h.minEndPTS||a,d=h.maxStartPTS||t,l=0;l<g.length;l++){var s=g.start(l)-this.bufferPadding,f=g.end(l)+this.bufferPadding;if(d>=s&&n<=f){o.time.push({startPTS:Math.max(t,g.start(l)),endPTS:Math.min(a,g.end(l))});break}else if(t<f&&a>s)o.partial=!0,o.time.push({startPTS:Math.max(t,g.start(l)),endPTS:Math.min(a,g.end(l))});else if(a<=s)break}return o},c.getPartialFragment=function(h){var T=null,L,g,o,t=0,a=this.bufferPadding,n=this.fragments;return Object.keys(n).forEach(function(d){var l=n[d];!l||O(l)&&(g=l.body.start-a,o=l.body.end+a,h>=g&&h<=o&&(L=Math.min(h-g,o-h),t<=L&&(T=l.body,t=L)))}),T},c.getState=function(h){var T=x(h),L=this.fragments[T];return L?L.buffered?O(L)?r.PARTIAL:r.OK:L.backtrack?r.BACKTRACKED:r.APPENDING:r.NOT_LOADED},c.backtrack=function(h,T){var L=x(h),g=this.fragments[L];if(!g||g.backtrack)return null;var o=g.backtrack=T||g.loaded;return g.loaded=null,o},c.getBacktrackData=function(h){var T=x(h),L=this.fragments[T];if(L){var g,o=L.backtrack;if(o!=null&&(g=o.payload)!==null&&g!==void 0&&g.byteLength)return o;this.removeFragment(h)}return null},c.isTimeBuffered=function(h,T,L){for(var g,o,t=0;t<L.length;t++){if(g=L.start(t)-this.bufferPadding,o=L.end(t)+this.bufferPadding,h>=g&&T<=o)return!0;if(T<=g)return!1}return!1},c.onFragLoaded=function(h,T){var L=T.frag,g=T.part;if(!(L.sn==="initSegment"||L.bitrateTest||g)){var o=x(L);this.fragments[o]={body:L,loaded:T,backtrack:null,buffered:!1,range:Object.create(null)}}},c.onBufferAppended=function(h,T){var L=this,g=T.frag,o=T.part,t=T.timeRanges;if(g.type===u.PlaylistLevelType.MAIN)if(this.activeFragment=g,o){var a=this.activeParts;a||(this.activeParts=a=[]),a.push(o)}else this.activeParts=null;this.timeRanges=t,Object.keys(t).forEach(function(n){var d=t[n];if(L.detectEvictedFragments(n,d),!o)for(var l=0;l<d.length;l++)g.appendedPTS=Math.max(d.end(l),g.appendedPTS||0)})},c.onFragBuffered=function(h,T){this.detectPartialFragments(T)},c.hasFragment=function(h){var T=x(h);return!!this.fragments[T]},c.removeFragmentsInRange=function(h,T,L){var g=this;Object.keys(this.fragments).forEach(function(o){var t=g.fragments[o];if(!!t&&t.buffered){var a=t.body;a.type===L&&a.start<T&&a.end>h&&g.removeFragment(a)}})},c.removeFragment=function(h){var T=x(h);h.stats.loaded=0,h.clearElementaryStreamInfo(),delete this.fragments[T]},c.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},m}();function O(m){var c,v;return m.buffered&&(((c=m.range.video)===null||c===void 0?void 0:c.partial)||((v=m.range.audio)===null||v===void 0?void 0:v.partial))}function x(m){return m.type+"_"+m.level+"_"+m.urlId+"_"+m.sn}},"./src/controller/gap-controller.ts":function(I,M,i){i.r(M),i.d(M,"STALL_MINIMUM_DURATION_MS",function(){return O}),i.d(M,"MAX_START_GAP_JUMP",function(){return x}),i.d(M,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return m}),i.d(M,"SKIP_BUFFER_RANGE_START",function(){return c}),i.d(M,"default",function(){return v});var A=i("./src/utils/buffer-helper.ts"),u=i("./src/errors.ts"),r=i("./src/events.ts"),P=i("./src/utils/logger.ts"),O=250,x=2,m=.1,c=.05,v=function(){function h(L,g,o,t){this.config=void 0,this.media=void 0,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=L,this.media=g,this.fragmentTracker=o,this.hls=t}var T=h.prototype;return T.destroy=function(){this.hls=this.fragmentTracker=this.media=null},T.poll=function(g){var o=this.config,t=this.media,a=this.stalled,n=t.currentTime,d=t.seeking,l=this.seeking&&!d,s=!this.seeking&&d;if(this.seeking=d,n!==g){if(this.moved=!0,a!==null){if(this.stallReported){var f=self.performance.now()-a;P.logger.warn("playback not stuck anymore @"+n+", after "+Math.round(f)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((s||l)&&(this.stalled=null),!(t.paused||t.ended||t.playbackRate===0||!A.BufferHelper.getBuffered(t).length)){var C=A.BufferHelper.bufferInfo(t,n,0),D=C.len>0,E=C.nextStart||0;if(!(!D&&!E)){if(d){var p=C.len>x,y=!E||E-n>x&&!this.fragmentTracker.getPartialFragment(n);if(p||y)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var S,R=Math.max(E,C.start||0)-n,w=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,k=w==null||(S=w.details)===null||S===void 0?void 0:S.live,_=k?w.details.targetduration*2:x;if(R>0&&R<=_){this._trySkipBufferHole(null);return}}var F=self.performance.now();if(a===null){this.stalled=F;return}var U=F-a;!d&&U>=O&&this._reportStall(C.len);var N=A.BufferHelper.bufferInfo(t,n,o.maxBufferHole);this._tryFixBufferStall(N,U)}}},T._tryFixBufferStall=function(g,o){var t=this.config,a=this.fragmentTracker,n=this.media,d=n.currentTime,l=a.getPartialFragment(d);if(l){var s=this._trySkipBufferHole(l);if(s)return}g.len>t.maxBufferHole&&o>t.highBufferWatchdogPeriod*1e3&&(P.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},T._reportStall=function(g){var o=this.hls,t=this.media,a=this.stallReported;a||(this.stallReported=!0,P.logger.warn("Playback stalling at @"+t.currentTime+" due to low buffer (buffer="+g+")"),o.trigger(r.Events.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:g}))},T._trySkipBufferHole=function(g){for(var o=this.config,t=this.hls,a=this.media,n=a.currentTime,d=0,l=A.BufferHelper.getBuffered(a),s=0;s<l.length;s++){var f=l.start(s);if(n+o.maxBufferHole>=d&&n<f){var C=Math.max(f+c,a.currentTime+m);return P.logger.warn("skipping hole, adjusting currentTime from "+n+" to "+C),this.moved=!0,this.stalled=null,a.currentTime=C,g&&t.trigger(r.Events.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+n+" to "+C,frag:g}),C}d=l.end(s)}return 0},T._tryNudgeBuffer=function(){var g=this.config,o=this.hls,t=this.media,a=t.currentTime,n=(this.nudgeRetry||0)+1;if(this.nudgeRetry=n,n<g.nudgeMaxRetry){var d=a+n*g.nudgeOffset;P.logger.warn("Nudging 'currentTime' from "+a+" to "+d),t.currentTime=d,o.trigger(r.Events.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else P.logger.error("Playhead still not moving while enough data buffered @"+a+" after "+g.nudgeMaxRetry+" nudges"),o.trigger(r.Events.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},h}()},"./src/controller/id3-track-controller.ts":function(I,M,i){i.r(M);var A=i("./src/events.ts"),u=i("./src/utils/texttrack-utils.ts"),r=i("./src/demux/id3.ts"),P=.25,O=function(){function x(c){this.hls=void 0,this.id3Track=null,this.media=null,this.hls=c,this._registerListeners()}var m=x.prototype;return m.destroy=function(){this._unregisterListeners()},m._registerListeners=function(){var v=this.hls;v.on(A.Events.MEDIA_ATTACHED,this.onMediaAttached,this),v.on(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this),v.on(A.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),v.on(A.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},m._unregisterListeners=function(){var v=this.hls;v.off(A.Events.MEDIA_ATTACHED,this.onMediaAttached,this),v.off(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this),v.off(A.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),v.off(A.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},m.onMediaAttached=function(v,h){this.media=h.media},m.onMediaDetaching=function(){!this.id3Track||(Object(u.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null)},m.getID3Track=function(v){if(!!this.media){for(var h=0;h<v.length;h++){var T=v[h];if(T.kind==="metadata"&&T.label==="id3")return Object(u.sendAddTrackEvent)(T,this.media),T}return this.media.addTextTrack("metadata","id3")}},m.onFragParsingMetadata=function(v,h){if(!!this.media){var T=h.frag,L=h.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var g=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,o=0;o<L.length;o++){var t=r.getID3Frames(L[o].data);if(t){var a=L[o].pts,n=o<L.length-1?L[o+1].pts:T.end,d=n-a;d<=0&&(n=a+P);for(var l=0;l<t.length;l++){var s=t[l];if(!r.isTimeStampFrame(s)){var f=new g(a,n,"");f.value=s,this.id3Track.addCue(f)}}}}}},m.onBufferFlushing=function(v,h){var T=h.startOffset,L=h.endOffset,g=h.type;if(!g||g==="audio"){var o=this.id3Track;o&&Object(u.removeCuesInRange)(o,T,L)}},x}();M.default=O},"./src/controller/latency-controller.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return x});var A=i("./src/errors.ts"),u=i("./src/events.ts"),r=i("./src/utils/logger.ts");function P(m,c){for(var v=0;v<c.length;v++){var h=c[v];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(m,h.key,h)}}function O(m,c,v){return c&&P(m.prototype,c),v&&P(m,v),m}var x=function(){function m(v){var h=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return h.timeupdate()},this.hls=v,this.config=v.config,this.registerListeners()}var c=m.prototype;return c.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},c.registerListeners=function(){this.hls.on(u.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(u.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(u.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(u.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(u.Events.ERROR,this.onError,this)},c.unregisterListeners=function(){this.hls.off(u.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(u.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(u.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(u.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(u.Events.ERROR,this.onError)},c.onMediaAttached=function(h,T){this.media=T.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},c.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},c.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},c.onLevelUpdated=function(h,T){var L=T.details;this.levelDetails=L,L.advanced&&this.timeupdate(),!L.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},c.onError=function(h,T){T.details===A.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,r.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},c.timeupdate=function(){var h=this.media,T=this.levelDetails;if(!(!h||!T)){this.currentTime=h.currentTime;var L=this.computeLatency();if(L!==null){this._latency=L;var g=this.config,o=g.lowLatencyMode,t=g.maxLiveSyncPlaybackRate;if(!(!o||t===1)){var a=this.targetLatency;if(a!==null){var n=L-a,d=Math.min(this.maxLatency,a+T.targetduration),l=n<d;if(T.live&&l&&n>.05&&this.forwardBufferLength>1){var s=Math.min(2,Math.max(1,t)),f=Math.round(2/(1+Math.exp(-.75*n-this.edgeStalled))*20)/20;h.playbackRate=Math.min(s,Math.max(1,f))}else h.playbackRate!==1&&h.playbackRate!==0&&(h.playbackRate=1)}}}}},c.estimateLiveEdge=function(){var h=this.levelDetails;return h===null?null:h.edge+h.age},c.computeLatency=function(){var h=this.estimateLiveEdge();return h===null?null:h-this.currentTime},O(m,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var h=this.config,T=this.levelDetails;return h.liveMaxLatencyDuration!==void 0?h.liveMaxLatencyDuration:T?h.liveMaxLatencyDurationCount*T.targetduration:0}},{key:"targetLatency",get:function(){var h=this.levelDetails;if(h===null)return null;var T=h.holdBack,L=h.partHoldBack,g=h.targetduration,o=this.config,t=o.liveSyncDuration,a=o.liveSyncDurationCount,n=o.lowLatencyMode,d=this.hls.userConfig,l=n&&L||T;(d.liveSyncDuration||d.liveSyncDurationCount||l===0)&&(l=t!==void 0?t:a*g);var s=g,f=1;return l+Math.min(this.stallCount*f,s)}},{key:"liveSyncPosition",get:function(){var h=this.estimateLiveEdge(),T=this.targetLatency,L=this.levelDetails;if(h===null||T===null||L===null)return null;var g=L.edge,o=h-T-this.edgeStalled,t=g-L.totalduration,a=g-(this.config.lowLatencyMode&&L.partTarget||L.targetduration);return Math.min(Math.max(t,o),a)}},{key:"drift",get:function(){var h=this.levelDetails;return h===null?1:h.drift}},{key:"edgeStalled",get:function(){var h=this.levelDetails;if(h===null)return 0;var T=(this.config.lowLatencyMode&&h.partTarget||h.targetduration)*3;return Math.max(h.age-T,0)}},{key:"forwardBufferLength",get:function(){var h=this.media,T=this.levelDetails;if(!h||!T)return 0;var L=h.buffered.length;return L?h.buffered.end(L-1):T.edge-this.currentTime}}]),m}()},"./src/controller/level-controller.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return o});var A=i("./src/types/level.ts"),u=i("./src/events.ts"),r=i("./src/errors.ts"),P=i("./src/utils/codecs.ts"),O=i("./src/controller/level-helper.ts"),x=i("./src/controller/base-playlist-controller.ts"),m=i("./src/types/loader.ts");function c(){return c=Object.assign||function(t){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var d in n)Object.prototype.hasOwnProperty.call(n,d)&&(t[d]=n[d])}return t},c.apply(this,arguments)}function v(t,a){for(var n=0;n<a.length;n++){var d=a[n];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(t,d.key,d)}}function h(t,a,n){return a&&v(t.prototype,a),n&&v(t,n),t}function T(t,a){t.prototype=Object.create(a.prototype),t.prototype.constructor=t,L(t,a)}function L(t,a){return L=Object.setPrototypeOf||function(d,l){return d.__proto__=l,d},L(t,a)}var g=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),o=function(t){T(a,t);function a(d){var l;return l=t.call(this,d,"[level-controller]")||this,l._levels=[],l._firstLevel=-1,l._startLevel=void 0,l.currentLevelIndex=-1,l.manualLevelIndex=-1,l.onParsedComplete=void 0,l._registerListeners(),l}var n=a.prototype;return n._registerListeners=function(){var l=this.hls;l.on(u.Events.MANIFEST_LOADED,this.onManifestLoaded,this),l.on(u.Events.LEVEL_LOADED,this.onLevelLoaded,this),l.on(u.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),l.on(u.Events.FRAG_LOADED,this.onFragLoaded,this),l.on(u.Events.ERROR,this.onError,this)},n._unregisterListeners=function(){var l=this.hls;l.off(u.Events.MANIFEST_LOADED,this.onManifestLoaded,this),l.off(u.Events.LEVEL_LOADED,this.onLevelLoaded,this),l.off(u.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),l.off(u.Events.FRAG_LOADED,this.onFragLoaded,this),l.off(u.Events.ERROR,this.onError,this)},n.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,t.prototype.destroy.call(this)},n.startLoad=function(){var l=this._levels;l.forEach(function(s){s.loadError=0}),t.prototype.startLoad.call(this)},n.onManifestLoaded=function(l,s){var f=[],C=[],D=[],E,p={},y,S=!1,R=!1,w=!1;if(s.levels.forEach(function(U){var N=U.attrs;S=S||!!(U.width&&U.height),R=R||!!U.videoCodec,w=w||!!U.audioCodec,g&&U.audioCodec&&U.audioCodec.indexOf("mp4a.40.34")!==-1&&(U.audioCodec=void 0);var W=U.bitrate+"-"+U.attrs.RESOLUTION+"-"+U.attrs.CODECS;y=p[W],y?y.url.push(U.url):(y=new A.Level(U),p[W]=y,f.push(y)),N&&(N.AUDIO&&Object(O.addGroupId)(y,"audio",N.AUDIO),N.SUBTITLES&&Object(O.addGroupId)(y,"text",N.SUBTITLES))}),(S||R)&&w&&(f=f.filter(function(U){var N=U.videoCodec,W=U.width,H=U.height;return!!N||!!(W&&H)})),f=f.filter(function(U){var N=U.audioCodec,W=U.videoCodec;return(!N||Object(P.isCodecSupportedInMp4)(N,"audio"))&&(!W||Object(P.isCodecSupportedInMp4)(W,"video"))}),s.audioTracks&&(C=s.audioTracks.filter(function(U){return!U.audioCodec||Object(P.isCodecSupportedInMp4)(U.audioCodec,"audio")}),Object(O.assignTrackIdsByGroup)(C)),s.subtitles&&(D=s.subtitles,Object(O.assignTrackIdsByGroup)(D)),f.length>0){E=f[0].bitrate,f.sort(function(U,N){return U.bitrate-N.bitrate}),this._levels=f;for(var k=0;k<f.length;k++)if(f[k].bitrate===E){this._firstLevel=k,this.log("manifest loaded, "+f.length+" level(s) found, first bitrate: "+E);break}var _=w&&!R,F={levels:f,audioTracks:C,subtitleTracks:D,firstLevel:this._firstLevel,stats:s.stats,audio:w,video:R,altAudio:!_&&C.some(function(U){return!!U.url})};this.hls.trigger(u.Events.MANIFEST_PARSED,F),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(u.Events.ERROR,{type:r.ErrorTypes.MEDIA_ERROR,details:r.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:s.url,reason:"no level with compatible codecs found in manifest"})},n.onError=function(l,s){if(t.prototype.onError.call(this,l,s),!s.fatal){var f=s.context,C=this._levels[this.currentLevelIndex];if(f&&(f.type===m.PlaylistContextType.AUDIO_TRACK&&C.audioGroupIds&&f.groupId===C.audioGroupIds[C.urlId]||f.type===m.PlaylistContextType.SUBTITLE_TRACK&&C.textGroupIds&&f.groupId===C.textGroupIds[C.urlId])){this.redundantFailover(this.currentLevelIndex);return}var D=!1,E=!0,p;switch(s.details){case r.ErrorDetails.FRAG_LOAD_ERROR:case r.ErrorDetails.FRAG_LOAD_TIMEOUT:case r.ErrorDetails.KEY_LOAD_ERROR:case r.ErrorDetails.KEY_LOAD_TIMEOUT:if(s.frag){var y=this._levels[s.frag.level];y?(y.fragmentError++,y.fragmentError>this.hls.config.fragLoadingMaxRetry&&(p=s.frag.level)):p=s.frag.level}break;case r.ErrorDetails.LEVEL_LOAD_ERROR:case r.ErrorDetails.LEVEL_LOAD_TIMEOUT:f&&(f.deliveryDirectives&&(E=!1),p=f.level),D=!0;break;case r.ErrorDetails.REMUX_ALLOC_ERROR:p=s.level,D=!0;break}p!==void 0&&this.recoverLevel(s,p,D,E)}},n.recoverLevel=function(l,s,f,C){var D=l.details,E=this._levels[s];if(E.loadError++,f){var p=this.retryLoadingOrFail(l);if(p)l.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(C){var y=E.url.length;if(y>1&&E.loadError<y)l.levelRetry=!0,this.redundantFailover(s);else if(this.manualLevelIndex===-1){var S=s===0?this._levels.length-1:s-1;this.currentLevelIndex!==S&&this._levels[S].loadError===0&&(this.warn(D+": switch to "+S),l.levelRetry=!0,this.hls.nextAutoLevel=S)}}},n.redundantFailover=function(l){var s=this._levels[l],f=s.url.length;if(f>1){var C=(s.urlId+1)%f;this.warn("Switching to redundant URL-id "+C),this._levels.forEach(function(D){D.urlId=C}),this.level=l}},n.onFragLoaded=function(l,s){var f=s.frag;if(f!==void 0&&f.type===m.PlaylistLevelType.MAIN){var C=this._levels[f.level];C!==void 0&&(C.fragmentError=0,C.loadError=0)}},n.onLevelLoaded=function(l,s){var f,C=s.level,D=s.details,E=this._levels[C];if(!E){var p;this.warn("Invalid level index "+C),(p=s.deliveryDirectives)!==null&&p!==void 0&&p.skip&&(D.deltaUpdateFailed=!0);return}C===this.currentLevelIndex?(E.fragmentError===0&&(E.loadError=0,this.retryCount=0),this.playlistLoaded(C,s,E.details)):(f=s.deliveryDirectives)!==null&&f!==void 0&&f.skip&&(D.deltaUpdateFailed=!0)},n.onAudioTrackSwitched=function(l,s){var f=this.hls.levels[this.currentLevelIndex];if(!!f&&f.audioGroupIds){for(var C=-1,D=this.hls.audioTracks[s.id].groupId,E=0;E<f.audioGroupIds.length;E++)if(f.audioGroupIds[E]===D){C=E;break}C!==f.urlId&&(f.urlId=C,this.startLoad())}},n.loadPlaylist=function(l){var s=this.currentLevelIndex,f=this._levels[s];if(this.canLoad&&f&&f.url.length>0){var C=f.urlId,D=f.url[C];if(l)try{D=l.addDirectives(D)}catch(E){this.warn("Could not construct new URL with HLS Delivery Directives: "+E)}this.log("Attempt loading level index "+s+(l?" at sn "+l.msn+" part "+l.part:"")+" with URL-id "+C+" "+D),this.clearTimer(),this.hls.trigger(u.Events.LEVEL_LOADING,{url:D,level:s,id:C,deliveryDirectives:l||null})}},n.removeLevel=function(l,s){var f=function(E,p){return p!==s},C=this._levels.filter(function(D,E){return E!==l?!0:D.url.length>1&&s!==void 0?(D.url=D.url.filter(f),D.audioGroupIds&&(D.audioGroupIds=D.audioGroupIds.filter(f)),D.textGroupIds&&(D.textGroupIds=D.textGroupIds.filter(f)),D.urlId=0,!0):!1}).map(function(D,E){var p=D.details;return p!=null&&p.fragments&&p.fragments.forEach(function(y){y.level=E}),D});this._levels=C,this.hls.trigger(u.Events.LEVELS_UPDATED,{levels:C})},h(a,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(l){var s,f=this._levels;if(f.length!==0&&!(this.currentLevelIndex===l&&(s=f[l])!==null&&s!==void 0&&s.details)){if(l<0||l>=f.length){var C=l<0;if(this.hls.trigger(u.Events.ERROR,{type:r.ErrorTypes.OTHER_ERROR,details:r.ErrorDetails.LEVEL_SWITCH_ERROR,level:l,fatal:C,reason:"invalid level idx"}),C)return;l=Math.min(l,f.length-1)}this.clearTimer();var D=this.currentLevelIndex,E=f[D],p=f[l];this.log("switching to level "+l+" from "+D),this.currentLevelIndex=l;var y=c({},p,{level:l,maxBitrate:p.maxBitrate,uri:p.uri,urlId:p.urlId});delete y._urlId,this.hls.trigger(u.Events.LEVEL_SWITCHING,y);var S=p.details;if(!S||S.live){var R=this.switchParams(p.uri,E==null?void 0:E.details);this.loadPlaylist(R)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(l){this.manualLevelIndex=l,this._startLevel===void 0&&(this._startLevel=l),l!==-1&&(this.level=l)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(l){this._firstLevel=l}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var l=this.hls.config.startLevel;return l!==void 0?l:this._firstLevel}else return this._startLevel},set:function(l){this._startLevel=l}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(l){this.level=l,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=l)}}]),a}(x.default)},"./src/controller/level-helper.ts":function(I,M,i){i.r(M),i.d(M,"addGroupId",function(){return r}),i.d(M,"assignTrackIdsByGroup",function(){return P}),i.d(M,"updatePTS",function(){return O}),i.d(M,"updateFragPTSDTS",function(){return m}),i.d(M,"mergeDetails",function(){return c}),i.d(M,"mapPartIntersection",function(){return v}),i.d(M,"mapFragmentIntersection",function(){return h}),i.d(M,"adjustSliding",function(){return T}),i.d(M,"addSliding",function(){return L}),i.d(M,"computeReloadInterval",function(){return g}),i.d(M,"getFragmentWithSN",function(){return o}),i.d(M,"getPartWith",function(){return t});var A=i("./src/polyfills/number.ts"),u=i("./src/utils/logger.ts");function r(a,n,d){switch(n){case"audio":a.audioGroupIds||(a.audioGroupIds=[]),a.audioGroupIds.push(d);break;case"text":a.textGroupIds||(a.textGroupIds=[]),a.textGroupIds.push(d);break}}function P(a){var n={};a.forEach(function(d){var l=d.groupId||"";d.id=n[l]=n[l]||0,n[l]++})}function O(a,n,d){var l=a[n],s=a[d];x(l,s)}function x(a,n){var d=n.startPTS;if(Object(A.isFiniteNumber)(d)){var l=0,s;n.sn>a.sn?(l=d-a.start,s=a):(l=a.start-d,s=n),s.duration!==l&&(s.duration=l)}else if(n.sn>a.sn){var f=a.cc===n.cc;f&&a.minEndPTS?n.start=a.start+(a.minEndPTS-a.start):n.start=a.start+a.duration}else n.start=Math.max(a.start-n.duration,0)}function m(a,n,d,l,s,f){var C=l-d;C<=0&&(u.logger.warn("Fragment should have a positive duration",n),l=d+n.duration,f=s+n.duration);var D=d,E=l,p=n.startPTS,y=n.endPTS;if(Object(A.isFiniteNumber)(p)){var S=Math.abs(p-d);Object(A.isFiniteNumber)(n.deltaPTS)?n.deltaPTS=Math.max(S,n.deltaPTS):n.deltaPTS=S,D=Math.max(d,p),d=Math.min(d,p),s=Math.min(s,n.startDTS),E=Math.min(l,y),l=Math.max(l,y),f=Math.max(f,n.endDTS)}n.duration=l-d;var R=d-n.start;n.appendedPTS=l,n.start=n.startPTS=d,n.maxStartPTS=D,n.startDTS=s,n.endPTS=l,n.minEndPTS=E,n.endDTS=f;var w=n.sn;if(!a||w<a.startSN||w>a.endSN)return 0;var k,_=w-a.startSN,F=a.fragments;for(F[_]=n,k=_;k>0;k--)x(F[k],F[k-1]);for(k=_;k<F.length-1;k++)x(F[k],F[k+1]);return a.fragmentHint&&x(F[F.length-1],a.fragmentHint),a.PTSKnown=a.alignedSliding=!0,R}function c(a,n){for(var d=null,l=a.fragments,s=l.length-1;s>=0;s--){var f=l[s].initSegment;if(f){d=f;break}}a.fragmentHint&&delete a.fragmentHint.endPTS;var C=0,D;if(h(a,n,function(k,_){k.relurl&&(C=k.cc-_.cc),Object(A.isFiniteNumber)(k.startPTS)&&Object(A.isFiniteNumber)(k.endPTS)&&(_.start=_.startPTS=k.startPTS,_.startDTS=k.startDTS,_.appendedPTS=k.appendedPTS,_.maxStartPTS=k.maxStartPTS,_.endPTS=k.endPTS,_.endDTS=k.endDTS,_.minEndPTS=k.minEndPTS,_.duration=k.endPTS-k.startPTS,_.duration&&(D=_),n.PTSKnown=n.alignedSliding=!0),_.elementaryStreams=k.elementaryStreams,_.loader=k.loader,_.stats=k.stats,_.urlId=k.urlId,k.initSegment&&(_.initSegment=k.initSegment,d=k.initSegment)}),d){var E=n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments;E.forEach(function(k){var _;(!k.initSegment||k.initSegment.relurl===((_=d)===null||_===void 0?void 0:_.relurl))&&(k.initSegment=d)})}if(n.skippedSegments&&(n.deltaUpdateFailed=n.fragments.some(function(k){return!k}),n.deltaUpdateFailed)){u.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var p=n.skippedSegments;p--;)n.fragments.shift();n.startSN=n.fragments[0].sn,n.startCC=n.fragments[0].cc}var y=n.fragments;if(C){u.logger.warn("discontinuity sliding from playlist, take drift into account");for(var S=0;S<y.length;S++)y[S].cc+=C}n.skippedSegments&&(n.startCC=n.fragments[0].cc),v(a.partList,n.partList,function(k,_){_.elementaryStreams=k.elementaryStreams,_.stats=k.stats}),D?m(n,D,D.startPTS,D.endPTS,D.startDTS,D.endDTS):T(a,n),y.length&&(n.totalduration=n.edge-y[0].start),n.driftStartTime=a.driftStartTime,n.driftStart=a.driftStart;var R=n.advancedDateTime;if(n.advanced&&R){var w=n.edge;n.driftStart||(n.driftStartTime=R,n.driftStart=w),n.driftEndTime=R,n.driftEnd=w}else n.driftEndTime=a.driftEndTime,n.driftEnd=a.driftEnd,n.advancedDateTime=a.advancedDateTime}function v(a,n,d){if(a&&n)for(var l=0,s=0,f=a.length;s<=f;s++){var C=a[s],D=n[s+l];C&&D&&C.index===D.index&&C.fragment.sn===D.fragment.sn?d(C,D):l--}}function h(a,n,d){for(var l=n.skippedSegments,s=Math.max(a.startSN,n.startSN)-n.startSN,f=(a.fragmentHint?1:0)+(l?n.endSN:Math.min(a.endSN,n.endSN))-n.startSN,C=n.startSN-a.startSN,D=n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments,E=a.fragmentHint?a.fragments.concat(a.fragmentHint):a.fragments,p=s;p<=f;p++){var y=E[C+p],S=D[p];l&&!S&&p<l&&(S=n.fragments[p]=y),y&&S&&d(y,S)}}function T(a,n){var d=n.startSN+n.skippedSegments-a.startSN,l=a.fragments;d<0||d>=l.length||L(n,l[d].start)}function L(a,n){if(n){for(var d=a.fragments,l=a.skippedSegments;l<d.length;l++)d[l].start+=n;a.fragmentHint&&(a.fragmentHint.start+=n)}}function g(a,n){var d=1e3*a.levelTargetDuration,l=d/2,s=a.age,f=s>0&&s<d*3,C=n.loading.end-n.loading.start,D,E=a.availabilityDelay;if(a.updated===!1)if(f){var p=333*a.misses;D=Math.max(Math.min(l,C*2),p),a.availabilityDelay=(a.availabilityDelay||0)+D}else D=l;else f?(E=Math.min(E||d/2,s),a.availabilityDelay=E,D=E+d-s):D=d-C;return Math.round(D)}function o(a,n,d){if(!a||!a.details)return null;var l=a.details,s=l.fragments[n-l.startSN];return s||(s=l.fragmentHint,s&&s.sn===n)?s:n<l.startSN&&d&&d.sn===n?d:null}function t(a,n,d){if(!a||!a.details)return null;var l=a.details.partList;if(l)for(var s=l.length;s--;){var f=l[s];if(f.index===d&&f.fragment.sn===n)return f}return null}},"./src/controller/stream-controller.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return l});var A=i("./src/polyfills/number.ts"),u=i("./src/controller/base-stream-controller.ts"),r=i("./src/is-supported.ts"),P=i("./src/events.ts"),O=i("./src/utils/buffer-helper.ts"),x=i("./src/controller/fragment-tracker.ts"),m=i("./src/types/loader.ts"),c=i("./src/loader/fragment.ts"),v=i("./src/demux/transmuxer-interface.ts"),h=i("./src/types/transmuxer.ts"),T=i("./src/controller/gap-controller.ts"),L=i("./src/errors.ts"),g=i("./src/utils/logger.ts");function o(s,f){for(var C=0;C<f.length;C++){var D=f[C];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(s,D.key,D)}}function t(s,f,C){return f&&o(s.prototype,f),C&&o(s,C),s}function a(s,f){s.prototype=Object.create(f.prototype),s.prototype.constructor=s,n(s,f)}function n(s,f){return n=Object.setPrototypeOf||function(D,E){return D.__proto__=E,D},n(s,f)}var d=100,l=function(s){a(f,s);function f(D,E){var p;return p=s.call(this,D,E,"[stream-controller]")||this,p.audioCodecSwap=!1,p.gapController=null,p.level=-1,p._forceStartLoad=!1,p.altAudio=!1,p.audioOnly=!1,p.fragPlaying=null,p.onvplaying=null,p.onvseeked=null,p.fragLastKbps=0,p.stalled=!1,p.couldBacktrack=!1,p.audioCodecSwitch=!1,p.videoBuffer=null,p._registerListeners(),p}var C=f.prototype;return C._registerListeners=function(){var E=this.hls;E.on(P.Events.MEDIA_ATTACHED,this.onMediaAttached,this),E.on(P.Events.MEDIA_DETACHING,this.onMediaDetaching,this),E.on(P.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.on(P.Events.MANIFEST_PARSED,this.onManifestParsed,this),E.on(P.Events.LEVEL_LOADING,this.onLevelLoading,this),E.on(P.Events.LEVEL_LOADED,this.onLevelLoaded,this),E.on(P.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),E.on(P.Events.ERROR,this.onError,this),E.on(P.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),E.on(P.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),E.on(P.Events.BUFFER_CREATED,this.onBufferCreated,this),E.on(P.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),E.on(P.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),E.on(P.Events.FRAG_BUFFERED,this.onFragBuffered,this)},C._unregisterListeners=function(){var E=this.hls;E.off(P.Events.MEDIA_ATTACHED,this.onMediaAttached,this),E.off(P.Events.MEDIA_DETACHING,this.onMediaDetaching,this),E.off(P.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.off(P.Events.MANIFEST_PARSED,this.onManifestParsed,this),E.off(P.Events.LEVEL_LOADED,this.onLevelLoaded,this),E.off(P.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),E.off(P.Events.ERROR,this.onError,this),E.off(P.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),E.off(P.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),E.off(P.Events.BUFFER_CREATED,this.onBufferCreated,this),E.off(P.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),E.off(P.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),E.off(P.Events.FRAG_BUFFERED,this.onFragBuffered,this)},C.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},C.startLoad=function(E){if(this.levels){var p=this.lastCurrentTime,y=this.hls;if(this.stopLoad(),this.setInterval(d),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var S=y.startLevel;S===-1&&(y.config.testBandwidth?(S=0,this.bitrateTest=!0):S=y.nextAutoLevel),this.level=y.nextLoadLevel=S,this.loadedmetadata=!1}p>0&&E===-1&&(this.log("Override startPosition with lastCurrentTime @"+p.toFixed(3)),E=p),this.state=u.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=E,this.tick()}else this._forceStartLoad=!0,this.state=u.State.STOPPED},C.stopLoad=function(){this._forceStartLoad=!1,s.prototype.stopLoad.call(this)},C.doTick=function(){switch(this.state){case u.State.IDLE:this.doTickIdle();break;case u.State.WAITING_LEVEL:{var E,p=this.levels,y=this.level,S=p==null||(E=p[y])===null||E===void 0?void 0:E.details;if(S&&(!S.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(S))break;this.state=u.State.IDLE;break}break}case u.State.FRAG_LOADING_WAITING_RETRY:{var R,w=self.performance.now(),k=this.retryDate;(!k||w>=k||(R=this.media)!==null&&R!==void 0&&R.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=u.State.IDLE)}break}this.onTickEnd()},C.onTickEnd=function(){s.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},C.doTickIdle=function(){var E,p,y=this.hls,S=this.levelLastLoaded,R=this.levels,w=this.media,k=y.config,_=y.nextLoadLevel;if(!(S===null||!w&&(this.startFragRequested||!k.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!R||!R[_])){var F=R[_];this.level=y.nextLoadLevel=_;var U=F.details;if(!U||this.state===u.State.WAITING_LEVEL||U.live&&this.levelLastLoaded!==_){this.state=u.State.WAITING_LEVEL;return}var N=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:w,m.PlaylistLevelType.MAIN);if(N!==null){var W=N.len,H=this.getMaxBufferLength(F.maxBitrate);if(!(W>=H)){if(this._streamEnded(N,U)){var G={};this.altAudio&&(G.type="video"),this.hls.trigger(P.Events.BUFFER_EOS,G),this.state=u.State.ENDED;return}var J=N.end,X=this.getNextFragment(J,U);if(this.couldBacktrack&&!this.fragPrevious&&X&&X.sn!=="initSegment"){var te=X.sn-U.startSN;te>1&&(X=U.fragments[te-1],this.fragmentTracker.removeFragment(X))}if(X&&this.fragmentTracker.getState(X)===x.FragmentState.OK&&this.nextLoadPosition>J){var le=this.audioOnly&&!this.altAudio?c.ElementaryStreamTypes.AUDIO:c.ElementaryStreamTypes.VIDEO;this.afterBufferFlushed(w,le,m.PlaylistLevelType.MAIN),X=this.getNextFragment(this.nextLoadPosition,U)}!X||(X.initSegment&&!X.initSegment.data&&!this.bitrateTest&&(X=X.initSegment),((E=X.decryptdata)===null||E===void 0?void 0:E.keyFormat)==="identity"&&!((p=X.decryptdata)!==null&&p!==void 0&&p.key)?this.loadKey(X,U):this.loadFragment(X,U,J))}}}},C.loadFragment=function(E,p,y){var S,R=this.fragmentTracker.getState(E);if(this.fragCurrent=E,R===x.FragmentState.BACKTRACKED){var w=this.fragmentTracker.getBacktrackData(E);if(w){this._handleFragmentLoadProgress(w),this._handleFragmentLoadComplete(w);return}else R=x.FragmentState.NOT_LOADED}R===x.FragmentState.NOT_LOADED||R===x.FragmentState.PARTIAL?E.sn==="initSegment"?this._loadInitSegment(E):this.bitrateTest?(E.bitrateTest=!0,this.log("Fragment "+E.sn+" of level "+E.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(E)):(this.startFragRequested=!0,s.prototype.loadFragment.call(this,E,p,y)):R===x.FragmentState.APPENDING?this.reduceMaxBufferLength(E.duration)&&this.fragmentTracker.removeFragment(E):((S=this.media)===null||S===void 0?void 0:S.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},C.getAppendedFrag=function(E){var p=this.fragmentTracker.getAppendedFrag(E,m.PlaylistLevelType.MAIN);return p&&"fragment"in p?p.fragment:p},C.getBufferedFrag=function(E){return this.fragmentTracker.getBufferedFrag(E,m.PlaylistLevelType.MAIN)},C.followingBufferedFrag=function(E){return E?this.getBufferedFrag(E.end+.5):null},C.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},C.nextLevelSwitch=function(){var E=this.levels,p=this.media;if(p!=null&&p.readyState){var y,S=this.getAppendedFrag(p.currentTime);if(S&&S.start>1&&this.flushMainBuffer(0,S.start-1),!p.paused&&E){var R=this.hls.nextLoadLevel,w=E[R],k=this.fragLastKbps;k&&this.fragCurrent?y=this.fragCurrent.duration*w.maxBitrate/(1e3*k)+1:y=0}else y=0;var _=this.getBufferedFrag(p.currentTime+y);if(_){var F=this.followingBufferedFrag(_);if(F){this.abortCurrentFrag();var U=F.maxStartPTS?F.maxStartPTS:F.start,N=F.duration,W=Math.max(_.end,U+Math.min(Math.max(N-this.config.maxFragLookUpTolerance,N*.5),N*.75));this.flushMainBuffer(W,Number.POSITIVE_INFINITY)}}}},C.abortCurrentFrag=function(){var E=this.fragCurrent;this.fragCurrent=null,E!=null&&E.loader&&E.loader.abort(),this.state===u.State.KEY_LOADING&&(this.state=u.State.IDLE),this.nextLoadPosition=this.getLoadPosition()},C.flushMainBuffer=function(E,p){s.prototype.flushMainBuffer.call(this,E,p,this.altAudio?"video":null)},C.onMediaAttached=function(E,p){s.prototype.onMediaAttached.call(this,E,p);var y=p.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),y.addEventListener("playing",this.onvplaying),y.addEventListener("seeked",this.onvseeked),this.gapController=new T.default(this.config,y,this.fragmentTracker,this.hls)},C.onMediaDetaching=function(){var E=this.media;E&&(E.removeEventListener("playing",this.onvplaying),E.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),s.prototype.onMediaDetaching.call(this)},C.onMediaPlaying=function(){this.tick()},C.onMediaSeeked=function(){var E=this.media,p=E?E.currentTime:null;Object(A.isFiniteNumber)(p)&&this.log("Media seeked to "+p.toFixed(3)),this.tick()},C.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(P.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null},C.onManifestParsed=function(E,p){var y=!1,S=!1,R;p.levels.forEach(function(w){R=w.audioCodec,R&&(R.indexOf("mp4a.40.2")!==-1&&(y=!0),R.indexOf("mp4a.40.5")!==-1&&(S=!0))}),this.audioCodecSwitch=y&&S&&!Object(r.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=p.levels,this.startFragRequested=!1},C.onLevelLoading=function(E,p){var y=this.levels;if(!(!y||this.state!==u.State.IDLE)){var S=y[p.level];(!S.details||S.details.live&&this.levelLastLoaded!==p.level||this.waitForCdnTuneIn(S.details))&&(this.state=u.State.WAITING_LEVEL)}},C.onLevelLoaded=function(E,p){var y,S=this.levels,R=p.level,w=p.details,k=w.totalduration;if(!S){this.warn("Levels were reset while loading level "+R);return}this.log("Level "+R+" loaded ["+w.startSN+","+w.endSN+"], cc ["+w.startCC+", "+w.endCC+"] duration:"+k);var _=this.fragCurrent;_&&(this.state===u.State.FRAG_LOADING||this.state===u.State.FRAG_LOADING_WAITING_RETRY)&&_.level!==p.level&&_.loader&&(this.state=u.State.IDLE,_.loader.abort());var F=S[R],U=0;if(w.live||(y=F.details)!==null&&y!==void 0&&y.live){if(w.fragments[0]||(w.deltaUpdateFailed=!0),w.deltaUpdateFailed)return;U=this.alignPlaylists(w,F.details)}if(F.details=w,this.levelLastLoaded=R,this.hls.trigger(P.Events.LEVEL_UPDATED,{details:w,level:R}),this.state===u.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(w))return;this.state=u.State.IDLE}this.startFragRequested?w.live&&this.synchronizeToLiveEdge(w):this.setStartPosition(w,U),this.tick()},C._handleFragmentLoadProgress=function(E){var p,y=E.frag,S=E.part,R=E.payload,w=this.levels;if(!w){this.warn("Levels were reset while fragment load was in progress. Fragment "+y.sn+" of level "+y.level+" will not be buffered");return}var k=w[y.level],_=k.details;if(!_){this.warn("Dropping fragment "+y.sn+" of level "+y.level+" after level details were reset");return}var F=k.videoCodec,U=_.PTSKnown||!_.live,N=(p=y.initSegment)===null||p===void 0?void 0:p.data,W=this._getAudioCodec(k),H=this.transmuxer=this.transmuxer||new v.default(this.hls,m.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),G=S?S.index:-1,J=G!==-1,X=new h.ChunkMetadata(y.level,y.sn,y.stats.chunkCount,R.byteLength,G,J),te=this.initPTS[y.cc];H.push(R,N,W,F,y,S,_.totalduration,U,X,te)},C.onAudioTrackSwitching=function(E,p){var y=this.altAudio,S=!!p.url,R=p.id;if(!S){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var w=this.fragCurrent;w!=null&&w.loader&&(this.log("Switching to main audio track, cancel main fragment load"),w.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var k=this.hls;y&&k.trigger(P.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),k.trigger(P.Events.AUDIO_TRACK_SWITCHED,{id:R})}},C.onAudioTrackSwitched=function(E,p){var y=p.id,S=!!this.hls.audioTracks[y].url;if(S){var R=this.videoBuffer;R&&this.mediaBuffer!==R&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=R)}this.altAudio=S,this.tick()},C.onBufferCreated=function(E,p){var y=p.tracks,S,R,w=!1;for(var k in y){var _=y[k];if(_.id==="main"){if(R=k,S=_,k==="video"){var F=y[k];F&&(this.videoBuffer=F.buffer)}}else w=!0}w&&S?(this.log("Alternate track found, use "+R+".buffered to schedule main fragment loading"),this.mediaBuffer=S.buffer):this.mediaBuffer=this.media},C.onFragBuffered=function(E,p){var y=p.frag,S=p.part;if(!(y&&y.type!==m.PlaylistLevelType.MAIN)){if(this.fragContextChanged(y)){this.warn("Fragment "+y.sn+(S?" p: "+S.index:"")+" of level "+y.level+" finished buffering, but was aborted. state: "+this.state),this.state===u.State.PARSED&&(this.state=u.State.IDLE);return}var R=S?S.stats:y.stats;this.fragLastKbps=Math.round(8*R.total/(R.buffering.end-R.loading.first)),y.sn!=="initSegment"&&(this.fragPrevious=y),this.fragBufferedComplete(y,S)}},C.onError=function(E,p){switch(p.details){case L.ErrorDetails.FRAG_LOAD_ERROR:case L.ErrorDetails.FRAG_LOAD_TIMEOUT:case L.ErrorDetails.KEY_LOAD_ERROR:case L.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(m.PlaylistLevelType.MAIN,p);break;case L.ErrorDetails.LEVEL_LOAD_ERROR:case L.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==u.State.ERROR&&(p.fatal?(this.warn(""+p.details),this.state=u.State.ERROR):!p.levelRetry&&this.state===u.State.WAITING_LEVEL&&(this.state=u.State.IDLE));break;case L.ErrorDetails.BUFFER_FULL_ERROR:if(p.parent==="main"&&(this.state===u.State.PARSING||this.state===u.State.PARSED)){var y=!0,S=this.getFwdBufferInfo(this.media,m.PlaylistLevelType.MAIN);S&&S.len>.5&&(y=!this.reduceMaxBufferLength(S.len)),y&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break}},C.checkBuffer=function(){var E=this.media,p=this.gapController;if(!(!E||!p||!E.readyState)){var y=O.BufferHelper.getBuffered(E);!this.loadedmetadata&&y.length?(this.loadedmetadata=!0,this.seekToStartPos()):p.poll(this.lastCurrentTime),this.lastCurrentTime=E.currentTime}},C.onFragLoadEmergencyAborted=function(){this.state=u.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},C.onBufferFlushed=function(E,p){var y=p.type;if(y!==c.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var S=(y===c.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(S,y,m.PlaylistLevelType.MAIN)}},C.onLevelsUpdated=function(E,p){this.levels=p.levels},C.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},C.seekToStartPos=function(){var E=this.media,p=E.currentTime,y=this.startPosition;if(y>=0&&p<y){if(E.seeking){g.logger.log("could not seek to "+y+", already seeking at "+p);return}var S=O.BufferHelper.getBuffered(E),R=S.length?S.start(0):0,w=R-y;w>0&&(w<this.config.maxBufferHole||w<this.config.maxFragLookUpTolerance)&&(g.logger.log("adjusting start position by "+w+" to match buffer start"),y+=w,this.startPosition=y),this.log("seek to target start position "+y+" from current time "+p),E.currentTime=y}},C._getAudioCodec=function(E){var p=this.config.defaultAudioCodec||E.audioCodec;return this.audioCodecSwap&&p&&(this.log("Swapping audio codec"),p.indexOf("mp4a.40.5")!==-1?p="mp4a.40.2":p="mp4a.40.5"),p},C._loadBitrateTestFrag=function(E){var p=this;this._doFragLoad(E).then(function(y){var S=p.hls;if(!(!y||S.nextLoadLevel||p.fragContextChanged(E))){p.fragLoadError=0,p.state=u.State.IDLE,p.startFragRequested=!1,p.bitrateTest=!1;var R=E.stats;R.parsing.start=R.parsing.end=R.buffering.start=R.buffering.end=self.performance.now(),S.trigger(P.Events.FRAG_LOADED,y)}})},C._handleTransmuxComplete=function(E){var p,y="main",S=this.hls,R=E.remuxResult,w=E.chunkMeta,k=this.getCurrentContext(w);if(!k){this.warn("The loading context changed while buffering fragment "+w.sn+" of level "+w.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(w.level);return}var _=k.frag,F=k.part,U=k.level,N=R.video,W=R.text,H=R.id3,G=R.initSegment,J=this.altAudio?void 0:R.audio;if(!this.fragContextChanged(_)){if(this.state=u.State.PARSING,G){G.tracks&&(this._bufferInitSegment(U,G.tracks,_,w),S.trigger(P.Events.FRAG_PARSING_INIT_SEGMENT,{frag:_,id:y,tracks:G.tracks}));var X=G.initPTS,te=G.timescale;Object(A.isFiniteNumber)(X)&&(this.initPTS[_.cc]=X,S.trigger(P.Events.INIT_PTS_FOUND,{frag:_,id:y,initPTS:X,timescale:te}))}if(N&&R.independent!==!1){if(U.details){var le=N.startPTS,re=N.endPTS,fe=N.startDTS,ue=N.endDTS;if(F)F.elementaryStreams[N.type]={startPTS:le,endPTS:re,startDTS:fe,endDTS:ue};else if(N.firstKeyFrame&&N.independent&&(this.couldBacktrack=!0),N.dropped&&N.independent){var ae=this.getLoadPosition()+this.config.maxBufferHole;if(ae<le){this.backtrack(_);return}_.setElementaryStreamInfo(N.type,_.start,re,_.start,ue,!0)}_.setElementaryStreamInfo(N.type,le,re,fe,ue),this.bufferFragmentData(N,_,F,w)}}else if(R.independent===!1){this.backtrack(_);return}if(J){var me=J.startPTS,ge=J.endPTS,be=J.startDTS,Se=J.endDTS;F&&(F.elementaryStreams[c.ElementaryStreamTypes.AUDIO]={startPTS:me,endPTS:ge,startDTS:be,endDTS:Se}),_.setElementaryStreamInfo(c.ElementaryStreamTypes.AUDIO,me,ge,be,Se),this.bufferFragmentData(J,_,F,w)}if(H!=null&&(p=H.samples)!==null&&p!==void 0&&p.length){var we={frag:_,id:y,samples:H.samples};S.trigger(P.Events.FRAG_PARSING_METADATA,we)}if(W){var Ce={frag:_,id:y,samples:W.samples};S.trigger(P.Events.FRAG_PARSING_USERDATA,Ce)}}},C._bufferInitSegment=function(E,p,y,S){var R=this;if(this.state===u.State.PARSING){this.audioOnly=!!p.audio&&!p.video,this.altAudio&&!this.audioOnly&&delete p.audio;var w=p.audio,k=p.video,_=p.audiovideo;if(w){var F=E.audioCodec,U=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(F&&(F.indexOf("mp4a.40.5")!==-1?F="mp4a.40.2":F="mp4a.40.5"),w.metadata.channelCount!==1&&U.indexOf("firefox")===-1&&(F="mp4a.40.5")),U.indexOf("android")!==-1&&w.container!=="audio/mpeg"&&(F="mp4a.40.2",this.log("Android: force audio codec to "+F)),E.audioCodec&&E.audioCodec!==F&&this.log('Swapping manifest audio codec "'+E.audioCodec+'" for "'+F+'"'),w.levelCodec=F,w.id="main",this.log("Init audio buffer, container:"+w.container+", codecs[selected/level/parsed]=["+(F||"")+"/"+(E.audioCodec||"")+"/"+w.codec+"]")}k&&(k.levelCodec=E.videoCodec,k.id="main",this.log("Init video buffer, container:"+k.container+", codecs[level/parsed]=["+(E.videoCodec||"")+"/"+k.codec+"]")),_&&this.log("Init audiovideo buffer, container:"+_.container+", codecs[level/parsed]=["+(E.attrs.CODECS||"")+"/"+_.codec+"]"),this.hls.trigger(P.Events.BUFFER_CODECS,p),Object.keys(p).forEach(function(N){var W=p[N],H=W.initSegment;H!=null&&H.byteLength&&R.hls.trigger(P.Events.BUFFER_APPENDING,{type:N,data:H,frag:y,part:null,chunkMeta:S,parent:y.type})}),this.tick()}},C.backtrack=function(E){this.couldBacktrack=!0,this.resetTransmuxer(),this.flushBufferGap(E);var p=this.fragmentTracker.backtrack(E);this.fragPrevious=null,this.nextLoadPosition=E.start,p?this.resetFragmentLoading(E):this.state=u.State.BACKTRACKING},C.checkFragmentChanged=function(){var E=this.media,p=null;if(E&&E.readyState>1&&E.seeking===!1){var y=E.currentTime;if(O.BufferHelper.isBuffered(E,y)?p=this.getAppendedFrag(y):O.BufferHelper.isBuffered(E,y+.1)&&(p=this.getAppendedFrag(y+.1)),p){var S=this.fragPlaying,R=p.level;(!S||p.sn!==S.sn||S.level!==R||p.urlId!==S.urlId)&&(this.hls.trigger(P.Events.FRAG_CHANGED,{frag:p}),(!S||S.level!==R)&&this.hls.trigger(P.Events.LEVEL_SWITCHED,{level:R}),this.fragPlaying=p)}}},t(f,[{key:"nextLevel",get:function(){var E=this.nextBufferedFrag;return E?E.level:-1}},{key:"currentLevel",get:function(){var E=this.media;if(E){var p=this.getAppendedFrag(E.currentTime);if(p)return p.level}return-1}},{key:"nextBufferedFrag",get:function(){var E=this.media;if(E){var p=this.getAppendedFrag(E.currentTime);return this.followingBufferedFrag(p)}else return null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),f}(u.default)},"./src/controller/subtitle-stream-controller.ts":function(I,M,i){i.r(M),i.d(M,"SubtitleStreamController",function(){return t});var A=i("./src/events.ts"),u=i("./src/utils/buffer-helper.ts"),r=i("./src/controller/fragment-finders.ts"),P=i("./src/utils/discontinuities.ts"),O=i("./src/controller/level-helper.ts"),x=i("./src/controller/fragment-tracker.ts"),m=i("./src/controller/base-stream-controller.ts"),c=i("./src/types/loader.ts"),v=i("./src/types/level.ts");function h(a,n){for(var d=0;d<n.length;d++){var l=n[d];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(a,l.key,l)}}function T(a,n,d){return n&&h(a.prototype,n),d&&h(a,d),a}function L(a,n){a.prototype=Object.create(n.prototype),a.prototype.constructor=a,g(a,n)}function g(a,n){return g=Object.setPrototypeOf||function(l,s){return l.__proto__=s,l},g(a,n)}var o=500,t=function(a){L(n,a);function n(l,s){var f;return f=a.call(this,l,s,"[subtitle-stream-controller]")||this,f.levels=[],f.currentTrackId=-1,f.tracksBuffered=[],f.mainDetails=null,f._registerListeners(),f}var d=n.prototype;return d.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},d._registerListeners=function(){var s=this.hls;s.on(A.Events.MEDIA_ATTACHED,this.onMediaAttached,this),s.on(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this),s.on(A.Events.MANIFEST_LOADING,this.onManifestLoading,this),s.on(A.Events.LEVEL_LOADED,this.onLevelLoaded,this),s.on(A.Events.ERROR,this.onError,this),s.on(A.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),s.on(A.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),s.on(A.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),s.on(A.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),s.on(A.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},d._unregisterListeners=function(){var s=this.hls;s.off(A.Events.MEDIA_ATTACHED,this.onMediaAttached,this),s.off(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this),s.off(A.Events.MANIFEST_LOADING,this.onManifestLoading,this),s.off(A.Events.LEVEL_LOADED,this.onLevelLoaded,this),s.off(A.Events.ERROR,this.onError,this),s.off(A.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),s.off(A.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),s.off(A.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),s.off(A.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),s.off(A.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},d.startLoad=function(){this.stopLoad(),this.state=m.State.IDLE,this.setInterval(o),this.tick()},d.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},d.onLevelLoaded=function(s,f){this.mainDetails=f.details},d.onSubtitleFragProcessed=function(s,f){var C=f.frag,D=f.success;if(this.fragPrevious=C,this.state=m.State.IDLE,!!D){var E=this.tracksBuffered[this.currentTrackId];if(!!E){for(var p,y=C.start,S=0;S<E.length;S++)if(y>=E[S].start&&y<=E[S].end){p=E[S];break}var R=C.start+C.duration;p?p.end=R:(p={start:y,end:R},E.push(p)),this.fragmentTracker.fragBuffered(C)}}},d.onBufferFlushing=function(s,f){var C=f.startOffset,D=f.endOffset;if(C===0&&D!==Number.POSITIVE_INFINITY){var E=this.currentTrackId,p=this.levels;if(!p.length||!p[E]||!p[E].details)return;var y=p[E].details,S=y.targetduration,R=D-S;if(R<=0)return;f.endOffsetSubtitles=Math.max(0,R),this.tracksBuffered.forEach(function(w){for(var k=0;k<w.length;){if(w[k].end<=R){w.shift();continue}else if(w[k].start<R)w[k].start=R;else break;k++}}),this.fragmentTracker.removeFragmentsInRange(C,R,c.PlaylistLevelType.SUBTITLE)}},d.onError=function(s,f){var C,D=f.frag;!D||D.type!==c.PlaylistLevelType.SUBTITLE||((C=this.fragCurrent)!==null&&C!==void 0&&C.loader&&this.fragCurrent.loader.abort(),this.state=m.State.IDLE)},d.onSubtitleTracksUpdated=function(s,f){var C=this,D=f.subtitleTracks;this.tracksBuffered=[],this.levels=D.map(function(E){return new v.Level(E)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(E){C.tracksBuffered[E.id]=[]}),this.mediaBuffer=null},d.onSubtitleTrackSwitch=function(s,f){if(this.currentTrackId=f.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var C=this.levels[this.currentTrackId];C!=null&&C.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,C&&this.setInterval(o)},d.onSubtitleTrackLoaded=function(s,f){var C,D=f.details,E=f.id,p=this.currentTrackId,y=this.levels;if(!!y.length){var S=y[p];if(!(E>=y.length||E!==p||!S)){if(this.mediaBuffer=this.mediaBufferTimeRanges,D.live||(C=S.details)!==null&&C!==void 0&&C.live){var R=this.mainDetails;if(D.deltaUpdateFailed||!R)return;var w=R.fragments[0];if(!S.details)D.hasProgramDateTime&&R.hasProgramDateTime?Object(P.alignMediaPlaylistByPDT)(D,R):w&&Object(O.addSliding)(D,w.start);else{var k=this.alignPlaylists(D,S.details);k===0&&w&&Object(O.addSliding)(D,w.start)}}if(S.details=D,this.levelLastLoaded=E,this.tick(),D.live&&!this.fragCurrent&&this.media&&this.state===m.State.IDLE){var _=Object(r.findFragmentByPTS)(null,D.fragments,this.media.currentTime,0);_||(this.warn("Subtitle playlist not aligned with playback"),S.details=void 0)}}}},d._handleFragmentLoadComplete=function(s){var f=s.frag,C=s.payload,D=f.decryptdata,E=this.hls;if(!this.fragContextChanged(f)&&C&&C.byteLength>0&&D&&D.key&&D.iv&&D.method==="AES-128"){var p=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(C),D.key.buffer,D.iv.buffer).then(function(y){var S=performance.now();E.trigger(A.Events.FRAG_DECRYPTED,{frag:f,payload:y,stats:{tstart:p,tdecrypt:S}})})}},d.doTick=function(){if(!this.media){this.state=m.State.IDLE;return}if(this.state===m.State.IDLE){var s,f=this.currentTrackId,C=this.levels;if(!C.length||!C[f]||!C[f].details)return;var D=C[f].details,E=D.targetduration,p=this.config,y=this.media,S=u.BufferHelper.bufferedInfo(this.mediaBufferTimeRanges,y.currentTime-E,p.maxBufferHole),R=S.end,w=S.len,k=this.getMaxBufferLength()+E;if(w>k)return;console.assert(D,"Subtitle track details are defined on idle subtitle stream controller tick");var _=D.fragments,F=_.length,U=D.edge,N,W=this.fragPrevious;if(R<U){var H=p.maxFragLookUpTolerance;N=Object(r.findFragmentByPTS)(W,_,R,H),!N&&W&&W.start<_[0].start&&(N=_[0])}else N=_[F-1];(s=N)!==null&&s!==void 0&&s.encrypted?this.loadKey(N,D):N&&this.fragmentTracker.getState(N)===x.FragmentState.NOT_LOADED&&this.loadFragment(N,D,R)}},d.loadFragment=function(s,f,C){this.fragCurrent=s,a.prototype.loadFragment.call(this,s,f,C)},T(n,[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}]),n}(m.default)},"./src/controller/subtitle-track-controller.ts":function(I,M,i){i.r(M);var A=i("./src/events.ts"),u=i("./src/utils/texttrack-utils.ts"),r=i("./src/controller/base-playlist-controller.ts"),P=i("./src/types/loader.ts");function O(T,L){for(var g=0;g<L.length;g++){var o=L[g];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(T,o.key,o)}}function x(T,L,g){return L&&O(T.prototype,L),g&&O(T,g),T}function m(T,L){T.prototype=Object.create(L.prototype),T.prototype.constructor=T,c(T,L)}function c(T,L){return c=Object.setPrototypeOf||function(o,t){return o.__proto__=t,o},c(T,L)}var v=function(T){m(L,T);function L(o){var t;return t=T.call(this,o,"[subtitle-track-controller]")||this,t.media=null,t.tracks=[],t.groupId=null,t.tracksInGroup=[],t.trackId=-1,t.selectDefaultTrack=!0,t.queuedDefaultTrack=-1,t.trackChangeListener=function(){return t.onTextTracksChanged()},t.asyncPollTrackChange=function(){return t.pollTrackChange(0)},t.useTextTrackPolling=!1,t.subtitlePollingInterval=-1,t.subtitleDisplay=!0,t.registerListeners(),t}var g=L.prototype;return g.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,T.prototype.destroy.call(this)},g.registerListeners=function(){var t=this.hls;t.on(A.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(A.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(A.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(A.Events.LEVEL_LOADING,this.onLevelLoading,this),t.on(A.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(A.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(A.Events.ERROR,this.onError,this)},g.unregisterListeners=function(){var t=this.hls;t.off(A.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(A.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(A.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(A.Events.LEVEL_LOADING,this.onLevelLoading,this),t.off(A.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(A.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(A.Events.ERROR,this.onError,this)},g.onMediaAttached=function(t,a){this.media=a.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},g.pollTrackChange=function(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,t)},g.onMediaDetaching=function(){if(!!this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var t=h(this.media.textTracks);t.forEach(function(a){Object(u.clearCurrentCues)(a)}),this.subtitleTrack=-1,this.media=null}},g.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},g.onManifestParsed=function(t,a){this.tracks=a.subtitleTracks},g.onSubtitleTrackLoaded=function(t,a){var n=a.id,d=a.details,l=this.trackId,s=this.tracksInGroup[l];if(!s){this.warn("Invalid subtitle track id "+n);return}var f=s.details;s.details=a.details,this.log("subtitle track "+n+" loaded ["+d.startSN+"-"+d.endSN+"]"),n===this.trackId&&(this.retryCount=0,this.playlistLoaded(n,a,f))},g.onLevelLoading=function(t,a){this.switchLevel(a.level)},g.onLevelSwitching=function(t,a){this.switchLevel(a.level)},g.switchLevel=function(t){var a=this.hls.levels[t];if(!!(a!=null&&a.textGroupIds)){var n=a.textGroupIds[a.urlId];if(this.groupId!==n){var d=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,l=this.tracks.filter(function(C){return!n||C.groupId===n});this.tracksInGroup=l;var s=this.findTrackId(d==null?void 0:d.name)||this.findTrackId();this.groupId=n;var f={subtitleTracks:l};this.log("Updating subtitle tracks, "+l.length+' track(s) found in "'+n+'" group-id'),this.hls.trigger(A.Events.SUBTITLE_TRACKS_UPDATED,f),s!==-1&&this.setSubtitleTrack(s,d)}}},g.findTrackId=function(t){for(var a=this.tracksInGroup,n=0;n<a.length;n++){var d=a[n];if((!this.selectDefaultTrack||d.default)&&(!t||t===d.name))return d.id}return-1},g.onError=function(t,a){T.prototype.onError.call(this,t,a),!(a.fatal||!a.context)&&a.context.type===P.PlaylistContextType.SUBTITLE_TRACK&&a.context.id===this.trackId&&a.context.groupId===this.groupId&&this.retryLoadingOrFail(a)},g.loadPlaylist=function(t){var a=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(a)){var n=a.id,d=a.groupId,l=a.url;if(t)try{l=t.addDirectives(l)}catch(s){this.warn("Could not construct new URL with HLS Delivery Directives: "+s)}this.log("Loading subtitle playlist for id "+n),this.hls.trigger(A.Events.SUBTITLE_TRACK_LOADING,{url:l,id:n,groupId:d,deliveryDirectives:t||null})}},g.toggleTrackModes=function(t){var a=this,n=this.media,d=this.subtitleDisplay,l=this.trackId;if(!!n){var s=h(n.textTracks),f=s.filter(function(E){return E.groupId===a.groupId});if(t===-1)[].slice.call(s).forEach(function(E){E.mode="disabled"});else{var C=f[l];C&&(C.mode="disabled")}var D=f[t];D&&(D.mode=d?"showing":"hidden")}},g.setSubtitleTrack=function(t,a){var n,d=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=t;return}if(this.trackId!==t&&this.toggleTrackModes(t),!(this.trackId===t&&(t===-1||(n=d[t])!==null&&n!==void 0&&n.details)||t<-1||t>=d.length)){this.clearTimer();var l=d[t];if(this.log("Switching to subtitle track "+t),this.trackId=t,l){var s=l.id,f=l.groupId,C=f===void 0?"":f,D=l.name,E=l.type,p=l.url;this.hls.trigger(A.Events.SUBTITLE_TRACK_SWITCH,{id:s,groupId:C,name:D,type:E,url:p});var y=this.switchParams(l.url,a==null?void 0:a.details);this.loadPlaylist(y)}else this.hls.trigger(A.Events.SUBTITLE_TRACK_SWITCH,{id:t})}},g.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var t=-1,a=h(this.media.textTracks),n=0;n<a.length;n++)if(a[n].mode==="hidden")t=n;else if(a[n].mode==="showing"){t=n;break}this.subtitleTrack!==t&&(this.subtitleTrack=t)}},x(L,[{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(t){this.selectDefaultTrack=!1;var a=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(t,a)}}]),L}(r.default);function h(T){for(var L=[],g=0;g<T.length;g++){var o=T[g];o.kind==="subtitles"&&o.label&&L.push(T[g])}return L}M.default=v},"./src/controller/timeline-controller.ts":function(I,M,i){i.r(M),i.d(M,"TimelineController",function(){return h});var A=i("./src/polyfills/number.ts"),u=i("./src/events.ts"),r=i("./src/utils/cea-608-parser.ts"),P=i("./src/utils/output-filter.ts"),O=i("./src/utils/webvtt-parser.ts"),x=i("./src/utils/texttrack-utils.ts"),m=i("./src/utils/imsc1-ttml-parser.ts"),c=i("./src/types/loader.ts"),v=i("./src/utils/logger.ts"),h=function(){function o(a){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=g(),this.captionsProperties=void 0,this.hls=a,this.config=a.config,this.Cues=a.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var n=new P.default(this,"textTrack1"),d=new P.default(this,"textTrack2"),l=new P.default(this,"textTrack3"),s=new P.default(this,"textTrack4");this.cea608Parser1=new r.default(1,n,d),this.cea608Parser2=new r.default(3,l,s)}a.on(u.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),a.on(u.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.on(u.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.on(u.Events.MANIFEST_LOADED,this.onManifestLoaded,this),a.on(u.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),a.on(u.Events.FRAG_LOADING,this.onFragLoading,this),a.on(u.Events.FRAG_LOADED,this.onFragLoaded,this),a.on(u.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),a.on(u.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),a.on(u.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),a.on(u.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),a.on(u.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var t=o.prototype;return t.destroy=function(){var n=this.hls;n.off(u.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),n.off(u.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.off(u.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.off(u.Events.MANIFEST_LOADED,this.onManifestLoaded,this),n.off(u.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),n.off(u.Events.FRAG_LOADING,this.onFragLoading,this),n.off(u.Events.FRAG_LOADED,this.onFragLoaded,this),n.off(u.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),n.off(u.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),n.off(u.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),n.off(u.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),n.off(u.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},t.addCues=function(n,d,l,s,f){for(var C=!1,D=f.length;D--;){var E=f[D],p=L(E[0],E[1],d,l);if(p>=0&&(E[0]=Math.min(E[0],d),E[1]=Math.max(E[1],l),C=!0,p/(l-d)>.5))return}if(C||f.push([d,l]),this.config.renderTextTracksNatively){var y=this.captionsTracks[n];this.Cues.newCue(y,d,l,s)}else{var S=this.Cues.newCue(null,d,l,s);this.hls.trigger(u.Events.CUES_PARSED,{type:"captions",cues:S,track:n})}},t.onInitPtsFound=function(n,d){var l=this,s=d.frag,f=d.id,C=d.initPTS,D=d.timescale,E=this.unparsedVttFrags;f==="main"&&(this.initPTS[s.cc]=C,this.timescale[s.cc]=D),E.length&&(this.unparsedVttFrags=[],E.forEach(function(p){l.onFragLoaded(u.Events.FRAG_LOADED,p)}))},t.getExistingTrack=function(n){var d=this.media;if(d)for(var l=0;l<d.textTracks.length;l++){var s=d.textTracks[l];if(s[n])return s}return null},t.createCaptionsTrack=function(n){this.config.renderTextTracksNatively?this.createNativeTrack(n):this.createNonNativeTrack(n)},t.createNativeTrack=function(n){if(!this.captionsTracks[n]){var d=this.captionsProperties,l=this.captionsTracks,s=this.media,f=d[n],C=f.label,D=f.languageCode,E=this.getExistingTrack(n);if(E)l[n]=E,Object(x.clearCurrentCues)(l[n]),Object(x.sendAddTrackEvent)(l[n],s);else{var p=this.createTextTrack("captions",C,D);p&&(p[n]=!0,l[n]=p)}}},t.createNonNativeTrack=function(n){if(!this.nonNativeCaptionsTracks[n]){var d=this.captionsProperties[n];if(!!d){var l=d.label,s={_id:n,label:l,kind:"captions",default:d.media?!!d.media.default:!1,closedCaptions:d.media};this.nonNativeCaptionsTracks[n]=s,this.hls.trigger(u.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}}},t.createTextTrack=function(n,d,l){var s=this.media;if(!!s)return s.addTextTrack(n,d,l)},t.onMediaAttaching=function(n,d){this.media=d.media,this._cleanTracks()},t.onMediaDetaching=function(){var n=this.captionsTracks;Object.keys(n).forEach(function(d){Object(x.clearCurrentCues)(n[d]),delete n[d]}),this.nonNativeCaptionsTracks={}},t.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=g(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},t._cleanTracks=function(){var n=this.media;if(!!n){var d=n.textTracks;if(d)for(var l=0;l<d.length;l++)Object(x.clearCurrentCues)(d[l])}},t.onSubtitleTracksUpdated=function(n,d){var l=this;this.textTracks=[];var s=d.subtitleTracks||[],f=s.some(function(p){return p.textCodec===m.IMSC1_CODEC});if(this.config.enableWebVTT||f&&this.config.enableIMSC1){var C=this.tracks&&s&&this.tracks.length===s.length;if(this.tracks=s||[],this.config.renderTextTracksNatively){var D=this.media?this.media.textTracks:[];this.tracks.forEach(function(p,y){var S;if(y<D.length){for(var R=null,w=0;w<D.length;w++)if(T(D[w],p)){R=D[w];break}R&&(S=R)}S?Object(x.clearCurrentCues)(S):(S=l.createTextTrack("subtitles",p.name,p.lang),S&&(S.mode="disabled")),S&&(S.groupId=p.groupId,l.textTracks.push(S))})}else if(!C&&this.tracks&&this.tracks.length){var E=this.tracks.map(function(p){return{label:p.name,kind:p.type.toLowerCase(),default:p.default,subtitleTrack:p}});this.hls.trigger(u.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:E})}}},t.onManifestLoaded=function(n,d){var l=this;this.config.enableCEA708Captions&&d.captions&&d.captions.forEach(function(s){var f=/(?:CC|SERVICE)([1-4])/.exec(s.instreamId);if(!!f){var C="textTrack"+f[1],D=l.captionsProperties[C];!D||(D.label=s.name,s.lang&&(D.languageCode=s.lang),D.media=s)}})},t.onFragLoading=function(n,d){var l=this.cea608Parser1,s=this.cea608Parser2,f=this.lastSn,C=this.lastPartIndex;if(!(!this.enabled||!(l&&s))&&d.frag.type===c.PlaylistLevelType.MAIN){var D,E,p=d.frag.sn,y=(D=d==null||(E=d.part)===null||E===void 0?void 0:E.index)!=null?D:-1;p===f+1||p===f&&y===C+1||(l.reset(),s.reset()),this.lastSn=p,this.lastPartIndex=y}},t.onFragLoaded=function(n,d){var l=d.frag,s=d.payload,f=this.initPTS,C=this.unparsedVttFrags;if(l.type===c.PlaylistLevelType.SUBTITLE)if(s.byteLength){if(!Object(A.isFiniteNumber)(f[l.cc])){C.push(d),f.length&&this.hls.trigger(u.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:l,error:new Error("Missing initial subtitle PTS")});return}var D=l.decryptdata,E="stats"in d;if(D==null||D.key==null||D.method!=="AES-128"||E){var p=this.tracks[l.level],y=this.vttCCs;y[l.cc]||(y[l.cc]={start:l.start,prevCC:this.prevCC,new:!0},this.prevCC=l.cc),p&&p.textCodec===m.IMSC1_CODEC?this._parseIMSC1(l,s):this._parseVTTs(l,s,y)}}else this.hls.trigger(u.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:l,error:new Error("Empty subtitle payload")})},t._parseIMSC1=function(n,d){var l=this,s=this.hls;Object(m.parseIMSC1)(d,this.initPTS[n.cc],this.timescale[n.cc],function(f){l._appendCues(f,n.level),s.trigger(u.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},function(f){v.logger.log("Failed to parse IMSC1: "+f),s.trigger(u.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:f})})},t._parseVTTs=function(n,d,l){var s=this,f=this.hls;Object(O.parseWebVTT)(d,this.initPTS[n.cc],this.timescale[n.cc],l,n.cc,n.start,function(C){s._appendCues(C,n.level),f.trigger(u.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},function(C){s._fallbackToIMSC1(n,d),v.logger.log("Failed to parse VTT cue: "+C),f.trigger(u.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:C})})},t._fallbackToIMSC1=function(n,d){var l=this,s=this.tracks[n.level];s.textCodec||Object(m.parseIMSC1)(d,this.initPTS[n.cc],this.timescale[n.cc],function(){s.textCodec=m.IMSC1_CODEC,l._parseIMSC1(n,d)},function(){s.textCodec="wvtt"})},t._appendCues=function(n,d){var l=this.hls;if(this.config.renderTextTracksNatively){var s=this.textTracks[d];if(s.mode==="disabled")return;n.forEach(function(D){return Object(x.addCueToTrack)(s,D)})}else{var f=this.tracks[d],C=f.default?"default":"subtitles"+d;l.trigger(u.Events.CUES_PARSED,{type:"subtitles",cues:n,track:C})}},t.onFragDecrypted=function(n,d){var l=d.frag;if(l.type===c.PlaylistLevelType.SUBTITLE){if(!Object(A.isFiniteNumber)(this.initPTS[l.cc])){this.unparsedVttFrags.push(d);return}this.onFragLoaded(u.Events.FRAG_LOADED,d)}},t.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},t.onFragParsingUserdata=function(n,d){var l=this.cea608Parser1,s=this.cea608Parser2;if(!(!this.enabled||!(l&&s)))for(var f=0;f<d.samples.length;f++){var C=d.samples[f].bytes;if(C){var D=this.extractCea608Data(C);l.addData(d.samples[f].pts,D[0]),s.addData(d.samples[f].pts,D[1])}}},t.onBufferFlushing=function(n,d){var l=d.startOffset,s=d.endOffset,f=d.endOffsetSubtitles,C=d.type,D=this.media;if(!(!D||D.currentTime<s)){if(!C||C==="video"){var E=this.captionsTracks;Object.keys(E).forEach(function(y){return Object(x.removeCuesInRange)(E[y],l,s)})}if(this.config.renderTextTracksNatively&&l===0&&f!==void 0){var p=this.textTracks;Object.keys(p).forEach(function(y){return Object(x.removeCuesInRange)(p[y],l,f)})}}},t.extractCea608Data=function(n){for(var d=n[0]&31,l=2,s=[[],[]],f=0;f<d;f++){var C=n[l++],D=127&n[l++],E=127&n[l++],p=(4&C)!==0,y=3&C;D===0&&E===0||p&&(y===0||y===1)&&(s[y].push(D),s[y].push(E))}return s},o}();function T(o,t){return o&&o.label===t.name&&!(o.textTrack1||o.textTrack2)}function L(o,t,a,n){return Math.min(t,n)-Math.max(o,a)}function g(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}}}},"./src/crypt/aes-crypto.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return A});var A=function(){function u(P,O){this.subtle=void 0,this.aesIV=void 0,this.subtle=P,this.aesIV=O}var r=u.prototype;return r.decrypt=function(O,x){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},x,O)},u}()},"./src/crypt/aes-decryptor.ts":function(I,M,i){i.r(M),i.d(M,"removePadding",function(){return u}),i.d(M,"default",function(){return r});var A=i("./src/utils/typed-array.ts");function u(P){var O=P.byteLength,x=O&&new DataView(P.buffer).getUint8(O-1);return x?Object(A.sliceUint8)(P,0,O-x):P}var r=function(){function P(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var O=P.prototype;return O.uint8ArrayToUint32Array_=function(m){for(var c=new DataView(m),v=new Uint32Array(4),h=0;h<4;h++)v[h]=c.getUint32(h*4);return v},O.initTable=function(){var m=this.sBox,c=this.invSBox,v=this.subMix,h=v[0],T=v[1],L=v[2],g=v[3],o=this.invSubMix,t=o[0],a=o[1],n=o[2],d=o[3],l=new Uint32Array(256),s=0,f=0,C=0;for(C=0;C<256;C++)C<128?l[C]=C<<1:l[C]=C<<1^283;for(C=0;C<256;C++){var D=f^f<<1^f<<2^f<<3^f<<4;D=D>>>8^D&255^99,m[s]=D,c[D]=s;var E=l[s],p=l[E],y=l[p],S=l[D]*257^D*16843008;h[s]=S<<24|S>>>8,T[s]=S<<16|S>>>16,L[s]=S<<8|S>>>24,g[s]=S,S=y*16843009^p*65537^E*257^s*16843008,t[D]=S<<24|S>>>8,a[D]=S<<16|S>>>16,n[D]=S<<8|S>>>24,d[D]=S,s?(s=E^l[l[l[y^E]]],f^=l[l[f]]):s=f=1}},O.expandKey=function(m){for(var c=this.uint8ArrayToUint32Array_(m),v=!0,h=0;h<c.length&&v;)v=c[h]===this.key[h],h++;if(!v){this.key=c;var T=this.keySize=c.length;if(T!==4&&T!==6&&T!==8)throw new Error("Invalid aes key size="+T);var L=this.ksRows=(T+6+1)*4,g,o,t=this.keySchedule=new Uint32Array(L),a=this.invKeySchedule=new Uint32Array(L),n=this.sBox,d=this.rcon,l=this.invSubMix,s=l[0],f=l[1],C=l[2],D=l[3],E,p;for(g=0;g<L;g++){if(g<T){E=t[g]=c[g];continue}p=E,g%T===0?(p=p<<8|p>>>24,p=n[p>>>24]<<24|n[p>>>16&255]<<16|n[p>>>8&255]<<8|n[p&255],p^=d[g/T|0]<<24):T>6&&g%T===4&&(p=n[p>>>24]<<24|n[p>>>16&255]<<16|n[p>>>8&255]<<8|n[p&255]),t[g]=E=(t[g-T]^p)>>>0}for(o=0;o<L;o++)g=L-o,o&3?p=t[g]:p=t[g-4],o<4||g<=4?a[o]=p:a[o]=s[n[p>>>24]]^f[n[p>>>16&255]]^C[n[p>>>8&255]]^D[n[p&255]],a[o]=a[o]>>>0}},O.networkToHostOrderSwap=function(m){return m<<24|(m&65280)<<8|(m&16711680)>>8|m>>>24},O.decrypt=function(m,c,v){for(var h=this.keySize+6,T=this.invKeySchedule,L=this.invSBox,g=this.invSubMix,o=g[0],t=g[1],a=g[2],n=g[3],d=this.uint8ArrayToUint32Array_(v),l=d[0],s=d[1],f=d[2],C=d[3],D=new Int32Array(m),E=new Int32Array(D.length),p,y,S,R,w,k,_,F,U,N,W,H,G,J,X=this.networkToHostOrderSwap;c<D.length;){for(U=X(D[c]),N=X(D[c+1]),W=X(D[c+2]),H=X(D[c+3]),w=U^T[0],k=H^T[1],_=W^T[2],F=N^T[3],G=4,J=1;J<h;J++)p=o[w>>>24]^t[k>>16&255]^a[_>>8&255]^n[F&255]^T[G],y=o[k>>>24]^t[_>>16&255]^a[F>>8&255]^n[w&255]^T[G+1],S=o[_>>>24]^t[F>>16&255]^a[w>>8&255]^n[k&255]^T[G+2],R=o[F>>>24]^t[w>>16&255]^a[k>>8&255]^n[_&255]^T[G+3],w=p,k=y,_=S,F=R,G=G+4;p=L[w>>>24]<<24^L[k>>16&255]<<16^L[_>>8&255]<<8^L[F&255]^T[G],y=L[k>>>24]<<24^L[_>>16&255]<<16^L[F>>8&255]<<8^L[w&255]^T[G+1],S=L[_>>>24]<<24^L[F>>16&255]<<16^L[w>>8&255]<<8^L[k&255]^T[G+2],R=L[F>>>24]<<24^L[w>>16&255]<<16^L[k>>8&255]<<8^L[_&255]^T[G+3],E[c]=X(p^l),E[c+1]=X(R^s),E[c+2]=X(S^f),E[c+3]=X(y^C),l=U,s=N,f=W,C=H,c=c+4}return E.buffer},P}()},"./src/crypt/decrypter.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return c});var A=i("./src/crypt/aes-crypto.ts"),u=i("./src/crypt/fast-aes-key.ts"),r=i("./src/crypt/aes-decryptor.ts"),P=i("./src/utils/logger.ts"),O=i("./src/utils/mp4-tools.ts"),x=i("./src/utils/typed-array.ts"),m=16,c=function(){function v(T,L,g){var o=g===void 0?{}:g,t=o.removePKCS7Padding,a=t===void 0?!0:t;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=T,this.config=L,this.removePKCS7Padding=a,a)try{var n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var h=v.prototype;return h.destroy=function(){this.observer=null},h.isSync=function(){return this.config.enableSoftwareAES},h.flush=function(){var L=this.currentResult;if(!L){this.reset();return}var g=new Uint8Array(L);return this.reset(),this.removePKCS7Padding?Object(r.removePadding)(g):g},h.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},h.decrypt=function(L,g,o,t){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(L),g,o);var a=this.flush();a&&t(a.buffer)}else this.webCryptoDecrypt(new Uint8Array(L),g,o).then(t)},h.softwareDecrypt=function(L,g,o){var t=this.currentIV,a=this.currentResult,n=this.remainderData;this.logOnce("JS AES decrypt"),n&&(L=Object(O.appendUint8Array)(n,L),this.remainderData=null);var d=this.getValidChunk(L);if(!d.length)return null;t&&(o=t);var l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new r.default),l.expandKey(g);var s=a;return this.currentResult=l.decrypt(d.buffer,0,o),this.currentIV=Object(x.sliceUint8)(d,-16).buffer,s||null},h.webCryptoDecrypt=function(L,g,o){var t=this,a=this.subtle;return(this.key!==g||!this.fastAesKey)&&(this.key=g,this.fastAesKey=new u.default(a,g)),this.fastAesKey.expandKey().then(function(n){if(!a)return Promise.reject(new Error("web crypto not initialized"));var d=new A.default(a,o);return d.decrypt(L.buffer,n)}).catch(function(n){return t.onWebCryptoError(n,L,g,o)})},h.onWebCryptoError=function(L,g,o,t){return P.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",L),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(g,o,t)},h.getValidChunk=function(L){var g=L,o=L.length-L.length%m;return o!==L.length&&(g=Object(x.sliceUint8)(L,0,o),this.remainderData=Object(x.sliceUint8)(L,o)),g},h.logOnce=function(L){!this.logEnabled||(P.logger.log("[decrypter.ts]: "+L),this.logEnabled=!1)},v}()},"./src/crypt/fast-aes-key.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return A});var A=function(){function u(P,O){this.subtle=void 0,this.key=void 0,this.subtle=P,this.key=O}var r=u.prototype;return r.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},u}()},"./src/demux/aacdemuxer.ts":function(I,M,i){i.r(M);var A=i("./src/demux/base-audio-demuxer.ts"),u=i("./src/demux/adts.ts"),r=i("./src/utils/logger.ts"),P=i("./src/demux/id3.ts");function O(c,v){c.prototype=Object.create(v.prototype),c.prototype.constructor=c,x(c,v)}function x(c,v){return x=Object.setPrototypeOf||function(T,L){return T.__proto__=L,T},x(c,v)}var m=function(c){O(v,c);function v(T,L){var g;return g=c.call(this)||this,g.observer=void 0,g.config=void 0,g.observer=T,g.config=L,g}var h=v.prototype;return h.resetInitSegment=function(L,g,o){c.prototype.resetInitSegment.call(this,L,g,o),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:L,duration:o,inputTimeScale:9e4,dropped:0}},v.probe=function(L){if(!L)return!1;for(var g=P.getID3Data(L,0)||[],o=g.length,t=L.length;o<t;o++)if(u.probe(L,o))return r.logger.log("ADTS sync word found !"),!0;return!1},h.canParse=function(L,g){return u.canParse(L,g)},h.appendFrame=function(L,g,o){u.initTrackConfig(L,this.observer,g,o,L.manifestCodec);var t=u.appendFrame(L,g,o,this.initPTS,this.frameIndex);if(t&&t.missing===0)return t},v}(A.default);m.minProbeByteLength=9,M.default=m},"./src/demux/adts.ts":function(I,M,i){i.r(M),i.d(M,"getAudioConfig",function(){return P}),i.d(M,"isHeaderPattern",function(){return O}),i.d(M,"getHeaderLength",function(){return x}),i.d(M,"getFullFrameLength",function(){return m}),i.d(M,"canGetFrameLength",function(){return c}),i.d(M,"isHeader",function(){return v}),i.d(M,"canParse",function(){return h}),i.d(M,"probe",function(){return T}),i.d(M,"initTrackConfig",function(){return L}),i.d(M,"getFrameDuration",function(){return g}),i.d(M,"parseFrameHeader",function(){return o}),i.d(M,"appendFrame",function(){return t});var A=i("./src/utils/logger.ts"),u=i("./src/errors.ts"),r=i("./src/events.ts");function P(a,n,d,l){var s,f,C,D,E=navigator.userAgent.toLowerCase(),p=l,y=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];s=((n[d+2]&192)>>>6)+1;var S=(n[d+2]&60)>>>2;if(S>y.length-1){a.trigger(r.Events.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+S});return}return C=(n[d+2]&1)<<2,C|=(n[d+3]&192)>>>6,A.logger.log("manifest codec:"+l+", ADTS type:"+s+", samplingIndex:"+S),/firefox/i.test(E)?S>=6?(s=5,D=new Array(4),f=S-3):(s=2,D=new Array(2),f=S):E.indexOf("android")!==-1?(s=2,D=new Array(2),f=S):(s=5,D=new Array(4),l&&(l.indexOf("mp4a.40.29")!==-1||l.indexOf("mp4a.40.5")!==-1)||!l&&S>=6?f=S-3:((l&&l.indexOf("mp4a.40.2")!==-1&&(S>=6&&C===1||/vivaldi/i.test(E))||!l&&C===1)&&(s=2,D=new Array(2)),f=S)),D[0]=s<<3,D[0]|=(S&14)>>1,D[1]|=(S&1)<<7,D[1]|=C<<3,s===5&&(D[1]|=(f&14)>>1,D[2]=(f&1)<<7,D[2]|=2<<2,D[3]=0),{config:D,samplerate:y[S],channelCount:C,codec:"mp4a.40."+s,manifestCodec:p}}function O(a,n){return a[n]===255&&(a[n+1]&246)===240}function x(a,n){return a[n+1]&1?7:9}function m(a,n){return(a[n+3]&3)<<11|a[n+4]<<3|(a[n+5]&224)>>>5}function c(a,n){return n+5<a.length}function v(a,n){return n+1<a.length&&O(a,n)}function h(a,n){return c(a,n)&&O(a,n)&&m(a,n)<=a.length-n}function T(a,n){if(v(a,n)){var d=x(a,n);if(n+d>=a.length)return!1;var l=m(a,n);if(l<=d)return!1;var s=n+l;return s===a.length||v(a,s)}return!1}function L(a,n,d,l,s){if(!a.samplerate){var f=P(n,d,l,s);if(!f)return;a.config=f.config,a.samplerate=f.samplerate,a.channelCount=f.channelCount,a.codec=f.codec,a.manifestCodec=f.manifestCodec,A.logger.log("parsed codec:"+a.codec+", rate:"+f.samplerate+", channels:"+f.channelCount)}}function g(a){return 1024*9e4/a}function o(a,n,d,l,s){var f=x(a,n),C=m(a,n);if(C-=f,C>0){var D=d+l*s;return{headerLength:f,frameLength:C,stamp:D}}}function t(a,n,d,l,s){var f=g(a.samplerate),C=o(n,d,l,s,f);if(C){var D=C.frameLength,E=C.headerLength,p=C.stamp,y=E+D,S=Math.max(0,d+y-n.length),R;S?(R=new Uint8Array(y-E),R.set(n.subarray(d+E,n.length),0)):R=n.subarray(d+E,d+y);var w={unit:R,pts:p};return S||a.samples.push(w),{sample:w,length:y,missing:S}}}},"./src/demux/base-audio-demuxer.ts":function(I,M,i){i.r(M),i.d(M,"initPTSFn",function(){return m});var A=i("./src/polyfills/number.ts"),u=i("./src/demux/id3.ts"),r=i("./src/demux/dummy-demuxed-track.ts"),P=i("./src/utils/mp4-tools.ts"),O=i("./src/utils/typed-array.ts"),x=function(){function c(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.initPTS=null}var v=c.prototype;return v.resetInitSegment=function(T,L,g){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},v.resetTimeStamp=function(){},v.resetContiguity=function(){},v.canParse=function(T,L){return!1},v.appendFrame=function(T,L,g){},v.demux=function(T,L){this.cachedData&&(T=Object(P.appendUint8Array)(this.cachedData,T),this.cachedData=null);var g=u.getID3Data(T,0),o=g?g.length:0,t,a,n=this._audioTrack,d=this._id3Track,l=g?u.getTimeStamp(g):void 0,s=T.length;for((this.frameIndex===0||this.initPTS===null)&&(this.initPTS=m(l,L)),g&&g.length>0&&d.samples.push({pts:this.initPTS,dts:this.initPTS,data:g}),a=this.initPTS;o<s;){if(this.canParse(T,o)){var f=this.appendFrame(n,T,o);f?(this.frameIndex++,a=f.sample.pts,o+=f.length,t=o):o=s}else u.canParse(T,o)?(g=u.getID3Data(T,o),d.samples.push({pts:a,dts:a,data:g}),o+=g.length,t=o):o++;if(o===s&&t!==s){var C=Object(O.sliceUint8)(T,t);this.cachedData?this.cachedData=Object(P.appendUint8Array)(this.cachedData,C):this.cachedData=C}}return{audioTrack:n,avcTrack:Object(r.dummyTrack)(),id3Track:d,textTrack:Object(r.dummyTrack)()}},v.demuxSampleAes=function(T,L,g){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},v.flush=function(T){var L=this.cachedData;return L&&(this.cachedData=null,this.demux(L,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:Object(r.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(r.dummyTrack)()}},v.destroy=function(){},c}(),m=function(v,h){return Object(A.isFiniteNumber)(v)?v*90:h*9e4};M.default=x},"./src/demux/chunk-cache.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return A});var A=function(){function r(){this.chunks=[],this.dataLength=0}var P=r.prototype;return P.push=function(x){this.chunks.push(x),this.dataLength+=x.length},P.flush=function(){var x=this.chunks,m=this.dataLength,c;if(x.length)x.length===1?c=x[0]:c=u(x,m);else return new Uint8Array(0);return this.reset(),c},P.reset=function(){this.chunks.length=0,this.dataLength=0},r}();function u(r,P){for(var O=new Uint8Array(P),x=0,m=0;m<r.length;m++){var c=r[m];O.set(c,x),x+=c.length}return O}},"./src/demux/dummy-demuxed-track.ts":function(I,M,i){i.r(M),i.d(M,"dummyTrack",function(){return A});function A(){return{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}},"./src/demux/exp-golomb.ts":function(I,M,i){i.r(M);var A=i("./src/utils/logger.ts"),u=function(){function r(O){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=O,this.bytesAvailable=O.byteLength,this.word=0,this.bitsAvailable=0}var P=r.prototype;return P.loadWord=function(){var x=this.data,m=this.bytesAvailable,c=x.byteLength-m,v=new Uint8Array(4),h=Math.min(4,m);if(h===0)throw new Error("no bytes available");v.set(x.subarray(c,c+h)),this.word=new DataView(v.buffer).getUint32(0),this.bitsAvailable=h*8,this.bytesAvailable-=h},P.skipBits=function(x){var m;this.bitsAvailable>x?(this.word<<=x,this.bitsAvailable-=x):(x-=this.bitsAvailable,m=x>>3,x-=m>>3,this.bytesAvailable-=m,this.loadWord(),this.word<<=x,this.bitsAvailable-=x)},P.readBits=function(x){var m=Math.min(this.bitsAvailable,x),c=this.word>>>32-m;return x>32&&A.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=m,this.bitsAvailable>0?this.word<<=m:this.bytesAvailable>0&&this.loadWord(),m=x-m,m>0&&this.bitsAvailable?c<<m|this.readBits(m):c},P.skipLZ=function(){var x;for(x=0;x<this.bitsAvailable;++x)if((this.word&2147483648>>>x)!==0)return this.word<<=x,this.bitsAvailable-=x,x;return this.loadWord(),x+this.skipLZ()},P.skipUEG=function(){this.skipBits(1+this.skipLZ())},P.skipEG=function(){this.skipBits(1+this.skipLZ())},P.readUEG=function(){var x=this.skipLZ();return this.readBits(x+1)-1},P.readEG=function(){var x=this.readUEG();return 1&x?1+x>>>1:-1*(x>>>1)},P.readBoolean=function(){return this.readBits(1)===1},P.readUByte=function(){return this.readBits(8)},P.readUShort=function(){return this.readBits(16)},P.readUInt=function(){return this.readBits(32)},P.skipScalingList=function(x){for(var m=8,c=8,v,h=0;h<x;h++)c!==0&&(v=this.readEG(),c=(m+v+256)%256),m=c===0?m:c},P.readSPS=function(){var x=0,m=0,c=0,v=0,h,T,L,g=this.readUByte.bind(this),o=this.readBits.bind(this),t=this.readUEG.bind(this),a=this.readBoolean.bind(this),n=this.skipBits.bind(this),d=this.skipEG.bind(this),l=this.skipUEG.bind(this),s=this.skipScalingList.bind(this);g();var f=g();if(o(5),n(3),g(),l(),f===100||f===110||f===122||f===244||f===44||f===83||f===86||f===118||f===128){var C=t();if(C===3&&n(1),l(),l(),n(1),a())for(T=C!==3?8:12,L=0;L<T;L++)a()&&(L<6?s(16):s(64))}l();var D=t();if(D===0)t();else if(D===1)for(n(1),d(),d(),h=t(),L=0;L<h;L++)d();l(),n(1);var E=t(),p=t(),y=o(1);y===0&&n(1),n(1),a()&&(x=t(),m=t(),c=t(),v=t());var S=[1,1];if(a()&&a()){var R=g();switch(R){case 1:S=[1,1];break;case 2:S=[12,11];break;case 3:S=[10,11];break;case 4:S=[16,11];break;case 5:S=[40,33];break;case 6:S=[24,11];break;case 7:S=[20,11];break;case 8:S=[32,11];break;case 9:S=[80,33];break;case 10:S=[18,11];break;case 11:S=[15,11];break;case 12:S=[64,33];break;case 13:S=[160,99];break;case 14:S=[4,3];break;case 15:S=[3,2];break;case 16:S=[2,1];break;case 255:{S=[g()<<8|g(),g()<<8|g()];break}}}return{width:Math.ceil((E+1)*16-x*2-m*2),height:(2-y)*(p+1)*16-(y?2:4)*(c+v),pixelRatio:S}},P.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},r}();M.default=u},"./src/demux/id3.ts":function(I,M,i){i.r(M),i.d(M,"isHeader",function(){return A}),i.d(M,"isFooter",function(){return u}),i.d(M,"getID3Data",function(){return r}),i.d(M,"canParse",function(){return O}),i.d(M,"getTimeStamp",function(){return x}),i.d(M,"isTimeStampFrame",function(){return m}),i.d(M,"getID3Frames",function(){return v}),i.d(M,"decodeFrame",function(){return h}),i.d(M,"utf8ArrayToStr",function(){return t}),i.d(M,"testables",function(){return a});var A=function(s,f){return f+10<=s.length&&s[f]===73&&s[f+1]===68&&s[f+2]===51&&s[f+3]<255&&s[f+4]<255&&s[f+6]<128&&s[f+7]<128&&s[f+8]<128&&s[f+9]<128},u=function(s,f){return f+10<=s.length&&s[f]===51&&s[f+1]===68&&s[f+2]===73&&s[f+3]<255&&s[f+4]<255&&s[f+6]<128&&s[f+7]<128&&s[f+8]<128&&s[f+9]<128},r=function(s,f){for(var C=f,D=0;A(s,f);){D+=10;var E=P(s,f+6);D+=E,u(s,f+10)&&(D+=10),f+=D}if(D>0)return s.subarray(C,C+D)},P=function(s,f){var C=0;return C=(s[f]&127)<<21,C|=(s[f+1]&127)<<14,C|=(s[f+2]&127)<<7,C|=s[f+3]&127,C},O=function(s,f){return A(s,f)&&P(s,f+6)+10<=s.length-f},x=function(s){for(var f=v(s),C=0;C<f.length;C++){var D=f[C];if(m(D))return o(D)}},m=function(s){return s&&s.key==="PRIV"&&s.info==="com.apple.streaming.transportStreamTimestamp"},c=function(s){var f=String.fromCharCode(s[0],s[1],s[2],s[3]),C=P(s,4),D=10;return{type:f,size:C,data:s.subarray(D,D+C)}},v=function(s){for(var f=0,C=[];A(s,f);){var D=P(s,f+6);f+=10;for(var E=f+D;f+8<E;){var p=c(s.subarray(f)),y=h(p);y&&C.push(y),f+=p.size+10}u(s,f)&&(f+=10)}return C},h=function(s){return s.type==="PRIV"?T(s):s.type[0]==="W"?g(s):L(s)},T=function(s){if(!(s.size<2)){var f=t(s.data,!0),C=new Uint8Array(s.data.subarray(f.length+1));return{key:s.type,info:f,data:C.buffer}}},L=function(s){if(!(s.size<2)){if(s.type==="TXXX"){var f=1,C=t(s.data.subarray(f),!0);f+=C.length+1;var D=t(s.data.subarray(f));return{key:s.type,info:C,data:D}}var E=t(s.data.subarray(1));return{key:s.type,data:E}}},g=function(s){if(s.type==="WXXX"){if(s.size<2)return;var f=1,C=t(s.data.subarray(f),!0);f+=C.length+1;var D=t(s.data.subarray(f));return{key:s.type,info:C,data:D}}var E=t(s.data);return{key:s.type,data:E}},o=function(s){if(s.data.byteLength===8){var f=new Uint8Array(s.data),C=f[3]&1,D=(f[4]<<23)+(f[5]<<15)+(f[6]<<7)+f[7];return D/=45,C&&(D+=4772185884e-2),Math.round(D)}},t=function(s,f){f===void 0&&(f=!1);var C=d();if(C){var D=C.decode(s);if(f){var E=D.indexOf("\0");return E!==-1?D.substring(0,E):D}return D.replace(/\0/g,"")}for(var p=s.length,y,S,R,w="",k=0;k<p;){if(y=s[k++],y===0&&f)return w;if(y===0||y===3)continue;switch(y>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:w+=String.fromCharCode(y);break;case 12:case 13:S=s[k++],w+=String.fromCharCode((y&31)<<6|S&63);break;case 14:S=s[k++],R=s[k++],w+=String.fromCharCode((y&15)<<12|(S&63)<<6|(R&63)<<0);break}}return w},a={decodeTextFrame:L},n;function d(){return!n&&typeof self.TextDecoder!="undefined"&&(n=new self.TextDecoder("utf-8")),n}},"./src/demux/mp3demuxer.ts":function(I,M,i){i.r(M);var A=i("./src/demux/base-audio-demuxer.ts"),u=i("./src/demux/id3.ts"),r=i("./src/utils/logger.ts"),P=i("./src/demux/mpegaudio.ts");function O(c,v){c.prototype=Object.create(v.prototype),c.prototype.constructor=c,x(c,v)}function x(c,v){return x=Object.setPrototypeOf||function(T,L){return T.__proto__=L,T},x(c,v)}var m=function(c){O(v,c);function v(){return c.apply(this,arguments)||this}var h=v.prototype;return h.resetInitSegment=function(L,g,o){c.prototype.resetInitSegment.call(this,L,g,o),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:L,duration:o,inputTimeScale:9e4,dropped:0}},v.probe=function(L){if(!L)return!1;for(var g=u.getID3Data(L,0)||[],o=g.length,t=L.length;o<t;o++)if(P.probe(L,o))return r.logger.log("MPEG Audio sync word found !"),!0;return!1},h.canParse=function(L,g){return P.canParse(L,g)},h.appendFrame=function(L,g,o){if(this.initPTS!==null)return P.appendFrame(L,g,o,this.initPTS,this.frameIndex)},v}(A.default);m.minProbeByteLength=4,M.default=m},"./src/demux/mp4demuxer.ts":function(I,M,i){i.r(M);var A=i("./src/utils/mp4-tools.ts"),u=i("./src/demux/dummy-demuxed-track.ts"),r=function(){function P(x,m){this.remainderData=null,this.config=void 0,this.config=m}var O=P.prototype;return O.resetTimeStamp=function(){},O.resetInitSegment=function(){},O.resetContiguity=function(){},P.probe=function(m){return Object(A.findBox)({data:m,start:0,end:Math.min(m.length,16384)},["moof"]).length>0},O.demux=function(m){var c=m,v=Object(u.dummyTrack)();if(this.config.progressive){this.remainderData&&(c=Object(A.appendUint8Array)(this.remainderData,m));var h=Object(A.segmentValidRange)(c);this.remainderData=h.remainder,v.samples=h.valid||new Uint8Array}else v.samples=c;return{audioTrack:Object(u.dummyTrack)(),avcTrack:v,id3Track:Object(u.dummyTrack)(),textTrack:Object(u.dummyTrack)()}},O.flush=function(){var m=Object(u.dummyTrack)();return m.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:Object(u.dummyTrack)(),avcTrack:m,id3Track:Object(u.dummyTrack)(),textTrack:Object(u.dummyTrack)()}},O.demuxSampleAes=function(m,c,v){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},O.destroy=function(){},P}();r.minProbeByteLength=1024,M.default=r},"./src/demux/mpegaudio.ts":function(I,M,i){i.r(M),i.d(M,"appendFrame",function(){return x}),i.d(M,"parseHeader",function(){return m}),i.d(M,"isHeaderPattern",function(){return c}),i.d(M,"isHeader",function(){return v}),i.d(M,"canParse",function(){return h}),i.d(M,"probe",function(){return T});var A=null,u=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],r=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],P=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],O=[0,1,1,4];function x(L,g,o,t,a){if(!(o+24>g.length)){var n=m(g,o);if(n&&o+n.frameLength<=g.length){var d=n.samplesPerFrame*9e4/n.sampleRate,l=t+a*d,s={unit:g.subarray(o,o+n.frameLength),pts:l,dts:l};return L.config=[],L.channelCount=n.channelCount,L.samplerate=n.sampleRate,L.samples.push(s),{sample:s,length:n.frameLength,missing:0}}}}function m(L,g){var o=L[g+1]>>3&3,t=L[g+1]>>1&3,a=L[g+2]>>4&15,n=L[g+2]>>2&3;if(o!==1&&a!==0&&a!==15&&n!==3){var d=L[g+2]>>1&1,l=L[g+3]>>6,s=o===3?3-t:t===3?3:4,f=u[s*14+a-1]*1e3,C=o===3?0:o===2?1:2,D=r[C*3+n],E=l===3?1:2,p=P[o][t],y=O[t],S=p*8*y,R=Math.floor(p*f/D+d)*y;if(A===null){var w=navigator.userAgent||"",k=w.match(/Chrome\/(\d+)/i);A=k?parseInt(k[1]):0}var _=!!A&&A<=87;return _&&t===2&&f>=224e3&&l===0&&(L[g+3]=L[g+3]|128),{sampleRate:D,channelCount:E,frameLength:R,samplesPerFrame:S}}}function c(L,g){return L[g]===255&&(L[g+1]&224)===224&&(L[g+1]&6)!==0}function v(L,g){return g+1<L.length&&c(L,g)}function h(L,g){var o=4;return c(L,g)&&o<=L.length-g}function T(L,g){if(g+1<L.length&&c(L,g)){var o=4,t=m(L,g),a=o;t!=null&&t.frameLength&&(a=t.frameLength);var n=g+a;return n===L.length||v(L,n)}return!1}},"./src/demux/sample-aes.ts":function(I,M,i){i.r(M);var A=i("./src/crypt/decrypter.ts"),u=i("./src/demux/tsdemuxer.ts"),r=function(){function P(x,m,c){this.keyData=void 0,this.decrypter=void 0,this.keyData=c,this.decrypter=new A.default(x,m,{removePKCS7Padding:!1})}var O=P.prototype;return O.decryptBuffer=function(m,c){this.decrypter.decrypt(m,this.keyData.key.buffer,this.keyData.iv.buffer,c)},O.decryptAacSample=function(m,c,v,h){var T=m[c].unit,L=T.subarray(16,T.length-T.length%16),g=L.buffer.slice(L.byteOffset,L.byteOffset+L.length),o=this;this.decryptBuffer(g,function(t){var a=new Uint8Array(t);T.set(a,16),h||o.decryptAacSamples(m,c+1,v)})},O.decryptAacSamples=function(m,c,v){for(;;c++){if(c>=m.length){v();return}if(!(m[c].unit.length<32)){var h=this.decrypter.isSync();if(this.decryptAacSample(m,c,v,h),!h)return}}},O.getAvcEncryptedData=function(m){for(var c=Math.floor((m.length-48)/160)*16+16,v=new Int8Array(c),h=0,T=32;T<m.length-16;T+=160,h+=16)v.set(m.subarray(T,T+16),h);return v},O.getAvcDecryptedUnit=function(m,c){for(var v=new Uint8Array(c),h=0,T=32;T<m.length-16;T+=160,h+=16)m.set(v.subarray(h,h+16),T);return m},O.decryptAvcSample=function(m,c,v,h,T,L){var g=Object(u.discardEPB)(T.data),o=this.getAvcEncryptedData(g),t=this;this.decryptBuffer(o.buffer,function(a){T.data=t.getAvcDecryptedUnit(g,a),L||t.decryptAvcSamples(m,c,v+1,h)})},O.decryptAvcSamples=function(m,c,v,h){if(m instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;c++,v=0){if(c>=m.length){h();return}for(var T=m[c].units;!(v>=T.length);v++){var L=T[v];if(!(L.data.length<=48||L.type!==1&&L.type!==5)){var g=this.decrypter.isSync();if(this.decryptAvcSample(m,c,v,h,L,g),!g)return}}}},P}();M.default=r},"./src/demux/transmuxer-interface.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return v});var A=i("./node_modules/webworkify-webpack/index.js"),u=i("./src/events.ts"),r=i("./src/demux/transmuxer.ts"),P=i("./src/utils/logger.ts"),O=i("./src/errors.ts"),x=i("./src/utils/mediasource-helper.ts"),m=i("./node_modules/eventemitter3/index.js"),c=Object(x.getMediaSource)()||{isTypeSupported:function(){return!1}},v=function(){function h(L,g,o,t){var a=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=L,this.id=g,this.onTransmuxComplete=o,this.onFlush=t;var n=L.config,d=function(D,E){E=E||{},E.frag=a.frag,E.id=a.id,L.trigger(D,E)};this.observer=new m.EventEmitter,this.observer.on(u.Events.FRAG_DECRYPTED,d),this.observer.on(u.Events.ERROR,d);var l={mp4:c.isTypeSupported("video/mp4"),mpeg:c.isTypeSupported("audio/mpeg"),mp3:c.isTypeSupported('audio/mp4; codecs="mp3"')},s=navigator.vendor;if(n.enableWorker&&typeof Worker!="undefined"){P.logger.log("demuxing in webworker");var f;try{f=this.worker=A("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),f.addEventListener("message",this.onwmsg),f.onerror=function(C){L.trigger(u.Events.ERROR,{type:O.ErrorTypes.OTHER_ERROR,details:O.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(C.message+"  ("+C.filename+":"+C.lineno+")")})},f.postMessage({cmd:"init",typeSupported:l,vendor:s,id:g,config:JSON.stringify(n)})}catch(C){P.logger.warn("Error in worker:",C),P.logger.error("Error while initializing DemuxerWorker, fallback to inline"),f&&self.URL.revokeObjectURL(f.objectURL),this.transmuxer=new r.default(this.observer,l,n,s,g),this.worker=null}}else this.transmuxer=new r.default(this.observer,l,n,s,g)}var T=h.prototype;return T.destroy=function(){var g=this.worker;if(g)g.removeEventListener("message",this.onwmsg),g.terminate(),this.worker=null;else{var o=this.transmuxer;o&&(o.destroy(),this.transmuxer=null)}var t=this.observer;t&&t.removeAllListeners(),this.observer=null},T.push=function(g,o,t,a,n,d,l,s,f,C){var D,E,p=this;f.transmuxing.start=self.performance.now();var y=this.transmuxer,S=this.worker,R=d?d.start:n.start,w=n.decryptdata,k=this.frag,_=!(k&&n.cc===k.cc),F=!(k&&f.level===k.level),U=k?f.sn-k.sn:-1,N=this.part?f.part-this.part.index:1,W=!F&&(U===1||U===0&&N===1),H=self.performance.now();(F||U||n.stats.parsing.start===0)&&(n.stats.parsing.start=H),d&&(N||!W)&&(d.stats.parsing.start=H);var G=!(k&&((D=n.initSegment)===null||D===void 0?void 0:D.url)===((E=k.initSegment)===null||E===void 0?void 0:E.url)),J=new r.TransmuxState(_,W,s,F,R,G);if(!W||_||G){P.logger.log("[transmuxer-interface, "+n.type+"]: Starting new transmux session for sn: "+f.sn+" p: "+f.part+" level: "+f.level+" id: "+f.id+`
        discontinuity: `+_+`
        trackSwitch: `+F+`
        contiguous: `+W+`
        accurateTimeOffset: `+s+`
        timeOffset: `+R+`
        initSegmentChange: `+G);var X=new r.TransmuxConfig(t,a,o,l,C);this.configureTransmuxer(X)}if(this.frag=n,this.part=d,S)S.postMessage({cmd:"demux",data:g,decryptdata:w,chunkMeta:f,state:J},g instanceof ArrayBuffer?[g]:[]);else if(y){var te=y.push(g,w,f,J);Object(r.isPromise)(te)?te.then(function(le){p.handleTransmuxComplete(le)}):this.handleTransmuxComplete(te)}},T.flush=function(g){var o=this;g.transmuxing.start=self.performance.now();var t=this.transmuxer,a=this.worker;if(a)a.postMessage({cmd:"flush",chunkMeta:g});else if(t){var n=t.flush(g);Object(r.isPromise)(n)?n.then(function(d){o.handleFlushResult(d,g)}):this.handleFlushResult(n,g)}},T.handleFlushResult=function(g,o){var t=this;g.forEach(function(a){t.handleTransmuxComplete(a)}),this.onFlush(o)},T.onWorkerMessage=function(g){var o=g.data,t=this.hls;switch(o.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(o.data);break}case"flush":{this.onFlush(o.data);break}default:{o.data=o.data||{},o.data.frag=this.frag,o.data.id=this.id,t.trigger(o.event,o.data);break}}},T.configureTransmuxer=function(g){var o=this.worker,t=this.transmuxer;o?o.postMessage({cmd:"configure",config:g}):t&&t.configure(g)},T.handleTransmuxComplete=function(g){g.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(g)},h}()},"./src/demux/transmuxer-worker.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return O});var A=i("./src/demux/transmuxer.ts"),u=i("./src/events.ts"),r=i("./src/utils/logger.ts"),P=i("./node_modules/eventemitter3/index.js");function O(h){var T=new P.EventEmitter,L=function(o,t){h.postMessage({event:o,data:t})};T.on(u.Events.FRAG_DECRYPTED,L),T.on(u.Events.ERROR,L),h.addEventListener("message",function(g){var o=g.data;switch(o.cmd){case"init":{var t=JSON.parse(o.config);h.transmuxer=new A.default(T,o.typeSupported,t,o.vendor,o.id),Object(r.enableLogs)(t.debug),L("init",null);break}case"configure":{h.transmuxer.configure(o.config);break}case"demux":{var a=h.transmuxer.push(o.data,o.decryptdata,o.chunkMeta,o.state);Object(A.isPromise)(a)?a.then(function(l){x(h,l)}):x(h,a);break}case"flush":{var n=o.chunkMeta,d=h.transmuxer.flush(n);Object(A.isPromise)(d)?d.then(function(l){c(h,l,n)}):c(h,d,n);break}}})}function x(h,T){if(!v(T.remuxResult)){var L=[],g=T.remuxResult,o=g.audio,t=g.video;o&&m(L,o),t&&m(L,t),h.postMessage({event:"transmuxComplete",data:T},L)}}function m(h,T){T.data1&&h.push(T.data1.buffer),T.data2&&h.push(T.data2.buffer)}function c(h,T,L){T.forEach(function(g){x(h,g)}),h.postMessage({event:"flush",data:L})}function v(h){return!h.audio&&!h.video&&!h.text&&!h.id3&&!h.initSegment}},"./src/demux/transmuxer.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return a}),i.d(M,"isPromise",function(){return l}),i.d(M,"TransmuxConfig",function(){return s}),i.d(M,"TransmuxState",function(){return f});var A=i("./src/events.ts"),u=i("./src/errors.ts"),r=i("./src/crypt/decrypter.ts"),P=i("./src/demux/aacdemuxer.ts"),O=i("./src/demux/mp4demuxer.ts"),x=i("./src/demux/tsdemuxer.ts"),m=i("./src/demux/mp3demuxer.ts"),c=i("./src/remux/mp4-remuxer.ts"),v=i("./src/remux/passthrough-remuxer.ts"),h=i("./src/demux/chunk-cache.ts"),T=i("./src/utils/mp4-tools.ts"),L=i("./src/utils/logger.ts"),g;try{g=self.performance.now.bind(self.performance)}catch{L.logger.debug("Unable to use Performance API on this environment"),g=self.Date.now}var o=[{demux:x.default,remux:c.default},{demux:O.default,remux:v.default},{demux:P.default,remux:c.default},{demux:m.default,remux:c.default}],t=1024;o.forEach(function(C){var D=C.demux;t=Math.max(t,D.minProbeByteLength)});var a=function(){function C(E,p,y,S,R){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new h.default,this.observer=E,this.typeSupported=p,this.config=y,this.vendor=S,this.id=R}var D=C.prototype;return D.configure=function(p){this.transmuxConfig=p,this.decrypter&&this.decrypter.reset()},D.push=function(p,y,S,R){var w=this,k=S.transmuxing;k.executeStart=g();var _=new Uint8Array(p),F=this.cache,U=this.config,N=this.currentTransmuxState,W=this.transmuxConfig;R&&(this.currentTransmuxState=R);var H=n(_,y);if(H&&H.method==="AES-128"){var G=this.getDecrypter();if(U.enableSoftwareAES){var J=G.softwareDecrypt(_,H.key.buffer,H.iv.buffer);if(!J)return k.executeEnd=g(),d(S);_=new Uint8Array(J)}else return this.decryptionPromise=G.webCryptoDecrypt(_,H.key.buffer,H.iv.buffer).then(function(Ke){var We=w.push(Ke,null,S);return w.decryptionPromise=null,We}),this.decryptionPromise}var X=R||N,te=X.contiguous,le=X.discontinuity,re=X.trackSwitch,fe=X.accurateTimeOffset,ue=X.timeOffset,ae=X.initSegmentChange,me=W.audioCodec,ge=W.videoCodec,be=W.defaultInitPts,Se=W.duration,we=W.initSegmentData;if((le||re||ae)&&this.resetInitSegment(we,me,ge,Se),(le||ae)&&this.resetInitialTimestamp(be),te||this.resetContiguity(),this.needsProbing(_,le,re)){if(F.dataLength){var Ce=F.flush();_=Object(T.appendUint8Array)(Ce,_)}this.configureTransmuxer(_,W)}var Le=this.transmux(_,H,ue,fe,S),Ue=this.currentTransmuxState;return Ue.contiguous=!0,Ue.discontinuity=!1,Ue.trackSwitch=!1,k.executeEnd=g(),Le},D.flush=function(p){var y=this,S=p.transmuxing;S.executeStart=g();var R=this.decrypter,w=this.cache,k=this.currentTransmuxState,_=this.decryptionPromise;if(_)return _.then(function(){return y.flush(p)});var F=[],U=k.timeOffset;if(R){var N=R.flush();N&&F.push(this.push(N,null,p))}var W=w.dataLength;w.reset();var H=this.demuxer,G=this.remuxer;if(!H||!G)return W>=t&&this.observer.emit(A.Events.ERROR,A.Events.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),S.executeEnd=g(),[d(p)];var J=H.flush(U);return l(J)?J.then(function(X){return y.flushRemux(F,X,p),F}):(this.flushRemux(F,J,p),F)},D.flushRemux=function(p,y,S){var R=y.audioTrack,w=y.avcTrack,k=y.id3Track,_=y.textTrack,F=this.currentTransmuxState,U=F.accurateTimeOffset,N=F.timeOffset;L.logger.log("[transmuxer.ts]: Flushed fragment "+S.sn+(S.part>-1?" p: "+S.part:"")+" of level "+S.level);var W=this.remuxer.remux(R,w,k,_,N,U,!0,this.id);p.push({remuxResult:W,chunkMeta:S}),S.transmuxing.executeEnd=g()},D.resetInitialTimestamp=function(p){var y=this.demuxer,S=this.remuxer;!y||!S||(y.resetTimeStamp(p),S.resetTimeStamp(p))},D.resetContiguity=function(){var p=this.demuxer,y=this.remuxer;!p||!y||(p.resetContiguity(),y.resetNextTimestamp())},D.resetInitSegment=function(p,y,S,R){var w=this.demuxer,k=this.remuxer;!w||!k||(w.resetInitSegment(y,S,R),k.resetInitSegment(p,y,S))},D.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},D.transmux=function(p,y,S,R,w){var k;return y&&y.method==="SAMPLE-AES"?k=this.transmuxSampleAes(p,y,S,R,w):k=this.transmuxUnencrypted(p,S,R,w),k},D.transmuxUnencrypted=function(p,y,S,R){var w=this.demuxer.demux(p,y,!1,!this.config.progressive),k=w.audioTrack,_=w.avcTrack,F=w.id3Track,U=w.textTrack,N=this.remuxer.remux(k,_,F,U,y,S,!1,this.id);return{remuxResult:N,chunkMeta:R}},D.transmuxSampleAes=function(p,y,S,R,w){var k=this;return this.demuxer.demuxSampleAes(p,y,S).then(function(_){var F=k.remuxer.remux(_.audioTrack,_.avcTrack,_.id3Track,_.textTrack,S,R,!1,k.id);return{remuxResult:F,chunkMeta:w}})},D.configureTransmuxer=function(p,y){for(var S=this.config,R=this.observer,w=this.typeSupported,k=this.vendor,_=y.audioCodec,F=y.defaultInitPts,U=y.duration,N=y.initSegmentData,W=y.videoCodec,H,G=0,J=o.length;G<J;G++)if(o[G].demux.probe(p)){H=o[G];break}H||(L.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),H={demux:O.default,remux:v.default});var X=this.demuxer,te=this.remuxer,le=H.remux,re=H.demux;(!te||!(te instanceof le))&&(this.remuxer=new le(R,S,w,k)),(!X||!(X instanceof re))&&(this.demuxer=new re(R,S,w),this.probe=re.probe),this.resetInitSegment(N,_,W,U),this.resetInitialTimestamp(F)},D.needsProbing=function(p,y,S){return!this.demuxer||!this.remuxer||y||S},D.getDecrypter=function(){var p=this.decrypter;return p||(p=this.decrypter=new r.default(this.observer,this.config)),p},C}();function n(C,D){var E=null;return C.byteLength>0&&D!=null&&D.key!=null&&D.iv!==null&&D.method!=null&&(E=D),E}var d=function(D){return{remuxResult:{},chunkMeta:D}};function l(C){return"then"in C&&C.then instanceof Function}var s=function(D,E,p,y,S){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=D,this.videoCodec=E,this.initSegmentData=p,this.duration=y,this.defaultInitPts=S},f=function(D,E,p,y,S,R){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=D,this.contiguous=E,this.accurateTimeOffset=p,this.trackSwitch=y,this.timeOffset=S,this.initSegmentChange=R}},"./src/demux/tsdemuxer.ts":function(I,M,i){i.r(M),i.d(M,"discardEPB",function(){return d});var A=i("./src/demux/adts.ts"),u=i("./src/demux/mpegaudio.ts"),r=i("./src/demux/exp-golomb.ts"),P=i("./src/demux/id3.ts"),O=i("./src/demux/sample-aes.ts"),x=i("./src/events.ts"),m=i("./src/utils/mp4-tools.ts"),c=i("./src/utils/logger.ts"),v=i("./src/errors.ts"),h={video:1,audio:2,id3:3,text:4},T=function(){function l(f,C,D){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this.aacLastPTS=null,this._initPTS=null,this._initDTS=null,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=f,this.config=C,this.typeSupported=D}l.probe=function(C){var D=l.syncOffset(C);return D<0?!1:(D&&c.logger.warn("MPEG2-TS detected but first sync word found @ offset "+D+", junk ahead ?"),!0)},l.syncOffset=function(C){for(var D=Math.min(1e3,C.length-564),E=0;E<D;){if(C[E]===71&&C[E+188]===71&&C[E+2*188]===71)return E;E++}return-1},l.createTrack=function(C,D){return{container:C==="video"||C==="audio"?"video/mp2t":void 0,type:C,id:h[C],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:C==="audio"?D:void 0}};var s=l.prototype;return s.resetInitSegment=function(C,D,E){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=l.createTrack("video",E),this._audioTrack=l.createTrack("audio",E),this._id3Track=l.createTrack("id3",E),this._txtTrack=l.createTrack("text",E),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=C,this.videoCodec=D,this._duration=E},s.resetTimeStamp=function(){},s.resetContiguity=function(){var C=this._audioTrack,D=this._avcTrack,E=this._id3Track;C&&(C.pesData=null),D&&(D.pesData=null),E&&(E.pesData=null),this.aacOverFlow=null,this.aacLastPTS=null},s.demux=function(C,D,E,p){E===void 0&&(E=!1),p===void 0&&(p=!1),E||(this.sampleAes=null);var y,S=this._avcTrack,R=this._audioTrack,w=this._id3Track,k=S.pid,_=S.pesData,F=R.pid,U=w.pid,N=R.pesData,W=w.pesData,H=!1,G=this.pmtParsed,J=this._pmtId,X=C.length;if(this.remainderData&&(C=Object(m.appendUint8Array)(this.remainderData,C),X=C.length,this.remainderData=null),X<188&&!p)return this.remainderData=C,{audioTrack:R,avcTrack:S,id3Track:w,textTrack:this._txtTrack};var te=Math.max(0,l.syncOffset(C));X-=(X+te)%188,X<C.byteLength&&!p&&(this.remainderData=new Uint8Array(C.buffer,X,C.buffer.byteLength-X));for(var le=0,re=te;re<X;re+=188)if(C[re]===71){var fe=!!(C[re+1]&64),ue=((C[re+1]&31)<<8)+C[re+2],ae=(C[re+3]&48)>>4,me=void 0;if(ae>1){if(me=re+5+C[re+4],me===re+188)continue}else me=re+4;switch(ue){case k:fe&&(_&&(y=t(_))&&this.parseAVCPES(y,!1),_={data:[],size:0}),_&&(_.data.push(C.subarray(me,re+188)),_.size+=re+188-me);break;case F:fe&&(N&&(y=t(N))&&(R.isAAC?this.parseAACPES(y):this.parseMPEGPES(y)),N={data:[],size:0}),N&&(N.data.push(C.subarray(me,re+188)),N.size+=re+188-me);break;case U:fe&&(W&&(y=t(W))&&this.parseID3PES(y),W={data:[],size:0}),W&&(W.data.push(C.subarray(me,re+188)),W.size+=re+188-me);break;case 0:fe&&(me+=C[me]+1),J=this._pmtId=g(C,me);break;case J:{fe&&(me+=C[me]+1);var ge=o(C,me,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,E);k=ge.avc,k>0&&(S.pid=k),F=ge.audio,F>0&&(R.pid=F,R.isAAC=ge.isAAC),U=ge.id3,U>0&&(w.pid=U),H&&!G&&(c.logger.log("reparse from beginning"),H=!1,re=te-188),G=this.pmtParsed=!0;break}case 17:case 8191:break;default:H=!0;break}}else le++;le>0&&this.observer.emit(x.Events.ERROR,x.Events.ERROR,{type:v.ErrorTypes.MEDIA_ERROR,details:v.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+le+" TS packet/s that do not start with 0x47"}),S.pesData=_,R.pesData=N,w.pesData=W;var be={audioTrack:R,avcTrack:S,id3Track:w,textTrack:this._txtTrack};return p&&this.extractRemainingSamples(be),be},s.flush=function(){var C=this.remainderData;this.remainderData=null;var D;return C?D=this.demux(C,-1,!1,!0):D={audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(D),this.sampleAes?this.decrypt(D,this.sampleAes):D},s.extractRemainingSamples=function(C){var D=C.audioTrack,E=C.avcTrack,p=C.id3Track,y=E.pesData,S=D.pesData,R=p.pesData,w;y&&(w=t(y))?(this.parseAVCPES(w,!0),E.pesData=null):E.pesData=y,S&&(w=t(S))?(D.isAAC?this.parseAACPES(w):this.parseMPEGPES(w),D.pesData=null):(S!=null&&S.size&&c.logger.log("last AAC PES packet truncated,might overlap between fragments"),D.pesData=S),R&&(w=t(R))?(this.parseID3PES(w),p.pesData=null):p.pesData=R},s.demuxSampleAes=function(C,D,E){var p=this.demux(C,E,!0,!this.config.progressive),y=this.sampleAes=new O.default(this.observer,this.config,D);return this.decrypt(p,y)},s.decrypt=function(C,D){return new Promise(function(E){var p=C.audioTrack,y=C.avcTrack;p.samples&&p.isAAC?D.decryptAacSamples(p.samples,0,function(){y.samples?D.decryptAvcSamples(y.samples,0,0,function(){E(C)}):E(C)}):y.samples&&D.decryptAvcSamples(y.samples,0,0,function(){E(C)})})},s.destroy=function(){this._initPTS=this._initDTS=null,this._duration=0},s.parseAVCPES=function(C,D){var E=this,p=this._avcTrack,y=this.parseAVCNALu(C.data),S=this.avcSample,R,w=!1;C.data=null,S&&y.length&&!p.audFound&&(a(S,p),S=this.avcSample=L(!1,C.pts,C.dts,"")),y.forEach(function(k){switch(k.type){case 1:{R=!0,S||(S=E.avcSample=L(!0,C.pts,C.dts,"")),S.frame=!0;var _=k.data;if(w&&_.length>4){var F=new r.default(_).readSliceType();(F===2||F===4||F===7||F===9)&&(S.key=!0)}break}case 5:R=!0,S||(S=E.avcSample=L(!0,C.pts,C.dts,"")),S.key=!0,S.frame=!0;break;case 6:{R=!0;var U=new r.default(d(k.data));U.readUByte();for(var N=0,W=0,H=!1,G=0;!H&&U.bytesAvailable>1;){N=0;do G=U.readUByte(),N+=G;while(G===255);W=0;do G=U.readUByte(),W+=G;while(G===255);if(N===4&&U.bytesAvailable!==0){H=!0;var J=U.readUByte();if(J===181){var X=U.readUShort();if(X===49){var te=U.readUInt();if(te===1195456820){var le=U.readUByte();if(le===3){for(var re=U.readUByte(),fe=U.readUByte(),ue=31&re,ae=[re,fe],me=0;me<ue;me++)ae.push(U.readUByte()),ae.push(U.readUByte()),ae.push(U.readUByte());n(E._txtTrack.samples,{type:3,pts:C.pts,bytes:ae})}}}}}else if(N===5&&U.bytesAvailable!==0){if(H=!0,W>16){for(var ge=[],be=0;be<16;be++)ge.push(U.readUByte().toString(16)),(be===3||be===5||be===7||be===9)&&ge.push("-");for(var Se=W-16,we=new Uint8Array(Se),Ce=0;Ce<Se;Ce++)we[Ce]=U.readUByte();n(E._txtTrack.samples,{pts:C.pts,payloadType:N,uuid:ge.join(""),userData:Object(P.utf8ArrayToStr)(we),userDataBytes:we})}}else if(W<U.bytesAvailable)for(var Le=0;Le<W;Le++)U.readUByte()}break}case 7:if(R=!0,w=!0,!p.sps){var Ue=new r.default(k.data),Ke=Ue.readSPS();p.width=Ke.width,p.height=Ke.height,p.pixelRatio=Ke.pixelRatio,p.sps=[k.data],p.duration=E._duration;for(var We=k.data.subarray(1,4),Be="avc1.",ze=0;ze<3;ze++){var Te=We[ze].toString(16);Te.length<2&&(Te="0"+Te),Be+=Te}p.codec=Be}break;case 8:R=!0,p.pps||(p.pps=[k.data]);break;case 9:R=!1,p.audFound=!0,S&&a(S,p),S=E.avcSample=L(!1,C.pts,C.dts,"");break;case 12:R=!1;break;default:R=!1,S&&(S.debug+="unknown NAL "+k.type+" ");break}if(S&&R){var tt=S.units;tt.push(k)}}),D&&S&&(a(S,p),this.avcSample=null)},s.getLastNalUnit=function(){var C,D=this.avcSample,E;if(!D||D.units.length===0){var p=this._avcTrack.samples;D=p[p.length-1]}if((C=D)!==null&&C!==void 0&&C.units){var y=D.units;E=y[y.length-1]}return E},s.parseAVCNALu=function(C){var D=C.byteLength,E=this._avcTrack,p=E.naluState||0,y=p,S=[],R=0,w,k,_,F=-1,U=0;for(p===-1&&(F=0,U=C[0]&31,p=0,R=1);R<D;){if(w=C[R++],!p){p=w?0:1;continue}if(p===1){p=w?0:2;continue}if(!w)p=3;else if(w===1){if(F>=0){var N={data:C.subarray(F,R-p-1),type:U};S.push(N)}else{var W=this.getLastNalUnit();if(W&&(y&&R<=4-y&&W.state&&(W.data=W.data.subarray(0,W.data.byteLength-y)),k=R-p-1,k>0)){var H=new Uint8Array(W.data.byteLength+k);H.set(W.data,0),H.set(C.subarray(0,k),W.data.byteLength),W.data=H,W.state=0}}R<D?(_=C[R]&31,F=R,U=_,p=0):p=-1}else p=0}if(F>=0&&p>=0){var G={data:C.subarray(F,D),type:U,state:p};S.push(G)}if(S.length===0){var J=this.getLastNalUnit();if(J){var X=new Uint8Array(J.data.byteLength+C.byteLength);X.set(J.data,0),X.set(C,J.data.byteLength),J.data=X}}return E.naluState=p,S},s.parseAACPES=function(C){var D=0,E=this._audioTrack,p=this.aacOverFlow,y=C.data;if(p){this.aacOverFlow=null;var S=p.sample.unit.byteLength,R=Math.min(p.missing,S),w=S-R;p.sample.unit.set(y.subarray(0,R),w),E.samples.push(p.sample),D=p.missing}var k,_;for(k=D,_=y.length;k<_-1&&!A.isHeader(y,k);k++);if(k!==D){var F,U;if(k<_-1?(F="AAC PES did not start with ADTS header,offset:"+k,U=!1):(F="no ADTS header found in AAC PES",U=!0),c.logger.warn("parsing error:"+F),this.observer.emit(x.Events.ERROR,x.Events.ERROR,{type:v.ErrorTypes.MEDIA_ERROR,details:v.ErrorDetails.FRAG_PARSING_ERROR,fatal:U,reason:F}),U)return}A.initTrackConfig(E,this.observer,y,k,this.audioCodec);var N;if(C.pts!==void 0)N=C.pts;else if(p){var W=A.getFrameDuration(E.samplerate);N=p.sample.pts+W}else{c.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var H=0;k<_;)if(A.isHeader(y,k)){if(k+5<_){var G=A.appendFrame(E,y,k,N,H);if(G)if(G.missing)this.aacOverFlow=G;else{k+=G.length,H++;continue}}break}else k++},s.parseMPEGPES=function(C){var D=C.data,E=D.length,p=0,y=0,S=C.pts;if(S===void 0){c.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;y<E;)if(u.isHeader(D,y)){var R=u.appendFrame(this._audioTrack,D,y,S,p);if(R)y+=R.length,p++;else break}else y++},s.parseID3PES=function(C){if(C.pts===void 0){c.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}this._id3Track.samples.push(C)},l}();T.minProbeByteLength=188;function L(l,s,f,C){return{key:l,frame:!1,pts:s,dts:f,units:[],debug:C,length:0}}function g(l,s){return(l[s+10]&31)<<8|l[s+11]}function o(l,s,f,C){var D={audio:-1,avc:-1,id3:-1,isAAC:!0},E=(l[s+1]&15)<<8|l[s+2],p=s+3+E-4,y=(l[s+10]&15)<<8|l[s+11];for(s+=12+y;s<p;){var S=(l[s+1]&31)<<8|l[s+2];switch(l[s]){case 207:if(!C){c.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:D.audio===-1&&(D.audio=S);break;case 21:D.id3===-1&&(D.id3=S);break;case 219:if(!C){c.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:D.avc===-1&&(D.avc=S);break;case 3:case 4:f?D.audio===-1&&(D.audio=S,D.isAAC=!1):c.logger.log("MPEG audio found, not supported in this browser");break;case 36:c.logger.warn("Unsupported HEVC stream type found");break}s+=((l[s+3]&15)<<8|l[s+4])+5}return D}function t(l){var s=0,f,C,D,E,p,y=l.data;if(!l||l.size===0)return null;for(;y[0].length<19&&y.length>1;){var S=new Uint8Array(y[0].length+y[1].length);S.set(y[0]),S.set(y[1],y[0].length),y[0]=S,y.splice(1,1)}f=y[0];var R=(f[0]<<16)+(f[1]<<8)+f[2];if(R===1){if(C=(f[4]<<8)+f[5],C&&C>l.size-6)return null;var w=f[7];w&192&&(E=(f[9]&14)*536870912+(f[10]&255)*4194304+(f[11]&254)*16384+(f[12]&255)*128+(f[13]&254)/2,w&64?(p=(f[14]&14)*536870912+(f[15]&255)*4194304+(f[16]&254)*16384+(f[17]&255)*128+(f[18]&254)/2,E-p>60*9e4&&(c.logger.warn(Math.round((E-p)/9e4)+"s delta between PTS and DTS, align them"),E=p)):p=E),D=f[8];var k=D+9;if(l.size<=k)return null;l.size-=k;for(var _=new Uint8Array(l.size),F=0,U=y.length;F<U;F++){f=y[F];var N=f.byteLength;if(k)if(k>N){k-=N;continue}else f=f.subarray(k),N-=k,k=0;_.set(f,s),s+=N}return C&&(C-=D+3),{data:_,pts:E,dts:p,len:C}}return null}function a(l,s){if(l.units.length&&l.frame){if(l.pts===void 0){var f=s.samples,C=f.length;if(C){var D=f[C-1];l.pts=D.pts,l.dts=D.dts}else{s.dropped++;return}}s.samples.push(l)}l.debug.length&&c.logger.log(l.pts+"/"+l.dts+":"+l.debug)}function n(l,s){var f=l.length;if(f>0){if(s.pts>=l[f-1].pts)l.push(s);else for(var C=f-1;C>=0;C--)if(s.pts<l[C].pts){l.splice(C,0,s);break}}else l.push(s)}function d(l){for(var s=l.byteLength,f=[],C=1;C<s-2;)l[C]===0&&l[C+1]===0&&l[C+2]===3?(f.push(C+2),C+=2):C++;if(f.length===0)return l;var D=s-f.length,E=new Uint8Array(D),p=0;for(C=0;C<D;p++,C++)p===f[0]&&(p++,f.shift()),E[C]=l[p];return E}M.default=T},"./src/errors.ts":function(I,M,i){i.r(M),i.d(M,"ErrorTypes",function(){return A}),i.d(M,"ErrorDetails",function(){return u});var A;(function(r){r.NETWORK_ERROR="networkError",r.MEDIA_ERROR="mediaError",r.KEY_SYSTEM_ERROR="keySystemError",r.MUX_ERROR="muxError",r.OTHER_ERROR="otherError"})(A||(A={}));var u;(function(r){r.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",r.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",r.KEY_SYSTEM_NO_SESSION="keySystemNoSession",r.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",r.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",r.MANIFEST_LOAD_ERROR="manifestLoadError",r.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",r.MANIFEST_PARSING_ERROR="manifestParsingError",r.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",r.LEVEL_EMPTY_ERROR="levelEmptyError",r.LEVEL_LOAD_ERROR="levelLoadError",r.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",r.LEVEL_SWITCH_ERROR="levelSwitchError",r.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",r.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",r.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",r.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",r.FRAG_LOAD_ERROR="fragLoadError",r.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",r.FRAG_DECRYPT_ERROR="fragDecryptError",r.FRAG_PARSING_ERROR="fragParsingError",r.REMUX_ALLOC_ERROR="remuxAllocError",r.KEY_LOAD_ERROR="keyLoadError",r.KEY_LOAD_TIMEOUT="keyLoadTimeOut",r.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",r.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",r.BUFFER_APPEND_ERROR="bufferAppendError",r.BUFFER_APPENDING_ERROR="bufferAppendingError",r.BUFFER_STALLED_ERROR="bufferStalledError",r.BUFFER_FULL_ERROR="bufferFullError",r.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",r.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",r.INTERNAL_EXCEPTION="internalException",r.INTERNAL_ABORTED="aborted",r.UNKNOWN="unknown"})(u||(u={}))},"./src/events.ts":function(I,M,i){i.r(M),i.d(M,"Events",function(){return A});var A;(function(u){u.MEDIA_ATTACHING="hlsMediaAttaching",u.MEDIA_ATTACHED="hlsMediaAttached",u.MEDIA_DETACHING="hlsMediaDetaching",u.MEDIA_DETACHED="hlsMediaDetached",u.BUFFER_RESET="hlsBufferReset",u.BUFFER_CODECS="hlsBufferCodecs",u.BUFFER_CREATED="hlsBufferCreated",u.BUFFER_APPENDING="hlsBufferAppending",u.BUFFER_APPENDED="hlsBufferAppended",u.BUFFER_EOS="hlsBufferEos",u.BUFFER_FLUSHING="hlsBufferFlushing",u.BUFFER_FLUSHED="hlsBufferFlushed",u.MANIFEST_LOADING="hlsManifestLoading",u.MANIFEST_LOADED="hlsManifestLoaded",u.MANIFEST_PARSED="hlsManifestParsed",u.LEVEL_SWITCHING="hlsLevelSwitching",u.LEVEL_SWITCHED="hlsLevelSwitched",u.LEVEL_LOADING="hlsLevelLoading",u.LEVEL_LOADED="hlsLevelLoaded",u.LEVEL_UPDATED="hlsLevelUpdated",u.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",u.LEVELS_UPDATED="hlsLevelsUpdated",u.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",u.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",u.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",u.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",u.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",u.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",u.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",u.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",u.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",u.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",u.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",u.CUES_PARSED="hlsCuesParsed",u.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",u.INIT_PTS_FOUND="hlsInitPtsFound",u.FRAG_LOADING="hlsFragLoading",u.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",u.FRAG_LOADED="hlsFragLoaded",u.FRAG_DECRYPTED="hlsFragDecrypted",u.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",u.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",u.FRAG_PARSING_METADATA="hlsFragParsingMetadata",u.FRAG_PARSED="hlsFragParsed",u.FRAG_BUFFERED="hlsFragBuffered",u.FRAG_CHANGED="hlsFragChanged",u.FPS_DROP="hlsFpsDrop",u.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",u.ERROR="hlsError",u.DESTROYING="hlsDestroying",u.KEY_LOADING="hlsKeyLoading",u.KEY_LOADED="hlsKeyLoaded",u.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",u.BACK_BUFFER_REACHED="hlsBackBufferReached"})(A||(A={}))},"./src/hls.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return n});var A=i("./node_modules/url-toolkit/src/url-toolkit.js"),u=i("./src/loader/playlist-loader.ts"),r=i("./src/loader/key-loader.ts"),P=i("./src/controller/id3-track-controller.ts"),O=i("./src/controller/latency-controller.ts"),x=i("./src/controller/level-controller.ts"),m=i("./src/controller/fragment-tracker.ts"),c=i("./src/controller/stream-controller.ts"),v=i("./src/is-supported.ts"),h=i("./src/utils/logger.ts"),T=i("./src/config.ts"),L=i("./node_modules/eventemitter3/index.js"),g=i("./src/events.ts"),o=i("./src/errors.ts");function t(d,l){for(var s=0;s<l.length;s++){var f=l[s];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(d,f.key,f)}}function a(d,l,s){return l&&t(d.prototype,l),s&&t(d,s),d}var n=function(){d.isSupported=function(){return Object(v.isSupported)()};function d(s){s===void 0&&(s={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new L.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var f=this.config=Object(T.mergeConfig)(d.DefaultConfig,s);this.userConfig=s,Object(h.enableLogs)(f.debug),this._autoLevelCapping=-1,f.progressive&&Object(T.enableStreamingMode)(f);var C=f.abrController,D=f.bufferController,E=f.capLevelController,p=f.fpsController,y=this.abrController=new C(this),S=this.bufferController=new D(this),R=this.capLevelController=new E(this),w=new p(this),k=new u.default(this),_=new r.default(this),F=new P.default(this),U=this.levelController=new x.default(this),N=new m.FragmentTracker(this),W=this.streamController=new c.default(this,N);R.setStreamController(W),w.setStreamController(W);var H=[U,W];this.networkControllers=H;var G=[k,_,y,S,R,w,F,N];this.audioTrackController=this.createController(f.audioTrackController,null,H),this.createController(f.audioStreamController,N,H),this.subtitleTrackController=this.createController(f.subtitleTrackController,null,H),this.createController(f.subtitleStreamController,N,H),this.createController(f.timelineController,null,G),this.emeController=this.createController(f.emeController,null,G),this.cmcdController=this.createController(f.cmcdController,null,G),this.latencyController=this.createController(O.default,null,G),this.coreComponents=G}var l=d.prototype;return l.createController=function(f,C,D){if(f){var E=C?new f(this,C):new f(this);return D&&D.push(E),E}return null},l.on=function(f,C,D){D===void 0&&(D=this),this._emitter.on(f,C,D)},l.once=function(f,C,D){D===void 0&&(D=this),this._emitter.once(f,C,D)},l.removeAllListeners=function(f){this._emitter.removeAllListeners(f)},l.off=function(f,C,D,E){D===void 0&&(D=this),this._emitter.off(f,C,D,E)},l.listeners=function(f){return this._emitter.listeners(f)},l.emit=function(f,C,D){return this._emitter.emit(f,C,D)},l.trigger=function(f,C){if(this.config.debug)return this.emit(f,f,C);try{return this.emit(f,f,C)}catch(D){h.logger.error("An internal error happened while handling event "+f+'. Error message: "'+D.message+'". Here is a stacktrace:',D),this.trigger(g.Events.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:f,error:D})}return!1},l.listenerCount=function(f){return this._emitter.listenerCount(f)},l.destroy=function(){h.logger.log("destroy"),this.trigger(g.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(f){return f.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(f){return f.destroy()}),this.coreComponents.length=0},l.attachMedia=function(f){h.logger.log("attachMedia"),this._media=f,this.trigger(g.Events.MEDIA_ATTACHING,{media:f})},l.detachMedia=function(){h.logger.log("detachMedia"),this.trigger(g.Events.MEDIA_DETACHING,void 0),this._media=null},l.loadSource=function(f){this.stopLoad();var C=this.media,D=this.url,E=this.url=A.buildAbsoluteURL(self.location.href,f,{alwaysNormalize:!0});h.logger.log("loadSource:"+E),C&&D&&D!==E&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(C)),this.trigger(g.Events.MANIFEST_LOADING,{url:f})},l.startLoad=function(f){f===void 0&&(f=-1),h.logger.log("startLoad("+f+")"),this.networkControllers.forEach(function(C){C.startLoad(f)})},l.stopLoad=function(){h.logger.log("stopLoad"),this.networkControllers.forEach(function(f){f.stopLoad()})},l.swapAudioCodec=function(){h.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},l.recoverMediaError=function(){h.logger.log("recoverMediaError");var f=this._media;this.detachMedia(),f&&this.attachMedia(f)},l.removeLevel=function(f,C){C===void 0&&(C=0),this.levelController.removeLevel(f,C)},a(d,[{key:"levels",get:function(){var f=this.levelController.levels;return f||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(f){h.logger.log("set currentLevel:"+f),this.loadLevel=f,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(f){h.logger.log("set nextLevel:"+f),this.levelController.manualLevel=f,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(f){h.logger.log("set loadLevel:"+f),this.levelController.manualLevel=f}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(f){this.levelController.nextLoadLevel=f}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(f){h.logger.log("set firstLevel:"+f),this.levelController.firstLevel=f}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(f){h.logger.log("set startLevel:"+f),f!==-1&&(f=Math.max(f,this.minAutoLevel)),this.levelController.startLevel=f}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(f){var C=!!f;C!==this.config.capLevelToPlayerSize&&(C?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=C)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(f){this._autoLevelCapping!==f&&(h.logger.log("set autoLevelCapping:"+f),this._autoLevelCapping=f)}},{key:"bandwidthEstimate",get:function(){var f=this.abrController.bwEstimator;return f?f.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var f=this.levels,C=this.config.minAutoBitrate;if(!f)return 0;for(var D=f.length,E=0;E<D;E++)if(f[E].maxBitrate>C)return E;return 0}},{key:"maxAutoLevel",get:function(){var f=this.levels,C=this.autoLevelCapping,D;return C===-1&&f&&f.length?D=f.length-1:D=C,D}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(f){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,f)}},{key:"audioTracks",get:function(){var f=this.audioTrackController;return f?f.audioTracks:[]}},{key:"audioTrack",get:function(){var f=this.audioTrackController;return f?f.audioTrack:-1},set:function(f){var C=this.audioTrackController;C&&(C.audioTrack=f)}},{key:"subtitleTracks",get:function(){var f=this.subtitleTrackController;return f?f.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var f=this.subtitleTrackController;return f?f.subtitleTrack:-1},set:function(f){var C=this.subtitleTrackController;C&&(C.subtitleTrack=f)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var f=this.subtitleTrackController;return f?f.subtitleDisplay:!1},set:function(f){var C=this.subtitleTrackController;C&&(C.subtitleDisplay=f)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(f){this.config.lowLatencyMode=f}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.1.5"}},{key:"Events",get:function(){return g.Events}},{key:"ErrorTypes",get:function(){return o.ErrorTypes}},{key:"ErrorDetails",get:function(){return o.ErrorDetails}},{key:"DefaultConfig",get:function(){return d.defaultConfig?d.defaultConfig:T.hlsDefaultConfig},set:function(f){d.defaultConfig=f}}]),d}();n.defaultConfig=void 0},"./src/is-supported.ts":function(I,M,i){i.r(M),i.d(M,"isSupported",function(){return r}),i.d(M,"changeTypeSupported",function(){return P});var A=i("./src/utils/mediasource-helper.ts");function u(){return self.SourceBuffer||self.WebKitSourceBuffer}function r(){var O=Object(A.getMediaSource)();if(!O)return!1;var x=u(),m=O&&typeof O.isTypeSupported=="function"&&O.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),c=!x||x.prototype&&typeof x.prototype.appendBuffer=="function"&&typeof x.prototype.remove=="function";return!!m&&!!c}function P(){var O,x=u();return typeof(x==null||(O=x.prototype)===null||O===void 0?void 0:O.changeType)=="function"}},"./src/loader/fragment-loader.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return T}),i.d(M,"LoadError",function(){return g});var A=i("./src/polyfills/number.ts"),u=i("./src/errors.ts");function r(o,t){o.prototype=Object.create(t.prototype),o.prototype.constructor=o,c(o,t)}function P(o){var t=typeof Map=="function"?new Map:void 0;return P=function(n){if(n===null||!m(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(n))return t.get(n);t.set(n,d)}function d(){return O(n,arguments,v(this).constructor)}return d.prototype=Object.create(n.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),c(d,n)},P(o)}function O(o,t,a){return x()?O=Reflect.construct:O=function(d,l,s){var f=[null];f.push.apply(f,l);var C=Function.bind.apply(d,f),D=new C;return s&&c(D,s.prototype),D},O.apply(null,arguments)}function x(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function m(o){return Function.toString.call(o).indexOf("[native code]")!==-1}function c(o,t){return c=Object.setPrototypeOf||function(n,d){return n.__proto__=d,n},c(o,t)}function v(o){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},v(o)}var h=Math.pow(2,17),T=function(){function o(a){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=a}var t=o.prototype;return t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t.abort=function(){this.loader&&this.loader.abort()},t.load=function(n,d){var l=this,s=n.url;if(!s)return Promise.reject(new g({type:u.ErrorTypes.NETWORK_ERROR,details:u.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:n,networkDetails:null},"Fragment does not have a "+(s?"part list":"url")));this.abort();var f=this.config,C=f.fLoader,D=f.loader;return new Promise(function(E,p){l.loader&&l.loader.destroy();var y=l.loader=n.loader=C?new C(f):new D(f),S=L(n),R={timeout:f.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:f.fragLoadingMaxRetryTimeout,highWaterMark:h};n.stats=y.stats,y.load(S,R,{onSuccess:function(k,_,F,U){l.resetLoader(n,y),E({frag:n,part:null,payload:k.data,networkDetails:U})},onError:function(k,_,F){l.resetLoader(n,y),p(new g({type:u.ErrorTypes.NETWORK_ERROR,details:u.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:n,response:k,networkDetails:F}))},onAbort:function(k,_,F){l.resetLoader(n,y),p(new g({type:u.ErrorTypes.NETWORK_ERROR,details:u.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:n,networkDetails:F}))},onTimeout:function(k,_,F){l.resetLoader(n,y),p(new g({type:u.ErrorTypes.NETWORK_ERROR,details:u.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:n,networkDetails:F}))},onProgress:function(k,_,F,U){d&&d({frag:n,part:null,payload:F,networkDetails:U})}})})},t.loadPart=function(n,d,l){var s=this;this.abort();var f=this.config,C=f.fLoader,D=f.loader;return new Promise(function(E,p){s.loader&&s.loader.destroy();var y=s.loader=n.loader=C?new C(f):new D(f),S=L(n,d),R={timeout:f.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:f.fragLoadingMaxRetryTimeout,highWaterMark:h};d.stats=y.stats,y.load(S,R,{onSuccess:function(k,_,F,U){s.resetLoader(n,y),s.updateStatsFromPart(n,d);var N={frag:n,part:d,payload:k.data,networkDetails:U};l(N),E(N)},onError:function(k,_,F){s.resetLoader(n,y),p(new g({type:u.ErrorTypes.NETWORK_ERROR,details:u.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:n,part:d,response:k,networkDetails:F}))},onAbort:function(k,_,F){n.stats.aborted=d.stats.aborted,s.resetLoader(n,y),p(new g({type:u.ErrorTypes.NETWORK_ERROR,details:u.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:n,part:d,networkDetails:F}))},onTimeout:function(k,_,F){s.resetLoader(n,y),p(new g({type:u.ErrorTypes.NETWORK_ERROR,details:u.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:n,part:d,networkDetails:F}))}})})},t.updateStatsFromPart=function(n,d){var l=n.stats,s=d.stats,f=s.total;if(l.loaded+=s.loaded,f){var C=Math.round(n.duration/d.duration),D=Math.min(Math.round(l.loaded/f),C),E=C-D,p=E*Math.round(l.loaded/D);l.total=l.loaded+p}else l.total=Math.max(l.loaded,l.total);var y=l.loading,S=s.loading;y.start?y.first+=S.first-S.start:(y.start=S.start,y.first=S.first),y.end=S.end},t.resetLoader=function(n,d){n.loader=null,this.loader===d&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),d.destroy()},o}();function L(o,t){t===void 0&&(t=null);var a=t||o,n={frag:o,part:t,responseType:"arraybuffer",url:a.url,headers:{},rangeStart:0,rangeEnd:0},d=a.byteRangeStartOffset,l=a.byteRangeEndOffset;return Object(A.isFiniteNumber)(d)&&Object(A.isFiniteNumber)(l)&&(n.rangeStart=d,n.rangeEnd=l),n}var g=function(o){r(t,o);function t(a){for(var n,d=arguments.length,l=new Array(d>1?d-1:0),s=1;s<d;s++)l[s-1]=arguments[s];return n=o.call.apply(o,[this].concat(l))||this,n.data=void 0,n.data=a,n}return t}(P(Error))},"./src/loader/fragment.ts":function(I,M,i){i.r(M),i.d(M,"ElementaryStreamTypes",function(){return h}),i.d(M,"BaseSegment",function(){return T}),i.d(M,"Fragment",function(){return L}),i.d(M,"Part",function(){return g});var A=i("./src/polyfills/number.ts"),u=i("./node_modules/url-toolkit/src/url-toolkit.js"),r=i("./src/utils/logger.ts"),P=i("./src/loader/level-key.ts"),O=i("./src/loader/load-stats.ts");function x(o,t){o.prototype=Object.create(t.prototype),o.prototype.constructor=o,m(o,t)}function m(o,t){return m=Object.setPrototypeOf||function(n,d){return n.__proto__=d,n},m(o,t)}function c(o,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(o,n.key,n)}}function v(o,t,a){return t&&c(o.prototype,t),a&&c(o,a),o}var h;(function(o){o.AUDIO="audio",o.VIDEO="video",o.AUDIOVIDEO="audiovideo"})(h||(h={}));var T=function(){function o(a){var n;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(n={},n[h.AUDIO]=null,n[h.VIDEO]=null,n[h.AUDIOVIDEO]=null,n),this.baseurl=a}var t=o.prototype;return t.setByteRange=function(n,d){var l=n.split("@",2),s=[];l.length===1?s[0]=d?d.byteRangeEndOffset:0:s[0]=parseInt(l[1]),s[1]=parseInt(l[0])+s[0],this._byteRange=s},v(o,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(u.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(n){this._url=n}}]),o}(),L=function(o){x(t,o);function t(n,d){var l;return l=o.call(this,d)||this,l._decryptdata=null,l.rawProgramDateTime=null,l.programDateTime=null,l.tagList=[],l.duration=0,l.sn=0,l.levelkey=void 0,l.type=void 0,l.loader=null,l.level=-1,l.cc=0,l.startPTS=void 0,l.endPTS=void 0,l.appendedPTS=void 0,l.startDTS=void 0,l.endDTS=void 0,l.start=0,l.deltaPTS=void 0,l.maxStartPTS=void 0,l.minEndPTS=void 0,l.stats=new O.LoadStats,l.urlId=0,l.data=void 0,l.bitrateTest=!1,l.title=null,l.initSegment=null,l.type=n,l}var a=t.prototype;return a.createInitializationVector=function(d){for(var l=new Uint8Array(16),s=12;s<16;s++)l[s]=d>>8*(15-s)&255;return l},a.setDecryptDataFromLevelKey=function(d,l){var s=d;return(d==null?void 0:d.method)==="AES-128"&&d.uri&&!d.iv&&(s=P.LevelKey.fromURI(d.uri),s.method=d.method,s.iv=this.createInitializationVector(l),s.keyFormat="identity"),s},a.setElementaryStreamInfo=function(d,l,s,f,C,D){D===void 0&&(D=!1);var E=this.elementaryStreams,p=E[d];if(!p){E[d]={startPTS:l,endPTS:s,startDTS:f,endDTS:C,partial:D};return}p.startPTS=Math.min(p.startPTS,l),p.endPTS=Math.max(p.endPTS,s),p.startDTS=Math.min(p.startDTS,f),p.endDTS=Math.max(p.endDTS,C)},a.clearElementaryStreamInfo=function(){var d=this.elementaryStreams;d[h.AUDIO]=null,d[h.VIDEO]=null,d[h.AUDIOVIDEO]=null},v(t,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var d=this.sn;typeof d!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&r.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),d=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,d)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(A.isFiniteNumber)(this.programDateTime))return null;var d=Object(A.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+d*1e3}},{key:"encrypted",get:function(){var d;return!!((d=this.decryptdata)!==null&&d!==void 0&&d.keyFormat&&this.decryptdata.uri)}}]),t}(T),g=function(o){x(t,o);function t(a,n,d,l,s){var f;f=o.call(this,d)||this,f.fragOffset=0,f.duration=0,f.gap=!1,f.independent=!1,f.relurl=void 0,f.fragment=void 0,f.index=void 0,f.stats=new O.LoadStats,f.duration=a.decimalFloatingPoint("DURATION"),f.gap=a.bool("GAP"),f.independent=a.bool("INDEPENDENT"),f.relurl=a.enumeratedString("URI"),f.fragment=n,f.index=l;var C=a.enumeratedString("BYTERANGE");return C&&f.setByteRange(C,s),s&&(f.fragOffset=s.fragOffset+s.duration),f}return v(t,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var n=this.elementaryStreams;return!!(n.audio||n.video||n.audiovideo)}}]),t}(T)},"./src/loader/key-loader.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return P});var A=i("./src/events.ts"),u=i("./src/errors.ts"),r=i("./src/utils/logger.ts"),P=function(){function O(m){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=m,this._registerListeners()}var x=O.prototype;return x._registerListeners=function(){this.hls.on(A.Events.KEY_LOADING,this.onKeyLoading,this)},x._unregisterListeners=function(){this.hls.off(A.Events.KEY_LOADING,this.onKeyLoading)},x.destroy=function(){this._unregisterListeners();for(var c in this.loaders){var v=this.loaders[c];v&&v.destroy()}this.loaders={}},x.onKeyLoading=function(c,v){var h=v.frag,T=h.type,L=this.loaders[T];if(!h.decryptdata){r.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var g=h.decryptdata.uri;if(g!==this.decrypturl||this.decryptkey===null){var o=this.hls.config;if(L&&(r.logger.warn("abort previous key loader for type:"+T),L.abort()),!g){r.logger.warn("key uri is falsy");return}var t=o.loader,a=h.loader=this.loaders[T]=new t(o);this.decrypturl=g,this.decryptkey=null;var n={url:g,frag:h,responseType:"arraybuffer"},d={timeout:o.fragLoadingTimeOut,maxRetry:0,retryDelay:o.fragLoadingRetryDelay,maxRetryDelay:o.fragLoadingMaxRetryTimeout,highWaterMark:0},l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};a.load(n,d,l)}else this.decryptkey&&(h.decryptdata.key=this.decryptkey,this.hls.trigger(A.Events.KEY_LOADED,{frag:h}))},x.loadsuccess=function(c,v,h){var T=h.frag;if(!T.decryptdata){r.logger.error("after key load, decryptdata unset");return}this.decryptkey=T.decryptdata.key=new Uint8Array(c.data),T.loader=null,delete this.loaders[T.type],this.hls.trigger(A.Events.KEY_LOADED,{frag:T})},x.loaderror=function(c,v){var h=v.frag,T=h.loader;T&&T.abort(),delete this.loaders[h.type],this.hls.trigger(A.Events.ERROR,{type:u.ErrorTypes.NETWORK_ERROR,details:u.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:h,response:c})},x.loadtimeout=function(c,v){var h=v.frag,T=h.loader;T&&T.abort(),delete this.loaders[h.type],this.hls.trigger(A.Events.ERROR,{type:u.ErrorTypes.NETWORK_ERROR,details:u.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:h})},O}()},"./src/loader/level-details.ts":function(I,M,i){i.r(M),i.d(M,"LevelDetails",function(){return O});var A=i("./src/polyfills/number.ts");function u(x,m){for(var c=0;c<m.length;c++){var v=m[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(x,v.key,v)}}function r(x,m,c){return m&&u(x.prototype,m),c&&u(x,c),x}var P=10,O=function(){function x(c){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=c}var m=x.prototype;return m.reloaded=function(v){if(!v){this.advanced=!0,this.updated=!0;return}var h=this.lastPartSn-v.lastPartSn,T=this.lastPartIndex-v.lastPartIndex;this.updated=this.endSN!==v.endSN||!!T||!!h,this.advanced=this.endSN>v.endSN||h>0||h===0&&T>0,this.updated||this.advanced?this.misses=Math.floor(v.misses*.6):this.misses=v.misses+1,this.availabilityDelay=v.availabilityDelay},r(x,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?Object(A.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||P}},{key:"drift",get:function(){var v=this.driftEndTime-this.driftStartTime;if(v>0){var h=this.driftEnd-this.driftStart;return h*1e3/v}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var v;return(v=this.partList)!==null&&v!==void 0&&v.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var v;return(v=this.fragments)!==null&&v!==void 0&&v.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var v;return(v=this.partList)!==null&&v!==void 0&&v.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var v;return(v=this.partList)!==null&&v!==void 0&&v.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),x}()},"./src/loader/level-key.ts":function(I,M,i){i.r(M),i.d(M,"LevelKey",function(){return P});var A=i("./node_modules/url-toolkit/src/url-toolkit.js");function u(O,x){for(var m=0;m<x.length;m++){var c=x[m];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(O,c.key,c)}}function r(O,x,m){return x&&u(O.prototype,x),m&&u(O,m),O}var P=function(){O.fromURL=function(m,c){return new O(m,c)},O.fromURI=function(m){return new O(m)};function O(x,m){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,m?this._uri=Object(A.buildAbsoluteURL)(x,m,{alwaysNormalize:!0}):this._uri=x}return r(O,[{key:"uri",get:function(){return this._uri}}]),O}()},"./src/loader/load-stats.ts":function(I,M,i){i.r(M),i.d(M,"LoadStats",function(){return A});var A=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return t});var A=i("./src/polyfills/number.ts"),u=i("./node_modules/url-toolkit/src/url-toolkit.js"),r=i("./src/loader/fragment.ts"),P=i("./src/loader/level-details.ts"),O=i("./src/loader/level-key.ts"),x=i("./src/utils/attr-list.ts"),m=i("./src/utils/logger.ts"),c=i("./src/utils/codecs.ts"),v=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,h=/#EXT-X-MEDIA:(.*)/g,T=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),L=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),g=/\.(mp4|m4s|m4v|m4a)$/i;function o(s){var f,C;return g.test((f=(C=u.parseURL(s))===null||C===void 0?void 0:C.path)!=null?f:"")}var t=function(){function s(){}return s.findGroup=function(C,D){for(var E=0;E<C.length;E++){var p=C[E];if(p.id===D)return p}},s.convertAVC1ToAVCOTI=function(C){var D=C.split(".");if(D.length>2){var E=D.shift()+".";return E+=parseInt(D.shift()).toString(16),E+=("000"+parseInt(D.shift()).toString(16)).substr(-4),E}return C},s.resolve=function(C,D){return u.buildAbsoluteURL(D,C,{alwaysNormalize:!0})},s.parseMasterPlaylist=function(C,D){var E=[],p={},y=!1;v.lastIndex=0;for(var S;(S=v.exec(C))!=null;)if(S[1]){var R=new x.AttrList(S[1]),w={attrs:R,bitrate:R.decimalInteger("AVERAGE-BANDWIDTH")||R.decimalInteger("BANDWIDTH"),name:R.NAME,url:s.resolve(S[2],D)},k=R.decimalResolution("RESOLUTION");k&&(w.width=k.width,w.height=k.height),a((R.CODECS||"").split(/[ ,]+/).filter(function(F){return F}),w),w.videoCodec&&w.videoCodec.indexOf("avc1")!==-1&&(w.videoCodec=s.convertAVC1ToAVCOTI(w.videoCodec)),E.push(w)}else if(S[3]){var _=new x.AttrList(S[3]);_["DATA-ID"]&&(y=!0,p[_["DATA-ID"]]=_)}return{levels:E,sessionData:y?p:null}},s.parseMasterPlaylistMedia=function(C,D,E,p){p===void 0&&(p=[]);var y,S=[],R=0;for(h.lastIndex=0;(y=h.exec(C))!==null;){var w=new x.AttrList(y[1]);if(w.TYPE===E){var k={attrs:w,bitrate:0,id:R++,groupId:w["GROUP-ID"],instreamId:w["INSTREAM-ID"],name:w.NAME||w.LANGUAGE||"",type:E,default:w.bool("DEFAULT"),autoselect:w.bool("AUTOSELECT"),forced:w.bool("FORCED"),lang:w.LANGUAGE,url:w.URI?s.resolve(w.URI,D):""};if(p.length){var _=s.findGroup(p,k.groupId)||p[0];n(k,_,"audioCodec"),n(k,_,"textCodec")}S.push(k)}}return S},s.parseLevelPlaylist=function(C,D,E,p,y){var S=new P.LevelDetails(D),R=S.fragments,w=null,k=0,_=0,F=0,U=0,N=null,W=new r.Fragment(p,D),H,G,J,X=-1,te=!1;for(T.lastIndex=0,S.m3u8=C;(H=T.exec(C))!==null;){te&&(te=!1,W=new r.Fragment(p,D),W.start=F,W.sn=k,W.cc=U,W.level=E,w&&(W.initSegment=w,W.rawProgramDateTime=w.rawProgramDateTime));var le=H[1];if(le){W.duration=parseFloat(le);var re=(" "+H[2]).slice(1);W.title=re||null,W.tagList.push(re?["INF",le,re]:["INF",le])}else if(H[3])Object(A.isFiniteNumber)(W.duration)&&(W.start=F,J&&(W.levelkey=J),W.sn=k,W.level=E,W.cc=U,W.urlId=y,R.push(W),W.relurl=(" "+H[3]).slice(1),l(W,N),N=W,F+=W.duration,k++,_=0,te=!0);else if(H[4]){var fe=(" "+H[4]).slice(1);N?W.setByteRange(fe,N):W.setByteRange(fe)}else if(H[5])W.rawProgramDateTime=(" "+H[5]).slice(1),W.tagList.push(["PROGRAM-DATE-TIME",W.rawProgramDateTime]),X===-1&&(X=R.length);else{if(H=H[0].match(L),!H){m.logger.warn("No matches on slow regex match for level playlist!");continue}for(G=1;G<H.length&&typeof H[G]=="undefined";G++);var ue=(" "+H[G]).slice(1),ae=(" "+H[G+1]).slice(1),me=H[G+2]?(" "+H[G+2]).slice(1):"";switch(ue){case"PLAYLIST-TYPE":S.type=ae.toUpperCase();break;case"MEDIA-SEQUENCE":k=S.startSN=parseInt(ae);break;case"SKIP":{var ge=new x.AttrList(ae),be=ge.decimalInteger("SKIPPED-SEGMENTS");if(Object(A.isFiniteNumber)(be)){S.skippedSegments=be;for(var Se=be;Se--;)R.unshift(null);k+=be}var we=ge.enumeratedString("RECENTLY-REMOVED-DATERANGES");we&&(S.recentlyRemovedDateranges=we.split("	"));break}case"TARGETDURATION":S.targetduration=parseFloat(ae);break;case"VERSION":S.version=parseInt(ae);break;case"EXTM3U":break;case"ENDLIST":S.live=!1;break;case"#":(ae||me)&&W.tagList.push(me?[ae,me]:[ae]);break;case"DIS":U++;case"GAP":W.tagList.push([ue]);break;case"BITRATE":W.tagList.push([ue,ae]);break;case"DISCONTINUITY-SEQ":U=parseInt(ae);break;case"KEY":{var Ce,Le=new x.AttrList(ae),Ue=Le.enumeratedString("METHOD"),Ke=Le.URI,We=Le.hexadecimalInteger("IV"),Be=Le.enumeratedString("KEYFORMATVERSIONS"),ze=Le.enumeratedString("KEYID"),Te=(Ce=Le.enumeratedString("KEYFORMAT"))!=null?Ce:"identity",tt=["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"];if(tt.indexOf(Te)>-1){m.logger.warn("Keyformat "+Te+" is not supported from the manifest");continue}else if(Te!=="identity")continue;Ue&&(J=O.LevelKey.fromURL(D,Ke),Ke&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(Ue)>=0&&(J.method=Ue,J.keyFormat=Te,ze&&(J.keyID=ze),Be&&(J.keyFormatVersions=Be),J.iv=We));break}case"START":{var rt=new x.AttrList(ae),Y=rt.decimalFloatingPoint("TIME-OFFSET");Object(A.isFiniteNumber)(Y)&&(S.startTimeOffset=Y);break}case"MAP":{var Z=new x.AttrList(ae);W.relurl=Z.URI,Z.BYTERANGE&&W.setByteRange(Z.BYTERANGE),W.level=E,W.sn="initSegment",J&&(W.levelkey=J),W.initSegment=null,w=W,te=!0;break}case"SERVER-CONTROL":{var oe=new x.AttrList(ae);S.canBlockReload=oe.bool("CAN-BLOCK-RELOAD"),S.canSkipUntil=oe.optionalFloat("CAN-SKIP-UNTIL",0),S.canSkipDateRanges=S.canSkipUntil>0&&oe.bool("CAN-SKIP-DATERANGES"),S.partHoldBack=oe.optionalFloat("PART-HOLD-BACK",0),S.holdBack=oe.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var pe=new x.AttrList(ae);S.partTarget=pe.decimalFloatingPoint("PART-TARGET");break}case"PART":{var Pe=S.partList;Pe||(Pe=S.partList=[]);var He=_>0?Pe[Pe.length-1]:void 0,$e=_++,Ze=new r.Part(new x.AttrList(ae),W,D,$e,He);Pe.push(Ze),W.duration+=Ze.duration;break}case"PRELOAD-HINT":{var Ve=new x.AttrList(ae);S.preloadHint=Ve;break}case"RENDITION-REPORT":{var Ne=new x.AttrList(ae);S.renditionReports=S.renditionReports||[],S.renditionReports.push(Ne);break}default:m.logger.warn("line parsed but not handled: "+H);break}}}N&&!N.relurl?(R.pop(),F-=N.duration,S.partList&&(S.fragmentHint=N)):S.partList&&(l(W,N),W.cc=U,S.fragmentHint=W);var nt=R.length,xt=R[0],ft=R[nt-1];if(F+=S.skippedSegments*S.targetduration,F>0&&nt&&ft){S.averagetargetduration=F/nt;var kt=ft.sn;S.endSN=kt!=="initSegment"?kt:0,xt&&(S.startCC=xt.cc,xt.initSegment||S.fragments.every(function(jt){return jt.relurl&&o(jt.relurl)})&&(m.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),W=new r.Fragment(p,D),W.relurl=ft.relurl,W.level=E,W.sn="initSegment",xt.initSegment=W,S.needSidxRanges=!0))}else S.endSN=0,S.startCC=0;return S.fragmentHint&&(F+=S.fragmentHint.duration),S.totalduration=F,S.endCC=U,X>0&&d(R,X),S},s}();function a(s,f){["video","audio","text"].forEach(function(C){var D=s.filter(function(p){return Object(c.isCodecType)(p,C)});if(D.length){var E=D.filter(function(p){return p.lastIndexOf("avc1",0)===0||p.lastIndexOf("mp4a",0)===0});f[C+"Codec"]=E.length>0?E[0]:D[0],s=s.filter(function(p){return D.indexOf(p)===-1})}}),f.unknownCodecs=s}function n(s,f,C){var D=f[C];D&&(s[C]=D)}function d(s,f){for(var C=s[f],D=f;D--;){var E=s[D];if(!E)return;E.programDateTime=C.programDateTime-E.duration*1e3,C=E}}function l(s,f){s.rawProgramDateTime?s.programDateTime=Date.parse(s.rawProgramDateTime):f!=null&&f.programDateTime&&(s.programDateTime=f.endProgramDateTime),Object(A.isFiniteNumber)(s.programDateTime)||(s.programDateTime=null,s.rawProgramDateTime=null)}},"./src/loader/playlist-loader.ts":function(I,M,i){i.r(M);var A=i("./src/polyfills/number.ts"),u=i("./src/events.ts"),r=i("./src/errors.ts"),P=i("./src/utils/logger.ts"),O=i("./src/utils/mp4-tools.ts"),x=i("./src/loader/m3u8-parser.ts"),m=i("./src/types/loader.ts"),c=i("./src/utils/attr-list.ts");function v(L){var g=L.type;switch(g){case m.PlaylistContextType.AUDIO_TRACK:return m.PlaylistLevelType.AUDIO;case m.PlaylistContextType.SUBTITLE_TRACK:return m.PlaylistLevelType.SUBTITLE;default:return m.PlaylistLevelType.MAIN}}function h(L,g){var o=L.url;return(o===void 0||o.indexOf("data:")===0)&&(o=g.url),o}var T=function(){function L(o){this.hls=void 0,this.loaders=Object.create(null),this.hls=o,this.registerListeners()}var g=L.prototype;return g.registerListeners=function(){var t=this.hls;t.on(u.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(u.Events.LEVEL_LOADING,this.onLevelLoading,this),t.on(u.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(u.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},g.unregisterListeners=function(){var t=this.hls;t.off(u.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(u.Events.LEVEL_LOADING,this.onLevelLoading,this),t.off(u.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(u.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},g.createInternalLoader=function(t){var a=this.hls.config,n=a.pLoader,d=a.loader,l=n||d,s=new l(a);return t.loader=s,this.loaders[t.type]=s,s},g.getInternalLoader=function(t){return this.loaders[t.type]},g.resetInternalLoader=function(t){this.loaders[t]&&delete this.loaders[t]},g.destroyInternalLoaders=function(){for(var t in this.loaders){var a=this.loaders[t];a&&a.destroy(),this.resetInternalLoader(t)}},g.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},g.onManifestLoading=function(t,a){var n=a.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:m.PlaylistContextType.MANIFEST,url:n,deliveryDirectives:null})},g.onLevelLoading=function(t,a){var n=a.id,d=a.level,l=a.url,s=a.deliveryDirectives;this.load({id:n,groupId:null,level:d,responseType:"text",type:m.PlaylistContextType.LEVEL,url:l,deliveryDirectives:s})},g.onAudioTrackLoading=function(t,a){var n=a.id,d=a.groupId,l=a.url,s=a.deliveryDirectives;this.load({id:n,groupId:d,level:null,responseType:"text",type:m.PlaylistContextType.AUDIO_TRACK,url:l,deliveryDirectives:s})},g.onSubtitleTrackLoading=function(t,a){var n=a.id,d=a.groupId,l=a.url,s=a.deliveryDirectives;this.load({id:n,groupId:d,level:null,responseType:"text",type:m.PlaylistContextType.SUBTITLE_TRACK,url:l,deliveryDirectives:s})},g.load=function(t){var a,n=this.hls.config,d=this.getInternalLoader(t);if(d){var l=d.context;if(l&&l.url===t.url){P.logger.trace("[playlist-loader]: playlist request ongoing");return}P.logger.log("[playlist-loader]: aborting previous loader for type: "+t.type),d.abort()}var s,f,C,D;switch(t.type){case m.PlaylistContextType.MANIFEST:s=n.manifestLoadingMaxRetry,f=n.manifestLoadingTimeOut,C=n.manifestLoadingRetryDelay,D=n.manifestLoadingMaxRetryTimeout;break;case m.PlaylistContextType.LEVEL:case m.PlaylistContextType.AUDIO_TRACK:case m.PlaylistContextType.SUBTITLE_TRACK:s=0,f=n.levelLoadingTimeOut;break;default:s=n.levelLoadingMaxRetry,f=n.levelLoadingTimeOut,C=n.levelLoadingRetryDelay,D=n.levelLoadingMaxRetryTimeout;break}if(d=this.createInternalLoader(t),(a=t.deliveryDirectives)!==null&&a!==void 0&&a.part){var E;if(t.type===m.PlaylistContextType.LEVEL&&t.level!==null?E=this.hls.levels[t.level].details:t.type===m.PlaylistContextType.AUDIO_TRACK&&t.id!==null?E=this.hls.audioTracks[t.id].details:t.type===m.PlaylistContextType.SUBTITLE_TRACK&&t.id!==null&&(E=this.hls.subtitleTracks[t.id].details),E){var p=E.partTarget,y=E.targetduration;p&&y&&(f=Math.min(Math.max(p*3,y*.8)*1e3,f))}}var S={timeout:f,maxRetry:s,retryDelay:C,maxRetryDelay:D,highWaterMark:0},R={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};d.load(t,S,R)},g.loadsuccess=function(t,a,n,d){if(d===void 0&&(d=null),n.isSidxRequest){this.handleSidxRequest(t,n),this.handlePlaylistLoaded(t,a,n,d);return}this.resetInternalLoader(n.type);var l=t.data;if(l.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(t,n,"no EXTM3U delimiter",d);return}a.parsing.start=performance.now(),l.indexOf("#EXTINF:")>0||l.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(t,a,n,d):this.handleMasterPlaylist(t,a,n,d)},g.loaderror=function(t,a,n){n===void 0&&(n=null),this.handleNetworkError(a,n,!1,t)},g.loadtimeout=function(t,a,n){n===void 0&&(n=null),this.handleNetworkError(a,n,!0)},g.handleMasterPlaylist=function(t,a,n,d){var l=this.hls,s=t.data,f=h(t,n),C=x.default.parseMasterPlaylist(s,f),D=C.levels,E=C.sessionData;if(!D.length){this.handleManifestParsingError(t,n,"no level found in manifest",d);return}var p=D.map(function(_){return{id:_.attrs.AUDIO,audioCodec:_.audioCodec}}),y=D.map(function(_){return{id:_.attrs.SUBTITLES,textCodec:_.textCodec}}),S=x.default.parseMasterPlaylistMedia(s,f,"AUDIO",p),R=x.default.parseMasterPlaylistMedia(s,f,"SUBTITLES",y),w=x.default.parseMasterPlaylistMedia(s,f,"CLOSED-CAPTIONS");if(S.length){var k=S.some(function(_){return!_.url});!k&&D[0].audioCodec&&!D[0].attrs.AUDIO&&(P.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),S.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new c.AttrList({}),bitrate:0,url:""}))}l.trigger(u.Events.MANIFEST_LOADED,{levels:D,audioTracks:S,subtitles:R,captions:w,url:f,stats:a,networkDetails:d,sessionData:E})},g.handleTrackOrLevelPlaylist=function(t,a,n,d){var l=this.hls,s=n.id,f=n.level,C=n.type,D=h(t,n),E=Object(A.isFiniteNumber)(s)?s:0,p=Object(A.isFiniteNumber)(f)?f:E,y=v(n),S=x.default.parseLevelPlaylist(t.data,D,p,y,E);if(!S.fragments.length){l.trigger(u.Events.ERROR,{type:r.ErrorTypes.NETWORK_ERROR,details:r.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:D,reason:"no fragments found in level",level:typeof n.level=="number"?n.level:void 0});return}if(C===m.PlaylistContextType.MANIFEST){var R={attrs:new c.AttrList({}),bitrate:0,details:S,name:"",url:D};l.trigger(u.Events.MANIFEST_LOADED,{levels:[R],audioTracks:[],url:D,stats:a,networkDetails:d,sessionData:null})}if(a.parsing.end=performance.now(),S.needSidxRanges){var w,k=(w=S.fragments[0].initSegment)===null||w===void 0?void 0:w.url;this.load({url:k,isSidxRequest:!0,type:C,level:f,levelDetails:S,id:s,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null});return}n.levelDetails=S,this.handlePlaylistLoaded(t,a,n,d)},g.handleSidxRequest=function(t,a){var n=Object(O.parseSegmentIndex)(new Uint8Array(t.data));if(!!n){var d=n.references,l=a.levelDetails;d.forEach(function(s,f){var C=s.info,D=l.fragments[f];D.byteRange.length===0&&D.setByteRange(String(1+C.end-C.start)+"@"+String(C.start)),D.initSegment&&D.initSegment.setByteRange(String(n.moovEndOffset)+"@0")})}},g.handleManifestParsingError=function(t,a,n,d){this.hls.trigger(u.Events.ERROR,{type:r.ErrorTypes.NETWORK_ERROR,details:r.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:a.type===m.PlaylistContextType.MANIFEST,url:t.url,reason:n,response:t,context:a,networkDetails:d})},g.handleNetworkError=function(t,a,n,d){n===void 0&&(n=!1),P.logger.warn("[playlist-loader]: A network "+(n?"timeout":"error")+" occurred while loading "+t.type+" level: "+t.level+" id: "+t.id+' group-id: "'+t.groupId+'"');var l=r.ErrorDetails.UNKNOWN,s=!1,f=this.getInternalLoader(t);switch(t.type){case m.PlaylistContextType.MANIFEST:l=n?r.ErrorDetails.MANIFEST_LOAD_TIMEOUT:r.ErrorDetails.MANIFEST_LOAD_ERROR,s=!0;break;case m.PlaylistContextType.LEVEL:l=n?r.ErrorDetails.LEVEL_LOAD_TIMEOUT:r.ErrorDetails.LEVEL_LOAD_ERROR,s=!1;break;case m.PlaylistContextType.AUDIO_TRACK:l=n?r.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:r.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,s=!1;break;case m.PlaylistContextType.SUBTITLE_TRACK:l=n?r.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:r.ErrorDetails.SUBTITLE_LOAD_ERROR,s=!1;break}f&&this.resetInternalLoader(t.type);var C={type:r.ErrorTypes.NETWORK_ERROR,details:l,fatal:s,url:t.url,loader:f,context:t,networkDetails:a};d&&(C.response=d),this.hls.trigger(u.Events.ERROR,C)},g.handlePlaylistLoaded=function(t,a,n,d){var l=n.type,s=n.level,f=n.id,C=n.groupId,D=n.loader,E=n.levelDetails,p=n.deliveryDirectives;if(!(E!=null&&E.targetduration)){this.handleManifestParsingError(t,n,"invalid target duration",d);return}if(!!D)switch(E.live&&(D.getCacheAge&&(E.ageHeader=D.getCacheAge()||0),(!D.getCacheAge||isNaN(E.ageHeader))&&(E.ageHeader=0)),l){case m.PlaylistContextType.MANIFEST:case m.PlaylistContextType.LEVEL:this.hls.trigger(u.Events.LEVEL_LOADED,{details:E,level:s||0,id:f||0,stats:a,networkDetails:d,deliveryDirectives:p});break;case m.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(u.Events.AUDIO_TRACK_LOADED,{details:E,id:f||0,groupId:C||"",stats:a,networkDetails:d,deliveryDirectives:p});break;case m.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(u.Events.SUBTITLE_TRACK_LOADED,{details:E,id:f||0,groupId:C||"",stats:a,networkDetails:d,deliveryDirectives:p});break}},L}();M.default=T},"./src/polyfills/number.ts":function(I,M,i){i.r(M),i.d(M,"isFiniteNumber",function(){return A}),i.d(M,"MAX_SAFE_INTEGER",function(){return u});var A=Number.isFinite||function(r){return typeof r=="number"&&isFinite(r)},u=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(I,M,i){i.r(M);var A=function(){function u(){}return u.getSilentFrame=function(P,O){switch(P){case"mp4a.40.2":if(O===1)return new Uint8Array([0,200,0,128,35,128]);if(O===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(O===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(O===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(O===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(O===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(O===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(O===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(O===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},u}();M.default=A},"./src/remux/mp4-generator.ts":function(I,M,i){i.r(M);var A=Math.pow(2,32)-1,u=function(){function r(){}return r.init=function(){r.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var O;for(O in r.types)r.types.hasOwnProperty(O)&&(r.types[O]=[O.charCodeAt(0),O.charCodeAt(1),O.charCodeAt(2),O.charCodeAt(3)]);var x=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),m=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);r.HDLR_TYPES={video:x,audio:m};var c=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),v=new Uint8Array([0,0,0,0,0,0,0,0]);r.STTS=r.STSC=r.STCO=v,r.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),r.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),r.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),r.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var h=new Uint8Array([105,115,111,109]),T=new Uint8Array([97,118,99,49]),L=new Uint8Array([0,0,0,1]);r.FTYP=r.box(r.types.ftyp,h,L,h,T),r.DINF=r.box(r.types.dinf,r.box(r.types.dref,c))},r.box=function(O){for(var x=8,m=arguments.length,c=new Array(m>1?m-1:0),v=1;v<m;v++)c[v-1]=arguments[v];for(var h=c.length,T=h;h--;)x+=c[h].byteLength;var L=new Uint8Array(x);for(L[0]=x>>24&255,L[1]=x>>16&255,L[2]=x>>8&255,L[3]=x&255,L.set(O,4),h=0,x=8;h<T;h++)L.set(c[h],x),x+=c[h].byteLength;return L},r.hdlr=function(O){return r.box(r.types.hdlr,r.HDLR_TYPES[O])},r.mdat=function(O){return r.box(r.types.mdat,O)},r.mdhd=function(O,x){x*=O;var m=Math.floor(x/(A+1)),c=Math.floor(x%(A+1));return r.box(r.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,O>>24&255,O>>16&255,O>>8&255,O&255,m>>24,m>>16&255,m>>8&255,m&255,c>>24,c>>16&255,c>>8&255,c&255,85,196,0,0]))},r.mdia=function(O){return r.box(r.types.mdia,r.mdhd(O.timescale,O.duration),r.hdlr(O.type),r.minf(O))},r.mfhd=function(O){return r.box(r.types.mfhd,new Uint8Array([0,0,0,0,O>>24,O>>16&255,O>>8&255,O&255]))},r.minf=function(O){return O.type==="audio"?r.box(r.types.minf,r.box(r.types.smhd,r.SMHD),r.DINF,r.stbl(O)):r.box(r.types.minf,r.box(r.types.vmhd,r.VMHD),r.DINF,r.stbl(O))},r.moof=function(O,x,m){return r.box(r.types.moof,r.mfhd(O),r.traf(m,x))},r.moov=function(O){for(var x=O.length,m=[];x--;)m[x]=r.trak(O[x]);return r.box.apply(null,[r.types.moov,r.mvhd(O[0].timescale,O[0].duration)].concat(m).concat(r.mvex(O)))},r.mvex=function(O){for(var x=O.length,m=[];x--;)m[x]=r.trex(O[x]);return r.box.apply(null,[r.types.mvex].concat(m))},r.mvhd=function(O,x){x*=O;var m=Math.floor(x/(A+1)),c=Math.floor(x%(A+1)),v=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,O>>24&255,O>>16&255,O>>8&255,O&255,m>>24,m>>16&255,m>>8&255,m&255,c>>24,c>>16&255,c>>8&255,c&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return r.box(r.types.mvhd,v)},r.sdtp=function(O){var x=O.samples||[],m=new Uint8Array(4+x.length),c,v;for(c=0;c<x.length;c++)v=x[c].flags,m[c+4]=v.dependsOn<<4|v.isDependedOn<<2|v.hasRedundancy;return r.box(r.types.sdtp,m)},r.stbl=function(O){return r.box(r.types.stbl,r.stsd(O),r.box(r.types.stts,r.STTS),r.box(r.types.stsc,r.STSC),r.box(r.types.stsz,r.STSZ),r.box(r.types.stco,r.STCO))},r.avc1=function(O){var x=[],m=[],c,v,h;for(c=0;c<O.sps.length;c++)v=O.sps[c],h=v.byteLength,x.push(h>>>8&255),x.push(h&255),x=x.concat(Array.prototype.slice.call(v));for(c=0;c<O.pps.length;c++)v=O.pps[c],h=v.byteLength,m.push(h>>>8&255),m.push(h&255),m=m.concat(Array.prototype.slice.call(v));var T=r.box(r.types.avcC,new Uint8Array([1,x[3],x[4],x[5],255,224|O.sps.length].concat(x).concat([O.pps.length]).concat(m))),L=O.width,g=O.height,o=O.pixelRatio[0],t=O.pixelRatio[1];return r.box(r.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,L>>8&255,L&255,g>>8&255,g&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),T,r.box(r.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),r.box(r.types.pasp,new Uint8Array([o>>24,o>>16&255,o>>8&255,o&255,t>>24,t>>16&255,t>>8&255,t&255])))},r.esds=function(O){var x=O.config.length;return new Uint8Array([0,0,0,0,3,23+x,0,1,0,4,15+x,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([x]).concat(O.config).concat([6,1,2]))},r.mp4a=function(O){var x=O.samplerate;return r.box(r.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,O.channelCount,0,16,0,0,0,0,x>>8&255,x&255,0,0]),r.box(r.types.esds,r.esds(O)))},r.mp3=function(O){var x=O.samplerate;return r.box(r.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,O.channelCount,0,16,0,0,0,0,x>>8&255,x&255,0,0]))},r.stsd=function(O){return O.type==="audio"?!O.isAAC&&O.codec==="mp3"?r.box(r.types.stsd,r.STSD,r.mp3(O)):r.box(r.types.stsd,r.STSD,r.mp4a(O)):r.box(r.types.stsd,r.STSD,r.avc1(O))},r.tkhd=function(O){var x=O.id,m=O.duration*O.timescale,c=O.width,v=O.height,h=Math.floor(m/(A+1)),T=Math.floor(m%(A+1));return r.box(r.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,x>>24&255,x>>16&255,x>>8&255,x&255,0,0,0,0,h>>24,h>>16&255,h>>8&255,h&255,T>>24,T>>16&255,T>>8&255,T&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,c>>8&255,c&255,0,0,v>>8&255,v&255,0,0]))},r.traf=function(O,x){var m=r.sdtp(O),c=O.id,v=Math.floor(x/(A+1)),h=Math.floor(x%(A+1));return r.box(r.types.traf,r.box(r.types.tfhd,new Uint8Array([0,0,0,0,c>>24,c>>16&255,c>>8&255,c&255])),r.box(r.types.tfdt,new Uint8Array([1,0,0,0,v>>24,v>>16&255,v>>8&255,v&255,h>>24,h>>16&255,h>>8&255,h&255])),r.trun(O,m.length+16+20+8+16+8+8),m)},r.trak=function(O){return O.duration=O.duration||4294967295,r.box(r.types.trak,r.tkhd(O),r.mdia(O))},r.trex=function(O){var x=O.id;return r.box(r.types.trex,new Uint8Array([0,0,0,0,x>>24,x>>16&255,x>>8&255,x&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},r.trun=function(O,x){var m=O.samples||[],c=m.length,v=12+16*c,h=new Uint8Array(v),T,L,g,o,t,a;for(x+=8+v,h.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,c&255,x>>>24&255,x>>>16&255,x>>>8&255,x&255],0),T=0;T<c;T++)L=m[T],g=L.duration,o=L.size,t=L.flags,a=L.cts,h.set([g>>>24&255,g>>>16&255,g>>>8&255,g&255,o>>>24&255,o>>>16&255,o>>>8&255,o&255,t.isLeading<<2|t.dependsOn,t.isDependedOn<<6|t.hasRedundancy<<4|t.paddingValue<<1|t.isNonSync,t.degradPrio&240<<8,t.degradPrio&15,a>>>24&255,a>>>16&255,a>>>8&255,a&255],12+16*T);return r.box(r.types.trun,h)},r.initSegment=function(O){r.types||r.init();var x=r.moov(O),m=new Uint8Array(r.FTYP.byteLength+x.byteLength);return m.set(r.FTYP),m.set(x,r.FTYP.byteLength),m},r}();u.types=void 0,u.HDLR_TYPES=void 0,u.STTS=void 0,u.STSC=void 0,u.STCO=void 0,u.STSZ=void 0,u.VMHD=void 0,u.SMHD=void 0,u.STSD=void 0,u.FTYP=void 0,u.DINF=void 0,M.default=u},"./src/remux/mp4-remuxer.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return a}),i.d(M,"normalizePts",function(){return n});var A=i("./src/polyfills/number.ts"),u=i("./src/remux/aac-helper.ts"),r=i("./src/remux/mp4-generator.ts"),P=i("./src/events.ts"),O=i("./src/errors.ts"),x=i("./src/utils/logger.ts"),m=i("./src/types/loader.ts"),c=i("./src/utils/timescale-conversion.ts");function v(){return v=Object.assign||function(f){for(var C=1;C<arguments.length;C++){var D=arguments[C];for(var E in D)Object.prototype.hasOwnProperty.call(D,E)&&(f[E]=D[E])}return f},v.apply(this,arguments)}var h=10*1e3,T=1024,L=1152,g=null,o=null,t=!1,a=function(){function f(D,E,p,y){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=D,this.config=E,this.typeSupported=p,this.ISGenerated=!1,g===null){var S=navigator.userAgent||"",R=S.match(/Chrome\/(\d+)/i);g=R?parseInt(R[1]):0}if(o===null){var w=navigator.userAgent.match(/Safari\/(\d+)/i);o=w?parseInt(w[1]):0}t=!!g&&g<75||!!o&&o<600}var C=f.prototype;return C.destroy=function(){},C.resetTimeStamp=function(E){x.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=E},C.resetNextTimestamp=function(){x.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},C.resetInitSegment=function(){x.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},C.getVideoStartPts=function(E){var p=!1,y=E.reduce(function(S,R){var w=R.pts-S;return w<-4294967296?(p=!0,n(S,R.pts)):w>0?S:R.pts},E[0].pts);return p&&x.logger.debug("PTS rollover detected"),y},C.remux=function(E,p,y,S,R,w,k,_){var F,U,N,W,H,G,J=R,X=R,te=E.pid>-1,le=p.pid>-1,re=p.samples.length,fe=E.samples.length>0,ue=re>1,ae=(!te||fe)&&(!le||ue)||this.ISGenerated||k;if(ae){this.ISGenerated||(N=this.generateIS(E,p,R));var me=this.isVideoContiguous,ge=-1;if(ue&&(ge=d(p.samples),!me&&this.config.forceKeyFrameOnDiscontinuity))if(G=!0,ge>0){x.logger.warn("[mp4-remuxer]: Dropped "+ge+" out of "+re+" video samples due to a missing keyframe");var be=this.getVideoStartPts(p.samples);p.samples=p.samples.slice(ge),p.dropped+=ge,X+=(p.samples[0].pts-be)/(p.timescale||9e4)}else ge===-1&&(x.logger.warn("[mp4-remuxer]: No keyframe found out of "+re+" video samples"),G=!1);if(this.ISGenerated){if(fe&&ue){var Se=this.getVideoStartPts(p.samples),we=n(E.samples[0].pts,Se)-Se,Ce=we/p.inputTimeScale;J+=Math.max(0,Ce),X+=Math.max(0,-Ce)}if(fe){if(E.samplerate||(x.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),N=this.generateIS(E,p,R)),U=this.remuxAudio(E,J,this.isAudioContiguous,w,le||ue||_===m.PlaylistLevelType.AUDIO?X:void 0),ue){var Le=U?U.endPTS-U.startPTS:0;p.inputTimeScale||(x.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),N=this.generateIS(E,p,R)),F=this.remuxVideo(p,X,me,Le)}}else ue&&(F=this.remuxVideo(p,X,me,0));F&&(F.firstKeyFrame=ge,F.independent=ge!==-1)}}return this.ISGenerated&&(y.samples.length&&(H=this.remuxID3(y,R)),S.samples.length&&(W=this.remuxText(S,R))),{audio:U,video:F,initSegment:N,independent:G,text:W,id3:H}},C.generateIS=function(E,p,y){var S=E.samples,R=p.samples,w=this.typeSupported,k={},_=!Object(A.isFiniteNumber)(this._initPTS),F="audio/mp4",U,N,W;if(_&&(U=N=1/0),E.config&&S.length&&(E.timescale=E.samplerate,E.isAAC||(w.mpeg?(F="audio/mpeg",E.codec=""):w.mp3&&(E.codec="mp3")),k.audio={id:"audio",container:F,codec:E.codec,initSegment:!E.isAAC&&w.mpeg?new Uint8Array(0):r.default.initSegment([E]),metadata:{channelCount:E.channelCount}},_&&(W=E.inputTimeScale,U=N=S[0].pts-Math.round(W*y))),p.sps&&p.pps&&R.length&&(p.timescale=p.inputTimeScale,k.video={id:"main",container:"video/mp4",codec:p.codec,initSegment:r.default.initSegment([p]),metadata:{width:p.width,height:p.height}},_)){W=p.inputTimeScale;var H=this.getVideoStartPts(R),G=Math.round(W*y);N=Math.min(N,n(R[0].dts,H)-G),U=Math.min(U,H-G)}if(Object.keys(k).length)return this.ISGenerated=!0,_&&(this._initPTS=U,this._initDTS=N),{tracks:k,initPTS:U,timescale:W}},C.remuxVideo=function(E,p,y,S){var R=E.inputTimeScale,w=E.samples,k=[],_=w.length,F=this._initPTS,U=this.nextAvcDts,N=8,W,H,G,J=Number.POSITIVE_INFINITY,X=Number.NEGATIVE_INFINITY,te=0,le=!1;if(!y||U===null){var re=p*R,fe=w[0].pts-n(w[0].dts,w[0].pts);U=re-fe}for(var ue=0;ue<_;ue++){var ae=w[ue];if(ae.pts=n(ae.pts-F,U),ae.dts=n(ae.dts-F,U),ae.dts>ae.pts){var me=18e3;te=Math.max(Math.min(te,ae.pts-ae.dts),-1*me)}ae.dts<w[ue>0?ue-1:ue].dts&&(le=!0)}le&&w.sort(function(Qt,fr){var _t=Qt.dts-fr.dts,jr=Qt.pts-fr.pts;return _t||jr}),H=w[0].dts,G=w[w.length-1].dts;var ge=Math.round((G-H)/(_-1));if(te<0){if(te<ge*-2){x.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(c.toMsFromMpegTsClock)(-ge,!0)+" ms");for(var be=te,Se=0;Se<_;Se++)w[Se].dts=be=Math.max(be,w[Se].pts-ge),w[Se].pts=Math.max(be,w[Se].pts)}else{x.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(c.toMsFromMpegTsClock)(te,!0)+" ms to overcome this issue");for(var we=0;we<_;we++)w[we].dts=w[we].dts+te}H=w[0].dts}if(y){var Ce=H-U,Le=Ce>ge,Ue=Ce<-1;if(Le||Ue){Le?x.logger.warn("AVC: "+Object(c.toMsFromMpegTsClock)(Ce,!0)+" ms ("+Ce+"dts) hole between fragments detected, filling it"):x.logger.warn("AVC: "+Object(c.toMsFromMpegTsClock)(-Ce,!0)+" ms ("+Ce+"dts) overlapping between fragments detected"),H=U;var Ke=w[0].pts-Ce;w[0].dts=H,w[0].pts=Ke,x.logger.log("Video: First PTS/DTS adjusted: "+Object(c.toMsFromMpegTsClock)(Ke,!0)+"/"+Object(c.toMsFromMpegTsClock)(H,!0)+", delta: "+Object(c.toMsFromMpegTsClock)(Ce,!0)+" ms")}}t&&(H=Math.max(0,H));for(var We=0,Be=0,ze=0;ze<_;ze++){for(var Te=w[ze],tt=Te.units,rt=tt.length,Y=0,Z=0;Z<rt;Z++)Y+=tt[Z].data.length;Be+=Y,We+=rt,Te.length=Y,Te.dts=Math.max(Te.dts,H),Te.pts=Math.max(Te.pts,Te.dts,0),J=Math.min(Te.pts,J),X=Math.max(Te.pts,X)}G=w[_-1].dts;var oe=Be+4*We+8,pe;try{pe=new Uint8Array(oe)}catch{this.observer.emit(P.Events.ERROR,P.Events.ERROR,{type:O.ErrorTypes.MUX_ERROR,details:O.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:oe,reason:"fail allocating video mdat "+oe});return}var Pe=new DataView(pe.buffer);Pe.setUint32(0,oe),pe.set(r.default.types.mdat,4);for(var He=0;He<_;He++){for(var $e=w[He],Ze=$e.units,Ve=0,Ne=0,nt=Ze.length;Ne<nt;Ne++){var xt=Ze[Ne],ft=xt.data,kt=xt.data.byteLength;Pe.setUint32(N,kt),N+=4,pe.set(ft,N),N+=kt,Ve+=4+kt}if(He<_-1)W=w[He+1].dts-$e.dts;else{var jt=this.config,Xt=$e.dts-w[He>0?He-1:He].dts;if(jt.stretchShortVideoTrack&&this.nextAudioPts!==null){var Nr=Math.floor(jt.maxBufferHole*R),cr=(S?J+S*R:this.nextAudioPts)-$e.pts;cr>Nr?(W=cr-Xt,W<0&&(W=Xt),x.logger.log("[mp4-remuxer]: It is approximately "+cr/90+" ms to the next segment; using duration "+W/90+" ms for the last video frame.")):W=Xt}else W=Xt}var Kr=Math.round($e.pts-$e.dts);k.push(new l($e.key,W,Ve,Kr))}if(k.length&&g&&g<70){var Or=k[0].flags;Or.dependsOn=2,Or.isNonSync=0}console.assert(W!==void 0,"mp4SampleDuration must be computed"),this.nextAvcDts=U=G+W,this.isVideoContiguous=!0;var Wr=r.default.moof(E.sequenceNumber++,H,v({},E,{samples:k})),Mr="video",Hr={data1:Wr,data2:pe,startPTS:J/R,endPTS:(X+W)/R,startDTS:H/R,endDTS:U/R,type:Mr,hasAudio:!1,hasVideo:!0,nb:k.length,dropped:E.dropped};return E.samples=[],E.dropped=0,console.assert(pe.length,"MDAT length must not be zero"),Hr},C.remuxAudio=function(E,p,y,S,R){var w=E.inputTimeScale,k=E.samplerate?E.samplerate:w,_=w/k,F=E.isAAC?T:L,U=F*_,N=this._initPTS,W=!E.isAAC&&this.typeSupported.mpeg,H=[],G=E.samples,J=W?0:8,X=this.nextAudioPts||-1,te=p*w;if(this.isAudioContiguous=y=y||G.length&&X>0&&(S&&Math.abs(te-X)<9e3||Math.abs(n(G[0].pts-N,te)-X)<20*U),G.forEach(function(ft){ft.pts=n(ft.pts-N,te)}),!y||X<0){if(G=G.filter(function(ft){return ft.pts>=0}),!G.length)return;R===0?X=0:S?X=Math.max(0,te):X=G[0].pts}if(E.isAAC)for(var le=R!==void 0,re=this.config.maxAudioFramesDrift,fe=0,ue=X;fe<G.length;fe++){var ae=G[fe],me=ae.pts,ge=me-ue,be=Math.abs(1e3*ge/w);if(ge<=-re*U&&le)fe===0&&(x.logger.warn("Audio frame @ "+(me/w).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*ge/w)+" ms."),this.nextAudioPts=X=ue=me);else if(ge>=re*U&&be<h&&le){var Se=Math.round(ge/U);ue=me-Se*U,ue<0&&(Se--,ue+=U),fe===0&&(this.nextAudioPts=X=ue),x.logger.warn("[mp4-remuxer]: Injecting "+Se+" audio frame @ "+(ue/w).toFixed(3)+"s due to "+Math.round(1e3*ge/w)+" ms gap.");for(var we=0;we<Se;we++){var Ce=Math.max(ue,0),Le=u.default.getSilentFrame(E.manifestCodec||E.codec,E.channelCount);Le||(x.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Le=ae.unit.subarray()),G.splice(fe,0,{unit:Le,pts:Ce}),ue+=U,fe++}}ae.pts=ue,ue+=U}for(var Ue=null,Ke=null,We,Be=0,ze=G.length;ze--;)Be+=G[ze].unit.byteLength;for(var Te=0,tt=G.length;Te<tt;Te++){var rt=G[Te],Y=rt.unit,Z=rt.pts;if(Ke!==null){var oe=H[Te-1];oe.duration=Math.round((Z-Ke)/_)}else if(y&&E.isAAC&&(Z=X),Ue=Z,Be>0){Be+=J;try{We=new Uint8Array(Be)}catch{this.observer.emit(P.Events.ERROR,P.Events.ERROR,{type:O.ErrorTypes.MUX_ERROR,details:O.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Be,reason:"fail allocating audio mdat "+Be});return}if(!W){var pe=new DataView(We.buffer);pe.setUint32(0,Be),We.set(r.default.types.mdat,4)}}else return;We.set(Y,J);var Pe=Y.byteLength;J+=Pe,H.push(new l(!0,F,Pe,0)),Ke=Z}var He=H.length;if(!!He){var $e=H[H.length-1];this.nextAudioPts=X=Ke+_*$e.duration;var Ze=W?new Uint8Array(0):r.default.moof(E.sequenceNumber++,Ue/_,v({},E,{samples:H}));E.samples=[];var Ve=Ue/w,Ne=X/w,nt="audio",xt={data1:Ze,data2:We,startPTS:Ve,endPTS:Ne,startDTS:Ve,endDTS:Ne,type:nt,hasAudio:!0,hasVideo:!1,nb:He};return this.isAudioContiguous=!0,console.assert(We.length,"MDAT length must not be zero"),xt}},C.remuxEmptyAudio=function(E,p,y,S){var R=E.inputTimeScale,w=E.samplerate?E.samplerate:R,k=R/w,_=this.nextAudioPts,F=(_!==null?_:S.startDTS*R)+this._initDTS,U=S.endDTS*R+this._initDTS,N=k*T,W=Math.ceil((U-F)/N),H=u.default.getSilentFrame(E.manifestCodec||E.codec,E.channelCount);if(x.logger.warn("[mp4-remuxer]: remux empty Audio"),!H){x.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var G=[],J=0;J<W;J++){var X=F+J*N;G.push({unit:H,pts:X,dts:X})}return E.samples=G,this.remuxAudio(E,p,y,!1)},C.remuxID3=function(E,p){var y=E.samples.length;if(!!y){for(var S=E.inputTimeScale,R=this._initPTS,w=this._initDTS,k=0;k<y;k++){var _=E.samples[k];_.pts=n(_.pts-R,p*S)/S,_.dts=n(_.dts-w,p*S)/S}var F=E.samples;return E.samples=[],{samples:F}}},C.remuxText=function(E,p){var y=E.samples.length;if(!!y){for(var S=E.inputTimeScale,R=this._initPTS,w=0;w<y;w++){var k=E.samples[w];k.pts=n(k.pts-R,p*S)/S}E.samples.sort(function(F,U){return F.pts-U.pts});var _=E.samples;return E.samples=[],{samples:_}}},f}();function n(f,C){var D;if(C===null)return f;for(C<f?D=-8589934592:D=8589934592;Math.abs(f-C)>4294967296;)f+=D;return f}function d(f){for(var C=0;C<f.length;C++)if(f[C].key)return C;return-1}var l=function(C,D,E,p){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=D,this.size=E,this.cts=p,this.flags=new s(C)},s=function(C){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=C?2:1,this.isNonSync=C?0:1}},"./src/remux/passthrough-remuxer.ts":function(I,M,i){i.r(M);var A=i("./src/polyfills/number.ts"),u=i("./src/utils/mp4-tools.ts"),r=i("./src/loader/fragment.ts"),P=i("./src/utils/logger.ts"),O=function(){function c(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var v=c.prototype;return v.destroy=function(){},v.resetTimeStamp=function(T){this.initPTS=T,this.lastEndDTS=null},v.resetNextTimestamp=function(){this.lastEndDTS=null},v.resetInitSegment=function(T,L,g){this.audioCodec=L,this.videoCodec=g,this.generateInitSegment(T),this.emitInitSegment=!0},v.generateInitSegment=function(T){var L=this.audioCodec,g=this.videoCodec;if(!T||!T.byteLength){this.initTracks=void 0,this.initData=void 0;return}var o=this.initData=Object(u.parseInitSegment)(T);L||(L=m(o.audio,r.ElementaryStreamTypes.AUDIO)),g||(g=m(o.video,r.ElementaryStreamTypes.VIDEO));var t={};o.audio&&o.video?t.audiovideo={container:"video/mp4",codec:L+","+g,initSegment:T,id:"main"}:o.audio?t.audio={container:"audio/mp4",codec:L,initSegment:T,id:"audio"}:o.video?t.video={container:"video/mp4",codec:g,initSegment:T,id:"main"}:P.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=t},v.remux=function(T,L,g,o,t){var a=this.initPTS,n=this.lastEndDTS,d={audio:void 0,video:void 0,text:o,id3:g,initSegment:void 0};Object(A.isFiniteNumber)(n)||(n=this.lastEndDTS=t||0);var l=L.samples;if(!l||!l.length)return d;var s={initPTS:void 0,timescale:1},f=this.initData;if((!f||!f.length)&&(this.generateInitSegment(l),f=this.initData),!f||!f.length)return P.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(s.tracks=this.initTracks,this.emitInitSegment=!1),Object(A.isFiniteNumber)(a)||(this.initPTS=s.initPTS=a=x(f,l,n));var C=Object(u.getDuration)(l,f),D=n,E=C+D;Object(u.offsetStartDTS)(f,l,a),C>0?this.lastEndDTS=E:(P.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var p=!!f.audio,y=!!f.video,S="";p&&(S+="audio"),y&&(S+="video");var R={data1:l,startPTS:D,startDTS:D,endPTS:E,endDTS:E,type:S,hasAudio:p,hasVideo:y,nb:1,dropped:0};return d.audio=R.type==="audio"?R:void 0,d.video=R.type!=="audio"?R:void 0,d.text=o,d.id3=g,d.initSegment=s,d},c}(),x=function(v,h,T){return Object(u.getStartDTS)(v,h)-T};function m(c,v){var h=c==null?void 0:c.codec;return h&&h.length>4?h:h==="hvc1"?"hvc1.1.c.L120.90":h==="av01"?"av01.0.04M.08":h==="avc1"||v===r.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}M.default=O},"./src/task-loop.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return A});var A=function(){function u(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var r=u.prototype;return r.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},r.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},r.onHandlerDestroyed=function(){},r.hasInterval=function(){return!!this._tickInterval},r.hasNextTick=function(){return!!this._tickTimer},r.setInterval=function(O){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,O),!0)},r.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},r.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},r.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},r.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},r.doTick=function(){},u}()},"./src/types/cmcd.ts":function(I,M,i){i.r(M),i.d(M,"CMCDVersion",function(){return A}),i.d(M,"CMCDObjectType",function(){return u}),i.d(M,"CMCDStreamingFormat",function(){return r}),i.d(M,"CMCDStreamType",function(){return P});var A=1,u;(function(O){O.MANIFEST="m",O.AUDIO="a",O.VIDEO="v",O.MUXED="av",O.INIT="i",O.CAPTION="c",O.TIMED_TEXT="tt",O.KEY="k",O.OTHER="o"})(u||(u={}));var r;(function(O){O.DASH="d",O.HLS="h",O.SMOOTH="s",O.OTHER="o"})(r||(r={}));var P;(function(O){O.VOD="v",O.LIVE="l"})(P||(P={}))},"./src/types/level.ts":function(I,M,i){i.r(M),i.d(M,"HlsSkip",function(){return r}),i.d(M,"getSkipValue",function(){return P}),i.d(M,"HlsUrlParameters",function(){return O}),i.d(M,"Level",function(){return x});function A(m,c){for(var v=0;v<c.length;v++){var h=c[v];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(m,h.key,h)}}function u(m,c,v){return c&&A(m.prototype,c),v&&A(m,v),m}var r;(function(m){m.No="",m.Yes="YES",m.v2="v2"})(r||(r={}));function P(m,c){var v=m.canSkipUntil,h=m.canSkipDateRanges,T=m.endSN,L=c!==void 0?c-T:0;return v&&L<v?h?r.v2:r.Yes:r.No}var O=function(){function m(v,h,T){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=v,this.part=h,this.skip=T}var c=m.prototype;return c.addDirectives=function(h){var T=new self.URL(h);return this.msn!==void 0&&T.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&T.searchParams.set("_HLS_part",this.part.toString()),this.skip&&T.searchParams.set("_HLS_skip",this.skip),T.toString()},m}(),x=function(){function m(c){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[c.url],this.attrs=c.attrs,this.bitrate=c.bitrate,c.details&&(this.details=c.details),this.id=c.id||0,this.name=c.name,this.width=c.width||0,this.height=c.height||0,this.audioCodec=c.audioCodec,this.videoCodec=c.videoCodec,this.unknownCodecs=c.unknownCodecs,this.codecSet=[c.videoCodec,c.audioCodec].filter(function(v){return v}).join(",").replace(/\.[^.,]+/g,"")}return u(m,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(v){var h=v%this.url.length;this._urlId!==h&&(this.details=void 0,this._urlId=h)}}]),m}()},"./src/types/loader.ts":function(I,M,i){i.r(M),i.d(M,"PlaylistContextType",function(){return A}),i.d(M,"PlaylistLevelType",function(){return u});var A;(function(r){r.MANIFEST="manifest",r.LEVEL="level",r.AUDIO_TRACK="audioTrack",r.SUBTITLE_TRACK="subtitleTrack"})(A||(A={}));var u;(function(r){r.MAIN="main",r.AUDIO="audio",r.SUBTITLE="subtitle"})(u||(u={}))},"./src/types/transmuxer.ts":function(I,M,i){i.r(M),i.d(M,"ChunkMetadata",function(){return A});var A=function(P,O,x,m,c,v){m===void 0&&(m=0),c===void 0&&(c=-1),v===void 0&&(v=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=u(),this.buffering={audio:u(),video:u(),audiovideo:u()},this.level=P,this.sn=O,this.id=x,this.size=m,this.part=c,this.partial=v};function u(){return{start:0,executeStart:0,executeEnd:0,end:0}}},"./src/utils/attr-list.ts":function(I,M,i){i.r(M),i.d(M,"AttrList",function(){return r});var A=/^(\d+)x(\d+)$/,u=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,r=function(){function P(x){typeof x=="string"&&(x=P.parseAttrList(x));for(var m in x)x.hasOwnProperty(m)&&(this[m]=x[m])}var O=P.prototype;return O.decimalInteger=function(m){var c=parseInt(this[m],10);return c>Number.MAX_SAFE_INTEGER?1/0:c},O.hexadecimalInteger=function(m){if(this[m]){var c=(this[m]||"0x").slice(2);c=(c.length&1?"0":"")+c;for(var v=new Uint8Array(c.length/2),h=0;h<c.length/2;h++)v[h]=parseInt(c.slice(h*2,h*2+2),16);return v}else return null},O.hexadecimalIntegerAsNumber=function(m){var c=parseInt(this[m],16);return c>Number.MAX_SAFE_INTEGER?1/0:c},O.decimalFloatingPoint=function(m){return parseFloat(this[m])},O.optionalFloat=function(m,c){var v=this[m];return v?parseFloat(v):c},O.enumeratedString=function(m){return this[m]},O.bool=function(m){return this[m]==="YES"},O.decimalResolution=function(m){var c=A.exec(this[m]);if(c!==null)return{width:parseInt(c[1],10),height:parseInt(c[2],10)}},P.parseAttrList=function(m){var c,v={},h='"';for(u.lastIndex=0;(c=u.exec(m))!==null;){var T=c[2];T.indexOf(h)===0&&T.lastIndexOf(h)===T.length-1&&(T=T.slice(1,-1)),v[c[1]]=T}return v},P}()},"./src/utils/binary-search.ts":function(I,M,i){i.r(M);var A={search:function(r,P){for(var O=0,x=r.length-1,m=null,c=null;O<=x;){m=(O+x)/2|0,c=r[m];var v=P(c);if(v>0)O=m+1;else if(v<0)x=m-1;else return c}return null}};M.default=A},"./src/utils/buffer-helper.ts":function(I,M,i){i.r(M),i.d(M,"BufferHelper",function(){return r});var A=i("./src/utils/logger.ts"),u={length:0,start:function(){return 0},end:function(){return 0}},r=function(){function P(){}return P.isBuffered=function(x,m){try{if(x){for(var c=P.getBuffered(x),v=0;v<c.length;v++)if(m>=c.start(v)&&m<=c.end(v))return!0}}catch{}return!1},P.bufferInfo=function(x,m,c){try{if(x){var v=P.getBuffered(x),h=[],T;for(T=0;T<v.length;T++)h.push({start:v.start(T),end:v.end(T)});return this.bufferedInfo(h,m,c)}}catch{}return{len:0,start:m,end:m,nextStart:void 0}},P.bufferedInfo=function(x,m,c){m=Math.max(0,m),x.sort(function(s,f){var C=s.start-f.start;return C||f.end-s.end});var v=[];if(c)for(var h=0;h<x.length;h++){var T=v.length;if(T){var L=v[T-1].end;x[h].start-L<c?x[h].end>L&&(v[T-1].end=x[h].end):v.push(x[h])}else v.push(x[h])}else v=x;for(var g=0,o,t=m,a=m,n=0;n<v.length;n++){var d=v[n].start,l=v[n].end;if(m+c>=d&&m<l)t=d,a=l,g=a-m;else if(m+c<d){o=d;break}}return{len:g,start:t||0,end:a||0,nextStart:o}},P.getBuffered=function(x){try{return x.buffered}catch(m){return A.logger.log("failed to get media.buffered",m),u}},P}()},"./src/utils/cea-608-parser.ts":function(I,M,i){i.r(M),i.d(M,"Row",function(){return a}),i.d(M,"CaptionScreen",function(){return n});var A=i("./src/utils/logger.ts"),u={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},r=function(E){var p=E;return u.hasOwnProperty(E)&&(p=u[E]),String.fromCharCode(p)},P=15,O=100,x={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},m={17:2,18:4,21:6,22:8,23:10,19:13,20:15},c={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},v={25:2,26:4,29:6,30:8,31:10,27:13,28:15},h=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],T;(function(D){D[D.ERROR=0]="ERROR",D[D.TEXT=1]="TEXT",D[D.WARNING=2]="WARNING",D[D.INFO=2]="INFO",D[D.DEBUG=3]="DEBUG",D[D.DATA=3]="DATA"})(T||(T={}));var L=function(){function D(){this.time=null,this.verboseLevel=T.ERROR}var E=D.prototype;return E.log=function(y,S){this.verboseLevel>=y&&A.logger.log(this.time+" ["+y+"] "+S)},D}(),g=function(E){for(var p=[],y=0;y<E.length;y++)p.push(E[y].toString(16));return p},o=function(){function D(p,y,S,R,w){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=p||"white",this.underline=y||!1,this.italics=S||!1,this.background=R||"black",this.flash=w||!1}var E=D.prototype;return E.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},E.setStyles=function(y){for(var S=["foreground","underline","italics","background","flash"],R=0;R<S.length;R++){var w=S[R];y.hasOwnProperty(w)&&(this[w]=y[w])}},E.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},E.equals=function(y){return this.foreground===y.foreground&&this.underline===y.underline&&this.italics===y.italics&&this.background===y.background&&this.flash===y.flash},E.copy=function(y){this.foreground=y.foreground,this.underline=y.underline,this.italics=y.italics,this.background=y.background,this.flash=y.flash},E.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},D}(),t=function(){function D(p,y,S,R,w,k){this.uchar=void 0,this.penState=void 0,this.uchar=p||" ",this.penState=new o(y,S,R,w,k)}var E=D.prototype;return E.reset=function(){this.uchar=" ",this.penState.reset()},E.setChar=function(y,S){this.uchar=y,this.penState.copy(S)},E.setPenState=function(y){this.penState.copy(y)},E.equals=function(y){return this.uchar===y.uchar&&this.penState.equals(y.penState)},E.copy=function(y){this.uchar=y.uchar,this.penState.copy(y.penState)},E.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},D}(),a=function(){function D(p){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var y=0;y<O;y++)this.chars.push(new t);this.logger=p,this.pos=0,this.currPenState=new o}var E=D.prototype;return E.equals=function(y){for(var S=!0,R=0;R<O;R++)if(!this.chars[R].equals(y.chars[R])){S=!1;break}return S},E.copy=function(y){for(var S=0;S<O;S++)this.chars[S].copy(y.chars[S])},E.isEmpty=function(){for(var y=!0,S=0;S<O;S++)if(!this.chars[S].isEmpty()){y=!1;break}return y},E.setCursor=function(y){this.pos!==y&&(this.pos=y),this.pos<0?(this.logger.log(T.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>O&&(this.logger.log(T.DEBUG,"Too large cursor position "+this.pos),this.pos=O)},E.moveCursor=function(y){var S=this.pos+y;if(y>1)for(var R=this.pos+1;R<S+1;R++)this.chars[R].setPenState(this.currPenState);this.setCursor(S)},E.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},E.insertChar=function(y){y>=144&&this.backSpace();var S=r(y);if(this.pos>=O){this.logger.log(T.ERROR,"Cannot insert "+y.toString(16)+" ("+S+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(S,this.currPenState),this.moveCursor(1)},E.clearFromPos=function(y){var S;for(S=y;S<O;S++)this.chars[S].reset()},E.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},E.clearToEndOfRow=function(){this.clearFromPos(this.pos)},E.getTextString=function(){for(var y=[],S=!0,R=0;R<O;R++){var w=this.chars[R].uchar;w!==" "&&(S=!1),y.push(w)}return S?"":y.join("")},E.setPenStyles=function(y){this.currPenState.setStyles(y);var S=this.chars[this.pos];S.setPenState(this.currPenState)},D}(),n=function(){function D(p){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var y=0;y<P;y++)this.rows.push(new a(p));this.logger=p,this.currRow=P-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var E=D.prototype;return E.reset=function(){for(var y=0;y<P;y++)this.rows[y].clear();this.currRow=P-1},E.equals=function(y){for(var S=!0,R=0;R<P;R++)if(!this.rows[R].equals(y.rows[R])){S=!1;break}return S},E.copy=function(y){for(var S=0;S<P;S++)this.rows[S].copy(y.rows[S])},E.isEmpty=function(){for(var y=!0,S=0;S<P;S++)if(!this.rows[S].isEmpty()){y=!1;break}return y},E.backSpace=function(){var y=this.rows[this.currRow];y.backSpace()},E.clearToEndOfRow=function(){var y=this.rows[this.currRow];y.clearToEndOfRow()},E.insertChar=function(y){var S=this.rows[this.currRow];S.insertChar(y)},E.setPen=function(y){var S=this.rows[this.currRow];S.setPenStyles(y)},E.moveCursor=function(y){var S=this.rows[this.currRow];S.moveCursor(y)},E.setCursor=function(y){this.logger.log(T.INFO,"setCursor: "+y);var S=this.rows[this.currRow];S.setCursor(y)},E.setPAC=function(y){this.logger.log(T.INFO,"pacData = "+JSON.stringify(y));var S=y.row-1;if(this.nrRollUpRows&&S<this.nrRollUpRows-1&&(S=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==S){for(var R=0;R<P;R++)this.rows[R].clear();var w=this.currRow+1-this.nrRollUpRows,k=this.lastOutputScreen;if(k){var _=k.rows[w].cueStartTime,F=this.logger.time;if(_&&F!==null&&_<F)for(var U=0;U<this.nrRollUpRows;U++)this.rows[S-this.nrRollUpRows+U+1].copy(k.rows[w+U])}}this.currRow=S;var N=this.rows[this.currRow];if(y.indent!==null){var W=y.indent,H=Math.max(W-1,0);N.setCursor(y.indent),y.color=N.chars[H].penState.foreground}var G={foreground:y.color,underline:y.underline,italics:y.italics,background:"black",flash:!1};this.setPen(G)},E.setBkgData=function(y){this.logger.log(T.INFO,"bkgData = "+JSON.stringify(y)),this.backSpace(),this.setPen(y),this.insertChar(32)},E.setRollUpRows=function(y){this.nrRollUpRows=y},E.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(T.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(T.TEXT,this.getDisplayText());var y=this.currRow+1-this.nrRollUpRows,S=this.rows.splice(y,1)[0];S.clear(),this.rows.splice(this.currRow,0,S),this.logger.log(T.INFO,"Rolling up")},E.getDisplayText=function(y){y=y||!1;for(var S=[],R="",w=-1,k=0;k<P;k++){var _=this.rows[k].getTextString();_&&(w=k+1,y?S.push("Row "+w+": '"+_+"'"):S.push(_.trim()))}return S.length>0&&(y?R="["+S.join(" | ")+"]":R=S.join(`
`)),R},E.getTextAndFormat=function(){return this.rows},D}(),d=function(){function D(p,y,S){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=p,this.outputFilter=y,this.mode=null,this.verbose=0,this.displayedMemory=new n(S),this.nonDisplayedMemory=new n(S),this.lastOutputScreen=new n(S),this.currRollUpRow=this.displayedMemory.rows[P-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=S}var E=D.prototype;return E.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[P-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},E.getHandler=function(){return this.outputFilter},E.setHandler=function(y){this.outputFilter=y},E.setPAC=function(y){this.writeScreen.setPAC(y)},E.setBkgData=function(y){this.writeScreen.setBkgData(y)},E.setMode=function(y){y!==this.mode&&(this.mode=y,this.logger.log(T.INFO,"MODE="+y),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=y)},E.insertChars=function(y){for(var S=0;S<y.length;S++)this.writeScreen.insertChar(y[S]);var R=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(T.INFO,R+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(T.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},E.ccRCL=function(){this.logger.log(T.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},E.ccBS=function(){this.logger.log(T.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},E.ccAOF=function(){},E.ccAON=function(){},E.ccDER=function(){this.logger.log(T.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},E.ccRU=function(y){this.logger.log(T.INFO,"RU("+y+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(y)},E.ccFON=function(){this.logger.log(T.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},E.ccRDC=function(){this.logger.log(T.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},E.ccTR=function(){this.logger.log(T.INFO,"TR"),this.setMode("MODE_TEXT")},E.ccRTD=function(){this.logger.log(T.INFO,"RTD"),this.setMode("MODE_TEXT")},E.ccEDM=function(){this.logger.log(T.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},E.ccCR=function(){this.logger.log(T.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},E.ccENM=function(){this.logger.log(T.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},E.ccEOC=function(){if(this.logger.log(T.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var y=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=y,this.writeScreen=this.nonDisplayedMemory,this.logger.log(T.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},E.ccTO=function(y){this.logger.log(T.INFO,"TO("+y+") - Tab Offset"),this.writeScreen.moveCursor(y)},E.ccMIDROW=function(y){var S={flash:!1};if(S.underline=y%2===1,S.italics=y>=46,S.italics)S.foreground="white";else{var R=Math.floor(y/2)-16,w=["white","green","blue","cyan","red","yellow","magenta"];S.foreground=w[R]}this.logger.log(T.INFO,"MIDROW: "+JSON.stringify(S)),this.writeScreen.setPen(S)},E.outputDataUpdate=function(y){y===void 0&&(y=!1);var S=this.logger.time;S!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=S:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,S,this.lastOutputScreen),y&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:S),this.lastOutputScreen.copy(this.displayedMemory))},E.cueSplitAtTime=function(y){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,y,this.displayedMemory),this.cueStartTime=y))},D}(),l=function(){function D(p,y,S){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var R=new L;this.channels=[null,new d(p,y,R),new d(p+1,S,R)],this.cmdHistory=C(),this.logger=R}var E=D.prototype;return E.getHandler=function(y){return this.channels[y].getHandler()},E.setHandler=function(y,S){this.channels[y].setHandler(S)},E.addData=function(y,S){var R,w,k,_=!1;this.logger.time=y;for(var F=0;F<S.length;F+=2)if(w=S[F]&127,k=S[F+1]&127,!(w===0&&k===0)){if(this.logger.log(T.DATA,"["+g([S[F],S[F+1]])+"] -> ("+g([w,k])+")"),R=this.parseCmd(w,k),R||(R=this.parseMidrow(w,k)),R||(R=this.parsePAC(w,k)),R||(R=this.parseBackgroundAttributes(w,k)),!R&&(_=this.parseChars(w,k),_)){var U=this.currentChannel;if(U&&U>0){var N=this.channels[U];N.insertChars(_)}else this.logger.log(T.WARNING,"No channel found yet. TEXT-MODE?")}!R&&!_&&this.logger.log(T.WARNING,"Couldn't parse cleaned data "+g([w,k])+" orig: "+g([S[F],S[F+1]]))}},E.parseCmd=function(y,S){var R=this.cmdHistory,w=(y===20||y===28||y===21||y===29)&&S>=32&&S<=47,k=(y===23||y===31)&&S>=33&&S<=35;if(!(w||k))return!1;if(f(y,S,R))return s(null,null,R),this.logger.log(T.DEBUG,"Repeated command ("+g([y,S])+") is dropped"),!0;var _=y===20||y===21||y===23?1:2,F=this.channels[_];return y===20||y===21||y===28||y===29?S===32?F.ccRCL():S===33?F.ccBS():S===34?F.ccAOF():S===35?F.ccAON():S===36?F.ccDER():S===37?F.ccRU(2):S===38?F.ccRU(3):S===39?F.ccRU(4):S===40?F.ccFON():S===41?F.ccRDC():S===42?F.ccTR():S===43?F.ccRTD():S===44?F.ccEDM():S===45?F.ccCR():S===46?F.ccENM():S===47&&F.ccEOC():F.ccTO(S-32),s(y,S,R),this.currentChannel=_,!0},E.parseMidrow=function(y,S){var R=0;if((y===17||y===25)&&S>=32&&S<=47){if(y===17?R=1:R=2,R!==this.currentChannel)return this.logger.log(T.ERROR,"Mismatch channel in midrow parsing"),!1;var w=this.channels[R];return w?(w.ccMIDROW(S),this.logger.log(T.DEBUG,"MIDROW ("+g([y,S])+")"),!0):!1}return!1},E.parsePAC=function(y,S){var R,w=this.cmdHistory,k=(y>=17&&y<=23||y>=25&&y<=31)&&S>=64&&S<=127,_=(y===16||y===24)&&S>=64&&S<=95;if(!(k||_))return!1;if(f(y,S,w))return s(null,null,w),!0;var F=y<=23?1:2;S>=64&&S<=95?R=F===1?x[y]:c[y]:R=F===1?m[y]:v[y];var U=this.channels[F];return U?(U.setPAC(this.interpretPAC(R,S)),s(y,S,w),this.currentChannel=F,!0):!1},E.interpretPAC=function(y,S){var R,w={color:null,italics:!1,indent:null,underline:!1,row:y};return S>95?R=S-96:R=S-64,w.underline=(R&1)===1,R<=13?w.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(R/2)]:R<=15?(w.italics=!0,w.color="white"):w.indent=Math.floor((R-16)/2)*4,w},E.parseChars=function(y,S){var R,w=null,k=null;if(y>=25?(R=2,k=y-8):(R=1,k=y),k>=17&&k<=19){var _;k===17?_=S+80:k===18?_=S+112:_=S+144,this.logger.log(T.INFO,"Special char '"+r(_)+"' in channel "+R),w=[_]}else y>=32&&y<=127&&(w=S===0?[y]:[y,S]);if(w){var F=g(w);this.logger.log(T.DEBUG,"Char codes =  "+F.join(",")),s(y,S,this.cmdHistory)}return w},E.parseBackgroundAttributes=function(y,S){var R=(y===16||y===24)&&S>=32&&S<=47,w=(y===23||y===31)&&S>=45&&S<=47;if(!(R||w))return!1;var k,_={};y===16||y===24?(k=Math.floor((S-32)/2),_.background=h[k],S%2===1&&(_.background=_.background+"_semi")):S===45?_.background="transparent":(_.foreground="black",S===47&&(_.underline=!0));var F=y<=23?1:2,U=this.channels[F];return U.setBkgData(_),s(y,S,this.cmdHistory),!0},E.reset=function(){for(var y=0;y<Object.keys(this.channels).length;y++){var S=this.channels[y];S&&S.reset()}this.cmdHistory=C()},E.cueSplitAtTime=function(y){for(var S=0;S<this.channels.length;S++){var R=this.channels[S];R&&R.cueSplitAtTime(y)}},D}();function s(D,E,p){p.a=D,p.b=E}function f(D,E,p){return p.a===D&&p.b===E}function C(){return{a:null,b:null}}M.default=l},"./src/utils/codecs.ts":function(I,M,i){i.r(M),i.d(M,"isCodecType",function(){return u}),i.d(M,"isCodecSupportedInMp4",function(){return r});var A={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function u(P,O){var x=A[O];return!!x&&x[P.slice(0,4)]===!0}function r(P,O){return MediaSource.isTypeSupported((O||"video")+'/mp4;codecs="'+P+'"')}},"./src/utils/cues.ts":function(I,M,i){i.r(M);var A=i("./src/utils/vttparser.ts"),u=i("./src/utils/webvtt-parser.ts"),r=i("./src/utils/texttrack-utils.ts"),P=/\s/,O={newCue:function(m,c,v,h){for(var T=[],L,g,o,t,a,n=self.VTTCue||self.TextTrackCue,d=0;d<h.rows.length;d++)if(L=h.rows[d],o=!0,t=0,a="",!L.isEmpty()){for(var l=0;l<L.chars.length;l++)P.test(L.chars[l].uchar)&&o?t++:(a+=L.chars[l].uchar,o=!1);L.cueStartTime=c,c===v&&(v+=1e-4),t>=16?t--:t++;var s=Object(A.fixLineBreaks)(a.trim()),f=Object(u.generateCueId)(c,v,s);(!m||!m.cues||!m.cues.getCueById(f))&&(g=new n(c,v,s),g.id=f,g.line=d+1,g.align="left",g.position=10+Math.min(80,Math.floor(t*8/32)*10),T.push(g))}return m&&T.length&&(T.sort(function(C,D){return C.line==="auto"||D.line==="auto"?0:C.line>8&&D.line>8?D.line-C.line:C.line-D.line}),T.forEach(function(C){return Object(r.addCueToTrack)(m,C)})),T}};M.default=O},"./src/utils/discontinuities.ts":function(I,M,i){i.r(M),i.d(M,"findFirstFragWithCC",function(){return P}),i.d(M,"shouldAlignOnDiscontinuities",function(){return O}),i.d(M,"findDiscontinuousReferenceFrag",function(){return x}),i.d(M,"adjustSlidingStart",function(){return c}),i.d(M,"alignStream",function(){return v}),i.d(M,"alignPDT",function(){return T}),i.d(M,"alignFragmentByPDTDelta",function(){return L}),i.d(M,"alignMediaPlaylistByPDT",function(){return g});var A=i("./src/polyfills/number.ts"),u=i("./src/utils/logger.ts"),r=i("./src/controller/level-helper.ts");function P(o,t){for(var a=null,n=0,d=o.length;n<d;n++){var l=o[n];if(l&&l.cc===t){a=l;break}}return a}function O(o,t,a){return!!(t.details&&(a.endCC>a.startCC||o&&o.cc<a.startCC))}function x(o,t){var a=o.fragments,n=t.fragments;if(!n.length||!a.length){u.logger.log("No fragments to align");return}var d=P(a,n[0].cc);if(!d||d&&!d.startPTS){u.logger.log("No frag in previous level to align on");return}return d}function m(o,t){if(o){var a=o.start+t;o.start=o.startPTS=a,o.endPTS=a+o.duration}}function c(o,t){for(var a=t.fragments,n=0,d=a.length;n<d;n++)m(a[n],o);t.fragmentHint&&m(t.fragmentHint,o),t.alignedSliding=!0}function v(o,t,a){!t||(h(o,a,t),!a.alignedSliding&&t.details&&T(a,t.details),!a.alignedSliding&&t.details&&!a.skippedSegments&&Object(r.adjustSliding)(t.details,a))}function h(o,t,a){if(O(o,a,t)){var n=x(a.details,t);n&&Object(A.isFiniteNumber)(n.start)&&(u.logger.log("Adjusting PTS using last level due to CC increase within current level "+t.url),c(n.start,t))}}function T(o,t){if(!(!t.fragments.length||!o.hasProgramDateTime||!t.hasProgramDateTime)){var a=t.fragments[0].programDateTime,n=o.fragments[0].programDateTime,d=(n-a)/1e3+t.fragments[0].start;d&&Object(A.isFiniteNumber)(d)&&(u.logger.log("Adjusting PTS using programDateTime delta "+(n-a)+"ms, sliding:"+d.toFixed(3)+" "+o.url+" "),c(d,o))}}function L(o,t){var a=o.programDateTime;if(!!a){var n=(a-t)/1e3;o.start=o.startPTS=n,o.endPTS=n+o.duration}}function g(o,t){if(!(!t.fragments.length||!o.hasProgramDateTime||!t.hasProgramDateTime)){var a=t.fragments[0].programDateTime,n=t.fragments[0].start,d=a-n*1e3;o.fragments.forEach(function(l){L(l,d)}),o.fragmentHint&&L(o.fragmentHint,d),o.alignedSliding=!0}}},"./src/utils/ewma-bandwidth-estimator.ts":function(I,M,i){i.r(M);var A=i("./src/utils/ewma.ts"),u=function(){function r(O,x,m){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=m,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new A.default(O),this.fast_=new A.default(x)}var P=r.prototype;return P.update=function(x,m){var c=this.slow_,v=this.fast_;this.slow_.halfLife!==x&&(this.slow_=new A.default(x,c.getEstimate(),c.getTotalWeight())),this.fast_.halfLife!==m&&(this.fast_=new A.default(m,v.getEstimate(),v.getTotalWeight()))},P.sample=function(x,m){x=Math.max(x,this.minDelayMs_);var c=8*m,v=x/1e3,h=c/v;this.fast_.sample(v,h),this.slow_.sample(v,h)},P.canEstimate=function(){var x=this.fast_;return x&&x.getTotalWeight()>=this.minWeight_},P.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},P.destroy=function(){},r}();M.default=u},"./src/utils/ewma.ts":function(I,M,i){i.r(M);var A=function(){function u(P,O,x){O===void 0&&(O=0),x===void 0&&(x=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=P,this.alpha_=P?Math.exp(Math.log(.5)/P):0,this.estimate_=O,this.totalWeight_=x}var r=u.prototype;return r.sample=function(O,x){var m=Math.pow(this.alpha_,O);this.estimate_=x*(1-m)+m*this.estimate_,this.totalWeight_+=O},r.getTotalWeight=function(){return this.totalWeight_},r.getEstimate=function(){if(this.alpha_){var O=1-Math.pow(this.alpha_,this.totalWeight_);if(O)return this.estimate_/O}return this.estimate_},u}();M.default=A},"./src/utils/fetch-loader.ts":function(I,M,i){i.r(M),i.d(M,"fetchSupported",function(){return L});var A=i("./src/polyfills/number.ts"),u=i("./src/loader/load-stats.ts"),r=i("./src/demux/chunk-cache.ts");function P(n,d){n.prototype=Object.create(d.prototype),n.prototype.constructor=n,v(n,d)}function O(n){var d=typeof Map=="function"?new Map:void 0;return O=function(s){if(s===null||!c(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof d!="undefined"){if(d.has(s))return d.get(s);d.set(s,f)}function f(){return x(s,arguments,h(this).constructor)}return f.prototype=Object.create(s.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),v(f,s)},O(n)}function x(n,d,l){return m()?x=Reflect.construct:x=function(f,C,D){var E=[null];E.push.apply(E,C);var p=Function.bind.apply(f,E),y=new p;return D&&v(y,D.prototype),y},x.apply(null,arguments)}function m(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function c(n){return Function.toString.call(n).indexOf("[native code]")!==-1}function v(n,d){return v=Object.setPrototypeOf||function(s,f){return s.__proto__=f,s},v(n,d)}function h(n){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(l){return l.__proto__||Object.getPrototypeOf(l)},h(n)}function T(){return T=Object.assign||function(n){for(var d=1;d<arguments.length;d++){var l=arguments[d];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(n[s]=l[s])}return n},T.apply(this,arguments)}function L(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}var g=function(){function n(l){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=l.fetchSetup||t,this.controller=new self.AbortController,this.stats=new u.LoadStats}var d=n.prototype;return d.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},d.abortInternal=function(){var s=this.response;(!s||!s.ok)&&(this.stats.aborted=!0,this.controller.abort())},d.abort=function(){var s;this.abortInternal(),(s=this.callbacks)!==null&&s!==void 0&&s.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},d.load=function(s,f,C){var D=this,E=this.stats;if(E.loading.start)throw new Error("Loader can only be used once.");E.loading.start=self.performance.now();var p=o(s,this.controller.signal),y=C.onProgress,S=s.responseType==="arraybuffer",R=S?"byteLength":"length";this.context=s,this.config=f,this.callbacks=C,this.request=this.fetchSetup(s,p),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){D.abortInternal(),C.onTimeout(E,s,D.response)},f.timeout),self.fetch(this.request).then(function(w){if(D.response=D.loader=w,!w.ok){var k=w.status,_=w.statusText;throw new a(_||"fetch, bad network response",k,w)}return E.loading.first=Math.max(self.performance.now(),E.loading.start),E.total=parseInt(w.headers.get("Content-Length")||"0"),y&&Object(A.isFiniteNumber)(f.highWaterMark)?D.loadProgressively(w,E,s,f.highWaterMark,y):S?w.arrayBuffer():w.text()}).then(function(w){var k=D.response;self.clearTimeout(D.requestTimeout),E.loading.end=Math.max(self.performance.now(),E.loading.first),E.loaded=E.total=w[R];var _={url:k.url,data:w};y&&!Object(A.isFiniteNumber)(f.highWaterMark)&&y(E,s,w,k),C.onSuccess(_,E,s,k)}).catch(function(w){if(self.clearTimeout(D.requestTimeout),!E.aborted){var k=w.code||0;C.onError({code:k,text:w.message},s,w.details)}})},d.getCacheAge=function(){var s=null;if(this.response){var f=this.response.headers.get("age");s=f?parseFloat(f):null}return s},d.loadProgressively=function(s,f,C,D,E){D===void 0&&(D=0);var p=new r.default,y=s.body.getReader(),S=function R(){return y.read().then(function(w){if(w.done)return p.dataLength&&E(f,C,p.flush(),s),Promise.resolve(new ArrayBuffer(0));var k=w.value,_=k.length;return f.loaded+=_,_<D||p.dataLength?(p.push(k),p.dataLength>=D&&E(f,C,p.flush(),s)):E(f,C,k,s),R()}).catch(function(){return Promise.reject()})};return S()},n}();function o(n,d){var l={method:"GET",mode:"cors",credentials:"same-origin",signal:d,headers:new self.Headers(T({},n.headers))};return n.rangeEnd&&l.headers.set("Range","bytes="+n.rangeStart+"-"+String(n.rangeEnd-1)),l}function t(n,d){return new self.Request(n.url,d)}var a=function(n){P(d,n);function d(l,s,f){var C;return C=n.call(this,l)||this,C.code=void 0,C.details=void 0,C.code=s,C.details=f,C}return d}(O(Error));M.default=g},"./src/utils/imsc1-ttml-parser.ts":function(I,M,i){i.r(M),i.d(M,"IMSC1_CODEC",function(){return c}),i.d(M,"parseIMSC1",function(){return L});var A=i("./src/utils/mp4-tools.ts"),u=i("./src/utils/vttparser.ts"),r=i("./src/utils/vttcue.ts"),P=i("./src/demux/id3.ts"),O=i("./src/utils/timescale-conversion.ts"),x=i("./src/utils/webvtt-parser.ts");function m(){return m=Object.assign||function(D){for(var E=1;E<arguments.length;E++){var p=arguments[E];for(var y in p)Object.prototype.hasOwnProperty.call(p,y)&&(D[y]=p[y])}return D},m.apply(this,arguments)}var c="stpp.ttml.im1t",v=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,h=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,T={left:"start",center:"center",right:"end",start:"start",end:"end"};function L(D,E,p,y,S){var R=Object(A.findBox)(new Uint8Array(D),["mdat"]);if(R.length===0){S(new Error("Could not parse IMSC1 mdat"));return}var w=R[0],k=Object(P.utf8ArrayToStr)(new Uint8Array(D,w.start,w.end-w.start)),_=Object(O.toTimescaleFromScale)(E,1,p);try{y(g(k,_))}catch(F){S(F)}}function g(D,E){var p=new DOMParser,y=p.parseFromString(D,"text/xml"),S=y.getElementsByTagName("tt")[0];if(!S)throw new Error("Invalid ttml");var R={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},w=Object.keys(R).reduce(function(N,W){return N[W]=S.getAttribute("ttp:"+W)||R[W],N},{}),k=S.getAttribute("xml:space")!=="preserve",_=t(o(S,"styling","style")),F=t(o(S,"layout","region")),U=o(S,"body","[begin]");return[].map.call(U,function(N){var W=a(N,k);if(!W||!N.hasAttribute("begin"))return null;var H=s(N.getAttribute("begin"),w),G=s(N.getAttribute("dur"),w),J=s(N.getAttribute("end"),w);if(H===null)throw l(N);if(J===null){if(G===null)throw l(N);J=H+G}var X=new r.default(H-E,J-E,W);X.id=Object(x.generateCueId)(X.startTime,X.endTime,X.text);var te=F[N.getAttribute("region")],le=_[N.getAttribute("style")];X.position=10,X.size=80;var re=n(te,le),fe=re.textAlign;if(fe){var ue=T[fe];ue&&(X.lineAlign=ue),X.align=fe}return m(X,re),X}).filter(function(N){return N!==null})}function o(D,E,p){var y=D.getElementsByTagName(E)[0];return y?[].slice.call(y.querySelectorAll(p)):[]}function t(D){return D.reduce(function(E,p){var y=p.getAttribute("xml:id");return y&&(E[y]=p),E},{})}function a(D,E){return[].slice.call(D.childNodes).reduce(function(p,y,S){var R;return y.nodeName==="br"&&S?p+`
`:(R=y.childNodes)!==null&&R!==void 0&&R.length?a(y,E):E?p+y.textContent.trim().replace(/\s+/g," "):p+y.textContent},"")}function n(D,E){var p="http://www.w3.org/ns/ttml#styling",y=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"];return y.reduce(function(S,R){var w=d(E,p,R)||d(D,p,R);return w&&(S[R]=w),S},{})}function d(D,E,p){return D.hasAttributeNS(E,p)?D.getAttributeNS(E,p):null}function l(D){return new Error("Could not parse ttml timestamp "+D)}function s(D,E){if(!D)return null;var p=Object(u.parseTimeStamp)(D);return p===null&&(v.test(D)?p=f(D,E):h.test(D)&&(p=C(D,E))),p}function f(D,E){var p=v.exec(D),y=(p[4]|0)+(p[5]|0)/E.subFrameRate;return(p[1]|0)*3600+(p[2]|0)*60+(p[3]|0)+y/E.frameRate}function C(D,E){var p=h.exec(D),y=Number(p[1]),S=p[2];switch(S){case"h":return y*3600;case"m":return y*60;case"ms":return y*1e3;case"f":return y/E.frameRate;case"t":return y/E.tickRate}return y}},"./src/utils/logger.ts":function(I,M,i){i.r(M),i.d(M,"enableLogs",function(){return x}),i.d(M,"logger",function(){return m});var A=function(){},u={trace:A,debug:A,log:A,warn:A,info:A,error:A},r=u;function P(c){var v=self.console[c];return v?v.bind(self.console,"["+c+"] >"):A}function O(c){for(var v=arguments.length,h=new Array(v>1?v-1:0),T=1;T<v;T++)h[T-1]=arguments[T];h.forEach(function(L){r[L]=c[L]?c[L].bind(c):P(L)})}function x(c){if(self.console&&c===!0||typeof c=="object"){O(c,"debug","log","info","warn","error");try{r.log()}catch{r=u}}else r=u}var m=r},"./src/utils/mediakeys-helper.ts":function(I,M,i){i.r(M),i.d(M,"KeySystems",function(){return A}),i.d(M,"requestMediaKeySystemAccess",function(){return u});var A;(function(r){r.WIDEVINE="com.widevine.alpha",r.PLAYREADY="com.microsoft.playready"})(A||(A={}));var u=function(){return typeof self!="undefined"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}()},"./src/utils/mediasource-helper.ts":function(I,M,i){i.r(M),i.d(M,"getMediaSource",function(){return A});function A(){return self.MediaSource||self.WebKitMediaSource}},"./src/utils/mp4-tools.ts":function(I,M,i){i.r(M),i.d(M,"bin2str",function(){return O}),i.d(M,"readUint16",function(){return x}),i.d(M,"readUint32",function(){return m}),i.d(M,"writeUint32",function(){return c}),i.d(M,"findBox",function(){return v}),i.d(M,"parseSegmentIndex",function(){return h}),i.d(M,"parseInitSegment",function(){return T}),i.d(M,"getStartDTS",function(){return L}),i.d(M,"getDuration",function(){return g}),i.d(M,"computeRawDurationFromSamples",function(){return o}),i.d(M,"offsetStartDTS",function(){return t}),i.d(M,"segmentValidRange",function(){return a}),i.d(M,"appendUint8Array",function(){return n});var A=i("./src/utils/typed-array.ts"),u=i("./src/loader/fragment.ts"),r=Math.pow(2,32)-1,P=[].push;function O(d){return String.fromCharCode.apply(null,d)}function x(d,l){"data"in d&&(l+=d.start,d=d.data);var s=d[l]<<8|d[l+1];return s<0?65536+s:s}function m(d,l){"data"in d&&(l+=d.start,d=d.data);var s=d[l]<<24|d[l+1]<<16|d[l+2]<<8|d[l+3];return s<0?4294967296+s:s}function c(d,l,s){"data"in d&&(l+=d.start,d=d.data),d[l]=s>>24,d[l+1]=s>>16&255,d[l+2]=s>>8&255,d[l+3]=s&255}function v(d,l){var s=[];if(!l.length)return s;var f,C,D;"data"in d?(f=d.data,C=d.start,D=d.end):(f=d,C=0,D=f.byteLength);for(var E=C;E<D;){var p=m(f,E),y=O(f.subarray(E+4,E+8)),S=p>1?E+p:D;if(y===l[0])if(l.length===1)s.push({data:f,start:E+8,end:S});else{var R=v({data:f,start:E+8,end:S},l.slice(1));R.length&&P.apply(s,R)}E=S}return s}function h(d){var l=v(d,["moov"]),s=l[0],f=s?s.end:null,C=v(d,["sidx"]);if(!C||!C[0])return null;var D=[],E=C[0],p=E.data[0],y=p===0?8:16,S=m(E,y);y+=4;var R=0,w=0;p===0?y+=8:y+=16,y+=2;var k=E.end+w,_=x(E,y);y+=2;for(var F=0;F<_;F++){var U=y,N=m(E,U);U+=4;var W=N&2147483647,H=(N&2147483648)>>>31;if(H===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var G=m(E,U);U+=4,D.push({referenceSize:W,subsegmentDuration:G,info:{duration:G/S,start:k,end:k+W-1}}),k+=W,U+=4,y=U}return{earliestPresentationTime:R,timescale:S,version:p,referencesCount:_,references:D,moovEndOffset:f}}function T(d){for(var l=[],s=v(d,["moov","trak"]),f=0;f<s.length;f++){var C=s[f],D=v(C,["tkhd"])[0];if(D){var E=D.data[D.start],p=E===0?12:20,y=m(D,p),S=v(C,["mdia","mdhd"])[0];if(S){E=S.data[S.start],p=E===0?12:20;var R=m(S,p),w=v(C,["mdia","hdlr"])[0];if(w){var k=O(w.data.subarray(w.start+8,w.start+12)),_={soun:u.ElementaryStreamTypes.AUDIO,vide:u.ElementaryStreamTypes.VIDEO}[k];if(_){var F=v(C,["mdia","minf","stbl","stsd"])[0],U=void 0;F&&(U=O(F.data.subarray(F.start+12,F.start+16))),l[y]={timescale:R,type:_},l[_]={timescale:R,id:y,codec:U}}}}}}var N=v(d,["moov","mvex","trex"]);return N.forEach(function(W){var H=m(W,4),G=l[H];G&&(G.default={duration:m(W,12),flags:m(W,20)})}),l}function L(d,l){return v(l,["moof","traf"]).reduce(function(s,f){var C=v(f,["tfdt"])[0],D=C.data[C.start],E=v(f,["tfhd"]).reduce(function(p,y){var S=m(y,4),R=d[S];if(R){var w=m(C,4);D===1&&(w*=Math.pow(2,32),w+=m(C,8));var k=R.timescale||9e4,_=w/k;if(isFinite(_)&&(p===null||_<p))return _}return p},null);return E!==null&&isFinite(E)&&(s===null||E<s)?E:s},null)||0}function g(d,l){for(var s=0,f=0,C=0,D=v(d,["moof","traf"]),E=0;E<D.length;E++){var p=D[E],y=v(p,["tfhd"])[0],S=m(y,4),R=l[S];if(!!R){var w=R.default,k=m(y,0)|(w==null?void 0:w.flags),_=w==null?void 0:w.duration;k&8&&(k&2?_=m(y,12):_=m(y,8));for(var F=R.timescale||9e4,U=v(p,["trun"]),N=0;N<U.length;N++){if(s=o(U[N]),!s&&_){var W=m(U[N],4);s=_*W}R.type===u.ElementaryStreamTypes.VIDEO?f+=s/F:R.type===u.ElementaryStreamTypes.AUDIO&&(C+=s/F)}}}if(f===0&&C===0){var H=h(d);if(H!=null&&H.references)return H.references.reduce(function(G,J){return G+J.info.duration||0},0)}return f||C}function o(d){var l=m(d,0),s=8;l&1&&(s+=4),l&4&&(s+=4);for(var f=0,C=m(d,4),D=0;D<C;D++){if(l&256){var E=m(d,s);f+=E,s+=4}l&512&&(s+=4),l&1024&&(s+=4),l&2048&&(s+=4)}return f}function t(d,l,s){v(l,["moof","traf"]).forEach(function(f){v(f,["tfhd"]).forEach(function(C){var D=m(C,4),E=d[D];if(!!E){var p=E.timescale||9e4;v(f,["tfdt"]).forEach(function(y){var S=y.data[y.start],R=m(y,4);if(S===0)c(y,4,R-s*p);else{R*=Math.pow(2,32),R+=m(y,8),R-=s*p,R=Math.max(R,0);var w=Math.floor(R/(r+1)),k=Math.floor(R%(r+1));c(y,4,w),c(y,8,k)}})}})})}function a(d){var l={valid:null,remainder:null},s=v(d,["moof"]);if(s){if(s.length<2)return l.remainder=d,l}else return l;var f=s[s.length-1];return l.valid=Object(A.sliceUint8)(d,0,f.start-8),l.remainder=Object(A.sliceUint8)(d,f.start-8),l}function n(d,l){var s=new Uint8Array(d.length+l.length);return s.set(d),s.set(l,d.length),s}},"./src/utils/output-filter.ts":function(I,M,i){i.r(M),i.d(M,"default",function(){return A});var A=function(){function u(P,O){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=P,this.trackName=O}var r=u.prototype;return r.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},r.newCue=function(O,x,m){(this.startTime===null||this.startTime>O)&&(this.startTime=O),this.endTime=x,this.screen=m,this.timelineController.createCaptionsTrack(this.trackName)},r.reset=function(){this.cueRanges=[],this.startTime=null},u}()},"./src/utils/texttrack-utils.ts":function(I,M,i){i.r(M),i.d(M,"sendAddTrackEvent",function(){return u}),i.d(M,"addCueToTrack",function(){return r}),i.d(M,"clearCurrentCues",function(){return P}),i.d(M,"removeCuesInRange",function(){return O}),i.d(M,"getCuesInRange",function(){return m});var A=i("./src/utils/logger.ts");function u(c,v){var h;try{h=new Event("addtrack")}catch{h=document.createEvent("Event"),h.initEvent("addtrack",!1,!1)}h.track=c,v.dispatchEvent(h)}function r(c,v){var h=c.mode;if(h==="disabled"&&(c.mode="hidden"),c.cues&&!c.cues.getCueById(v.id))try{if(c.addCue(v),!c.cues.getCueById(v.id))throw new Error("addCue is failed for: "+v)}catch(L){A.logger.debug("[texttrack-utils]: "+L);var T=new self.TextTrackCue(v.startTime,v.endTime,v.text);T.id=v.id,c.addCue(T)}h==="disabled"&&(c.mode=h)}function P(c){var v=c.mode;if(v==="disabled"&&(c.mode="hidden"),c.cues)for(var h=c.cues.length;h--;)c.removeCue(c.cues[h]);v==="disabled"&&(c.mode=v)}function O(c,v,h){var T=c.mode;if(T==="disabled"&&(c.mode="hidden"),c.cues&&c.cues.length>0)for(var L=m(c.cues,v,h),g=0;g<L.length;g++)c.removeCue(L[g]);T==="disabled"&&(c.mode=T)}function x(c,v){if(v<c[0].startTime)return 0;var h=c.length-1;if(v>c[h].endTime)return-1;for(var T=0,L=h;T<=L;){var g=Math.floor((L+T)/2);if(v<c[g].startTime)L=g-1;else if(v>c[g].startTime&&T<h)T=g+1;else return g}return c[T].startTime-v<v-c[L].startTime?T:L}function m(c,v,h){var T=[],L=x(c,v);if(L>-1)for(var g=L,o=c.length;g<o;g++){var t=c[g];if(t.startTime>=v&&t.endTime<=h)T.push(t);else if(t.startTime>h)return T}return T}},"./src/utils/time-ranges.ts":function(I,M,i){i.r(M);var A={toString:function(r){for(var P="",O=r.length,x=0;x<O;x++)P+="["+r.start(x).toFixed(3)+","+r.end(x).toFixed(3)+"]";return P}};M.default=A},"./src/utils/timescale-conversion.ts":function(I,M,i){i.r(M),i.d(M,"toTimescaleFromBase",function(){return u}),i.d(M,"toTimescaleFromScale",function(){return r}),i.d(M,"toMsFromMpegTsClock",function(){return P}),i.d(M,"toMpegTsClockFromTimescale",function(){return O});var A=9e4;function u(x,m,c,v){c===void 0&&(c=1),v===void 0&&(v=!1);var h=x*m*c;return v?Math.round(h):h}function r(x,m,c,v){return c===void 0&&(c=1),v===void 0&&(v=!1),u(x,m,1/c,v)}function P(x,m){return m===void 0&&(m=!1),u(x,1e3,1/A,m)}function O(x,m){return m===void 0&&(m=1),u(x,A,1/m)}},"./src/utils/typed-array.ts":function(I,M,i){i.r(M),i.d(M,"sliceUint8",function(){return A});function A(u,r,P){return Uint8Array.prototype.slice?u.slice(r,P):new Uint8Array(Array.prototype.slice.call(u,r,P))}},"./src/utils/vttcue.ts":function(I,M,i){i.r(M),M.default=function(){if(typeof self!="undefined"&&self.VTTCue)return self.VTTCue;var A=["","lr","rl"],u=["start","middle","end","left","right"];function r(c,v){if(typeof v!="string"||!Array.isArray(c))return!1;var h=v.toLowerCase();return~c.indexOf(h)?h:!1}function P(c){return r(A,c)}function O(c){return r(u,c)}function x(c){for(var v=arguments.length,h=new Array(v>1?v-1:0),T=1;T<v;T++)h[T-1]=arguments[T];for(var L=1;L<arguments.length;L++){var g=arguments[L];for(var o in g)c[o]=g[o]}return c}function m(c,v,h){var T=this,L={enumerable:!0};T.hasBeenReset=!1;var g="",o=!1,t=c,a=v,n=h,d=null,l="",s=!0,f="auto",C="start",D=50,E="middle",p=50,y="middle";Object.defineProperty(T,"id",x({},L,{get:function(){return g},set:function(R){g=""+R}})),Object.defineProperty(T,"pauseOnExit",x({},L,{get:function(){return o},set:function(R){o=!!R}})),Object.defineProperty(T,"startTime",x({},L,{get:function(){return t},set:function(R){if(typeof R!="number")throw new TypeError("Start time must be set to a number.");t=R,this.hasBeenReset=!0}})),Object.defineProperty(T,"endTime",x({},L,{get:function(){return a},set:function(R){if(typeof R!="number")throw new TypeError("End time must be set to a number.");a=R,this.hasBeenReset=!0}})),Object.defineProperty(T,"text",x({},L,{get:function(){return n},set:function(R){n=""+R,this.hasBeenReset=!0}})),Object.defineProperty(T,"region",x({},L,{get:function(){return d},set:function(R){d=R,this.hasBeenReset=!0}})),Object.defineProperty(T,"vertical",x({},L,{get:function(){return l},set:function(R){var w=P(R);if(w===!1)throw new SyntaxError("An invalid or illegal string was specified.");l=w,this.hasBeenReset=!0}})),Object.defineProperty(T,"snapToLines",x({},L,{get:function(){return s},set:function(R){s=!!R,this.hasBeenReset=!0}})),Object.defineProperty(T,"line",x({},L,{get:function(){return f},set:function(R){if(typeof R!="number"&&R!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");f=R,this.hasBeenReset=!0}})),Object.defineProperty(T,"lineAlign",x({},L,{get:function(){return C},set:function(R){var w=O(R);if(!w)throw new SyntaxError("An invalid or illegal string was specified.");C=w,this.hasBeenReset=!0}})),Object.defineProperty(T,"position",x({},L,{get:function(){return D},set:function(R){if(R<0||R>100)throw new Error("Position must be between 0 and 100.");D=R,this.hasBeenReset=!0}})),Object.defineProperty(T,"positionAlign",x({},L,{get:function(){return E},set:function(R){var w=O(R);if(!w)throw new SyntaxError("An invalid or illegal string was specified.");E=w,this.hasBeenReset=!0}})),Object.defineProperty(T,"size",x({},L,{get:function(){return p},set:function(R){if(R<0||R>100)throw new Error("Size must be between 0 and 100.");p=R,this.hasBeenReset=!0}})),Object.defineProperty(T,"align",x({},L,{get:function(){return y},set:function(R){var w=O(R);if(!w)throw new SyntaxError("An invalid or illegal string was specified.");y=w,this.hasBeenReset=!0}})),T.displayState=void 0}return m.prototype.getCueAsHTML=function(){var c=self.WebVTT;return c.convertCueToDOMTree(self,this.text)},m}()},"./src/utils/vttparser.ts":function(I,M,i){i.r(M),i.d(M,"parseTimeStamp",function(){return r}),i.d(M,"fixLineBreaks",function(){return v}),i.d(M,"VTTParser",function(){return h});var A=i("./src/utils/vttcue.ts"),u=function(){function T(){}var L=T.prototype;return L.decode=function(o,t){if(!o)return"";if(typeof o!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(o))},T}();function r(T){function L(o,t,a,n){return(o|0)*3600+(t|0)*60+(a|0)+parseFloat(n||0)}var g=T.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return g?parseFloat(g[2])>59?L(g[2],g[3],0,g[4]):L(g[1],g[2],g[3],g[4]):null}var P=function(){function T(){this.values=Object.create(null)}var L=T.prototype;return L.set=function(o,t){!this.get(o)&&t!==""&&(this.values[o]=t)},L.get=function(o,t,a){return a?this.has(o)?this.values[o]:t[a]:this.has(o)?this.values[o]:t},L.has=function(o){return o in this.values},L.alt=function(o,t,a){for(var n=0;n<a.length;++n)if(t===a[n]){this.set(o,t);break}},L.integer=function(o,t){/^-?\d+$/.test(t)&&this.set(o,parseInt(t,10))},L.percent=function(o,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){var a=parseFloat(t);if(a>=0&&a<=100)return this.set(o,a),!0}return!1},T}();function O(T,L,g,o){var t=o?T.split(o):[T];for(var a in t)if(typeof t[a]=="string"){var n=t[a].split(g);if(n.length===2){var d=n[0],l=n[1];L(d,l)}}}var x=new A.default(0,0,""),m=x.align==="middle"?"middle":"center";function c(T,L,g){var o=T;function t(){var d=r(T);if(d===null)throw new Error("Malformed timestamp: "+o);return T=T.replace(/^[^\sa-zA-Z-]+/,""),d}function a(d,l){var s=new P;O(d,function(D,E){var p;switch(D){case"region":for(var y=g.length-1;y>=0;y--)if(g[y].id===E){s.set(D,g[y].region);break}break;case"vertical":s.alt(D,E,["rl","lr"]);break;case"line":p=E.split(","),s.integer(D,p[0]),s.percent(D,p[0])&&s.set("snapToLines",!1),s.alt(D,p[0],["auto"]),p.length===2&&s.alt("lineAlign",p[1],["start",m,"end"]);break;case"position":p=E.split(","),s.percent(D,p[0]),p.length===2&&s.alt("positionAlign",p[1],["start",m,"end","line-left","line-right","auto"]);break;case"size":s.percent(D,E);break;case"align":s.alt(D,E,["start",m,"end","left","right"]);break}},/:/,/\s/),l.region=s.get("region",null),l.vertical=s.get("vertical","");var f=s.get("line","auto");f==="auto"&&x.line===-1&&(f=-1),l.line=f,l.lineAlign=s.get("lineAlign","start"),l.snapToLines=s.get("snapToLines",!0),l.size=s.get("size",100),l.align=s.get("align",m);var C=s.get("position","auto");C==="auto"&&x.position===50&&(C=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=C}function n(){T=T.replace(/^\s+/,"")}if(n(),L.startTime=t(),n(),T.substr(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+o);T=T.substr(3),n(),L.endTime=t(),n(),a(T,L)}function v(T){return T.replace(/<br(?: \/)?>/gi,`
`)}var h=function(){function T(){this.state="INITIAL",this.buffer="",this.decoder=new u,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var L=T.prototype;return L.parse=function(o){var t=this;o&&(t.buffer+=t.decoder.decode(o,{stream:!0}));function a(){var C=t.buffer,D=0;for(C=v(C);D<C.length&&C[D]!=="\r"&&C[D]!==`
`;)++D;var E=C.substr(0,D);return C[D]==="\r"&&++D,C[D]===`
`&&++D,t.buffer=C.substr(D),E}function n(C){O(C,function(D,E){},/:/)}try{var d="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;d=a();var l=d.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!l||!l[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var s=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(s?s=!1:d=a(),t.state){case"HEADER":/:/.test(d)?n(d):d||(t.state="ID");continue;case"NOTE":d||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(d)){t.state="NOTE";break}if(!d)continue;if(t.cue=new A.default(0,0,""),t.state="CUE",d.indexOf("-->")===-1){t.cue.id=d;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{c(d,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{var f=d.indexOf("-->")!==-1;if(!d||f&&(s=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=d}continue;case"BADCUE":d||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},L.flush=function(){var o=this;try{if((o.cue||o.state==="HEADER")&&(o.buffer+=`

`,o.parse()),o.state==="INITIAL"||o.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){o.onparsingerror&&o.onparsingerror(t)}return o.onflush&&o.onflush(),this},T}()},"./src/utils/webvtt-parser.ts":function(I,M,i){i.r(M),i.d(M,"generateCueId",function(){return h}),i.d(M,"parseWebVTT",function(){return L});var A=i("./src/polyfills/number.ts"),u=i("./src/utils/vttparser.ts"),r=i("./src/demux/id3.ts"),P=i("./src/utils/timescale-conversion.ts"),O=i("./src/remux/mp4-remuxer.ts"),x=/\r\n|\n\r|\n|\r/g,m=function(o,t,a){return a===void 0&&(a=0),o.substr(a,t.length)===t},c=function(o){var t=parseInt(o.substr(-3)),a=parseInt(o.substr(-6,2)),n=parseInt(o.substr(-9,2)),d=o.length>9?parseInt(o.substr(0,o.indexOf(":"))):0;if(!Object(A.isFiniteNumber)(t)||!Object(A.isFiniteNumber)(a)||!Object(A.isFiniteNumber)(n)||!Object(A.isFiniteNumber)(d))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+o);return t+=1e3*a,t+=60*1e3*n,t+=60*60*1e3*d,t},v=function(o){for(var t=5381,a=o.length;a;)t=t*33^o.charCodeAt(--a);return(t>>>0).toString()};function h(g,o,t){return v(g.toString())+v(o.toString())+v(t)}var T=function(o,t,a){var n=o[t],d=o[n.prevCC];if(!d||!d.new&&n.new){o.ccOffset=o.presentationOffset=n.start,n.new=!1;return}for(;(l=d)!==null&&l!==void 0&&l.new;){var l;o.ccOffset+=n.start-d.start,n.new=!1,n=d,d=o[n.prevCC]}o.presentationOffset=a};function L(g,o,t,a,n,d,l,s){var f=new u.VTTParser,C=Object(r.utf8ArrayToStr)(new Uint8Array(g)).trim().replace(x,`
`).split(`
`),D=[],E=Object(P.toMpegTsClockFromTimescale)(o,t),p="00:00.000",y=0,S=0,R,w=!0,k=!1;f.oncue=function(_){var F=a[n],U=a.ccOffset,N=(y-E)/9e4;if(F!=null&&F.new&&(S!==void 0?U=a.ccOffset=F.start:T(a,n,N)),N&&(U=N-a.presentationOffset),k){var W=_.endTime-_.startTime,H=Object(O.normalizePts)((_.startTime+U-S)*9e4,d*9e4)/9e4;_.startTime=H,_.endTime=H+W}var G=_.text.trim();_.text=decodeURIComponent(encodeURIComponent(G)),_.id||(_.id=h(_.startTime,_.endTime,G)),_.endTime>0&&D.push(_)},f.onparsingerror=function(_){R=_},f.onflush=function(){if(R){s(R);return}l(D)},C.forEach(function(_){if(w)if(m(_,"X-TIMESTAMP-MAP=")){w=!1,k=!0,_.substr(16).split(",").forEach(function(F){m(F,"LOCAL:")?p=F.substr(6):m(F,"MPEGTS:")&&(y=parseInt(F.substr(7)))});try{S=c(p)/1e3}catch(F){k=!1,R=F}return}else _===""&&(w=!1);f.parse(_+`
`)}),f.flush()}},"./src/utils/xhr-loader.ts":function(I,M,i){i.r(M);var A=i("./src/utils/logger.ts"),u=i("./src/loader/load-stats.ts"),r=/^age:\s*[\d.]+\s*$/m,P=function(){function O(m){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=m?m.xhrSetup:null,this.stats=new u.LoadStats,this.retryDelay=0}var x=O.prototype;return x.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},x.abortInternal=function(){var c=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),c&&(c.onreadystatechange=null,c.onprogress=null,c.readyState!==4&&(this.stats.aborted=!0,c.abort()))},x.abort=function(){var c;this.abortInternal(),(c=this.callbacks)!==null&&c!==void 0&&c.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},x.load=function(c,v,h){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=c,this.config=v,this.callbacks=h,this.retryDelay=v.retryDelay,this.loadInternal()},x.loadInternal=function(){var c=this.config,v=this.context;if(!!c){var h=this.loader=new self.XMLHttpRequest,T=this.stats;T.loading.first=0,T.loaded=0;var L=this.xhrSetup;try{if(L)try{L(h,v.url)}catch{h.open("GET",v.url,!0),L(h,v.url)}h.readyState||h.open("GET",v.url,!0);var g=this.context.headers;if(g)for(var o in g)h.setRequestHeader(o,g[o])}catch(t){this.callbacks.onError({code:h.status,text:t.message},v,h);return}v.rangeEnd&&h.setRequestHeader("Range","bytes="+v.rangeStart+"-"+(v.rangeEnd-1)),h.onreadystatechange=this.readystatechange.bind(this),h.onprogress=this.loadprogress.bind(this),h.responseType=v.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),c.timeout),h.send()}},x.readystatechange=function(){var c=this.context,v=this.loader,h=this.stats;if(!(!c||!v)){var T=v.readyState,L=this.config;if(!h.aborted&&T>=2)if(self.clearTimeout(this.requestTimeout),h.loading.first===0&&(h.loading.first=Math.max(self.performance.now(),h.loading.start)),T===4){v.onreadystatechange=null,v.onprogress=null;var g=v.status;if(g>=200&&g<300){h.loading.end=Math.max(self.performance.now(),h.loading.first);var o,t;if(c.responseType==="arraybuffer"?(o=v.response,t=o.byteLength):(o=v.responseText,t=o.length),h.loaded=h.total=t,!this.callbacks)return;var a=this.callbacks.onProgress;if(a&&a(h,c,o,v),!this.callbacks)return;var n={url:v.responseURL,data:o};this.callbacks.onSuccess(n,h,c,v)}else h.retry>=L.maxRetry||g>=400&&g<499?(A.logger.error(g+" while loading "+c.url),this.callbacks.onError({code:g,text:v.statusText},c,v)):(A.logger.warn(g+" while loading "+c.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,L.maxRetryDelay),h.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),L.timeout)}},x.loadtimeout=function(){A.logger.warn("timeout while loading "+this.context.url);var c=this.callbacks;c&&(this.abortInternal(),c.onTimeout(this.stats,this.context,this.loader))},x.loadprogress=function(c){var v=this.stats;v.loaded=c.loaded,c.lengthComputable&&(v.total=c.total)},x.getCacheAge=function(){var c=null;if(this.loader&&r.test(this.loader.getAllResponseHeaders())){var v=this.loader.getResponseHeader("age");c=v?parseFloat(v):null}return c},O}();M.default=P}}).default})})(qi);var qr=li(qi.exports);const Ic={class:"p-4"},wc=ye({setup(e,{expose:b}){const I=di(),M={github(P,O,x){return`https://raw.githubusercontent.com/${P}/${O}/main/${x}/playlist.m3u8`},HK1(P,O,x){return`https://ghproxy.fsofso.com/https://github.com/${P}/${O}/blob/main/${x}/playlist.m3u8`},HK2(P,O,x){return`https://raw.iqiq.io/${P}/${O}/main/${x}/playlist.m3u8`},HK3(P,O,x){return`https://hk1.monika.love/${P}/${O}/main/${x}/playlist.m3u8`},jsDelivr(P,O,x){return`https://cdn.jsdelivr.net/gh/${P}/${O}/${x}/playlist.m3u8`},other(P,O,x){return`https://raw.githubusercontents.com/${P}/${O}/main/${x}/playlist.m3u8`}},i=(P,O,x)=>Object.keys(M).map(function(m){const c=M[m](P,O,x);return{name:m,url:c,type:"customHls",customType:{customHls:function(v,h){const T=new qr;T.loadSource(v.src),T.attachMedia(v)}}}}),A=i(I.value.username,I.value.repoName,I.value.directoryName),u=ne();let r;return pt(()=>{r=new Rc({container:u.value,autoplay:!1,theme:"#0093ff",loop:!0,lang:"zh-cn",screenshot:!1,hotkey:!0,preload:"auto",volume:.7,mutex:!0,video:{url:A[0].url,quality:A,defaultQuality:0,type:"customHls",customType:{customHls:function(P,O){const x=new qr;x.loadSource(P.src),x.attachMedia(P)}}},contextmenu:[{text:"origin",link:A[0].url}]})}),b({switchVideo(P,O,x){const m=i(P,O,x);r.switchVideo({url:m[0].url,quality:m,defaultQuality:0,type:"customHls",customType:{customHls:function(c,v){const h=new qr;h.loadSource(c.src),h.attachMedia(c)}}})}}),(P,O)=>(q(),se("div",Ic,[De("div",{ref_key:"videoRef",ref:u},null,512)]))}});async function kc(){const e=ne(0),b=ne([]),I=ci(),[M,i]=await Ia(),[A,u]=await fi({});return M||A?(I.close(),Bn(Promise.reject(M||A))):(e.value=i.public_repos,b.value=ea(u),I.close(),Bn(Promise.resolve({total:e,userRepoList:b})))}function ea(e){return e.map(({id:b,name:I,node_id:M,full_name:i,size:A,html_url:u,updated_at:r,created_at:P})=>({id:b,node_id:M,name:I,full_name:i,size:A,html_url:u,updated_at:r,created_at:P})).filter(b=>b.name.startsWith("v"))}var ta={exports:{}};(function(e,b){(function(I,M){e.exports=M()})(ui,function(){var I="minute",M=/[+-]\d\d(?::?\d\d)?/g,i=/([+-]|\d\d)/g;return function(A,u,r){var P=u.prototype;r.utc=function(T){var L={date:T,utc:!0,args:arguments};return new u(L)},P.utc=function(T){var L=r(this.toDate(),{locale:this.$L,utc:!0});return T?L.add(this.utcOffset(),I):L},P.local=function(){return r(this.toDate(),{locale:this.$L,utc:!1})};var O=P.parse;P.parse=function(T){T.utc&&(this.$u=!0),this.$utils().u(T.$offset)||(this.$offset=T.$offset),O.call(this,T)};var x=P.init;P.init=function(){if(this.$u){var T=this.$d;this.$y=T.getUTCFullYear(),this.$M=T.getUTCMonth(),this.$D=T.getUTCDate(),this.$W=T.getUTCDay(),this.$H=T.getUTCHours(),this.$m=T.getUTCMinutes(),this.$s=T.getUTCSeconds(),this.$ms=T.getUTCMilliseconds()}else x.call(this)};var m=P.utcOffset;P.utcOffset=function(T,L){var g=this.$utils().u;if(g(T))return this.$u?0:g(this.$offset)?m.call(this):this.$offset;if(typeof T=="string"&&(T=function(n){n===void 0&&(n="");var d=n.match(M);if(!d)return null;var l=(""+d[0]).match(i)||["-",0,0],s=l[0],f=60*+l[1]+ +l[2];return f===0?0:s==="+"?f:-f}(T),T===null))return this;var o=Math.abs(T)<=16?60*T:T,t=this;if(L)return t.$offset=o,t.$u=T===0,t;if(T!==0){var a=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(t=this.local().add(o+a,I)).$offset=o,t.$x.$localOffset=a}else t=this.utc();return t};var c=P.format;P.format=function(T){var L=T||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return c.call(this,L)},P.valueOf=function(){var T=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*T},P.isUTC=function(){return!!this.$u},P.toISOString=function(){return this.toDate().toISOString()},P.toString=function(){return this.toDate().toUTCString()};var v=P.toDate;P.toDate=function(T){return T==="s"&&this.$offset?r(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():v.call(this)};var h=P.diff;P.diff=function(T,L,g){if(T&&this.$u===T.$u)return h.call(this,T,L,g);var o=this.local(),t=r(T).local();return h.call(o,t,L,g)}}})})(ta);var _c=ta.exports;const Bc=ye({async setup(e){let b,I;ka.extend(_c);let M=ne([]),i=di(),A=ne(0),u=ne(1),r=ne(30),P=ne(null),O=ne(!0);ne(null);let x=ne(null);const m=ne(!1),[c,v]=([b,I]=_a(()=>kc()),b=await b,I(),b);if(!c&&v){const{userRepoList:L,total:g}=v;M.value=L.value,A.value=g.value}Me([r,u],async([L,g])=>{const o=ci(),[t,a]=await fi({page:g,per_page:L});if(t)return o.close(),Promise.reject(t);M.value=ea(a),o.close()});async function h(L,g){console.log(L,g),m.value=!0;const[o,t]=await Fa(L);if(o)return m.value=!1,Promise.reject(o);M.value.forEach(a=>{a.name===L&&(a.children=t.map(n=>({name:n.name,path:`${n.path}`})))}),m.value=!1}function T({indexPath:L}){i.value.repoName=L[0],i.value.directoryName=L[1];const g=x.value;g&&g.switchVideo(i.value.username,i.value.repoName,i.value.directoryName),console.log("target::",i.value)}return pt(()=>{console.log("dPlayerRef::",x)}),(L,g)=>{const o=Pc,t=Ut,a=Ac,n=pd,d=vd,l=hd,s=Li,f=zu,C=bc,D=Ha,E=Vu,p=Yu,y=vc,S=$u,R=Gu,w=Ba;return q(),xe(R,{style:{height:"100%"}},{default:ve(()=>[Ae(f,{style:{width:"auto"}},{default:ve(()=>[Ae(s,{ref_key:"leftScrollRef",ref:P},{default:ve(()=>[Ae(l,{collapse:ce(O),class:"el-menu-vertical","menu-trigger":"click",onOpen:h},{default:ve(()=>[(q(!0),se(ut,null,ir(ce(M),k=>(q(),xe(d,{key:k.id,index:k.name},{title:ve(()=>[Ae(t,null,{default:ve(()=>[Ae(o)]),_:1}),gt(De("span",null,Je(k.name),513),[[Vt,!ce(O)]])]),default:ve(()=>[gt((q(),se("div",null,[k.children?(q(!0),se(ut,{key:0},ir(k.children,_=>(q(),xe(n,{key:_.name,index:_.path,onClick:T},{default:ve(()=>[Ae(t,null,{default:ve(()=>[Ae(a)]),_:1}),xr(" "+Je(_.name),1)]),_:2},1032,["index"]))),128)):(q(),se(ut,{key:1},[],64))])),[[w,m.value]])]),_:2},1032,["index"]))),128))]),_:1},8,["collapse"])]),_:1},512)]),_:1}),Ae(R,null,{default:ve(()=>[Ae(E,{style:{"padding-left":"0px"}},{default:ve(()=>[Ae(D,{size:"large",text:"",style:{height:"100%","border-radius":"0"},onClick:g[0]||(g[0]=()=>{gr(O)?O.value=!ce(O):O=!ce(O)})},{icon:ve(()=>[Ae(t,{style:{"font-size":"24px"}},{default:ve(()=>[Ae(C)]),_:1})]),_:1})]),_:1}),Ae(p,null,{default:ve(()=>[Ae(wc,{ref_key:"dPlayerRef",ref:x},null,512)]),_:1}),Ae(S,null,{default:ve(()=>[Ae(y,{currentPage:ce(u),"onUpdate:currentPage":[g[1]||(g[1]=k=>gr(u)?u.value=k:u=k),g[3]||(g[3]=k=>{gr(u)?u.value=k:u=k})],currentPageModifiers:{sync:!0},background:"",layout:"prev, sizes,pager, next","page-sizes":[30,50,80,100],"page-size":ce(r),total:ce(A),style:{"justify-content":"center"},"onUpdate:pageSize":g[2]||(g[2]=k=>{gr(r)?r.value=k:r=k})},null,8,["currentPage","page-size","total"])]),_:1})]),_:1})]),_:1})}}});var Kc=wa(Bc,[["__scopeId","data-v-57e39456"]]);export{Kc as default};
